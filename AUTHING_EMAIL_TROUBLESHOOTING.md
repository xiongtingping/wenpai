# Authing 邮箱验证码问题排查指南

## 🔍 **问题诊断**

### 当前状态
- ✅ App ID 和 Host 配置正确
- ✅ 应用连接正常
- ❌ 邮箱验证码发送失败（400 错误）

### 错误信息
```
Request failed with status code 400
```

## 🔧 **排查步骤**

### 1. 登录 Authing 控制台
访问：https://console.authing.cn/

### 2. 检查应用配置

#### 2.1 登录配置
1. 进入应用设置 → "登录配置"
2. 检查以下项目是否已启用：
   - ✅ 邮箱验证码登录
   - ✅ 邮箱验证码注册
   - ✅ 邮箱找回密码

#### 2.2 邮箱服务配置
1. 进入"消息服务" → "邮箱服务"
2. 检查是否已配置邮箱服务提供商：
   - SendGrid
   - 阿里云邮件推送
   - 腾讯云邮件推送
   - 其他邮件服务商

**注意：免费版 Authing 可能不提供邮箱服务，需要升级到付费版**

#### 2.3 邮箱模板配置
1. 进入"消息服务" → "邮箱模板"
2. 检查以下模板是否已启用：
   - 验证码模板
   - 注册模板
   - 登录模板
   - 找回密码模板

### 3. 安全设置检查

#### 3.1 域名白名单
1. 进入"安全设置"
2. 检查域名白名单是否包含：
   - `www.wenpai.xyz`
   - `wenpai.xyz`

#### 3.2 回调地址
1. 检查回调地址配置：
   - `https://www.wenpai.xyz/callback`

### 4. 应用状态检查

#### 4.1 应用状态
- 确认应用状态为"正常"
- 检查是否在免费额度内

#### 4.2 邮箱服务额度
- 检查邮箱服务是否还有剩余额度
- 免费版可能限制邮箱功能

## 🛠️ **解决方案**

### 方案1：升级到付费版 Authing
1. 联系 Authing 销售团队
2. 升级到付费版以获得完整的邮箱服务功能

### 方案2：配置邮箱服务
1. 在 Authing 控制台配置邮箱服务提供商
2. 常用的免费邮箱服务：
   - SendGrid（每月免费 100 封）
   - 阿里云邮件推送
   - 腾讯云邮件推送

### 方案3：使用短信验证码替代
1. 在登录配置中启用短信验证码
2. 配置短信服务提供商

### 方案4：使用密码登录
1. 暂时使用密码登录功能
2. 在登录配置中启用密码登录

## 📋 **测试命令**

### 运行诊断脚本
```bash
node diagnose-authing.cjs
```

### 测试邮箱发送
```bash
node test-simple-email.cjs xiongtingping@gmail.com
```

### 检查可用方法
```bash
node test-authing-methods.cjs
```

## 📞 **技术支持**

如果以上步骤都无法解决问题，建议：

1. 查看 Authing 官方文档：https://docs.authing.cn/
2. 联系 Authing 技术支持
3. 在 Authing 社区寻求帮助

## 🔄 **临时解决方案**

在邮箱验证码功能修复之前，可以：

1. 使用密码登录功能
2. 使用社交登录（如微信、QQ等）
3. 使用短信验证码登录
4. 暂时禁用邮箱验证码登录

---

**最后更新：2024-07-14**
**状态：等待 Authing 控制台配置检查** 