/**
 * å†…å®¹æ–¹æ¡ˆé…ç½®
 * å®šä¹‰ä¸åŒé£æ ¼çš„å†…å®¹ç”Ÿæˆæ–¹æ¡ˆ
 */

/**
 * å†…å®¹æ–¹æ¡ˆæ¥å£
 */
export interface ContentScheme {
  id: string;
  name: string;
  description: string;
  icon: string;
  color: string;
  platforms: string[];
  features: string[];
  isDefault?: boolean;
}

/**
 * å¹³å°æç¤ºè¯æ¨¡æ¿æ¥å£
 */
export interface PlatformPromptTemplate {
  name: string;
  styleGuide: string;
  prompt: (input: string) => string;
}

/**
 * å…¨åŸŸå†…å®¹é€‚é…æ–¹æ¡ˆ
 * é’ˆå¯¹ä¸åŒå¹³å°ç‰¹ç‚¹çš„å†…å®¹ç”Ÿæˆæ–¹æ¡ˆ
 */
export const globalContentAdaptationScheme: ContentScheme = {
  id: 'global-adaptation',
  name: 'å…¨åŸŸå†…å®¹é€‚é…æ–¹æ¡ˆ',
  description: 'é’ˆå¯¹å°çº¢ä¹¦ã€å¾®åšã€å¾®ä¿¡ã€æŠ–éŸ³ã€çŸ¥ä¹ã€Bç«™ç­‰ä¸»æµå¹³å°çš„ä¸“ä¸šå†…å®¹é€‚é…æ–¹æ¡ˆï¼Œç¡®ä¿å†…å®¹ç¬¦åˆå„å¹³å°ç‰¹è‰²å’Œç”¨æˆ·ä¹ æƒ¯',
  icon: 'ğŸŒ',
  color: 'from-purple-500 to-indigo-600',
  platforms: ['xiaohongshu', 'weibo', 'wechat', 'douyin', 'zhihu', 'bilibili'],
  features: [
    'å¤šå¹³å°é£æ ¼é€‚é…',
    'ä¸“ä¸šæç¤ºè¯æ¨¡æ¿',
    'å¹³å°ç‰¹è‰²ä¼˜åŒ–',
    'ç”¨æˆ·ä¹ æƒ¯åŒ¹é…',
    'å†…å®¹ç»“æ„è§„èŒƒ',
    'äº’åŠ¨å¼•å¯¼è®¾è®¡'
  ],
  isDefault: true
};

/**
 * å¹³å°æç¤ºè¯æ¨¡æ¿é…ç½®
 */
export const platformPromptTemplates: Record<string, PlatformPromptTemplate> = {
  xiaohongshu: {
    name: 'å°çº¢ä¹¦',
    styleGuide: `é£æ ¼ï¼šäº²åˆ‡ã€ç»†è…»ã€æœ‰ç”Ÿæ´»ç¾å­¦ã€‚å¸¸ç”¨è¡¨è¾¾å¦‚"å·¨å¥½ç”¨"ã€"é—­çœ¼å…¥"ã€"å§å¦¹ä»¬çœ‹è¿‡æ¥ï¼"ã€‚
å†™ä½œç»“æ„å»ºè®®ï¼š
1. ç”¨é’©å­å¸å¼•ç‚¹å‡»ï¼ˆå¦‚"è¿™ç©æ„ä¹Ÿå¤ªé¦™äº†å§ï¼"ï¼‰
2. åˆ†äº«äº²èº«ä½“éªŒèƒŒæ™¯
3. äº§å“ä½¿ç”¨æ„Ÿå—
4. æ€»ç»“äº®ç‚¹+æ¨èç†ç”±

ä½¿ç”¨ emoji è¡¨æƒ…ï¼Œå¹¶ä»¥"ç¬¬ä¸€äººç§°"è¯­æ°”æ’°å†™ï¼Œé¿å…AIè…”è°ƒï¼ŒçœŸå®è‡ªç„¶ã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½æ“…é•¿æ’°å†™å°çº¢ä¹¦çˆ†æ¬¾ç¬”è®°çš„å†…å®¹åˆ›ä½œè€…ã€‚

è¯·æ ¹æ®ä»¥ä¸‹åŸå§‹å†…å®¹ï¼Œç”Ÿæˆä¸€ç¯‡ç¬¦åˆå°çº¢ä¹¦é£æ ¼çš„å›¾æ–‡ç¬”è®°å†…å®¹ï¼Œé£æ ¼è¦æœ‰"é—ºèœœæ„Ÿ"å’Œ"ç§è‰åŠ›"ï¼ŒåŠ å…¥çœŸå®ä½“éªŒæè¿°å’Œå£è¯­åŒ–è¡¨è¾¾ï¼š

åŸå§‹å†…å®¹ï¼š
${input}

è¯·è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼šXXXXXï¼ˆæœ‰å¸å¼•åŠ›çš„ç¬”è®°æ ‡é¢˜ï¼‰
å†…å®¹ï¼šXXXXXï¼ˆæ­£æ–‡å†…å®¹ï¼ŒåŒ…å«ç”Ÿæ´»æ„Ÿå—ã€ç»†èŠ‚ä½“éªŒã€çœŸå®æ¨èï¼Œä½¿ç”¨emojiï¼‰`,
  },

  weibo: {
    name: 'å¾®åš',
    styleGuide: `é£æ ¼ï¼šç®€æ´ã€æœ‰è§‚ç‚¹ã€çƒ­ç‚¹æ„Ÿå¼ºã€‚é€‚åˆè¹­çƒ­åº¦å’Œäº’åŠ¨ã€‚
å»ºè®®åŠ å…¥è¯é¢˜æ ‡ç­¾ï¼ˆ#XX#ï¼‰ã€@ç”¨æˆ·ï¼Œä»¥åŠç®€çŸ­å¸¦æƒ…ç»ªçš„å¥å­ã€‚

è¯­è¨€è¦æœ‰"çˆ½æ„Ÿ"ï¼Œç»“å°¾å»ºè®®å¼•å¯¼è®¨è®ºæˆ–æŠ•ç¥¨ã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½æ“…é•¿æ’°å†™å¾®åšçƒ­è¯„å†…å®¹çš„ç”¨æˆ·ã€‚

è¯·æ ¹æ®ä»¥ä¸‹åŸå§‹å†…å®¹ï¼Œç”Ÿæˆä¸€æ¡å¾®åšå†…å®¹ï¼š
- è¯­è¨€è¦çŸ­å°æœ‰åŠ›ï¼Œæœ€å¥½æ§åˆ¶åœ¨200å­—ä»¥å†…
- å¸¦è¯é¢˜ #XX#
- å¼•å¯¼è¯»è€…è½¬å‘/è®¨è®º

åŸå§‹å†…å®¹ï¼š
${input}

è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼š#å…³é”®è¯è¯é¢˜#
å†…å®¹ï¼šXXXXï¼ˆç®€æ´è¡¨è¾¾è§‚ç‚¹ï¼Œå¯ä½¿ç”¨ç½‘ç»œæµè¡Œè¯­ï¼‰`,
  },

  wechat: {
    name: 'å¾®ä¿¡',
    styleGuide: `é£æ ¼ï¼šä¸“ä¸šã€æƒå¨ï¼Œé€‚åˆèŒåœºäººç¾¤é˜…è¯»ã€‚
æ–‡ç« ç»“æ„è¦æ¸…æ™°ï¼Œæœ‰é€»è¾‘ï¼Œæœ‰æ´å¯Ÿï¼Œæ”¯æŒå¼•ç”¨æƒå¨è§‚ç‚¹æˆ–æ•°æ®ã€‚

è¯­è¨€æ­£å¼ã€å‡†ç¡®ã€é¿å…AIè…”å’Œå£è¯­åŒ–è¡¨è¾¾ã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½ä¸“ä¸šå†…å®¹ç¼–è¾‘ï¼Œè´Ÿè´£æ’°å†™é€‚åˆå¾®ä¿¡å…¬ä¼—å¹³å°å‘å¸ƒçš„æ·±åº¦å†…å®¹æ–‡ç« ã€‚

è¯·æ ¹æ®ä»¥ä¸‹åŸå§‹å†…å®¹ï¼Œæ’°å†™ä¸€ç¯‡ä¸“ä¸šæ–‡ç« ï¼Œç»“æ„æ¸…æ™°ï¼Œé€»è¾‘å®Œæ•´ï¼Œç”¨è¯ä¸¥è°¨ï¼š

åŸå§‹å†…å®¹ï¼š
${input}

è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼šXXXXXï¼ˆä¸“ä¸šæ€§å¼ºï¼Œå‡†ç¡®è¡¨è¾¾ä¸»é¢˜ï¼‰
å†…å®¹ï¼šXXXXï¼ˆä¸å°‘äº500å­—ï¼Œå…·æœ‰æ·±åº¦ä¸å¯è¯»æ€§ï¼‰`,
  },

  douyin: {
    name: 'æŠ–éŸ³',
    styleGuide: `é£æ ¼ï¼šè½»æ¾ã€æœ‰è¶£ã€ä¸Šå¤´ã€‚é€‚åˆé…åˆè§†é¢‘èŠ‚å¥ï¼Œå…·å¤‡æƒ…ç»ªåè½¬ã€‚
è¯­æ°”éœ€å…·å¤‡"è¯­éŸ³è½¬æ–‡å­—æ„Ÿ"ï¼Œå¦‚"å§å¦¹ä»¬ï¼Œè¿™ä¹Ÿå¤ªç¦»è°±äº†å§ï¼"

å»ºè®®è¾“å‡º3æ®µå¼è„šæœ¬ï¼šå¼€å¤´å¸å¼•äººâ†’ä¸­æ®µåè½¬â†’ç»“å°¾é«˜èƒ½å¼•å¯¼äº’åŠ¨ã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½æŠ–éŸ³çŸ­è§†é¢‘è„šæœ¬åˆ›ä½œè€…ã€‚

è¯·å°†ä»¥ä¸‹åŸå§‹å†…å®¹æ”¹å†™ä¸ºé€‚åˆæ‹æ‘„æŠ–éŸ³çŸ­è§†é¢‘çš„æ–‡å­—è„šæœ¬ï¼Œè¯­æ°”æ´»æ³¼ï¼Œæœ‰æƒ…ç»ªåè½¬ï¼Œé€‚åˆé…ä¹èŠ‚å¥ï¼š

åŸå§‹å†…å®¹ï¼š
${input}

è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼šXXXXXï¼ˆçˆ†ç‚¹æ ‡é¢˜ï¼‰
è„šæœ¬å†…å®¹ï¼š
ç”»é¢ä¸€ï¼š[è„šæœ¬æ–‡æ¡ˆ]
ç”»é¢äºŒï¼š[è„šæœ¬æ–‡æ¡ˆ]
ç”»é¢ä¸‰ï¼š[è„šæœ¬æ–‡æ¡ˆ]
ç»“å°¾Call to Actionï¼š[å¼•å¯¼å…³æ³¨/è¯„è®ºçš„è¯è¯­]`,
  },

  zhihu: {
    name: 'çŸ¥ä¹',
    styleGuide: `é£æ ¼ï¼šç†æ€§ã€æ·±åº¦ã€ç»“æ„åŒ–ã€‚å»ºè®®"æ€»-åˆ†-æ€»"ç»“æ„ï¼Œå†…å®¹é€»è¾‘è¦ä¸¥è°¨ï¼Œæœ‰è¯æ®æˆ–æ•°æ®æ”¯æŒã€‚

è¯­æ°”éœ€å…‹åˆ¶ã€ä¸“ä¸šï¼Œé¿å…æƒ…ç»ªåŒ–æˆ–å•†ä¸šåŒ–è¡¨è¿°ã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½çŸ¥ä¹ç­”ä¸»ï¼Œæ“…é•¿ç†æ€§åˆ†æã€é€»è¾‘è¡¨è¾¾ã€‚

è¯·æ ¹æ®ä»¥ä¸‹åŸå§‹å†…å®¹ï¼Œæ’°å†™ä¸€ç¯‡çŸ¥ä¹å›ç­”ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæœ‰æ·±åº¦ï¼Œå¼•ç”¨ä¾‹è¯æ•°æ®æ›´ä½³ï¼š

åŸå§‹å†…å®¹ï¼š
${input}

è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼šXXXXXï¼ˆå¦‚"å¦‚ä½•çœ‹å¾…â€¦"ã€"ä¸ºä»€ä¹ˆâ€¦"ï¼‰
å†…å®¹ï¼š1ï¼‰è§‚ç‚¹é™ˆè¿° 2ï¼‰é€»è¾‘è®ºè¯ï¼ˆå«ä¸¾ä¾‹ï¼‰3ï¼‰æ€»ç»“å½’çº³`,
  },

  bilibili: {
    name: 'Bç«™',
    styleGuide: `é£æ ¼ï¼šå¹´è½»ã€æ´»åŠ›ã€æœ‰æ¢—ã€‚é€‚åˆè§†é¢‘ç®€ä»‹ã€å¼€ç®±ç¨¿ã€æç¬‘åæ§½ã€å®‰åˆ©å‹å†…å®¹ã€‚

è¯­æ°”è¦è½»æ¾ã€èƒ½ç©æ¢—ï¼Œé€‚åˆ"å¼¹å¹•åœºæ™¯"å…±é¸£æ„Ÿã€‚`,
    prompt: (input: string) => `ä½ æ˜¯ä¸€ä½Bç«™è§†é¢‘upä¸»ï¼Œæ“…é•¿æ’°å†™æç¬‘ã€æœ‰å…±é¸£çš„å†…å®¹ç®€ä»‹ã€‚

è¯·å°†ä»¥ä¸‹åŸå§‹å†…å®¹æ”¹å†™ä¸ºé€‚åˆBç«™é£æ ¼çš„è§†é¢‘ç®€ä»‹ï¼Œè¯­æ°”å¹´è½»ã€æœ‰æ¢—ã€æ¥åœ°æ°”ï¼š

åŸå§‹å†…å®¹ï¼š
${input}

è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š

æ ‡é¢˜ï¼šã€XXXXã€‘ï¼ˆç”¨ã€ã€‘åŒ…å›´ï¼Œå¸¦æœ‰æ¢—æˆ–æƒ…ç»ªï¼‰
ç®€ä»‹å†…å®¹ï¼šXXXXXï¼ˆè¯­è¨€è½»æ¾æ´»æ³¼ï¼Œå¯å¸¦è°ƒä¾ƒæˆ–äºŒæ¬¡å…ƒè¯­æ°”ï¼‰`,
  },
};

/**
 * å¹³å°æŠ€æœ¯è§„æ ¼
 */
export const platformSpecifications = {
  xiaohongshu: {
    maxLength: 1000,
    hashtagCount: 20,
    features: ['å›¾æ–‡ç¬”è®°', 'ç§è‰æ¨è', 'ç”Ÿæ´»åˆ†äº«', 'è¯é¢˜æŒ‘æˆ˜'],
    bestPractices: [
      'ä½¿ç”¨é«˜è´¨é‡å›¾ç‰‡',
      'æ·»åŠ ç›¸å…³è¯é¢˜æ ‡ç­¾',
      'åˆ†äº«çœŸå®ä½¿ç”¨ä½“éªŒ',
      'ä¸ç²‰ä¸äº’åŠ¨å›å¤'
    ]
  },
  weibo: {
    maxLength: 200,
    hashtagCount: 10,
    features: ['å®æ—¶åŠ¨æ€', 'è¯é¢˜è®¨è®º', 'çƒ­ç‚¹è¿½è¸ª', 'ç²‰ä¸äº’åŠ¨'],
    bestPractices: [
      'æŠ“ä½çƒ­ç‚¹è¯é¢˜',
      'ä½¿ç”¨è¯é¢˜æ ‡ç­¾',
      'é…å›¾å¢å¼ºè¡¨è¾¾',
      'å¼•å¯¼ç”¨æˆ·äº’åŠ¨'
    ]
  },
  wechat: {
    maxLength: 5000,
    hashtagCount: 0,
    features: ['æ·±åº¦æ–‡ç« ', 'ä¸“ä¸šåˆ†æ', 'è¡Œä¸šæ´å¯Ÿ', 'æƒå¨å‘å¸ƒ'],
    bestPractices: [
      'å†…å®¹ç»“æ„æ¸…æ™°',
      'å¼•ç”¨æƒå¨æ•°æ®',
      'ä¸“ä¸šæœ¯è¯­å‡†ç¡®',
      'é€»è¾‘è®ºè¯å®Œæ•´'
    ]
  },
  douyin: {
    maxLength: 300,
    hashtagCount: 15,
    features: ['çŸ­è§†é¢‘', 'éŸ³ä¹é…ä¹', 'ç‰¹æ•ˆæ»¤é•œ', 'ç›´æ’­å¸¦è´§'],
    bestPractices: [
      'å¼€å¤´3ç§’å¸å¼•æ³¨æ„',
      'èŠ‚å¥æ„Ÿå¼º',
      'æƒ…ç»ªåè½¬',
      'å¼•å¯¼å…³æ³¨äº’åŠ¨'
    ]
  },
  zhihu: {
    maxLength: 10000,
    hashtagCount: 0,
    features: ['é—®ç­”ç¤¾åŒº', 'ä¸“ä¸šè®¨è®º', 'çŸ¥è¯†åˆ†äº«', 'ç†æ€§åˆ†æ'],
    bestPractices: [
      'é€»è¾‘ç»“æ„æ¸…æ™°',
      'å¼•ç”¨å¯é æ•°æ®',
      'é¿å…æƒ…ç»ªåŒ–è¡¨è¾¾',
      'æä¾›æœ‰ä»·å€¼è§‚ç‚¹'
    ]
  },
  bilibili: {
    maxLength: 2000,
    hashtagCount: 10,
    features: ['è§†é¢‘å¹³å°', 'å¼¹å¹•äº’åŠ¨', 'äºŒæ¬¡å…ƒæ–‡åŒ–', 'å¹´è½»ç¾¤ä½“'],
    bestPractices: [
      'æ ‡é¢˜æœ‰æ¢—æœ‰è¶£',
      'å†…å®¹æ¥åœ°æ°”',
      'ä¸å¼¹å¹•äº’åŠ¨',
      'ä¿æŒå¹´è½»æ´»åŠ›'
    ]
  }
};

/**
 * å†…å®¹æ–¹æ¡ˆåˆ—è¡¨
 */
export const contentSchemes: ContentScheme[] = [
  globalContentAdaptationScheme,
  {
    id: 'universal',
    name: 'é€šç”¨é€‚é…æ–¹æ¡ˆ',
    description: 'é€‚ç”¨äºå¤§å¤šæ•°å¹³å°çš„åŸºç¡€å†…å®¹é€‚é…ï¼Œä¿æŒå†…å®¹æ ¸å¿ƒä»·å€¼çš„åŒæ—¶è¿›è¡Œé€‚åº¦è°ƒæ•´',
    icon: 'ğŸ”„',
    color: 'from-blue-500 to-cyan-500',
    platforms: ['general'],
    features: [
      'é€šç”¨å†…å®¹é€‚é…',
      'ä¿æŒæ ¸å¿ƒä»·å€¼',
      'é€‚åº¦é£æ ¼è°ƒæ•´',
      'å¤šå¹³å°å…¼å®¹'
    ]
  },
  {
    id: 'marketing',
    name: 'è¥é”€æ¨å¹¿æ–¹æ¡ˆ',
    description: 'ä¸“æ³¨äºè¥é”€æ•ˆæœçš„å†…å®¹é€‚é…ï¼Œå¼ºè°ƒè½¬åŒ–ç‡å’Œç”¨æˆ·è¡ŒåŠ¨å¼•å¯¼',
    icon: 'ğŸ“ˆ',
    color: 'from-green-500 to-emerald-500',
    platforms: ['marketing'],
    features: [
      'è¥é”€å¯¼å‘',
      'è½¬åŒ–ä¼˜åŒ–',
      'è¡ŒåŠ¨å¼•å¯¼',
      'æ•ˆæœè¿½è¸ª'
    ]
  },
  {
    id: 'creative',
    name: 'åˆ›æ„å†™ä½œæ–¹æ¡ˆ',
    description: 'æ³¨é‡åˆ›æ„æ€§å’Œç‹¬ç‰¹æ€§çš„å†…å®¹ç”Ÿæˆï¼Œé€‚åˆéœ€è¦å·®å¼‚åŒ–è¡¨è¾¾çš„åœºæ™¯',
    icon: 'âœ¨',
    color: 'from-purple-500 to-pink-500',
    platforms: ['creative'],
    features: [
      'åˆ›æ„è¡¨è¾¾',
      'å·®å¼‚åŒ–å†…å®¹',
      'ç‹¬ç‰¹è§†è§’',
      'è‰ºæœ¯æ€§è¡¨è¾¾'
    ]
  }
];

/**
 * è·å–æ–¹æ¡ˆé…ç½®
 */
export function getContentScheme(schemeId: string): ContentScheme | undefined {
  return contentSchemes.find(scheme => scheme.id === schemeId);
}

/**
 * è·å–å¹³å°æç¤ºè¯æ¨¡æ¿
 */
export function getPlatformPromptTemplate(platform: string): PlatformPromptTemplate | undefined {
  return platformPromptTemplates[platform];
}

/**
 * è·å–å¹³å°æŠ€æœ¯è§„æ ¼
 */
export function getPlatformSpecification(platform: string) {
  return platformSpecifications[platform as keyof typeof platformSpecifications];
}

/**
 * ç”Ÿæˆå¹³å°é€‚é…å†…å®¹
 */
export function generatePlatformContent(
  originalContent: string,
  platform: string,
  schemeId: string = 'global-adaptation'
): string {
  const template = getPlatformPromptTemplate(platform);
  if (!template) {
    return originalContent;
  }

  // æ ¹æ®æ–¹æ¡ˆIDè°ƒæ•´æç¤ºè¯
  let adjustedPrompt = template.prompt(originalContent);
  
  if (schemeId === 'marketing') {
    adjustedPrompt += '\n\næ³¨æ„ï¼šé‡ç‚¹çªå‡ºè¥é”€æ•ˆæœå’Œè½¬åŒ–å¼•å¯¼ï¼Œä½¿ç”¨æ›´å…·è¯´æœåŠ›çš„è¡¨è¾¾ã€‚';
  } else if (schemeId === 'creative') {
    adjustedPrompt += '\n\næ³¨æ„ï¼šæ³¨é‡åˆ›æ„æ€§å’Œç‹¬ç‰¹æ€§ï¼Œä½¿ç”¨æ›´æœ‰æƒ³è±¡åŠ›çš„è¡¨è¾¾æ–¹å¼ã€‚';
  }

  return adjustedPrompt;
} 