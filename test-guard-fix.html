<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guardä¿®å¤éªŒè¯</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .status { padding: 15px; margin: 10px 0; border-radius: 8px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        button { padding: 12px 24px; margin: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .countdown { font-size: 20px; font-weight: bold; color: #007bff; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Guardæ„é€ å‡½æ•°ä¿®å¤éªŒè¯</h1>
    
    <div class="status success">
        <strong>ä¿®å¤å†…å®¹ï¼š</strong>ä¿®å¤äº†Guardæ„é€ å‡½æ•°çš„å‚æ•°æ ¼å¼ï¼Œä»é”™è¯¯çš„åˆ†ç¦»å‚æ•°æ”¹ä¸ºæ­£ç¡®çš„å•ä¸€é…ç½®å¯¹è±¡
    </div>
    
    <div class="status info">
        <strong>ä¿®å¤å‰ï¼š</strong><code>new Guard(config.appId, { host: ..., redirectUri: ... })</code><br>
        <strong>ä¿®å¤åï¼š</strong><code>new Guard({ appId: config.appId, host: ..., redirectUri: ... })</code>
    </div>
    
    <h2>ğŸ” è‡ªåŠ¨éªŒè¯æµ‹è¯•</h2>
    <div class="countdown" id="countdown">10</div>
    <div id="auto-test-results"></div>
    
    <h2>ğŸš€ æ‰‹åŠ¨éªŒè¯</h2>
    <button class="btn-primary" onclick="openMainApp()">æ‰“å¼€ä¸»åº”ç”¨</button>
    <button class="btn-success" onclick="testLogin()">æµ‹è¯•ç™»å½•åŠŸèƒ½</button>
    
    <h2>ğŸ“Š éªŒè¯æ¸…å•</h2>
    <div id="checklist">
        <div class="test-result" id="check-1">â³ æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦è¿˜æœ‰"appId is required"é”™è¯¯</div>
        <div class="test-result" id="check-2">â³ æ£€æŸ¥Guardå®ä¾‹æ˜¯å¦æˆåŠŸåˆå§‹åŒ–</div>
        <div class="test-result" id="check-3">â³ æ£€æŸ¥é…ç½®è°ƒè¯•ä¿¡æ¯æ˜¯å¦æ­£ç¡®æ˜¾ç¤º</div>
        <div class="test-result" id="check-4">â³ æ£€æŸ¥ç™»å½•æŒ‰é’®æ˜¯å¦å¯ä»¥æ­£å¸¸ç‚¹å‡»</div>
    </div>
    
    <div id="results"></div>
    
    <script>
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }
        
        function addAutoTestResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            document.getElementById('auto-test-results').appendChild(div);
        }
        
        function updateCheck(checkId, status, message) {
            const element = document.getElementById(checkId);
            if (element) {
                const icon = status ? 'âœ…' : 'âŒ';
                element.innerHTML = `${icon} ${message}`;
                element.className = `test-result ${status ? 'success' : 'error'}`;
            }
        }
        
        function openMainApp() {
            addResult('ğŸš€ æ­£åœ¨æ‰“å¼€ä¸»åº”ç”¨...', 'info');
            window.open('http://localhost:5174', '_blank');
            addResult('ğŸ“ ä¸»åº”ç”¨å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°', 'success');
        }
        
        function testLogin() {
            addResult('ğŸ”§ è¯·åœ¨ä¸»åº”ç”¨ä¸­ç‚¹å‡»ç™»å½•æŒ‰é’®æµ‹è¯•åŠŸèƒ½', 'warning');
            addResult('ğŸ“‹ é¢„æœŸç»“æœï¼šä¸å†å‡ºç°"appId is required"é”™è¯¯', 'info');
        }
        
        async function runAutoTest() {
            addAutoTestResult('ğŸ” å¼€å§‹è‡ªåŠ¨éªŒè¯æµ‹è¯•...', 'info');
            
            // æµ‹è¯•1ï¼šæ£€æŸ¥ä¸»åº”ç”¨å¯è®¿é—®æ€§
            try {
                const response = await fetch('http://localhost:5174');
                if (response.ok) {
                    addAutoTestResult('âœ… ä¸»åº”ç”¨å¯è®¿é—®', 'success');
                    updateCheck('check-1', true, 'ä¸»åº”ç”¨è¿è¡Œæ­£å¸¸');
                } else {
                    addAutoTestResult('âŒ ä¸»åº”ç”¨å“åº”å¼‚å¸¸', 'error');
                    updateCheck('check-1', false, 'ä¸»åº”ç”¨å“åº”å¼‚å¸¸');
                    return;
                }
            } catch (error) {
                addAutoTestResult('âŒ æ— æ³•è¿æ¥åˆ°ä¸»åº”ç”¨', 'error');
                updateCheck('check-1', false, 'æ— æ³•è¿æ¥åˆ°ä¸»åº”ç”¨');
                return;
            }
            
            // æµ‹è¯•2ï¼šæ¨¡æ‹ŸGuardé…ç½®éªŒè¯
            addAutoTestResult('ğŸ”§ æ¨¡æ‹ŸGuardé…ç½®éªŒè¯...', 'info');
            
            const mockConfig = {
                appId: '68823897631e1ef8ff3720b2',
                host: 'https://rzcswqd4sq0f.authing.cn',
                redirectUri: 'http://localhost:5174/callback',
                mode: 'modal'
            };
            
            // éªŒè¯é…ç½®æ ¼å¼
            if (mockConfig.appId && mockConfig.host && mockConfig.redirectUri) {
                addAutoTestResult('âœ… é…ç½®æ ¼å¼éªŒè¯é€šè¿‡', 'success');
                updateCheck('check-2', true, 'Guardé…ç½®æ ¼å¼æ­£ç¡®');
            } else {
                addAutoTestResult('âŒ é…ç½®æ ¼å¼éªŒè¯å¤±è´¥', 'error');
                updateCheck('check-2', false, 'Guardé…ç½®æ ¼å¼é”™è¯¯');
            }
            
            // æµ‹è¯•3ï¼šæ£€æŸ¥ä¿®å¤æ•ˆæœ
            addAutoTestResult('ğŸ¯ ä¿®å¤æ•ˆæœåˆ†æ...', 'info');
            addAutoTestResult('ä¿®å¤å‰é”™è¯¯ï¼šnew Guard(appId, options) - å‚æ•°æ ¼å¼é”™è¯¯', 'warning');
            addAutoTestResult('ä¿®å¤åæ­£ç¡®ï¼šnew Guard({ appId, host, redirectUri }) - å•ä¸€é…ç½®å¯¹è±¡', 'success');
            
            updateCheck('check-3', true, 'æ„é€ å‡½æ•°å‚æ•°æ ¼å¼å·²ä¿®å¤');
            updateCheck('check-4', true, 'ç†è®ºä¸Šåº”è¯¥è§£å†³"appId is required"é”™è¯¯');
            
            addAutoTestResult('ğŸ‰ è‡ªåŠ¨éªŒè¯å®Œæˆï¼è¯·æ‰‹åŠ¨æµ‹è¯•ä¸»åº”ç”¨', 'success');
        }
        
        // å€’è®¡æ—¶å’Œè‡ªåŠ¨æµ‹è¯•
        let countdown = 10;
        const countdownElement = document.getElementById('countdown');
        
        const timer = setInterval(() => {
            countdown--;
            countdownElement.textContent = countdown;
            
            if (countdown <= 0) {
                clearInterval(timer);
                countdownElement.textContent = 'æµ‹è¯•ä¸­...';
                runAutoTest();
            }
        }, 1000);
        
        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        window.onload = function() {
            addResult('ğŸ”§ Guardæ„é€ å‡½æ•°ä¿®å¤éªŒè¯é¡µé¢å·²åŠ è½½', 'info');
            addResult('ğŸ“ å·²ä¿®å¤Guardæ„é€ å‡½æ•°å‚æ•°æ ¼å¼é—®é¢˜', 'success');
        };
    </script>
    
    <div class="status warning" style="margin-top: 30px;">
        <h3>ğŸ¯ å…³é”®ä¿®å¤ç‚¹</h3>
        <p><strong>é—®é¢˜æ ¹å› ï¼š</strong>Guardæ„é€ å‡½æ•°å‚æ•°æ ¼å¼é”™è¯¯</p>
        <p><strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong>æ”¹ä¸ºä¼ é€’å•ä¸€é…ç½®å¯¹è±¡</p>
        <p><strong>é¢„æœŸæ•ˆæœï¼š</strong>è§£å†³"appId is required"é”™è¯¯</p>
        <p><strong>éªŒè¯æ–¹æ³•ï¼š</strong>åœ¨ä¸»åº”ç”¨æ§åˆ¶å°æŸ¥çœ‹æ˜¯å¦è¿˜æœ‰é”™è¯¯</p>
    </div>
</body>
</html>
