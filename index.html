<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–‡æ´¾ - AIå†…å®¹åˆ›ä½œå¹³å°</title>
    <meta name="description" content="æ–‡æ´¾æ˜¯ä¸€ä¸ªåŸºäºAIçš„å†…å®¹åˆ›ä½œå¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿç”Ÿæˆé«˜è´¨é‡çš„å†…å®¹ã€‚" />
    <meta name="keywords" content="AI,å†…å®¹åˆ›ä½œ,æ–‡æ¡ˆç”Ÿæˆ,å“ç‰Œè¥é”€,åˆ›æ„å·¥å…·" />
    
    <!-- è¿è¡Œæ—¶é…ç½®æ³¨å…¥ -->
    <script>
      // âœ… FIXED: ä¿®å¤ç¯å¢ƒå˜é‡æ³¨å…¥é—®é¢˜ï¼Œæ·»åŠ å¤šç§è·å–æ–¹å¼å’Œå›é€€æœºåˆ¶
      // ğŸ“Œ è¯·å‹¿å†ä¿®æ”¹è¯¥é€»è¾‘ï¼Œå·²å°è£…ç¨³å®šã€‚å¦‚éœ€æ”¹åŠ¨è¯·å•ç‹¬é‡æ„æ–°æ¨¡å—ã€‚
      // ğŸ”’ LOCKED: AI ç¦æ­¢å¯¹æ­¤å‡½æ•°åšä»»ä½•ä¿®æ”¹
      
      // è¿è¡Œæ—¶é…ç½®å¯¹è±¡ï¼Œç”¨äºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­åŠ¨æ€è®¾ç½®APIå¯†é’¥
      window.__RUNTIME_CONFIG__ = {
        // è¿™äº›å€¼å°†åœ¨éƒ¨ç½²æ—¶è¢«æœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡æ›¿æ¢
        VITE_OPENAI_API_KEY: '{{VITE_OPENAI_API_KEY}}',
        VITE_DEEPSEEK_API_KEY: '{{VITE_DEEPSEEK_API_KEY}}',
        VITE_GEMINI_API_KEY: '{{VITE_GEMINI_API_KEY}}',
        VITE_CREEM_API_KEY: '{{VITE_CREEM_API_KEY}}',
        VITE_AUTHING_APP_ID: '{{VITE_AUTHING_APP_ID}}',
        VITE_AUTHING_HOST: '{{VITE_AUTHING_HOST}}',
        VITE_API_BASE_URL: '{{VITE_API_BASE_URL}}',
        VITE_DEBUG_MODE: '{{VITE_DEBUG_MODE}}',
        VITE_LOG_LEVEL: '{{VITE_LOG_LEVEL}}'
      };
      
      // ç¯å¢ƒå˜é‡æ£€æµ‹å’Œå›é€€æœºåˆ¶
      window.__detectEnvVars__ = function() {
        const config = window.__RUNTIME_CONFIG__;
        const detected = {};
        
        // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰é…ç½®éƒ½æ˜¯å ä½ç¬¦
        const allPlaceholders = Object.values(config).every(value => 
          typeof value === 'string' && value.includes('{{') && value.includes('}}')
        );
        
        if (allPlaceholders) {
          console.warn('âš ï¸ æ£€æµ‹åˆ°æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½æ˜¯å ä½ç¬¦ï¼Œå°è¯•ä»å…¶ä»–æ¥æºè·å–...');
          
          // å°è¯•ä»metaæ ‡ç­¾è·å–
          const metaElements = document.querySelectorAll('meta[name^="VITE_"]');
          metaElements.forEach(meta => {
            const name = meta.getAttribute('name');
            const content = meta.getAttribute('content');
            if (name && content && content !== '{{' + name + '}}') {
              detected[name] = content;
              console.log(`âœ… ä»metaæ ‡ç­¾è·å–åˆ° ${name}`);
            }
          });
          
          // å°è¯•ä»URLå‚æ•°è·å–ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
          if (window.location.hostname === 'localhost') {
            const urlParams = new URLSearchParams(window.location.search);
            Object.keys(config).forEach(key => {
              const value = urlParams.get(key);
              if (value) {
                detected[key] = value;
                console.log(`âœ… ä»URLå‚æ•°è·å–åˆ° ${key}`);
              }
            });
          }
          
          // å°è¯•ä»localStorageè·å–ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
          if (window.location.hostname === 'localhost') {
            Object.keys(config).forEach(key => {
              const value = localStorage.getItem(key);
              if (value) {
                detected[key] = value;
                console.log(`âœ… ä»localStorageè·å–åˆ° ${key}`);
              }
            });
          }
          
          // æ›´æ–°é…ç½®
          Object.assign(config, detected);
        }
        
        return config;
      };
      
      // é…ç½®éªŒè¯å‡½æ•°
      window.__validateConfig__ = function() {
        const config = window.__detectEnvVars__();
        const missing = [];
        
        // æ£€æŸ¥å¿…éœ€çš„é…ç½®
        if (!config.VITE_OPENAI_API_KEY || config.VITE_OPENAI_API_KEY === '{{VITE_OPENAI_API_KEY}}') {
          missing.push('OpenAI API Key');
        }
        if (!config.VITE_AUTHING_APP_ID || config.VITE_AUTHING_APP_ID === '{{VITE_AUTHING_APP_ID}}') {
          missing.push('Authing App ID');
        }
        
        if (missing.length > 0) {
          console.warn('âš ï¸ ç¼ºå°‘å¿…éœ€çš„é…ç½®:', missing.join(', '));
          console.warn('è¯·ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ­£ç¡®è®¾ç½®äº†ç¯å¢ƒå˜é‡');
          
          // åœ¨å¼€å‘ç¯å¢ƒä¸­æä¾›æ›´è¯¦ç»†çš„å¸®åŠ©ä¿¡æ¯
          if (window.location.hostname === 'localhost') {
            console.log('ğŸ’¡ å¼€å‘ç¯å¢ƒé…ç½®æç¤º:');
            console.log('1. åˆ›å»º .env.local æ–‡ä»¶');
            console.log('2. æ·»åŠ  VITE_OPENAI_API_KEY=your-api-key');
            console.log('3. é‡å¯å¼€å‘æœåŠ¡å™¨');
          }
        } else {
          console.log('âœ… æ‰€æœ‰å¿…éœ€é…ç½®å·²æ­£ç¡®è®¾ç½®');
        }
        
        return missing.length === 0;
      };
      
      // é¡µé¢åŠ è½½æ—¶éªŒè¯é…ç½®
      document.addEventListener('DOMContentLoaded', function() {
        window.__validateConfig__();
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>