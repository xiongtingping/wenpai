import{c as e,u as s,r as t,j as a,S as r,T as i,a as l,b as n,d as c,B as o,R as d,C as m,e as h,f as x,g as u,h as p,i as j,k as g,l as f,L as b,m as N,n as v,A as w,o as y,p as I,q as k,s as S,M as C,V as A,t as z,v as O,w as T,G as E,Z as P,x as $,P as U,F as D,y as B,z as J,D as F,E as M,H as L,I as _,J as H,K,N as V,O as q,Q as W,U as G,W as R,X,Y as Z}from"./index-CYvVoP-H.js";import{S as Y}from"./slider-ROG4cFKn.js";import{C as Q}from"./checkbox-CEF6-z30.js";import ee from"./aiService-fGAwix_K.js";import{D as se,a as te,b as ae,c as re,d as ie}from"./dialog-XgOp7gnt.js";import{I as le}from"./input-C7T9kmHO.js";import{I as ne}from"./info-x65m4toA.js";import{E as ce}from"./external-link-Bguz_PIV.js";import{T as oe}from"./triangle-alert-CmYwpf4d.js";import{L as de}from"./lock-DYBiRvcQ.js";import{S as me}from"./save-DT5yk6UW.js";import{S as he}from"./square-pen-DqPou0km.js";import{H as xe}from"./heart-DnfFMmPh.js";import{C as ue}from"./copy-D3g8yJt7.js";
/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=e("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),je=e("languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),ge={wechat:{name:"微信",description:"微信公众号、朋友圈",maxLength:2e3,hashtagCount:0,tone:"专业、权威",features:["图文并茂","深度内容","专业术语"]},weibo:{name:"微博",description:"新浪微博",maxLength:140,hashtagCount:3,tone:"简洁、热点",features:["话题标签","@用户","转发互动"]},xiaohongshu:{name:"小红书",description:"小红书笔记",maxLength:1e3,hashtagCount:20,tone:"种草、分享",features:["个人体验","图片展示","标签丰富"]},douyin:{name:"抖音",description:"抖音短视频",maxLength:300,hashtagCount:5,tone:"轻松、有趣",features:["视频脚本","音乐配合","互动引导"]},zhihu:{name:"知乎",description:"知乎问答",maxLength:5e3,hashtagCount:0,tone:"专业、深度",features:["详细解答","专业术语","引用来源"]},bilibili:{name:"B站",description:"B站视频",maxLength:500,hashtagCount:10,tone:"年轻、活力",features:["弹幕互动","视频标题","分区标签"]}};let fe="gpt-4o-mini";const be={"gpt-4o":{id:"gpt-4o",name:"OpenAI GPT-4o",provider:"OpenAI",description:"最新最强大的AI模型，性能卓越，创意丰富，支持多模态输入输出",features:["超强理解能力","创意内容生成","多模态支持","上下文记忆优秀","代码生成能力强"],maxTokens:128e3,pricing:{input:.0025,output:.01}},"gpt-4o-mini":{id:"gpt-4o-mini",name:"OpenAI GPT-4o mini",provider:"OpenAI",description:"GPT-4o的轻量版本，性价比极高，适合日常使用",features:["性价比极高","响应速度快","理解能力优秀","适合日常对话","成本控制友好"],maxTokens:128e3,pricing:{input:15e-5,output:6e-4}},"deepseek-v3":{id:"deepseek-v3",name:"DeepSeek V3",provider:"DeepSeek",description:"中文优化模型，理解力强，适合本地化内容和中文创作",features:["中文理解优秀","本地化内容创作","文化语境理解","中文表达自然","适合中文用户"],maxTokens:128e3,pricing:{input:14e-5,output:56e-5}}},Ne={trial:["gpt-4o-mini","deepseek-v3"],pro:["gpt-4o","gpt-4o-mini","deepseek-v3"],premium:["gpt-4o","gpt-4o-mini","deepseek-v3"]};function ve(e){return be[e]}const we={weibo:{platformId:"weibo",platformName:"微博",authUrl:"https://open.weibo.com/oauth2/authorize",apiBaseUrl:"https://api.weibo.com/2",isAuthorized:!1},zhihu:{platformId:"zhihu",platformName:"知乎",authUrl:"https://www.zhihu.com/oauth/authorize",apiBaseUrl:"https://api.zhihu.com",isAuthorized:!1},xiaohongshu:{platformId:"xiaohongshu",platformName:"小红书",authUrl:"https://oauth.xiaohongshu.com/oauth/authorize",apiBaseUrl:"https://api.xiaohongshu.com",isAuthorized:!1},bilibili:{platformId:"bilibili",platformName:"B站",authUrl:"https://passport.bilibili.com/login",apiBaseUrl:"https://api.bilibili.com",isAuthorized:!1},douyin:{platformId:"douyin",platformName:"抖音",authUrl:"https://open.douyin.com/oauth/authorize",apiBaseUrl:"https://open.douyin.com",isAuthorized:!1},twitter:{platformId:"twitter",platformName:"Twitter",authUrl:"https://twitter.com/i/oauth2/authorize",apiBaseUrl:"https://api.twitter.com/2",isAuthorized:!1},linkedin:{platformId:"linkedin",platformName:"LinkedIn",authUrl:"https://www.linkedin.com/oauth/v2/authorization",apiBaseUrl:"https://api.linkedin.com/v2",isAuthorized:!1}};function ye(){return Object.values(we)}function Ie(e){const s=`platform_api_config_${e}`,t=localStorage.getItem(s);if(!t)return null;try{const s=JSON.parse(t);return{...we[e],...s}}catch{return null}}async function ke(e,s){const t=Ie(e);if(!t)return{success:!1,error:"平台配置不存在"};switch(e){case"weibo":return await async function(e,s){var t;try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成微博授权"};const a=await fetch(`${s.apiBaseUrl}/statuses/update.json`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${s.accessToken}`},body:new URLSearchParams({status:e.text,source:"wenpai-app"})}),r=await a.json();return r.id?{success:!0,publishId:r.id,publishUrl:`https://weibo.com/${null==(t=r.user)?void 0:t.id}/${r.id}`,response:r}:{success:!1,error:r.error||"发布失败"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"网络错误"}}}(s,t);case"zhihu":return await async function(e,s){try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成知乎授权"};const t=await fetch(`${s.apiBaseUrl}/drafts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.accessToken}`},body:JSON.stringify({title:e.title||"新文章",content:e.text,topics:e.hashtags||[]})}),a=await t.json();if(a.id){const e=await fetch(`${s.apiBaseUrl}/drafts/${a.id}/publish`,{method:"POST",headers:{Authorization:`Bearer ${s.accessToken}`}}),t=await e.json();if(t.url)return{success:!0,publishId:a.id,publishUrl:t.url,response:t}}return{success:!1,error:"发布失败"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"网络错误"}}}(s,t);case"twitter":return await async function(e,s){var t,a,r;try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成Twitter授权"};const i=await fetch(`${s.apiBaseUrl}/tweets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.accessToken}`},body:JSON.stringify({text:e.text})}),l=await i.json();return(null==(t=l.data)?void 0:t.id)?{success:!0,publishId:l.data.id,publishUrl:`https://twitter.com/user/status/${l.data.id}`,response:l}:{success:!1,error:(null==(r=null==(a=l.errors)?void 0:a[0])?void 0:r.message)||"发布失败"}}catch(i){return{success:!1,error:i instanceof Error?i.message:"网络错误"}}}(s,t);default:return{success:!1,error:"暂不支持该平台的API直发"}}}function Se(e){const s=Ie(e);return(null==s?void 0:s.isAuthorized)||!1}function Ce({open:e,onOpenChange:v}){const{toast:w}=s(),[y,I]=t.useState([]),[k,S]=t.useState(null),[C,A]=t.useState(!1),[z,O]=t.useState(""),[T,E]=t.useState(""),[P,$]=t.useState("");t.useEffect(()=>{if(e){const e=ye().map(e=>Ie(e.platformId)||e);I(e)}},[e]);const U=e=>e.isAuthorized?a.jsx(N,{className:"w-4 h-4 text-green-500"}):e.accessToken?a.jsx(oe,{className:"w-4 h-4 text-yellow-500"}):a.jsx(f,{className:"w-4 h-4 text-gray-400"}),D=e=>e.isAuthorized?"已授权":e.accessToken?"待验证":"未配置",B=e=>e.isAuthorized?"bg-green-100 text-green-800 border-green-200":e.accessToken?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-600 border-gray-200";return a.jsx(se,{open:e,onOpenChange:v,children:a.jsxs(te,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx(ae,{children:a.jsxs(re,{className:"flex items-center gap-2",children:[a.jsx(r,{className:"w-5 h-5"}),"平台API配置管理"]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsxs(i,{defaultValue:"platforms",className:"h-full",children:[a.jsxs(l,{className:"grid w-full grid-cols-2",children:[a.jsx(n,{value:"platforms",children:"平台配置"}),a.jsx(n,{value:"help",children:"使用说明"})]}),a.jsx(c,{value:"platforms",className:"h-full overflow-auto",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ne,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{className:"text-sm text-gray-600",children:"配置平台API密钥和访问令牌，支持内容直发功能"})]}),a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{const e=ye().map(e=>Ie(e.platformId)||e);I(e),w({title:"状态已刷新",description:"平台配置状态已更新"})},children:[a.jsx(d,{className:"w-4 h-4 mr-1"}),"刷新状态"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(e=>a.jsxs(m,{className:"relative",children:[a.jsxs(h,{className:"pb-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(x,{className:"text-lg",children:e.platformName}),a.jsxs("div",{className:"flex items-center gap-2",children:[U(e),a.jsx(u,{variant:"outline",className:B(e),children:D(e)})]})]}),a.jsxs(p,{children:["平台ID: ",e.platformId]})]}),a.jsxs(j,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(pe,{className:"w-4 h-4 text-gray-400"}),a.jsxs("span",{className:"text-gray-600",children:["API密钥: ",e.apiKey?"已配置":"未配置"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(g,{className:"w-4 h-4 text-gray-400"}),a.jsxs("span",{className:"text-gray-600",children:["访问令牌: ",e.accessToken?"已配置":"未配置"]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs(o,{size:"sm",variant:"outline",onClick:()=>(e=>{S(e),O(e.apiKey||""),E(e.accessToken||""),$(e.userId||""),A(!0)})(e),children:[a.jsx(r,{className:"w-4 h-4 mr-1"}),"配置"]}),e.authUrl&&a.jsxs(o,{size:"sm",variant:"outline",onClick:()=>(e=>{const s=function(e){const s=function(e){return we[e]||null}(e);return(null==s?void 0:s.authUrl)||null}(e.platformId);s?(window.open(s,"_blank","noopener,noreferrer"),w({title:"授权页面已打开",description:"请在授权页面完成授权，然后返回配置访问令牌"})):w({title:"授权失败",description:"该平台暂不支持授权",variant:"destructive"})})(e),children:[a.jsx(ce,{className:"w-4 h-4 mr-1"}),"授权"]}),(e.apiKey||e.accessToken)&&a.jsxs(o,{size:"sm",variant:"outline",onClick:()=>{return function(e){const s=`platform_api_config_${e}`;localStorage.removeItem(s)}(s=e.platformId),I(e=>e.map(e=>e.platformId===s?{...e,apiKey:void 0,accessToken:void 0,userId:void 0,isAuthorized:!1}:e)),void w({title:"配置已清除",description:"平台API配置已清除"});var s},children:[a.jsx(f,{className:"w-4 h-4 mr-1"}),"清除"]})]})]})]},e.platformId))})]})}),a.jsx(c,{value:"help",className:"h-full overflow-auto",children:a.jsx("div",{className:"space-y-6",children:a.jsxs(m,{children:[a.jsx(h,{children:a.jsx(x,{children:"API直发功能说明"})}),a.jsxs(j,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"什么是API直发？"}),a.jsx("p",{className:"text-sm text-gray-600",children:"API直发功能允许您通过平台的官方API直接发布内容，无需手动复制粘贴。 配置完成后，可以一键将AI生成的内容直接发布到各平台。"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"支持的平台"}),a.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[a.jsx("li",{children:"• 微博 - 支持文本发布"}),a.jsx("li",{children:"• 知乎 - 支持文章发布"}),a.jsx("li",{children:"• Twitter - 支持推文发布"}),a.jsx("li",{children:"• 更多平台开发中..."})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"配置步骤"}),a.jsxs("ol",{className:"text-sm text-gray-600 space-y-1",children:[a.jsx("li",{children:'1. 点击"授权"按钮，在平台官网完成授权'}),a.jsx("li",{children:"2. 获取API密钥和访问令牌"}),a.jsx("li",{children:"3. 在配置页面填入相关信息"}),a.jsx("li",{children:"4. 保存配置，即可使用API直发功能"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"安全说明"}),a.jsx("p",{className:"text-sm text-gray-600",children:"所有API密钥和访问令牌仅存储在您的浏览器本地，不会上传到服务器。 请妥善保管您的密钥信息，不要泄露给他人。"})]})]})]})})})]})}),a.jsx(se,{open:C,onOpenChange:A,children:a.jsxs(te,{children:[a.jsx(ae,{children:a.jsxs(re,{children:["配置 ",null==k?void 0:k.platformName," API"]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(b,{htmlFor:"apiKey",children:"API密钥"}),a.jsx(le,{id:"apiKey",type:"password",placeholder:"请输入API密钥",value:z,onChange:e=>O(e.target.value)})]}),a.jsxs("div",{children:[a.jsx(b,{htmlFor:"accessToken",children:"访问令牌"}),a.jsx(le,{id:"accessToken",type:"password",placeholder:"请输入访问令牌",value:T,onChange:e=>E(e.target.value)})]}),a.jsxs("div",{children:[a.jsx(b,{htmlFor:"userId",children:"用户ID"}),a.jsx(le,{id:"userId",placeholder:"请输入用户ID（可选）",value:P,onChange:e=>$(e.target.value)})]})]}),a.jsxs(ie,{children:[a.jsx(o,{variant:"outline",onClick:()=>A(!1),children:"取消"}),a.jsx(o,{onClick:()=>{if(!k)return;const e={apiKey:z.trim()||void 0,accessToken:T.trim()||void 0,userId:P.trim()||void 0,isAuthorized:!!T.trim()};!function(e,s){const t=`platform_api_config_${e}`;localStorage.setItem(t,JSON.stringify(s))}(k.platformId,e),I(s=>s.map(s=>s.platformId===k.platformId?{...s,...e}:s)),A(!1),S(null),w({title:"配置已保存",description:`${k.platformName}的API配置已更新`})},children:"保存配置"})]})]})})]})})}function Ae({isOpen:e,onClose:s,onUpgrade:t,remainingCount:r,userType:i}){const l="trial"===i?{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会，立即升级享受更多功能！`,upgradeText:"立即升级",upgradeDescription:"升级后享受更多使用次数和高级功能"}:"pro"===i?{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会，升级后不限次！`,upgradeText:"升级高级版",upgradeDescription:"升级到高级版享受不限量使用"}:{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会`,upgradeText:"立即升级",upgradeDescription:"升级后享受更多使用次数"};return a.jsx(se,{open:e,onOpenChange:s,children:a.jsxs(te,{className:"sm:max-w-md",children:[a.jsx(ae,{children:a.jsxs(re,{className:"flex items-center gap-2 text-amber-600",children:[a.jsx(oe,{className:"h-5 w-5"}),l.title]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-red-600 mb-2",children:["仅剩 ",r," 次"]}),a.jsx("p",{className:"text-gray-600",children:l.description})]}),"trial"===i&&a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-lg border border-blue-200",children:[a.jsxs("h4",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"升级专业版特权"]}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:"• 30次/月AI内容适配"}),a.jsx("li",{children:"• 创意魔方功能"}),a.jsx("li",{children:"• 高级AI模型"}),a.jsx("li",{children:"• 余额继承机制"})]})]}),"pro"===i&&a.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200",children:[a.jsxs("h4",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"升级高级版特权"]}),a.jsxs("ul",{className:"text-sm text-amber-700 space-y-1",children:[a.jsx("li",{children:"• 不限量AI内容适配"}),a.jsx("li",{children:"• 全网雷达功能"}),a.jsx("li",{children:"• 品牌库功能"}),a.jsx("li",{children:"• 最新AI模型"})]})]})]}),a.jsxs(ie,{className:"flex gap-2",children:[a.jsx(o,{variant:"outline",onClick:s,children:"稍后再说"}),a.jsxs(o,{onClick:t,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:[l.upgradeText,a.jsx(w,{className:"h-4 w-4 ml-2"})]})]})]})})}function ze({isOpen:e,onClose:s,onUpgrade:t,featureName:r,featureDescription:i}){return a.jsx(se,{open:e,onOpenChange:s,children:a.jsxs(te,{className:"sm:max-w-md",children:[a.jsx(ae,{children:a.jsxs(re,{className:"flex items-center gap-2 text-purple-600",children:[a.jsx(de,{className:"h-5 w-5"}),"高级功能权限"]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl font-bold text-gray-800 mb-2",children:r}),a.jsx("p",{className:"text-gray-600",children:i})]}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg border border-purple-200",children:[a.jsxs("h4",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"升级高级版解锁特权"]}),a.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[a.jsx("li",{children:"• 不限量AI内容适配"}),a.jsx("li",{children:"• 创意魔方功能"}),a.jsx("li",{children:"• 全网雷达功能"}),a.jsx("li",{children:"• 品牌库功能"}),a.jsx("li",{children:"• 最新AI模型"}),a.jsx("li",{children:"• 余额继承机制"})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 p-3 rounded-lg border border-amber-200",children:a.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[a.jsx(y,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium",children:"限时优惠：年付省300元"})]})})]}),a.jsxs(ie,{className:"flex gap-2",children:[a.jsx(o,{variant:"outline",onClick:s,children:"稍后再说"}),a.jsxs(o,{onClick:t,className:"bg-gradient-to-r from-purple-500 to-blue-600 hover:from-purple-600 hover:to-blue-700",children:["立即升级解锁",a.jsx(w,{className:"h-4 w-4 ml-2"})]})]})]})})}const Oe={weibo:"https://weibo.com/newpost",xiaohongshu:"https://creator.xiaohongshu.com/publish",zhihu:"https://zhuanlan.zhihu.com/write",bilibili:"https://member.bilibili.com/platform/upload/text",douyin:"https://creator.douyin.com/creator-micro/content/upload",toutiao:"https://mp.toutiao.com/profile_v4/graphic/publish",baijiahao:"https://baijiahao.baidu.com/builder/rc/edit",kuaishou:"https://cp.kuaishou.com/article/publish",wechat:"https://mp.weixin.qq.com/",facebook:"https://www.facebook.com/",twitter:"https://twitter.com/compose/tweet",linkedin:"https://www.linkedin.com/feed/",v2ex:"https://www.v2ex.com/new",github:"https://github.com/new",sspai:"https://sspai.com/write",juejin:"https://juejin.cn/editor/drafts/new",csdn:"https://mp.csdn.net/mp_blog/creation/editor",hellogithub:"https://hellogithub.com/",ithome:"https://my.ithome.com/#/write",ngabbs:"https://bbs.nga.cn/thread.php?fid=-7",weatheralarm:"https://www.nmc.cn/",earthquake:"https://www.ceic.ac.cn/",history:"https://baike.baidu.com/item/%E5%8E%86%E5%8F%B2%E4%B8%8A%E7%9A%84%E4%BB%8A%E5%A4%A9/42704"};function Te(e){const s=ge[e],t=(null==s?void 0:s.name)||e;switch(e){case"zhihu":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(C,{className:"h-4 w-4 text-blue-500 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"weibo":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(z,{className:"h-4 w-4 text-orange-500 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"xiaohongshu":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(S,{className:"h-4 w-4 text-rose-500 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"wechat":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(C,{className:"h-4 w-4 text-green-500 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"douyin":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(A,{className:"h-4 w-4 text-black mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"video":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(T,{className:"h-4 w-4 text-green-600 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"twitter":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{className:"h-4 w-4 text-black mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});case"bilibili":return a.jsxs("div",{className:"flex items-center",children:[a.jsx(A,{className:"h-4 w-4 text-blue-400 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]});default:return a.jsxs("div",{className:"flex items-center",children:[a.jsx(C,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-xs",children:t})]})}}function Ee(e){switch(e){case"zhihu":return 200;case"douyin":case"video":default:return 50;case"xiaohongshu":case"bilibili":return 100;case"wechat":return 300;case"weibo":return 20;case"twitter":return 10}}function Pe(e){switch(e){case"zhihu":return 1e4;case"douyin":case"xiaohongshu":case"video":return 1e3;case"wechat":return 2e4;case"weibo":default:return 2e3;case"twitter":return 280;case"bilibili":return 5e3}}function $e({icon:e,title:s,description:t,checked:r,onChange:i}){return a.jsxs(m,{className:Z("relative border cursor-pointer transition-all duration-200 h-36 flex flex-col",r?"border-primary bg-primary/5 shadow-md ring-1 ring-primary/20":"bg-background hover:shadow-sm hover:border-gray-300"),onClick:()=>i(!r),children:[a.jsx(h,{className:"pb-1 pt-4 flex-shrink-0",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center space-x-2 min-w-0",children:[a.jsx("div",{className:"flex-shrink-0",children:e}),a.jsx(x,{className:"text-sm font-semibold truncate leading-tight",children:s})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Q,{checked:r,onCheckedChange:i,className:"data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground"})})]})}),a.jsx(j,{className:"pt-0 pb-4 flex-grow flex items-start",children:a.jsx(p,{className:"text-xs leading-relaxed overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",maxHeight:"4.8rem"},children:t})})]})}function Ue(){var e,g,f;const{toast:N}=s(),v=I(),[y,Z]=t.useState(""),[le,ne]=t.useState([]),[oe,de]=t.useState([]),[pe,we]=t.useState(!1),[ye,Ie]=t.useState(!1),[Ue,De]=t.useState({}),[Be,Je]=t.useState({}),[Fe,Me]=t.useState(!1),[Le,_e]=t.useState(null),[He,Ke]=t.useState({}),[Ve,qe]=t.useState(new Set),[We,Ge]=t.useState({charCountPreset:"auto",globalEmoji:!1,globalMd:!1}),[Re,Xe]=t.useState("openai"),[Ze,Ye]=t.useState(fe),[Qe,es]=t.useState("trial"),ss=(Ne[Qe]||[]).map(e=>be[e]).filter(Boolean),ts=Object.values(be),{usageRemaining:as,decrementUsage:rs}=k(),[is,ls]=t.useState(!1),[ns,cs]=t.useState(0),[os,ds]=t.useState(!1),[ms,hs]=t.useState({name:"",description:""}),xs=t.useMemo(()=>[{id:"xiaohongshu",name:"小红书",description:"适合生活方式、美妆、旅行等分享，强调个人体验和情感共鸣",icon:a.jsx(S,{className:"h-4 w-4 text-rose-500"})},{id:"zhihu",name:"知乎",description:"适合专业知识分享和理性讨论，强调逻辑和论证",icon:a.jsx(C,{className:"h-4 w-4 text-blue-500"})},{id:"douyin",name:"抖音脚本",description:"适合短视频脚本，活泼有趣，强调视听效果",icon:a.jsx(A,{className:"h-4 w-4 text-black"})},{id:"weibo",name:"新浪微博",description:"简短有力的观点表达，适合热点话题讨论",icon:a.jsx(z,{className:"h-4 w-4 text-orange-500"})},{id:"wechat",name:"公众号",description:"深度内容，适合教程、观点和专业分析",icon:a.jsx(C,{className:"h-4 w-4 text-green-500"})},{id:"bilibili",name:"B站",description:"适合视频脚本，兼具专业性和趣味性",icon:a.jsx(A,{className:"h-4 w-4 text-blue-400"})},{id:"twitter",name:"X（推特）",description:"简短、直接的表达，支持多种语言和国际化视角",icon:a.jsx(O,{className:"h-4 w-4 text-black"})},{id:"video",name:"视频号",description:"视频内容与互动引导并重，亲和力强",icon:a.jsx(T,{className:"h-4 w-4 text-green-600"})},{id:"baijia",name:"百家号",description:"长篇深度内容，SEO友好，权威感强，适合资讯类内容",icon:a.jsx(E,{className:"h-4 w-4 text-blue-700"})},{id:"kuaishou",name:"快手",description:"接地气表达，真实朴实，亲民风格，适合生活记录",icon:a.jsx(P,{className:"h-4 w-4 text-yellow-600"})},{id:"wangyi",name:"网易小蜜蜂",description:"注重原创性，文笔流畅，观点独特，适合深度评论",icon:a.jsx($,{className:"h-4 w-4 text-red-500"})},{id:"toutiao",name:"头条号",description:"标题党友好，热点敏感，算法推荐，适合时事评论",icon:a.jsx(E,{className:"h-4 w-4 text-purple-600"})}],[]),us=t.useCallback(()=>{const e={};xs.forEach(s=>{e[s.id]={charCount:Math.floor(.6*Pe(s.id)),useEmoji:"xiaohongshu"===s.id||"weibo"===s.id,useMdFormat:"zhihu"===s.id||"wechat"===s.id,useAutoFormat:!0}}),De(e);const s={};xs.forEach(e=>{s[e.id]=!1}),Je(s)},[xs]),ps=()=>{try{localStorage.setItem("platformSettings",JSON.stringify(Ue)),localStorage.setItem("globalSettings",JSON.stringify(We)),localStorage.setItem("selectedPlatforms",JSON.stringify(le)),N({title:"设置已保存",description:"您的平台设置已成功保存"})}catch{N({title:"保存设置失败",description:"无法保存您的设置，请稍后再试",variant:"destructive"})}};t.useEffect(()=>{Object.keys(Ue).length>0&&localStorage.setItem("platformSettings",JSON.stringify(Ue))},[Ue]),t.useEffect(()=>{Object.keys(We).length>0&&localStorage.setItem("globalSettings",JSON.stringify(We))},[We]),t.useEffect(()=>{le.length>0&&localStorage.setItem("selectedPlatforms",JSON.stringify(le))},[le]),t.useEffect(()=>{const e=localStorage.getItem("platformSettings"),s=localStorage.getItem("globalSettings"),t=localStorage.getItem("selectedPlatforms");if(e)try{const s=JSON.parse(e);De(s)}catch{us()}else us();if(s)try{const e=JSON.parse(s);Ge(e)}catch{}if(t)try{const e=JSON.parse(t);ne(e)}catch{}const a={};xs.forEach(e=>{a[e.id]=!1}),Je(a)},[us,xs]),t.useEffect(()=>{us()},[us]);const js=y.length,gs=y.trim().length>10&&le.length>0&&as>0,fs=(e,s,t)=>{De(a=>({...a,[e]:{...a[e],[s]:t}}))},bs=(e,s)=>{Ge(t=>({...t,[e]:s}))},[Ns,vs]=t.useState(!1),[ws,ys]=t.useState(null),Is=async e=>{await new Promise(e=>setTimeout(e,1e3));let s=e;return Object.entries({"小红书":"Xiaohongshu","抖音":"TikTok","微博":"Weibo","知乎":"Zhihu","公众号":"WeChat Official Account","B站":"Bilibili","视频号":"Video Account","试了":"tried","味道":"taste","治愈":"healing","小时候":"childhood","牛奶糖":"milk candy","甜而不腻":"sweet but not cloying","质地":"texture","冰淇淋":"ice cream","慕斯":"mousse","水润":"moisturizing","吸收":"absorption","粘腻":"sticky","秋冬":"autumn and winter","干皮":"dry skin","姐妹们":"sisters","闭眼冲":"go for it blindly","身体乳":"body lotion","护肤":"skincare","救星":"savior","推荐":"recommend","真的":"really","超级":"super","好用":"good to use","喜欢":"like","分享":"share","体验":"experience","感觉":"feel","效果":"effect","产品":"product","品牌":"brand","购买":"buy","价格":"price","优惠":"discount","活动":"activity","限时":"limited time","抢购":"rush to buy","赶紧":"hurry up","不要":"don't","错过":"miss","机会":"opportunity","最后":"last","一次":"once","时间":"time","结束":"end","开始":"start","立刻":"immediately","今天":"today","明天":"tomorrow","昨天":"yesterday","这周":"this week","下周":"next week","本月":"this month","下月":"next month","今年":"this year","明年":"next year"}).forEach(([e,t])=>{s=s.replace(new RegExp(e,"g"),t)}),s=s.replace(/。/g,". ").replace(/，/g,", ").replace(/！/g,"! ").replace(/？/g,"? ").replace(/：/g,": ").replace(/；/g,"; "),s},[ks,Ss]=t.useState(""),[Cs,As]=t.useState(!1),[zs,Os]=t.useState([]),[Ts,Es]=t.useState([]),[Ps,$s]=t.useState(null),[Us,Ds]=t.useState(!1),[Bs,Js]=t.useState([]),Fs=t.useCallback(()=>{const e=JSON.parse(localStorage.getItem("shareHistory")||"[]");Js(e)},[]);t.useEffect(()=>{Us&&Fs()},[Us,Fs]);const[Ms,Ls]=t.useState(!1),[_s,Hs]=t.useState("jump"),[Ks,Vs]=t.useState(new Set);return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(U,{title:"AI内容适配器",description:"一次创作，多平台适配，让您的内容在每个平台都能发挥最大效果",showAdaptButton:!1,actions:a.jsxs(a.Fragment,{children:[a.jsxs(o,{variant:"outline",onClick:()=>window.location.href="/history",children:[a.jsx(D,{className:"h-4 w-4 mr-1"}),"历史记录"]}),a.jsxs(o,{variant:"outline",onClick:()=>Ls(!0),children:[a.jsx(r,{className:"h-4 w-4 mr-1"}),"API配置"]})]})}),a.jsxs("div",{className:"container mx-auto py-6 px-4",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-medium mb-2",children:"内容创作"}),a.jsx(B,{children:a.jsxs(J,{children:[a.jsx(F,{asChild:!0,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"剩余次数:"}),a.jsx(u,{variant:as<=5?"destructive":"default",children:as})]})}),a.jsxs(M,{side:"bottom",children:[a.jsx("p",{children:"每次多平台内容生成消耗1次使用额度"}),a.jsx("p",{children:"每月自动获得20次免费使用机会"}),a.jsx("p",{children:"通过邀请好友可获得额外使用次数"})]})]})})]}),a.jsx(m,{className:"mb-6",children:a.jsx(j,{className:"pt-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(b,{className:"text-sm font-medium",children:"发布模式:"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(o,{variant:"jump"===_s?"default":"outline",size:"sm",onClick:()=>Hs("jump"),children:[a.jsx(ce,{className:"w-4 h-4 mr-1"}),"跳转发布"]}),a.jsxs(o,{variant:"api"===_s?"default":"outline",size:"sm",onClick:()=>Hs("api"),children:[a.jsx(P,{className:"w-4 h-4 mr-1"}),"API直发"]})]}),"api"===_s&&a.jsxs(u,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[a.jsx(P,{className:"w-3 h-3 mr-1"}),"需要配置API密钥"]})]})})}),a.jsxs(m,{className:"mb-8",children:[a.jsxs(h,{children:[a.jsx(x,{className:"text-lg",children:"输入原始内容"}),a.jsx(p,{children:"请输入您想要进行多平台适配的原始内容"})]}),a.jsxs(j,{children:[a.jsx(L,{placeholder:"在此输入您的原始内容，我们将为您适配到不同平台...",className:"min-h-[200px]",value:y,onChange:e=>Z(e.target.value)}),a.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-center",children:[a.jsx(Q,{id:"use-brand-library",checked:ye,onCheckedChange:e=>{e&&("trial"===Qe&&(hs({name:"品牌库功能",description:"使用品牌库资料进行创作，AI会自动遵循您的品牌语言规范"}),ds(!0),1))||Ie(!!e)}}),a.jsxs("div",{children:[a.jsx(b,{htmlFor:"use-brand-library",className:"text-sm cursor-pointer",children:"使用品牌库资料进行创作"}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["上传您的品牌资料库，AI在创作时会自动遵循您的语言规范，融入品牌价值，规避公关风险。分发再多平台，品牌形象始终如一。",a.jsx("span",{className:"text-xs text-amber-500 ml-1",children:"（需开通高级功能）"})]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto justify-center",children:[a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>Me(e=>!e),className:"text-xs rounded-lg shadow-sm border border-blue-200",children:["适配设置",Fe?a.jsx(_,{className:"ml-1 h-3 w-3"}):a.jsx(H,{className:"ml-1 h-3 w-3"})]}),a.jsxs(u,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[js," 字符"]})]})]}),Fe&&a.jsx("div",{className:"mt-2 w-full",children:a.jsxs("div",{className:"bg-white rounded-lg shadow p-3 flex flex-col items-center w-full max-w-full",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 w-full px-4",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(b,{className:"text-xs w-28 flex-shrink-0",children:"全局字符数限制"}),a.jsxs(K,{value:We.charCountPreset,onValueChange:e=>bs("charCountPreset",e),children:[a.jsx(V,{className:"h-7 w-36 text-xs",children:a.jsx(q,{placeholder:"选择字符数限制"})}),a.jsxs(W,{children:[a.jsx(G,{value:"auto",children:"自动"}),a.jsx(G,{value:"mini",children:"精简(50-200字)"}),a.jsx(G,{value:"standard",children:"标准(200-800字)"}),a.jsx(G,{value:"detailed",children:"详细(800+)"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(b,{className:"text-xs w-28 flex-shrink-0",children:"启用表情符号"}),a.jsx(Q,{id:"global-emoji",checked:We.globalEmoji,onCheckedChange:e=>bs("globalEmoji",!!e)})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(b,{className:"text-xs w-28 flex-shrink-0",children:"启用Markdown格式"}),a.jsx(Q,{id:"global-md",checked:We.globalMd,onCheckedChange:e=>bs("globalMd",!!e)})]})]}),a.jsx("div",{className:"flex justify-center mt-2 w-full",children:a.jsxs(o,{variant:"outline",size:"sm",onClick:ps,className:"flex items-center h-7 text-xs px-3",children:[a.jsx(me,{className:"h-3 w-3 mr-1"}),"保存"]})})]})})]})]}),a.jsxs(m,{className:"mb-8",children:[a.jsx(h,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(x,{className:"text-lg",children:"AI 模型选择"}),a.jsx(p,{children:"选择您喜欢的AI模型生成内容，默认优先推荐GPT-4o"})]}),"trial"===Qe&&a.jsx(o,{variant:"outline",size:"sm",onClick:()=>v("/payment"),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"去解锁"})]})}),a.jsx(j,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ts.map(e=>{let s=!ss.some(s=>s.id===e.id),t="",r=!1;return"gpt-4o"===e.id&&"trial"===Qe&&(t="专业版/高级版专属",r=!0),a.jsx("div",{className:"p-6 border-2 rounded-xl cursor-pointer transition-all hover:shadow-md "+(Ze===e.id?"border-blue-500 bg-blue-50 shadow-sm":s?"border-gray-200 bg-gray-100 opacity-60 cursor-not-allowed":"border-gray-200 hover:border-blue-300"),onClick:()=>((e,s)=>{if(s)return;Ye(e),fe=e;const t=function(e){var s;return(null==(s=be[e])?void 0:s.provider)||"Unknown"}(e);"OpenAI"===t&&Xe("openai"),"DeepSeek"===t&&Xe("deepseek")})(e.id,s),children:a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 mt-0.5 "+(Ze===e.id?"border-blue-500 bg-blue-500":"border-gray-300"),children:Ze===e.id&&a.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"font-semibold text-blue-600 text-base",children:e.name}),t&&a.jsx(u,{className:"bg-gray-200 text-gray-600 text-xs",children:t})]}),a.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.description}),r&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:a.jsxs("p",{className:"text-xs text-yellow-700 flex items-center",children:[a.jsx("span",{className:"mr-1",children:"🔒"}),"去解锁高级功能"]})})]})]})},e.id)})}),Ze&&a.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[a.jsx("p",{className:"font-medium",children:null==(e=ve(Ze))?void 0:e.name}),a.jsx("p",{children:null==(g=ve(Ze))?void 0:g.description})]}),a.jsxs("div",{className:"mt-4 flex gap-2 items-center",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"模拟订阅等级："}),a.jsx(o,{size:"sm",variant:"trial"===Qe?"default":"outline",onClick:()=>es("trial"),children:"免费版"}),a.jsx(o,{size:"sm",variant:"pro"===Qe?"default":"outline",onClick:()=>es("pro"),children:"专业版"}),a.jsx(o,{size:"sm",variant:"premium"===Qe?"default":"outline",onClick:()=>es("premium"),children:"高级版"})]})]})})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-lg font-medium mb-4",children:"选择目标平台"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 auto-rows-fr",children:xs.map(e=>a.jsx($e,{icon:e.icon,title:e.name,description:e.description,checked:le.includes(e.id),onChange:s=>{return t=e.id,void ne(s?e=>[...e,t]:e=>e.filter(e=>e!==t));var t}},e.id))}),le.length>0&&a.jsxs(m,{className:"mt-6",children:[a.jsx(h,{className:"pb-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r,{className:"h-4 w-4"}),a.jsx(x,{className:"text-base",children:"平台设置"}),a.jsxs(u,{variant:"secondary",className:"text-xs",children:[le.length,"个平台"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(o,{variant:"outline",size:"sm",onClick:ps,children:[a.jsx(me,{className:"h-3 w-3 mr-1"}),"保存设置"]}),a.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>Me(!Fe),children:[Fe?"收起":"展开",Fe?a.jsx(_,{className:"ml-1 h-4 w-4"}):a.jsx(H,{className:"ml-1 h-4 w-4"})]})]})]})}),Fe&&a.jsx(j,{className:"pt-0",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-b pb-4",children:[a.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"全局设置"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{id:"global-emoji",checked:We.globalEmoji,onCheckedChange:e=>bs("globalEmoji",!!e)}),a.jsxs(b,{htmlFor:"global-emoji",className:"text-sm cursor-pointer flex items-center",children:[a.jsx(R,{className:"h-3 w-3 mr-1"}),"全局添加emoji表情"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{id:"global-md",checked:We.globalMd,onCheckedChange:e=>bs("globalMd",!!e)}),a.jsxs(b,{htmlFor:"global-md",className:"text-sm cursor-pointer flex items-center",children:[a.jsx(D,{className:"h-3 w-3 mr-1"}),"全局MD格式"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{id:"global-auto",checked:!0,disabled:!0}),a.jsxs(b,{htmlFor:"global-auto",className:"text-sm cursor-pointer flex items-center text-gray-500",children:[a.jsx(X,{className:"h-3 w-3 mr-1"}),"全局自动排版"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"平台特定设置"}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:le.map(e=>{const s=xs.find(s=>s.id===e),t=Ue[e]||{},r=["zhihu","wechat","weibo","xiaohongshu"].includes(e);return s?a.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50/50",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.icon,a.jsx("span",{className:"text-sm font-medium",children:s.name}),r&&a.jsx(u,{variant:"outline",className:"text-xs",children:"优化"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsxs(b,{className:"text-xs",children:["字符数: ",t.charCount||Pe(e)]}),a.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ee(e),"-",Pe(e)]})]}),a.jsx(Y,{value:[t.charCount||Pe(e)],min:Ee(e),max:Pe(e),step:10,onValueChange:s=>fs(e,"charCount",s[0]),className:"w-full"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{id:`${e}-emoji`,checked:t.useEmoji,onCheckedChange:s=>fs(e,"useEmoji",!!s)}),a.jsxs(b,{htmlFor:`${e}-emoji`,className:"text-xs cursor-pointer flex items-center",children:[a.jsx(R,{className:"h-3 w-3 mr-1"}),"emoji"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{id:`${e}-md`,checked:t.useMdFormat,onCheckedChange:s=>fs(e,"useMdFormat",!!s)}),a.jsxs(b,{htmlFor:`${e}-md`,className:"text-xs cursor-pointer flex items-center",children:[a.jsx(D,{className:"h-3 w-3 mr-1"}),"MD格式"]})]})]}),r&&a.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs text-blue-600",children:["zhihu"===e&&"知乎: MD格式优化专业排版，自动排版添加分割线","wechat"===e&&"公众号: MD格式适合深度阅读，专业排版","weibo"===e&&"微博: emoji提升互动性，字数限制2000字","xiaohongshu"===e&&"小红书: emoji增加亲和力，自动排版优化视觉效果"]})]})]},e):null})})]})]})})]})]}),a.jsx("div",{className:"flex justify-center mb-12",children:a.jsx(o,{size:"lg",disabled:!gs||pe,onClick:async()=>{if(!gs)return;if(as<=3&&as>0&&(cs(as),ls(!0),1))return;if(as<=0)return void N({title:"使用次数已用完",description:"请通过邀请好友获取更多使用机会",variant:"destructive"});we(!0),(()=>{const e={...Ue};We.globalEmoji&&Object.keys(e).forEach(s=>{e[s].useEmoji=!0}),We.globalMd&&Object.keys(e).forEach(s=>{e[s].useMdFormat=!0}),"auto"!==We.charCountPreset&&Object.keys(e).forEach(s=>{switch(We.charCountPreset){case"mini":e[s].charCount=Math.min(200,Pe(s));break;case"standard":e[s].charCount=Math.min(800,Pe(s));break;case"detailed":e[s].charCount=Pe(s)}}),De(e)})();const e=le.map(e=>({platformId:e,content:"",steps:[{status:"loading",message:"分析原始内容..."},{status:"waiting",message:"提取核心信息..."},{status:"waiting",message:"进行平台适配..."},{status:"waiting",message:"优化输出结果..."}]}));de(e);try{const e={};le.forEach(s=>{const t=Ue[s];e[`${s}-charCount`]=(null==t?void 0:t.charCount)||.6*Pe(s),e[`${s}-emoji`]=(null==t?void 0:t.useEmoji)||!1,e[`${s}-mdFormat`]=(null==t?void 0:t.useMdFormat)||!1,e[`${s}-autoFormat`]=(null==t?void 0:t.useAutoFormat)||!1,e[`${s}-brandLibrary`]=ye});const s=await async function(e,s,t){try{const a=await ee.adaptContent(e,s,t);return{success:a.success,data:a.data,error:a.error}}catch(a){return{success:!1,error:a instanceof Error?a.message:"内容适配失败"}}}(y,le,e);for(let t=0;t<le.length;t++){const e=le[t],a=(s,t)=>{de(a=>a.map(a=>a.platformId===e?{...a,steps:a.steps.map((e,a)=>a===s?{...e,status:t}:e)}:a))};a(0,"completed"),await new Promise(e=>setTimeout(e,300)),a(1,"loading"),await new Promise(e=>setTimeout(e,300)),a(1,"completed"),a(2,"loading"),await new Promise(e=>setTimeout(e,300)),a(2,"completed"),a(3,"loading"),await new Promise(e=>setTimeout(e,300));for(const t of le){const e=s[t];e&&e.content?(a(3,"completed"),de(s=>s.map(s=>s.platformId===t?{...s,content:e.content,source:e.source,error:e.error}:s))):(a(3,"error"),de(e=>e.map(e=>e.platformId===t?{...e,error:"生成失败：无法获取适配内容"}:e)))}}rs(),(e=>{const s="history_anonymous",t=localStorage.getItem(s);let a=[];if(t)try{a=JSON.parse(t)}catch{}const r=(new Date).toISOString();e.forEach(e=>{e.content&&a.push({platformId:e.platformId,content:e.content,timestamp:r})}),localStorage.setItem(s,JSON.stringify(a))})(oe),N({title:"内容已生成",description:`已成功为${le.length}个平台生成内容`})}catch(s){de(e=>e.map(e=>({...e,steps:e.steps.map(e=>"loading"===e.status?{...e,status:"error"}:e),error:s instanceof Error?s.message:"生成失败"}))),N({title:"生成失败",description:s instanceof Error?s.message:"内容生成过程中发生错误，请稍后重试",variant:"destructive"})}finally{we(!1)}},className:"w-full max-w-md",children:pe?a.jsxs(a.Fragment,{children:[a.jsx(d,{className:"mr-2 h-4 w-4 animate-spin"}),"正在生成中..."]}):a.jsxs(a.Fragment,{children:["开始生成",a.jsx(w,{className:"ml-2 h-4 w-4"})]})})}),oe.length>0&&a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsx("h2",{className:"text-3xl font-bold",children:"平台适配结果"}),a.jsxs(o,{size:"lg",variant:"default",onClick:()=>{const e=oe.filter(e=>e.content).map(e=>e.platformId);Os(e),As(!0)},disabled:0===oe.filter(e=>e.content).length,children:["api"===_s?a.jsx(P,{className:"h-5 w-5 mr-2"}):a.jsx(ce,{className:"h-5 w-5 mr-2"}),"api"===_s?"批量API直发":"批量一键转发"]})]}),a.jsxs(i,{defaultValue:null==(f=oe[0])?void 0:f.platformId,className:"w-full",children:[a.jsx(l,{className:"mb-6 grid w-full grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 h-12 overflow-x-auto",children:oe.map(e=>a.jsx(n,{value:e.platformId,className:"text-xs sm:text-sm font-medium min-w-0",children:a.jsx("div",{className:"flex items-center",children:Te(e.platformId)})},e.platformId))}),oe.map(e=>{var s,t;return a.jsx(c,{value:e.platformId,children:a.jsxs(m,{className:"p-8 shadow-lg border-2",children:[a.jsx(h,{className:"pb-4",children:a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs(x,{className:"text-2xl flex items-center",children:[Te(e.platformId),a.jsx("span",{className:"ml-3",children:(null==(s=ge[e.platformId])?void 0:s.name)||e.platformId})]})})}),a.jsxs(j,{className:"space-y-6",children:[a.jsx("div",{className:"space-y-3",children:e.steps.map((e,s)=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium "+("completed"===e.status?"bg-green-500 text-white":"loading"===e.status?"bg-blue-500 text-white animate-spin":"error"===e.status?"bg-red-500 text-white":"bg-gray-200 text-gray-600"),children:"completed"===e.status?"✓":"loading"===e.status?"⟳":"error"===e.status?"✗":s+1}),a.jsx("span",{className:"text-sm "+("completed"===e.status?"text-green-600":"loading"===e.status?"text-blue-600":"error"===e.status?"text-red-600":"text-gray-500"),children:e.message})]},s))}),e.error&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:"✗"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"生成失败"}),a.jsx("div",{className:"mt-1 text-sm text-red-700",children:e.error})]})]})}),e.content&&!e.error&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:"✓"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"AI生成内容"}),a.jsx("div",{className:"mt-1 text-sm text-green-700",children:"内容已成功生成，您可以编辑、复制或收藏"})]})]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"生成结果"}),a.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-blue-500 to-purple-600 mx-auto rounded-full"})]}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8 items-start",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-center xl:justify-start gap-2 mb-3",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"生成内容"}),a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.content?Le===e.platformId?a.jsxs("div",{className:"space-y-3",children:[a.jsx(L,{value:e.content,onChange:s=>{de(t=>t.map(t=>t.platformId===e.platformId?{...t,content:s.target.value}:t))},className:"min-h-[300px] text-base resize-none"}),a.jsxs("div",{className:"flex gap-3 justify-center lg:justify-start",children:[a.jsx(o,{size:"sm",onClick:()=>{return s=e.platformId,t=e.content,de(e=>e.map(e=>e.platformId===s?{...e,content:t}:e)),_e(null),void N({title:"保存成功",description:"内容已更新"});var s,t},className:"bg-green-600 hover:bg-green-700",children:"保存"}),a.jsx(o,{size:"sm",variant:"outline",onClick:()=>_e(null),children:"取消"})]})]}):a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"whitespace-pre-wrap rounded-lg border-2 p-6 overflow-auto max-h-[600px] text-base leading-relaxed shadow-sm "+("xiaohongshu"===e.platformId?"bg-rose-50 border-rose-200":"douyin"===e.platformId?"bg-black text-white border-gray-800":"weibo"===e.platformId?"bg-orange-50 border-orange-200":"zhihu"===e.platformId?"bg-blue-50 border-blue-200":"wechat"===e.platformId?"bg-green-50 border-green-200":"bilibili"===e.platformId?"bg-pink-50 border-pink-200":"video"===e.platformId?"bg-emerald-50 border-emerald-200":"twitter"===e.platformId?"bg-sky-50 border-sky-200":"bg-gray-50 border-gray-200"),children:e.content}),a.jsx("div",{className:"absolute top-4 right-4",children:a.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-xs font-medium text-gray-700 shadow-sm",children:(null==(t=ge[e.platformId])?void 0:t.name)||e.platformId})})]}):e.error?a.jsx("div",{className:"rounded-lg border-2 border-dashed border-red-200 p-12 flex items-center justify-center bg-red-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-red-600 text-lg font-medium",children:"生成失败"}),a.jsx("p",{className:"text-red-500 text-sm mt-2",children:e.error})]})}):a.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-200 p-12 flex items-center justify-center bg-gray-50",children:a.jsx("p",{className:"text-muted-foreground text-lg",children:"生成的内容将显示在这里..."})})]}),He[e.platformId]&&a.jsx("div",{className:"hidden lg:flex items-center justify-center absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10",children:a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:a.jsx("div",{className:"w-0 h-0 border-l-2 border-r-2 border-t-2 border-white"})})}),He[e.platformId]&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-2 mb-3",children:[a.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"翻译内容"}),a.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"whitespace-pre-wrap rounded-lg border-2 border-blue-200 p-6 bg-blue-50 overflow-auto max-h-[600px] text-base leading-relaxed shadow-sm",children:He[e.platformId]}),a.jsx("div",{className:"absolute top-4 right-4",children:a.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-xs font-medium text-blue-700 shadow-sm",children:"翻译版本"})})]})]})]})]}),e.content&&a.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[a.jsxs(o,{size:"lg",variant:"outline",onClick:()=>(async e=>{if(!pe){de(s=>s.map(s=>s.platformId===e?{...s,steps:[{status:"loading",message:"重新分析内容..."},{status:"waiting",message:"提取核心信息..."},{status:"waiting",message:"进行平台适配..."},{status:"waiting",message:"优化输出结果..."}]}:s));try{const s={},t=Ue[e];s[`${e}-charCount`]=(null==t?void 0:t.charCount)||.6*Pe(e),s[`${e}-emoji`]=(null==t?void 0:t.useEmoji)||!1,s[`${e}-mdFormat`]=(null==t?void 0:t.useMdFormat)||!1,s[`${e}-autoFormat`]=(null==t?void 0:t.useAutoFormat)||!1,s[`${e}-brandLibrary`]=ye;const a=await async function(e,s,t){try{const a=await ee.adaptContent(s,[e],t);return{success:a.success,data:a.data,error:a.error}}catch(a){return{success:!1,error:a instanceof Error?a.message:"内容重新生成失败"}}}(e,y,s),r=(s,t)=>{de(a=>a.map(a=>a.platformId===e?{...a,steps:a.steps.map((e,a)=>a===s?{...e,status:t}:e)}:a))};r(0,"completed"),await new Promise(e=>setTimeout(e,300)),r(1,"loading"),await new Promise(e=>setTimeout(e,300)),r(1,"completed"),r(2,"loading"),await new Promise(e=>setTimeout(e,300)),r(2,"completed"),r(3,"loading"),await new Promise(e=>setTimeout(e,300));const i=a[e];r(3,"completed"),de(s=>s.map(s=>s.platformId===e?{...s,content:i.content,source:i.source,error:i.error}:s)),N({title:"重新生成成功",description:`已为${e}重新生成内容`})}catch(s){de(t=>t.map(t=>t.platformId===e?{...t,steps:t.steps.map(e=>"loading"===e.status?{...e,status:"error"}:e),error:s instanceof Error?s.message:"重新生成失败"}:t)),N({title:"重新生成失败",description:s instanceof Error?s.message:`适配${e}内容时出错`,variant:"destructive"})}}})(e.platformId),disabled:pe,children:[a.jsx(d,{className:"h-5 w-5 mr-2"}),"重新生成"]}),a.jsxs(o,{size:"lg",variant:"outline",onClick:()=>{return s=e.platformId,void _e(Le===s?null:s);var s},children:[a.jsx(he,{className:"h-5 w-5 mr-2"}),Le===e.platformId?"取消编辑":"编辑"]}),a.jsxs(o,{size:"lg",variant:"outline",onClick:()=>(e=>{const s=oe.find(s=>s.platformId===e);if(!s||!s.content)return void N({title:"无法收藏",description:"没有可收藏的内容",variant:"destructive"});const t=JSON.parse(localStorage.getItem("favorites")||"[]"),a={id:Date.now().toString(),platformId:e,content:s.content,platformName:e,timestamp:(new Date).toISOString()};t.push(a),localStorage.setItem("favorites",JSON.stringify(t)),N({title:"收藏成功",description:"内容已添加到收藏，可在我的页面查看"})})(e.platformId),children:[a.jsx(xe,{className:"h-5 w-5 mr-2"}),"收藏"]}),a.jsxs(o,{size:"lg",variant:"outline",onClick:()=>{return s=e.content,navigator.clipboard.writeText(s),void N({title:"已复制到剪贴板",description:"内容已成功复制，可直接粘贴使用"});var s},children:[a.jsx(ue,{className:"h-5 w-5 mr-2"}),"一键复制"]}),a.jsxs(o,{size:"lg",variant:"outline",onClick:()=>(async(e,s)=>{if(Ve.has(e))N({title:"请勿频繁点击",description:"翻译进行中，请稍候...",variant:"destructive"});else{qe(s=>new Set(s).add(e));try{const t=await(async e=>{try{const s=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,targetLang:"en",sourceLang:"zh"})});if(!s.ok)throw new Error("Translation API failed");return(await s.json()).translatedText||e}catch{return Is(e)}})(s);Ke(s=>({...s,[e]:t})),N({title:"翻译完成",description:"内容已翻译为英文"})}catch{N({title:"翻译失败",description:"翻译过程中出现错误，请稍后重试",variant:"destructive"})}finally{setTimeout(()=>{qe(s=>{const t=new Set(s);return t.delete(e),t})},3e3)}}})(e.platformId,e.content),disabled:Ve.has(e.platformId),children:[a.jsx(je,{className:"h-5 w-5 mr-2"}),"一键翻译"]}),a.jsxs(o,{size:"lg",variant:"default",onClick:()=>(e=>{const s=oe.find(s=>s.platformId===e);s&&s.content?(ys({platformId:e,content:s.content}),vs(!0)):N({title:"无法发布",description:"没有可发布的内容",variant:"destructive"})})(e.platformId),disabled:Ks.has(e.platformId),children:[Ks.has(e.platformId)?a.jsx(d,{className:"h-5 w-5 mr-2 animate-spin"}):"api"===_s?a.jsx(P,{className:"h-5 w-5 mr-2"}):a.jsx(ce,{className:"h-5 w-5 mr-2"}),Ks.has(e.platformId)?"发布中...":"api"===_s?"API直发":"立刻发布"]})]})]})]})},e.platformId)})]})]})]}),a.jsx(se,{open:Ns,onOpenChange:vs,children:a.jsxs(te,{children:[a.jsx(ae,{children:a.jsx(re,{children:"一键转发确认"})}),a.jsxs("div",{className:"py-2 text-gray-700",children:[a.jsx("p",{children:"api"===_s?"是否通过API直接发布内容？":"内容已复制到剪贴板，是否跳转到平台发布页？"}),a.jsx("div",{className:"bg-gray-100 rounded p-2 mt-2 text-xs break-all max-h-32 overflow-auto",children:null==ws?void 0:ws.content})]}),a.jsxs(ie,{children:[a.jsx(o,{variant:"outline",onClick:()=>vs(!1),children:"取消"}),a.jsx(o,{variant:"default",onClick:()=>{if(!ws)return;const{platformId:e,content:s}=ws;if("api"===_s)(async(e,s)=>{if(!Se(e))return N({title:"未授权",description:"请先配置平台API授权信息",variant:"destructive"}),void Ls(!0);Vs(s=>new Set(s).add(e));try{const t={text:s,title:`AI生成内容 - ${(new Date).toLocaleString()}`,hashtags:[]},a=await ke(e,t);if(a.success){const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t)),N({title:"发布成功",description:`内容已成功发布到${e}`}),a.publishUrl&&window.open(a.publishUrl,"_blank","noopener,noreferrer")}else N({title:"发布失败",description:a.error||"发布过程中出现错误",variant:"destructive"})}catch(t){N({title:"发布失败",description:t instanceof Error?t.message:"网络错误",variant:"destructive"})}finally{Vs(s=>{const t=new Set(s);return t.delete(e),t})}})(e,s);else{navigator.clipboard.writeText(s);const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t));const a=Oe[e];a?(window.open(a,"_blank","noopener,noreferrer"),N({title:"内容已复制，正在跳转",description:`内容已复制到剪贴板，正在打开${e}官网`})):N({title:"内容已复制",description:"内容已复制到剪贴板，但该平台的发布链接暂未配置"})}vs(!1),ys(null)},children:"api"===_s?"确认发布":"跳转并发布"})]})]})}),a.jsx(se,{open:Cs,onOpenChange:As,children:a.jsxs(te,{children:[a.jsx(ae,{children:a.jsx(re,{children:"批量一键转发"})}),a.jsxs("div",{className:"py-2 text-gray-700",children:[a.jsx("p",{children:"请选择要批量转发的平台："}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:oe.filter(e=>e.content).map(e=>a.jsx(o,{variant:zs.includes(e.platformId)?"default":"outline",onClick:()=>Os(s=>s.includes(e.platformId)?s.filter(s=>s!==e.platformId):[...s,e.platformId]),children:e.platformId},e.platformId))})]}),a.jsxs(ie,{children:[a.jsx(o,{variant:"outline",onClick:()=>As(!1),children:"取消"}),a.jsx(o,{variant:"default",onClick:()=>{const e=zs.map(e=>{const s=oe.find(s=>s.platformId===e);return s&&s.content?{platformId:e,content:s.content}:null}).filter(Boolean);"api"===_s?((async e=>{const s=e.filter(e=>!Se(e));if(s.length>0)return N({title:"部分平台未授权",description:`请先配置 ${s.join(", ")} 的API授权信息`,variant:"destructive"}),void Ls(!0);const t=e.filter(e=>Se(e));if(0===t.length)return void N({title:"无可用平台",description:"请先配置至少一个平台的API授权信息",variant:"destructive"});const a=oe.find(e=>e.platformId===t[0]);if(null==a?void 0:a.content){Vs(new Set(t));try{const e={text:a.content,title:`AI生成内容 - ${(new Date).toLocaleString()}`,hashtags:[]},s=await async function(e,s){const t=[];for(const r of e)try{const e=await ke(r,s);t.push(e)}catch(a){t.push({success:!1,error:a instanceof Error?a.message:"发布失败"})}return t}(t,e),r=s.filter(e=>e.success).length,i=s.length-r,l=JSON.parse(localStorage.getItem("shareHistory")||"[]");s.forEach((e,s)=>{e.success&&l.unshift({id:Date.now().toString()+s,platformId:t[s],platformName:t[s],content:a.content,time:(new Date).toISOString()})}),localStorage.setItem("shareHistory",JSON.stringify(l)),N({title:"批量发布完成",description:`成功: ${r}个平台，失败: ${i}个平台`}),s.forEach((e,s)=>{e.success&&e.publishUrl&&setTimeout(()=>{window.open(e.publishUrl,"_blank","noopener,noreferrer")},500*s)})}catch(r){N({title:"批量发布失败",description:r instanceof Error?r.message:"网络错误",variant:"destructive"})}finally{Vs(new Set)}}else N({title:"无内容可发布",description:"请先生成内容",variant:"destructive"})})(zs),As(!1)):(Es(e),As(!1),e.length>0&&$s(e[0]))},disabled:0===zs.length,children:"开始批量转发"})]})]})}),a.jsx(se,{open:!!Ps,onOpenChange:e=>{e||$s(null)},children:a.jsxs(te,{children:[a.jsx(ae,{children:a.jsx(re,{children:"批量一键转发"})}),a.jsxs("div",{className:"py-2 text-gray-700",children:[a.jsxs("p",{children:["内容已复制到剪贴板，是否跳转到 ",null==Ps?void 0:Ps.platformId," 发布页？"]}),a.jsx("div",{className:"bg-gray-100 rounded p-2 mt-2 text-xs break-all max-h-32 overflow-auto",children:null==Ps?void 0:Ps.content})]}),a.jsxs(ie,{children:[a.jsx(o,{variant:"outline",onClick:()=>{if(!Ps)return;const e=Ts.findIndex(e=>e.platformId===Ps.platformId);e>=0&&e<Ts.length-1?$s(Ts[e+1]):($s(null),Es([]),N({title:"批量转发完成",description:"已完成所有平台的转发"}))},children:"跳过"}),a.jsx(o,{variant:"default",onClick:()=>{if(!Ps)return;const{platformId:e,content:s}=Ps;navigator.clipboard.writeText(s);const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t));const a=Oe[e];a&&window.open(a,"_blank","noopener,noreferrer");const r=Ts.findIndex(s=>s.platformId===e);r>=0&&r<Ts.length-1?$s(Ts[r+1]):($s(null),Es([]),N({title:"批量转发完成",description:"已完成所有平台的转发"}))},children:"跳转并发布"})]})]})}),a.jsx(se,{open:Us,onOpenChange:Ds,children:a.jsxs(te,{className:"max-w-2xl",children:[a.jsx(ae,{children:a.jsx(re,{children:"转发历史"})}),a.jsx("div",{className:"py-2 text-gray-700 max-h-[60vh] overflow-auto",children:0===Bs.length?a.jsx("div",{className:"text-center text-gray-400 py-8",children:"暂无转发历史"}):a.jsx("div",{className:"space-y-4",children:Bs.map(e=>a.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-bold text-blue-600",children:e.platformName}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.time).toLocaleString()})]}),a.jsx("div",{className:"text-xs break-all mb-1",children:e.content}),a.jsx(o,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(e.content),children:"复制内容"})]},e.id))})}),a.jsxs(ie,{children:[a.jsx(o,{variant:"outline",onClick:()=>{localStorage.removeItem("shareHistory"),Js([]),N({title:"已清空",description:"转发历史已清空"})},disabled:0===Bs.length,children:"清空历史"}),a.jsx(o,{variant:"default",onClick:()=>Ds(!1),children:"关闭"})]})]})}),a.jsx(Ce,{open:Ms,onOpenChange:Ls}),a.jsx(Ae,{isOpen:is,onClose:()=>ls(!1),onUpgrade:()=>{ls(!1),v("/payment")},remainingCount:ns,userType:"trial"===Qe?"trial":"pro"}),a.jsx(ze,{isOpen:os,onClose:()=>ds(!1),onUpgrade:()=>{ds(!1),v("/payment")},featureName:ms.name,featureDescription:ms.description})]})}export{Ue as default};
