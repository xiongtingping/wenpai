import{j as e}from"./ui-core-BoM6Gtru.js";import{r as i}from"./router-CDHmMMQ-.js";import"./react-vendor-D7XYiaTe.js";function r(){const[r,d]=i.useState(""),[t,n]=i.useState(null),[s,o]=i.useState(!1),[l,a]=i.useState(null),[p,x]=i.useState(!1),[c,h]=i.useState("页面已加载"),m=async(e,i)=>{o(!0),a(null),h(`开始测试 ${i}...`);try{const r=await fetch("http://localhost:8888/.netlify/functions/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({priceId:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const t=await r.json();if(!t.success)throw new Error("二维码生成失败");d(t.qrCodeDataURL),n(t.price),h(`${i} 二维码生成成功`)}catch(r){a((null==r?void 0:r.message)||"二维码生成失败"),d(""),n(null),h(`错误: ${(null==r?void 0:r.message)||"二维码生成失败"}`)}finally{o(!1)}},f=async()=>{x(!0),await m("prod_3nJOuQeVStqkp6JaDcrKHf","专业版月付"),x(!1)};return i.useEffect(()=>{h("页面已加载，等待用户操作")},[]),e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"24px"},children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h1",{style:{fontSize:"2rem",fontWeight:"bold",textAlign:"center",marginBottom:"8px"},children:"支付二维码测试"}),e.jsx("p",{style:{textAlign:"center",color:"#666"},children:"测试后端生成的支付二维码显示功能"})]}),e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px",backgroundColor:"#f9fafb"},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"调试信息"}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#666"},children:c})]}),e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"测试配置"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[{name:"专业版月付",priceId:"prod_3nJOuQeVStqkp6JaDcrKHf"},{name:"专业版年付",priceId:"prod_5qBlDTLpD3h9gvOZFd4Rgu"},{name:"高级版月付",priceId:"prod_4HYBfvrcbXYnbxjlswMj28"},{name:"高级版年付",priceId:"prod_6OfIoVnRg2pXsuYceVKOYk"}].map(i=>e.jsxs("button",{onClick:()=>m(i.priceId,i.name),disabled:s,style:{padding:"16px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:s?"#f3f4f6":"#ffffff",cursor:s?"not-allowed":"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontWeight:"500"},children:i.name}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:i.priceId})]},i.priceId))})]}),e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"bold"},children:"支付二维码"}),e.jsx("button",{onClick:f,disabled:p||s,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#ffffff",cursor:p||s?"not-allowed":"pointer",fontSize:"0.875rem"},children:p?"刷新中...":"刷新"})]}),e.jsx("div",{style:{textAlign:"center"},children:s?e.jsxs("div",{style:{padding:"32px"},children:[e.jsx("div",{style:{display:"inline-block",width:"24px",height:"24px",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{margin:"8px 0 0 0"},children:"正在生成二维码..."})]}):l?e.jsxs("div",{style:{padding:"32px"},children:[e.jsx("div",{style:{color:"#dc2626",marginBottom:"16px"},children:l}),e.jsx("button",{onClick:f,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#ffffff",cursor:"pointer"},children:"重试"})]}):r?e.jsxs("div",{children:[null!==t&&e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("span",{style:{display:"inline-block",padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"1.125rem",fontWeight:"500"},children:["¥",t.toFixed(2)]})}),e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("img",{src:r,alt:"支付宝二维码",style:{border:"2px solid #e5e7eb",borderRadius:"8px",width:"300px",height:"300px"}})}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:e.jsx("p",{style:{margin:"0 0 4px 0"},children:"扫码后会跳转到Creem安全支付页，请放心支付"})})]}):e.jsx("div",{style:{padding:"32px",color:"#6b7280"},children:"请选择测试配置生成二维码"})})]}),r&&e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"调试信息"}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"二维码数据长度:"})," ",r.length," 字符"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"价格:"})," ",null!==t?`¥${t.toFixed(2)}`:"未获取"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"二维码类型:"})," ",r.startsWith("data:image/png")?"PNG":"未知"]})]})]}),e.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})}export{r as default};
