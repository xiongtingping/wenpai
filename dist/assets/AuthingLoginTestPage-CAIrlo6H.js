import{_ as s,aC as e,u as a,r as c,bl as t,j as i,C as l,e as r,f as n,ay as d,i as x,g as m,R as h,k as j,S as o,h as p,B as g,m as u,l as N,aF as f}from"./index-BuR5xlXm.js";import{L as v}from"./log-in-ozpaY2gY.js";import{E as y}from"./eye-off-BbLMqTMw.js";import{L as w}from"./log-out-Cw0Q0gIC.js";function b(){const{user:b,isAuthenticated:k,status:A,login:I,logout:D}=s(),{user:C,isLoggedIn:L,loading:G,guard:R,showLogin:S,hideLogin:U}=e(),{toast:E}=a(),[$,z]=c.useState(null),[H,M]=c.useState([]);c.useEffect(()=>{try{const s=t();z(s)}catch(s){}},[]);const q=(s,e,a)=>{M(c=>[...c,{id:Date.now(),test:s,status:e,message:a,timestamp:(new Date).toLocaleTimeString()}])};return i.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Authing登录系统测试"}),i.jsx("p",{className:"text-gray-600",children:"测试Authing登录系统的各项功能和配置"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[i.jsxs(l,{children:[i.jsx(r,{className:"pb-3",children:i.jsxs(n,{className:"flex items-center gap-2",children:[i.jsx(d,{className:"w-5 h-5"}),"认证状态"]})}),i.jsxs(x,{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(m,{variant:k?"default":"secondary",children:k?"已登录":"未登录"}),G&&i.jsx(h,{className:"w-4 h-4 animate-spin"})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["状态: ",A]})]})]}),i.jsxs(l,{children:[i.jsx(r,{className:"pb-3",children:i.jsxs(n,{className:"flex items-center gap-2",children:[i.jsx(j,{className:"w-5 h-5"}),"Authing状态"]})}),i.jsxs(x,{children:[i.jsx("div",{className:"flex items-center gap-2 mb-2",children:i.jsx(m,{variant:L?"default":"secondary",children:L?"已连接":"未连接"})}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Guard: ",R?"已初始化":"未初始化"]})]})]}),i.jsxs(l,{children:[i.jsx(r,{className:"pb-3",children:i.jsxs(n,{className:"flex items-center gap-2",children:[i.jsx(o,{className:"w-5 h-5"}),"配置状态"]})}),i.jsxs(x,{children:[i.jsx("div",{className:"flex items-center gap-2 mb-2",children:i.jsx(m,{variant:$?"default":"destructive",children:$?"已配置":"未配置"})}),i.jsxs("p",{className:"text-sm text-gray-600",children:["App ID: ",(null==$?void 0:$.appId)?"已设置":"未设置"]})]})]})]}),i.jsxs(l,{className:"mb-8",children:[i.jsxs(r,{children:[i.jsx(n,{children:"操作面板"}),i.jsx(p,{children:"测试Authing登录系统的各项功能"})]}),i.jsx(x,{children:i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsxs(g,{onClick:()=>{M([]),q("Authing配置","success","配置加载成功"),$?(q("App ID","success",$.appId),q("Host","success",$.host),q("Redirect URI","success",$.redirectUri),q("Mode","success",$.mode)):q("配置加载","error","配置加载失败"),(async()=>{try{const s=await fetch("https://qutkgzkfaezk-demo.authing.cn");s.ok?q("网络连接","success","Authing服务可访问"):q("网络连接","error",`服务响应异常: ${s.status}`)}catch(s){q("网络连接","error",`连接失败: ${s instanceof Error?s.message:"未知错误"}`)}})(),R?q("Guard组件","success","Guard组件已初始化"):q("Guard组件","error","Guard组件未初始化"),L?q("登录状态","success","用户已登录"):q("登录状态","warning","用户未登录"),b?(q("用户信息","success",`用户ID: ${b.id}`),q("用户名","success",b.nickname||b.username||"未设置"),q("邮箱","success",b.email||"未设置")):q("用户信息","warning","无用户信息"),E({title:"测试完成",description:"请查看测试结果"})},className:"flex items-center gap-2",children:[i.jsx(h,{className:"w-4 h-4"}),"运行所有测试"]}),i.jsxs(g,{onClick:()=>{S(),q("显示登录","success","登录界面已显示")},variant:"outline",className:"flex items-center gap-2",children:[i.jsx(v,{className:"w-4 h-4"}),"显示登录界面"]}),i.jsxs(g,{onClick:()=>{U(),q("隐藏登录","success","登录界面已隐藏")},variant:"outline",className:"flex items-center gap-2",children:[i.jsx(y,{className:"w-4 h-4"}),"隐藏登录界面"]}),k&&i.jsxs(g,{onClick:()=>{D(),q("用户登出","success","用户已登出")},variant:"destructive",className:"flex items-center gap-2",children:[i.jsx(w,{className:"w-4 h-4"}),"登出"]})]})})]}),b&&i.jsxs(l,{className:"mb-8",children:[i.jsx(r,{children:i.jsx(n,{children:"当前用户信息"})}),i.jsx(x,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"用户ID"}),i.jsx("p",{className:"text-sm",children:b.id})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"用户名"}),i.jsx("p",{className:"text-sm",children:b.nickname||b.username||"未设置"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"邮箱"}),i.jsx("p",{className:"text-sm",children:b.email||"未设置"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"手机号"}),i.jsx("p",{className:"text-sm",children:b.phone||"未设置"})]})]})})]}),$&&i.jsxs(l,{className:"mb-8",children:[i.jsx(r,{children:i.jsx(n,{children:"Authing配置信息"})}),i.jsx(x,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"App ID"}),i.jsx("p",{className:"text-sm font-mono",children:$.appId})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Host"}),i.jsx("p",{className:"text-sm font-mono",children:$.host})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Redirect URI"}),i.jsx("p",{className:"text-sm font-mono",children:$.redirectUri})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mode"}),i.jsx("p",{className:"text-sm",children:$.mode})]})]})})]}),i.jsxs(l,{children:[i.jsxs(r,{children:[i.jsx(n,{children:"测试结果"}),i.jsx(p,{children:"显示各项功能的测试结果"})]}),i.jsx(x,{children:0===H.length?i.jsx("p",{className:"text-gray-500 text-center py-8",children:'暂无测试结果，请点击"运行所有测试"开始测试'}):i.jsx("div",{className:"space-y-3",children:H.map(s=>i.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:["success"===s.status&&i.jsx(u,{className:"w-5 h-5 text-green-500"}),"error"===s.status&&i.jsx(N,{className:"w-5 h-5 text-red-500"}),"warning"===s.status&&i.jsx(f,{className:"w-5 h-5 text-yellow-500"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:s.test}),i.jsx("p",{className:"text-sm text-gray-600",children:s.message})]}),i.jsx("span",{className:"text-xs text-gray-400",children:s.timestamp})]},s.id))})})]})]})}export{b as default};
