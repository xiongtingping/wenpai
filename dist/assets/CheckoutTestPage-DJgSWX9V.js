import{r as e,u as s,j as a,B as i,ae as r,_ as l,aV as c,C as d,e as t,f as n,g as m,i as x,L as o,T as p,a as h,b as j,d as u}from"./index-CYvVoP-H.js";import{I as f}from"./input-C7T9kmHO.js";import{S as N}from"./separator-DS2DK2Rh.js";import{A as v}from"./AlipayQRCode-BO-RtIJF.js";import{r as g}from"./creemClientService-hzbV9p0u.js";import{C as b}from"./credit-card-B13ZmeOa.js";import{E as y}from"./external-link-Bguz_PIV.js";import"./smartphone-Bju1SvB9.js";import"./browser-Cnf2s-_L.js";function I({priceId:l,customerEmail:c,children:d="立即支付",variant:t="default",size:n="default",className:m="",disabled:x=!1,showIcon:o=!0}){const[p,h]=e.useState(!1),{toast:j}=s();return a.jsx(i,{onClick:async()=>{if(l){h(!0);try{await g(l,c),j({title:"正在跳转",description:"正在跳转到支付页面..."})}catch(e){j({title:"支付失败",description:e.message||"无法跳转到支付页面，请稍后重试",variant:"destructive"})}finally{h(!1)}}else j({title:"错误",description:"产品ID不能为空",variant:"destructive"})},variant:t,size:n,className:m,disabled:x||p,children:p?a.jsxs(a.Fragment,{children:[a.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}),"处理中..."]}):a.jsxs(a.Fragment,{children:[o&&a.jsx(b,{className:"w-4 h-4 mr-2"}),d,o&&a.jsx(y,{className:"w-4 h-4 ml-2"})]})})}function C(){const[s,r]=e.useState("prod_3nJOuQeVStqkp6JaDcrKHf"),[g,b]=e.useState(""),[y,C]=e.useState(!1),{user:w}=l();return c.useEffect(()=>{(null==w?void 0:w.email)&&!g&&b(w.email)},[w,g]),a.jsx("div",{className:"container mx-auto py-8 px-4 max-w-6xl",children:a.jsxs(d,{children:[a.jsxs(t,{children:[a.jsxs(n,{className:"flex items-center gap-2",children:["💳 完整支付流程测试",a.jsx(m,{variant:"secondary",children:"Creem支付"})]}),a.jsx("p",{className:"text-muted-foreground",children:"测试Creem支付的完整流程，包括二维码支付和跳转支付"})]}),a.jsxs(x,{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:"选择产品"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{name:"专业版月付",priceId:"prod_3nJOuQeVStqkp6JaDcrKHf",price:"¥29.00",description:"适合个人用户使用"},{name:"专业版年付",priceId:"prod_5qBlDTLpD3h9gvOZFd4Rgu",price:"¥299.00",description:"年付享受更多优惠"},{name:"高级版月付",priceId:"prod_4HYBfvrcbXYnbxjlswMj28",price:"¥59.00",description:"适合团队使用"},{name:"高级版年付",priceId:"prod_6OfIoVnRg2pXsuYceVKOYk",price:"¥599.00",description:"年付享受更多优惠"}].map(e=>a.jsx(d,{className:"p-4 cursor-pointer transition-colors "+(s===e.priceId?"border-blue-500 bg-blue-50":"hover:border-gray-300"),onClick:()=>{return s=e.priceId,r(s),void C(!1);var s},children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:e.name}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),a.jsx(m,{variant:"outline",className:"text-lg px-3 py-1",children:e.price})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:e.priceId}),s===e.priceId&&a.jsx(m,{variant:"default",className:"mt-1",children:"已选择"})]})]})},e.priceId))})]}),a.jsxs("div",{children:[a.jsx(o,{htmlFor:"customerEmail",children:"客户邮箱"}),a.jsx(f,{id:"customerEmail",type:"email",placeholder:"customer@example.com",value:g,onChange:e=>b(e.target.value),className:"mt-2"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"用于支付通知和订单确认"})]}),a.jsxs(p,{defaultValue:"redirect",className:"w-full",children:[a.jsxs(h,{className:"grid w-full grid-cols-2",children:[a.jsx(j,{value:"redirect",children:"跳转支付"}),a.jsx(j,{value:"qrcode",children:"二维码支付"})]}),a.jsx(u,{value:"redirect",className:"space-y-4",children:a.jsx(d,{className:"p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"跳转到Creem支付页面"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"点击支付按钮后，将跳转到Creem的支付页面完成支付"})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsx("h5",{className:"font-medium mb-2",children:"当前配置"}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"价格ID:"})," ",s]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"客户邮箱:"})," ",g||"未设置"]})]})]}),a.jsx("div",{className:"flex gap-4",children:a.jsx(I,{priceId:s,customerEmail:g||void 0,className:"flex-1",size:"lg",children:"跳转到支付页面"})})]})})}),a.jsx(u,{value:"qrcode",className:"space-y-4",children:a.jsx(d,{className:"p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"扫码支付"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"生成支付宝二维码，使用手机扫码完成支付"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(i,{onClick:()=>{C(!0)},className:"flex-1",size:"lg",children:"生成支付二维码"}),a.jsx(i,{variant:"outline",onClick:()=>C(!1),children:"隐藏二维码"})]}),y&&s&&a.jsxs("div",{className:"border-t pt-6",children:[a.jsx("h5",{className:"font-medium mb-4",children:"支付二维码"}),a.jsx("div",{className:"flex justify-center",children:a.jsx(v,{priceId:s,customerEmail:g||void 0,title:"使用支付宝扫码付款",showPrice:!0,onRefresh:()=>{}})})]})]})})})]}),a.jsx(N,{}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"支付流程说明"}),a.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-medium",children:"1."}),a.jsx("span",{children:"选择产品和支付方式"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-medium",children:"2."}),a.jsx("span",{children:"填写客户邮箱（用于支付通知）"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-medium",children:"3."}),a.jsx("span",{children:"点击支付按钮或扫描二维码"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-medium",children:"4."}),a.jsx("span",{children:"在Creem支付页面完成支付"})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-medium",children:"5."}),a.jsx("span",{children:"支付成功后自动返回并激活服务"})]})]})]})]})]})})}export{C as default};
