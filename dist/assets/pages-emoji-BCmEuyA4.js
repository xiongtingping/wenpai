import{j as e}from"./ui-core-CkDiOLPZ.js";import{r as s}from"./router-CDHmMMQ-.js";import{C as a,a as t,b as l,e as i,B as n,u as r,S as c,d as o}from"./pages-home-cm4XWoxC.js";import{B as d,L as m,T as x,I as h,o as u,i as j,j as p,k as g,l as v,S as N,e as f,f as w,g as b,h as y}from"./pages-adapt-BekQTgf9.js";import{n as k,U as C,N as S}from"./api-services-CFC91rmd.js";import{a as $}from"./pages-content-extractor-BZ1ALdwH.js";import{A as E,a as T,P as z}from"./pages-brand-CdVj9KMe.js";import{ab as P,as as I,e as R,C as A,X as U,at as B,au as F,av as L,n as D,g as M,x as O,aw as G,z as V,W as q,w as J,ar as W,h as _,a5 as H,m as K}from"./utils-DOwhHgxs.js";import"./react-vendor-D7XYiaTe.js";import"./components-landing-lYQV1woT.js";import"./components-layout-Dpkc7dU5.js";import"./components-auth-Cmg7TtKX.js";function Q({onUploadComplete:r,onReset:c}){const[o,h]=s.useState("image"),[u,j]=s.useState(null),[p,g]=s.useState(""),[v,N]=s.useState(!1),[f,w]=s.useState(null),b=s.useRef(null),y=()=>{j(null),g(""),w(null),N(!1),b.current&&(b.current.value=""),c()},k=()=>{var e;null==(e=b.current)||e.click()};return e.jsxs(a,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(t,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"ä¸Šä¼ å“ç‰Œç´ æ"]})}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"image"===o?"default":"outline",onClick:()=>h("image"),className:"flex-1",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"ä¸Šä¼ å›¾ç‰‡"]}),e.jsxs(n,{variant:"description"===o?"default":"outline",onClick:()=>h("description"),className:"flex-1",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"æ–‡å­—æè¿°"]})]}),f&&e.jsx(E,{variant:"destructive",children:e.jsx(T,{children:f})}),"image"===o&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-gray-400 transition-colors",onClick:k,children:u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:URL.createObjectURL(u),alt:"é¢„è§ˆ",className:"w-32 h-32 object-cover rounded-lg"}),e.jsxs(d,{className:"absolute -top-2 -right-2 bg-green-500",children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),"å·²ä¸Šä¼ "]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:u.name})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(P,{className:"w-12 h-12 mx-auto text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"ç‚¹å‡»ä¸Šä¼ å“ç‰Œå›¾ç‰‡"}),e.jsx("p",{className:"text-sm text-gray-500",children:"æ”¯æŒ JPGã€PNG æ ¼å¼ï¼Œæœ€å¤§ 5MB"})]})]})}),e.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];a&&(a.type.startsWith("image/")?a.size>5242880?w("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB"):(w(null),j(a),N(!0),setTimeout(()=>{N(!1),r({image:a})},1e3)):w("è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶"))},className:"hidden"}),u&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{onClick:k,variant:"outline",className:"flex-1",children:"é‡æ–°é€‰æ‹©"}),e.jsx(n,{onClick:y,variant:"outline",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),"description"===o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"å“ç‰Œæè¿°"}),e.jsx(x,{id:"description",placeholder:"è¯·æè¿°æ‚¨çš„å“ç‰Œç‰¹ç‚¹ï¼Œä¾‹å¦‚ï¼šç§‘æŠ€å…¬å¸ï¼Œè“è‰²ä¸»é¢˜ï¼Œç®€çº¦ç°ä»£é£æ ¼...",value:p,onChange:e=>g(e.target.value),rows:4,className:"resize-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{onClick:()=>{p.trim()?(w(null),N(!0),setTimeout(()=>{N(!1),r({description:p.trim()})},500)):w("è¯·è¾“å…¥å“ç‰Œæè¿°")},disabled:v||!p.trim(),className:"flex-1",children:v?"å¤„ç†ä¸­...":"æäº¤æè¿°"}),e.jsx(n,{onClick:y,variant:"outline",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),v&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"image"===o?"æ­£åœ¨ä¸Šä¼ å›¾ç‰‡...":"æ­£åœ¨å¤„ç†æè¿°..."})]})]})]})}const X=["å¼€å¿ƒå¾®ç¬‘","å¤§ç¬‘","ç”Ÿæ°”","å“­æ³£","æƒŠè®¶","ç–‘æƒ‘","ç¡è§‰","åèˆŒ","é¼“æŒ","æ¯”å¿ƒ","ç‚¹èµ","OK æ‰‹åŠ¿","æ‹’ç»","æ‹å¤´","ä¸¾æ‰‹æé—®","åŠ æ²¹","æŒ‘çœ‰","å®³ç¾","çœ¨çœ¼","é»‘è„¸","é¼»æ¶•æ³¡","æµå£æ°´","å’€åš¼","å·ç¬‘","å“åˆ°","æ‰“å–·åš","çˆ±å¿ƒçœ¼","åº†ç¥","æ‹¿çº¢åŒ…","ä¸¾æ¯å¾®ç¬‘"],Y=[{value:"cute",label:"å¯çˆ±é£æ ¼",emoji:"ğŸ¥°"},{value:"modern",label:"ç°ä»£ç®€çº¦",emoji:"âœ¨"},{value:"vintage",label:"å¤å¤ç»å…¸",emoji:"ğŸ“·"},{value:"cartoon",label:"å¡é€šåŠ¨æ¼«",emoji:"ğŸ¨"},{value:"minimalist",label:"æç®€ä¸»ä¹‰",emoji:"âšª"},{value:"3d",label:"3Dç«‹ä½“",emoji:"ğŸ¯"}],Z=["ç®€å•","é€‚ä¸­","å¤æ‚","éå¸¸å¤æ‚","æåº¦å¤æ‚"];function ee(e,s){return X.map(a=>({emotion:a,prompt:`ä¸€ä¸ª${s}å“ç‰Œå¡é€šå½¢è±¡æ­£åœ¨${a}ï¼Œ${e}ï¼Œè¡¨æƒ…é£æ ¼ä¸º emojiï¼Œæ‰å¹³å¡é€šé£ï¼Œé€æ˜èƒŒæ™¯`}))}function se(e,s,a){const t=function(e,s){var a;if(!e)return"";let t="";const l=(null==(a=Y.find(e=>e.value===s))?void 0:a.label)||"å¯çˆ±";return e.image?t=`åŸºäºä¸Šä¼ çš„å“ç‰Œå›¾ç‰‡ï¼Œåˆ›å»ºä¸€ä¸ª${l}çš„Emojiè¡¨æƒ…`:e.description&&(t=`åŸºäºæè¿°"${e.description}"ï¼Œåˆ›å»ºä¸€ä¸ª${l}çš„Emojiè¡¨æƒ…`),t}(e,s);let l=`${t}ï¼Œ${Z[a-1]}ç¨‹åº¦çš„è®¾è®¡ï¼Œ`;switch(s){case"cute":l+="åœ†æ¶¦çš„çº¿æ¡ï¼Œæ¸©æš–çš„è‰²å½©ï¼Œå……æ»¡äº²å’ŒåŠ›";break;case"modern":l+="ç®€æ´çš„å‡ ä½•å½¢çŠ¶ï¼Œæ¸…æ™°çš„è½®å»“ï¼Œç°ä»£æ„Ÿåè¶³";break;case"vintage":l+="å¤å¤è‰²è°ƒï¼Œç»å…¸å…ƒç´ ï¼Œæ€€æ—§é£æ ¼";break;case"cartoon":l+="å¤¸å¼ çš„è¡¨æƒ…ï¼Œé²œè‰³çš„è‰²å½©ï¼Œå¡é€šé£æ ¼";break;case"minimalist":l+="æç®€è®¾è®¡ï¼Œå•ä¸€è‰²å½©ï¼Œç®€æ´æ˜äº†";break;case"3d":l+="ç«‹ä½“æ•ˆæœï¼Œå…‰å½±å±‚æ¬¡ï¼Œ3Dæ¸²æŸ“é£æ ¼"}return l}function ae({uploadedData:o,onPromptReady:j,onBatchPromptsReady:p,onBrandChange:g,onBack:v}){const[N,f]=s.useState(""),[w,b]=s.useState(""),[y,k]=s.useState(!1),[C,S]=s.useState("cute"),[$,E]=s.useState([3]),[T,z]=s.useState(!1),[P,I]=s.useState(""),[R,A]=s.useState("single"),[U,G]=s.useState([]),{toast:V}=r();return s.useEffect(()=>{if(o&&"single"===R){const e=se(o,C,$[0]);f(e),T||b(e)}},[o,C,$,R,T]),e.jsxs(a,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(t,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"æ„å»ºç”Ÿæˆæç¤ºè¯"]})}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"ç”Ÿæˆæ¨¡å¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"single"===R?"default":"outline",onClick:()=>A("single"),className:"flex-1",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"å•ä¸ªæç¤ºè¯"]}),e.jsxs(n,{variant:"batch"===R?"default":"outline",onClick:()=>A("batch"),className:"flex-1",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"æ‰¹é‡æƒ…ç»ª"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"brand-name",children:"å“ç‰Œåç§°"}),e.jsx(h,{id:"brand-name",placeholder:"è¯·è¾“å…¥æ‚¨çš„å“ç‰Œåç§°",value:P,onChange:e=>{I(e.target.value),null==g||g(e.target.value)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"é€‰æ‹©é£æ ¼"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Y.map(s=>e.jsxs(n,{variant:C===s.value?"default":"outline",onClick:()=>S(s.value),className:"flex flex-col items-center gap-1 h-auto py-3",children:[e.jsx("span",{className:"text-lg",children:s.emoji}),e.jsx("span",{className:"text-xs",children:s.label})]},s.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{children:["è®¾è®¡å¤æ‚åº¦: ",Z[$[0]-1]]}),e.jsx(u,{value:$,onValueChange:E,max:5,min:1,step:1,className:"w-full"})]}),e.jsx(n,{onClick:async()=>{k(!0),setTimeout(()=>{if("single"===R){const e=se(o,C,$[0]);f(e),b(e)}else{const e=function(e,s,a,t="å“ç‰Œ"){return ee((null==e?void 0:e.description)||"å¡é€šå½¢è±¡",t).map(({emotion:e,prompt:t})=>{var l;return{emotion:e,prompt:`${t}ï¼Œ${(null==(l=Y.find(e=>e.value===s))?void 0:l.label)||"å¯çˆ±"}é£æ ¼ï¼Œ${Z[a-1]}ç¨‹åº¦çš„è®¾è®¡`}})}(o,C,$[0],P);G(e)}k(!1),V({title:"Promptç”Ÿæˆå®Œæˆ",description:"single"===R?"å·²ä¸ºæ‚¨ç”Ÿæˆä¸ªæ€§åŒ–çš„Emojiç”Ÿæˆæç¤ºè¯":`å·²ç”Ÿæˆ${U.length}ä¸ªæƒ…ç»ªæç¤ºè¯`})},2e3)},disabled:y||!o||"batch"===R&&!P.trim(),className:"w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"ç”Ÿæˆä¸­..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"single"===R?"è‡ªåŠ¨ç”ŸæˆPrompt":"ç”Ÿæˆæ‰¹é‡æƒ…ç»ªPrompt"]})}),"single"===R&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"custom-prompt",children:"è‡ªå®šä¹‰Prompt"}),e.jsx(c,{id:"custom-prompt",checked:T,onCheckedChange:z})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"ç”Ÿæˆæç¤ºè¯"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{value:T?w:N,onChange:e=>b(e.target.value),placeholder:"æ­£åœ¨ç”Ÿæˆä¸ªæ€§åŒ–æç¤ºè¯...",rows:4,className:"resize-none pr-12",disabled:!T}),e.jsx(n,{size:"sm",variant:"ghost",onClick:async()=>{const e=T?w:N;try{await navigator.clipboard.writeText(e),V({title:"å¤åˆ¶æˆåŠŸ",description:"Promptå·²å¤åˆ¶åˆ°å‰ªè´´æ¿"})}catch(s){V({title:"å¤åˆ¶å¤±è´¥",description:"è¯·æ‰‹åŠ¨å¤åˆ¶æ–‡æœ¬",variant:"destructive"})}},className:"absolute top-2 right-2",children:e.jsx(O,{className:"w-4 h-4"})})]})]})]}),"batch"===R&&U.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{children:["æ‰¹é‡æƒ…ç»ªæç¤ºè¯ (",U.length,"ä¸ª)"]}),e.jsxs(n,{size:"sm",variant:"ghost",onClick:async()=>{const e=U.map(e=>`${e.emotion}: ${e.prompt}`).join("\n\n");try{await navigator.clipboard.writeText(e),V({title:"å¤åˆ¶æˆåŠŸ",description:"æ‰¹é‡æç¤ºè¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿"})}catch(s){V({title:"å¤åˆ¶å¤±è´¥",description:"è¯·æ‰‹åŠ¨å¤åˆ¶æ–‡æœ¬",variant:"destructive"})}},children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"å¤åˆ¶å…¨éƒ¨"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded-lg p-3",children:U.map((s,a)=>e.jsxs("div",{className:"p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(d,{variant:"secondary",children:s.emotion}),e.jsx(n,{size:"sm",variant:"ghost",onClick:()=>navigator.clipboard.writeText(s.prompt),children:e.jsx(O,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.prompt})]},a))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{onClick:v,variant:"outline",className:"flex-1",children:"è¿”å›"}),e.jsx(n,{onClick:()=>{if("single"===R){const e=T?w:N;if(!e.trim())return void V({title:"æç¤ºè¯ä¸èƒ½ä¸ºç©º",description:"è¯·å…ˆç”Ÿæˆæˆ–è¾“å…¥æç¤ºè¯",variant:"destructive"});j(e)}else{if(0===U.length)return void V({title:"æ‰¹é‡æç¤ºè¯ä¸ºç©º",description:"è¯·å…ˆç”Ÿæˆæ‰¹é‡æç¤ºè¯",variant:"destructive"});null==p||p(U)}},disabled:"single"===R?!N.trim()&&!w.trim():0===U.length,className:"flex-1",children:"single"===R?"ç¡®è®¤ä½¿ç”¨":"å¼€å§‹æ‰¹é‡ç”Ÿæˆ"})]})]})]})}function te({character:c,brand:o,uploadedImage:d}){const[m,x]=s.useState([]),[h,u]=s.useState(!1),[j,p]=s.useState(0),[g,v]=s.useState(""),[N,f]=s.useState(0),[w,b]=s.useState(0),{toast:y}=r(),k=(e,s="ç”Ÿæˆå¤±è´¥")=>`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(`\n      <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">\n        <rect width="64" height="64" fill="#f3f4f6"/>\n        <text x="32" y="32" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="8">${e}</text>\n        <text x="32" y="44" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="6">${s}</text>\n      </svg>\n    `)))}`,C=async e=>{var s,a,t;let l=null;for(let n=1;n<=3;n++)try{const l={provider:"openai",action:"generate-image",prompt:e,n:1,size:"512x512",response_format:"url"};if(d){const s=await S(d);l.reference_image=s,l.prompt=`åŸºäºå‚è€ƒå›¾ç‰‡çš„é£æ ¼å’Œç‰¹å¾ï¼Œ${e}`}const i=await fetch("/.netlify/functions/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const n=await i.json();if(n.success&&(null==(t=null==(a=null==(s=n.data)?void 0:s.images)?void 0:a[0])?void 0:t.url))return n.data.images[0].url;throw new Error(n.error||n.message||"å›¾åƒç”Ÿæˆå¤±è´¥")}catch(i){if(l=i instanceof Error?i:new Error(String(i)),n<3){const e=1e3*n;await new Promise(s=>setTimeout(s,e))}}throw new Error(`å›¾åƒç”Ÿæˆå¤±è´¥ï¼Œå·²é‡è¯•3æ¬¡: ${null==l?void 0:l.message}`)};function S(e){return new Promise((s,a)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=a=>{const l=t.result;if(e.size<1048576){const e=l.split(",")[1];return void s(e)}const i=new Image;i.onload=()=>{const e=document.createElement("canvas"),a=e.getContext("2d");let{width:t,height:l}=i;const n=512;t>l?t>n&&(l=l*n/t,t=n):l>n&&(t=t*n/l,l=n),e.width=t,e.height=l,null==a||a.drawImage(i,0,0,t,l);const r=e.toDataURL("image/jpeg",.7).split(",")[1];s(r)},i.onerror=()=>{const e=l.split(",")[1];s(e)},i.src=l},t.onerror=e=>a(e)})}return e.jsxs(a,{className:"w-full",children:[e.jsx(t,{children:e.jsx(l,{className:"text-xl font-bold",children:"Step 3ï¼šAI ç”Ÿæˆå“ç‰Œ Emoji"})}),e.jsxs(i,{className:"space-y-4",children:[e.jsx(n,{onClick:async()=>{u(!0),x([]),p(0),v(""),b(0);try{const s=ee(c,o);f(s.length);const a=[],t=s.length;for(let l=0;l<t;l++){const{prompt:i,emotion:n}=s[l];try{v(n),b(l+1),p((l+1)/t*100);const e=await C(i);a.push({emotion:n,url:e}),(l+1)%3==0&&l<t-1&&await new Promise(e=>setTimeout(e,3e3))}catch(e){a.push({emotion:n,url:k(n,"ç”Ÿæˆå¤±è´¥")}),a.slice(-2).filter(e=>e.url.includes("ç”Ÿæˆå¤±è´¥")).length>=2&&await new Promise(e=>setTimeout(e,8e3))}}x(a),y({title:"ç”Ÿæˆå®Œæˆ",description:`æˆåŠŸç”Ÿæˆ ${a.length} ä¸ªä¸ªæ€§åŒ–Emoji`})}catch(e){y({title:"ç”Ÿæˆå¤±è´¥",description:e instanceof Error?e.message:"è¯·é‡è¯•",variant:"destructive"})}finally{u(!1),p(0),v(""),b(0),f(0)}},disabled:h,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:h?"ç”Ÿæˆä¸­...":"å¼€å§‹ç”Ÿæˆ"}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"ç”Ÿæˆè¿›åº¦"}),e.jsxs("span",{children:[w,"/",N," (",Math.round(j),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${j}%`}})}),g&&e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["æ­£åœ¨ç”Ÿæˆ: ",g]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["é¢„è®¡å‰©ä½™æ—¶é—´: ",Math.ceil(8*(N-w))," ç§’"]})]}),m.length>0&&e.jsx("div",{className:"grid grid-cols-5 gap-4 mt-4",children:m.map(({emotion:s,url:a})=>e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:a,alt:s,className:"w-16 h-16 object-contain mx-auto border rounded-lg"}),e.jsx("p",{className:"text-xs mt-1 text-gray-600",children:s})]},s))})]})]})}function le({emojis:s,onDelete:a,onRegenerate:t}){return e.jsx("div",{className:"grid grid-cols-5 gap-4",children:s.map(({emotion:s,url:l})=>e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:l,alt:s,className:"w-16 h-16 mx-auto cursor-pointer",onClick:()=>navigator.clipboard.writeText(l),title:"ç‚¹å‡»å¤åˆ¶é“¾æ¥"}),e.jsx("p",{className:"text-xs",children:s}),e.jsxs("div",{className:"flex justify-center space-x-2 mt-1",children:[e.jsx("button",{className:"text-red-500 text-xs",onClick:()=>a(s),children:"åˆ é™¤"}),e.jsx("button",{className:"text-blue-500 text-xs",onClick:()=>t(s),children:"é‡ç”Ÿ"})]})]},s))})}function ie(){const[t,l]=s.useState("upload"),[r,c]=s.useState(null),[o,d]=s.useState(""),[m,x]=s.useState([]),[h,u]=s.useState([]),[j,p]=s.useState(!1),[g,v]=s.useState("single"),[N,f]=s.useState(""),[w,b]=s.useState(""),y=[{id:"upload",title:"ä¸Šä¼ ç´ æ",description:"ä¸Šä¼ å“ç‰Œå›¾ç‰‡æˆ–è¾“å…¥æè¿°"},{id:"build",title:"æ„å»ºæç¤ºè¯",description:"ç”Ÿæˆä¸ªæ€§åŒ–ç”Ÿæˆæç¤ºè¯"},{id:"generate",title:"ç”ŸæˆEmoji",description:"AIç”Ÿæˆä¸ªæ€§åŒ–Emoji"},{id:"gallery",title:"ä½œå“å±•ç¤º",description:"æŸ¥çœ‹å’Œç®¡ç†ç”Ÿæˆçš„Emoji"}],k=y.findIndex(e=>e.id===t),C=e=>{c(e),e.description&&f(e.description),l("build")},S=e=>{d(e),v("single"),l("generate")},$=e=>{x(e),v("batch"),l("generate")},E=e=>{b(e)},T=()=>{switch(t){case"build":l("upload");break;case"generate":l("build");break;case"gallery":l("generate")}},P=()=>{l("upload"),c(null),d(""),x([]),u([]),v("single"),f(""),b("")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"ä¸ªæ€§åŒ–å“ç‰Œ Emoji ç”Ÿæˆå™¨"}),e.jsx("p",{className:"text-gray-600",children:"åŸºäºæ‚¨çš„å“ç‰Œç‰¹è‰²ï¼ŒAIæ™ºèƒ½ç”Ÿæˆä¸“å±Emojiè¡¨æƒ…"})]}),e.jsx(a,{children:e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:y.map((s,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`\n                      w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\n                      ${a<=k?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}\n                    `,children:a<k?e.jsx(A,{className:"w-5 h-5"}):a+1}),e.jsxs("div",{className:"text-xs mt-2 text-center max-w-20",children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsx("div",{className:"text-gray-500",children:s.description})]})]}),a<y.length-1&&e.jsx("div",{className:`\n                      w-16 h-0.5 mx-4\n                      ${a<k?"bg-blue-500":"bg-gray-200"}\n                    `})]},s.id))}),e.jsxs("div",{className:"mt-6",children:[e.jsx(z,{value:k/(y.length-1)*100,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["æ­¥éª¤ ",k+1," / ",y.length]}),e.jsxs("span",{children:[Math.round(k/(y.length-1)*100),"% å®Œæˆ"]})]})]})]})}),e.jsx("div",{className:"min-h-[600px]",children:(()=>{switch(t){case"upload":return e.jsx(Q,{onUploadComplete:C,onReset:P});case"build":return e.jsx(ae,{uploadedData:r,onPromptReady:S,onBatchPromptsReady:$,onBack:T,onBrandChange:E});case"generate":return e.jsx(te,{character:N||"å¡é€šå½¢è±¡",brand:w||"å“ç‰Œ",uploadedImage:null==r?void 0:r.image});case"gallery":return e.jsx(le,{emojis:h.map(e=>({emotion:e.emotion||"æœªçŸ¥",url:e.url})),onDelete:e=>{const s=h.find(s=>s.emotion===e);var a;s&&(a=s.id,u(e=>e.filter(e=>e.id!==a)))},onRegenerate:e=>{l("generate")}});default:return null}})()}),e.jsx(a,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["å·²ç”Ÿæˆ ",h.length," ä¸ªä¸ªæ€§åŒ–Emoji","batch"===g&&m.length>0&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["(æ‰¹é‡æ¨¡å¼: ",m.length,"ä¸ªæƒ…ç»ª)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:["upload"!==t&&e.jsx(n,{onClick:P,variant:"outline",size:"sm",children:"é‡æ–°å¼€å§‹"}),h.length>0&&e.jsx(n,{onClick:()=>l("gallery"),variant:"outline",size:"sm",children:"æŸ¥çœ‹ä½œå“é›†"})]})]})})})]})})}const ne=()=>{const[c,u]=s.useState([]),[E,T]=s.useState([]),[z,P]=s.useState(""),[I,R]=s.useState("all"),[A,U]=s.useState("color"),[B,F]=s.useState(null),[Q,X]=s.useState("gallery"),[Y,Z]=s.useState(!1),[ee,se]=s.useState("grid"),[ae,te]=s.useState(new Set),[le,ne]=s.useState(""),[re,ce]=s.useState(!1),[oe,de]=s.useState([]),[me,xe]=s.useState(""),{toast:he}=r(),ue=s.useMemo(()=>k.getEmojiStats().byGroup,[]);s.useEffect(()=>{const e=k.getAllEmojis();u(e),T(e)},[]),s.useEffect(()=>{let e=c;z&&(e=k.searchEmojis(z)),"all"!==I&&(e=e.filter(e=>e.group===I)),T(e)},[c,z,I]);const je=async e=>{try{let s=e.unicode;e.hasSkinTone&&(s=k.applySkinToneModifier(e.unicode,"medium")),await navigator.clipboard.writeText(s),he({title:"å¤åˆ¶æˆåŠŸ",description:`å·²å¤åˆ¶ ${s} åˆ°å‰ªè´´æ¿`})}catch(s){he({title:"å¤åˆ¶å¤±è´¥",description:"è¯·æ‰‹åŠ¨å¤åˆ¶",variant:"destructive"})}},pe=e=>e.hasSkinTone?k.applySkinToneModifier(e.unicode,"medium"):e.unicode;return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8 space-y-6",children:e.jsxs(j,{value:Q,onValueChange:X,children:[e.jsxs(p,{className:"grid w-full grid-cols-3",children:[e.jsxs(g,{value:"gallery",className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Emojiå›¾åº“"]}),e.jsxs(g,{value:"ai-recommend",className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"AIæ¨è"]}),e.jsxs(g,{value:"brand-emoji",className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"å“ç‰ŒEmojiç”Ÿæˆå™¨"]})]}),e.jsxs(v,{value:"gallery",className:"space-y-6",children:[e.jsx(a,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(h,{placeholder:"æœç´¢emojiã€åç§°æˆ–å…³é”®è¯...",value:z,onChange:e=>P(e.target.value),className:"pl-10"})]}),e.jsxs(N,{value:I,onValueChange:R,children:[e.jsx(f,{className:"w-48",children:e.jsx(w,{placeholder:"é€‰æ‹©åˆ†ç±»"})}),e.jsxs(b,{children:[e.jsx(y,{value:"all",children:"å…¨éƒ¨åˆ†ç±»"}),C.map(s=>e.jsxs(y,{value:s,children:[s," (",ue[s]||0,")"]},s))]})]}),e.jsxs(N,{value:A,onValueChange:e=>U(e),children:[e.jsx(f,{className:"w-40",children:e.jsx(w,{placeholder:"é€‰æ‹©é£æ ¼"})}),e.jsx(b,{children:Object.entries(S).map(([s,a])=>e.jsx(y,{value:s,children:a.name},s))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"grid"===ee?"default":"outline",size:"sm",onClick:()=>se("grid"),children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(n,{variant:"list"===ee?"default":"outline",size:"sm",onClick:()=>se("list"),children:e.jsx(q,{className:"w-4 h-4"})})]})]})})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(n,{variant:"all"===I?"default":"outline",size:"sm",onClick:()=>R("all"),children:"å…¨éƒ¨"}),C.map(s=>e.jsxs(n,{variant:I===s?"default":"outline",size:"sm",onClick:()=>R(s),className:"flex items-center gap-2",children:[e.jsx("span",{className:"hidden sm:inline",children:s}),e.jsx(d,{variant:"secondary",className:"text-xs",children:ue[s]||0})]},s))]}),e.jsx("div",{className:"grid"===ee?"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 gap-4":"space-y-2",children:E.map(s=>e.jsx(a,{className:"group cursor-pointer hover:shadow-lg transition-all duration-200 "+("grid"===ee?"aspect-square":"flex-row"),children:e.jsxs(i,{className:"p-4 "+("list"===ee?"flex items-center gap-4":""),children:[e.jsxs("div",{className:`relative ${"grid"===ee?"aspect-square mb-2":"w-12 h-12"} flex items-center justify-center`,children:[e.jsx("div",{className:"text-4xl cursor-pointer hover:scale-110 transition-transform",onClick:()=>je(s),title:`${s.name} (${s.unicode})`,children:pe(s)}),e.jsx(n,{variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity "+("list"===ee?"relative opacity-100":""),onClick:e=>{var a;e.stopPropagation(),a=s.unicode,te(e=>{const s=new Set(e);return s.has(a)?s.delete(a):s.add(a),s})},children:e.jsx(J,{className:"w-3 h-3 "+(ae.has(s.unicode)?"fill-red-500 text-red-500":"")})})]}),e.jsxs("div",{className:"text-center "+("list"===ee?"flex-1 text-left":""),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 truncate",children:s.name}),"list"===ee&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsx("span",{className:"mr-2",children:s.group}),s.hasSkinTone&&e.jsx(d,{variant:"outline",className:"text-xs mr-1",children:"è‚¤è‰²"}),s.hasGender&&e.jsx(d,{variant:"outline",className:"text-xs",children:"æ€§åˆ«"})]})]}),"list"===ee&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),je(s)},children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),(async e=>{try{const s=k.generateEmojiUrl(e.codepoint,"color",128),a=await fetch(s);if(!a.ok)throw new Error("ä¸‹è½½å¤±è´¥");const t=await a.blob(),l=window.URL.createObjectURL(t),i=document.createElement("a");i.href=l,i.download=`${e.name.replace(/\s+/g,"-")}-${e.unicode}-noto-color.png`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(l),document.body.removeChild(i),he({title:"ä¸‹è½½æˆåŠŸ",description:`å·²ä¸‹è½½ ${e.name}`})}catch(s){he({title:"ä¸‹è½½å¤±è´¥",description:"å›¾ç‰‡èµ„æºå¯èƒ½ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•",variant:"destructive"})}})(s)},children:e.jsx(W,{className:"w-4 h-4"})})]})]})},s.codepoint))}),0===E.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"æ²¡æœ‰æ‰¾åˆ°ç›¸å…³emoji"}),e.jsx("p",{className:"text-gray-500",children:"å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–é€‰æ‹©å…¶ä»–åˆ†ç±»"})]})]}),e.jsx(v,{value:"ai-recommend",className:"space-y-6",children:e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"AI Emojiæ¨è"]}),e.jsx(o,{children:"è¾“å…¥å†…å®¹åœºæ™¯ï¼ŒAIå°†ä¸ºæ‚¨æ¨èæœ€åˆé€‚çš„emojiè¡¨æƒ…ç¬¦å·"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"å†…å®¹åœºæ™¯"}),e.jsx(x,{placeholder:"è¯·è¾“å…¥éœ€è¦emojiçš„å†…å®¹åœºæ™¯ï¼Œä¾‹å¦‚ï¼šåˆ†äº«ä¸€ä¸ªå¥èº«å‡è‚¥çš„æˆåŠŸæ¡ˆä¾‹ã€åº†ç¥é¡¹ç›®å®Œæˆã€è¡¨è¾¾å¯¹ç¾é£Ÿçš„å–œçˆ±ç­‰...",value:le,onChange:e=>ne(e.target.value),rows:4,className:"w-full"})]}),e.jsx(n,{onClick:async()=>{var e,s,a;if(le.trim()){ce(!0);try{const t=await $.recommendEmojis(le),l=t.data,i=null==l?void 0:l.data;if(!t.success||!(null==(a=null==(s=null==(e=null==i?void 0:i.choices)?void 0:e[0])?void 0:s.message)?void 0:a.content))throw new Error("AIå“åº”æ ¼å¼å¼‚å¸¸");{const e=i.choices[0].message.content,s=e.match(/æ¨èemoji[:ï¼š]\s*(.+?)(?:\n|æ¨èç†ç”±|$)/i);if(s){const e=s[1].split(/\s+/).filter(e=>e.trim());de(e)}const a=e.match(/æ¨èç†ç”±[:ï¼š]\s*(.+?)$/is);xe(a?a[1].trim():e),he({title:"AIæ¨èå®Œæˆ",description:`å·²ä¸ºæ‚¨æ¨è ${oe.length} ä¸ªemoji`})}}catch(t){he({title:"æ¨èå¤±è´¥",description:"è¯·ç¨åé‡è¯•AIæ¨èåŠŸèƒ½",variant:"destructive"})}finally{ce(!1)}}else he({title:"è¯·è¾“å…¥å†…å®¹",description:"è¯·æä¾›éœ€è¦æ¨èemojiçš„å†…å®¹åœºæ™¯",variant:"destructive"})},disabled:re||!le.trim(),className:"w-full",children:re?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"AIæ¨èä¸­..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"è·å–AIæ¨è"]})}),oe.length>0&&e.jsxs(a,{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200",children:[e.jsx(t,{children:e.jsxs(l,{className:"text-lg flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-purple-600"}),"AIæ¨èç»“æœ"]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"æ¨èçš„Emoji"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:oe.map((s,a)=>e.jsx(n,{variant:"outline",size:"lg",className:"text-2xl h-12 w-12 p-0",onClick:()=>{navigator.clipboard.writeText(s),he({title:"å·²å¤åˆ¶",description:`å·²å¤åˆ¶ ${s}`})},children:s},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:async()=>{try{const e=oe.join(" ");await navigator.clipboard.writeText(e),he({title:"å¤åˆ¶æˆåŠŸ",description:`å·²å¤åˆ¶æ¨èçš„emoji: ${e}`})}catch(e){he({title:"å¤åˆ¶å¤±è´¥",description:"è¯·æ‰‹åŠ¨å¤åˆ¶",variant:"destructive"})}},variant:"outline",size:"sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"å¤åˆ¶æ‰€æœ‰"]}),e.jsxs(n,{onClick:()=>{de([]),xe("")},variant:"outline",size:"sm",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"æ¸…ç©ºç»“æœ"]})]})]}),me&&e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"æ¨èç†ç”±"}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:me})})]})]})]}),e.jsxs(a,{className:"bg-gradient-to-r from-green-50 to-teal-50 border-green-200",children:[e.jsx(t,{children:e.jsxs(l,{className:"text-lg flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-green-600"}),"ä½¿ç”¨å»ºè®®"]})}),e.jsx(i,{children:e.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"æ ‡é¢˜ä½¿ç”¨ï¼š"}),"åœ¨æ ‡é¢˜ä¸­æ”¾ç½®1-2ä¸ªæœ€å…³é”®çš„emojiå¢å¼ºå¸å¼•åŠ›"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"æ­£æ–‡ç©¿æ’ï¼š"}),"åœ¨æ­£æ–‡æ®µè½é—´é€‚é‡ä½¿ç”¨emojiå¢åŠ èŠ‚å¥æ„Ÿ"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"ç»“å°¾å¼ºåŒ–ï¼š"}),"åœ¨ç»“å°¾ä½¿ç”¨emojiå¢å¼ºæƒ…æ„Ÿè¡¨è¾¾å’Œäº’åŠ¨æ€§"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"å¹³å°é€‚é…ï¼š"}),"ä¸åŒå¹³å°çš„emojiä½¿ç”¨ä¹ æƒ¯æœ‰å·®å¼‚ï¼Œæ³¨æ„è°ƒæ•´"]})]})})]})]})]})}),e.jsx(v,{value:"brand-emoji",className:"space-y-6",children:e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"å“ç‰ŒEmojiç”Ÿæˆå™¨"]}),e.jsx(o,{children:"è¾“å…¥å“ç‰Œè§’è‰²å’Œå“ç‰Œåï¼ŒAIå°†ä¸ºæ‚¨ç”Ÿæˆä¸“å±çš„å“ç‰Œemoji"})]}),e.jsx(i,{className:"space-y-6",children:e.jsx(ie,{})})]})})]})})})};export{ne as default};
