import{r as e,j as s,o as a,B as r}from"./index-CqEx2ZQ2.js";import{C as i,d as t,a as l,b as n}from"./card-DrUj54Xk.js";import{B as c}from"./badge-CY8ouemD.js";import{S as m}from"./separator-BUmw8N0j.js";import{A as d}from"./alert-gfeJw6JG.js";import{g as x,a as o,i as h,r as u}from"./apiConfig-CndcvE7E.js";import{R as p}from"./refresh-cw-Dgb94Q6d.js";import{C as j}from"./circle-check-big-BO31TZ-5.js";import{T as g}from"./triangle-alert-BmHPuVcw.js";import{C as N}from"./circle-x-DnzhD4kF.js";import{I as f}from"./info-F2_x9WlH.js";import{C as v}from"./copy-HXuvyyMP.js";import{E as y}from"./external-link-BZjY4ckH.js";function I(){const e=x(),s=o(),a=[],r=[],i=[];h("sk-***[已隐藏]***","openai")||(a.push("VITE_OPENAI_API_KEY 格式无效"),i.push("OpenAI API密钥应以 sk- 开头，长度至少20个字符")),h("sk-c195bdaf58941978ec7322fc6dd88","deepseek")||(a.push("VITE_DEEPSEEK_API_KEY 格式无效"),i.push("DeepSeek API密钥应以 sk- 开头，长度至少30个字符")),h("your-gemini-api-key","gemini")||(a.push("VITE_GEMINI_API_KEY 格式无效"),i.push("Gemini API密钥长度至少20个字符")),h("your-creem-api-key-here","creem")||(a.push("VITE_CREEM_API_KEY 格式无效"),i.push("Creem API密钥应以 creem_ 开头")),e.environment.isProd&&!e.backend.baseUrl&&(r.push("生产环境缺少后端API配置"),i.push("生产环境建议配置完整的后端API服务"));const t=s.details.map(s=>({...s,value:b(s.name,e)}));return{isValid:0===a.length,errors:a,warnings:r,summary:s,details:t,recommendations:i}}function b(e,s){switch(e){case"OpenAI API":return s.openai.apiKey?`${s.openai.apiKey.substring(0,8)}...`:"未设置";case"DeepSeek API":return s.deepseek.apiKey?`${s.deepseek.apiKey.substring(0,8)}...`:"未设置";case"Gemini API":return s.gemini.apiKey?`${s.gemini.apiKey.substring(0,8)}...`:"未设置";case"Authing认证":return s.authing.appId?`${s.authing.appId.substring(0,8)}...`:"未设置";case"Creem支付":return s.creem.apiKey?`${s.creem.apiKey.substring(0,8)}...`:"未设置";case"后端API":return s.backend.baseUrl||"未设置";default:return"未知"}}function w(){const[x,o]=e.useState(null),[h,b]=e.useState(!1),[w,A]=e.useState("overview"),E=async()=>{b(!0);try{u();const e=I();o(e)}catch(e){}finally{b(!1)}};e.useEffect(()=>{E()},[]);const P=e=>{navigator.clipboard.writeText(e)},_=e=>{switch(e){case"valid":return s.jsx(j,{className:"w-4 h-4 text-green-600"});case"invalid":return s.jsx(N,{className:"w-4 h-4 text-red-600"});case"missing":return s.jsx(g,{className:"w-4 h-4 text-yellow-600"});case"optional":return s.jsx(f,{className:"w-4 h-4 text-blue-600"});default:return s.jsx(f,{className:"w-4 h-4 text-gray-600"})}},k=e=>{switch(e){case"valid":return"bg-green-100 text-green-800";case"invalid":return"bg-red-100 text-red-800";case"missing":return"bg-yellow-100 text-yellow-800";case"optional":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};if(!x)return s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx(i,{children:s.jsxs(t,{className:"flex items-center justify-center py-8",children:[s.jsx(p,{className:"w-6 h-6 animate-spin mr-2"}),"正在检查API配置..."]})})});const T=function(){const e=I();return e.isValid&&0===e.warnings.length?{status:"success",message:"✅ 所有API配置正确",details:["所有必需的API配置已正确设置","系统可以正常运行"]}:e.isValid&&e.warnings.length>0?{status:"warning",message:"⚠️ API配置基本正确，但有一些警告",details:["必需的API配置已设置","系统可以正常运行",`但有 ${e.warnings.length} 个警告需要注意`]}:{status:"error",message:"❌ API配置存在问题",details:[`发现 ${e.errors.length} 个错误`,`发现 ${e.warnings.length} 个警告`,"请修复配置问题后重新部署"]}}();return s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs(i,{children:[s.jsx(l,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(a,{className:"w-5 h-5"}),"API配置测试"]}),s.jsxs(r,{onClick:E,disabled:h,children:[s.jsx(p,{className:"w-4 h-4 mr-2 "+(h?"animate-spin":"")}),"重新检查"]})]})}),s.jsxs(t,{children:[s.jsx(d,{className:"mb-6 "+("success"===T.status?"border-green-200 bg-green-50":"warning"===T.status?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50"),children:s.jsxs("div",{className:"flex items-start gap-3",children:["success"===T.status&&s.jsx(j,{className:"w-5 h-5 text-green-600 mt-0.5"}),"warning"===T.status&&s.jsx(g,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),"error"===T.status&&s.jsx(N,{className:"w-5 h-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:T.message}),s.jsx("ul",{className:"text-sm space-y-1",children:T.details.map((e,a)=>s.jsx("li",{children:e},a))})]})]})}),s.jsxs("div",{className:"flex space-x-1 mb-6",children:[s.jsx(r,{variant:"overview"===w?"default":"outline",size:"sm",onClick:()=>A("overview"),children:"概览"}),s.jsx(r,{variant:"details"===w?"default":"outline",size:"sm",onClick:()=>A("details"),children:"详细配置"}),s.jsx(r,{variant:"deployment"===w?"default":"outline",size:"sm",onClick:()=>A("deployment"),children:"部署配置"})]}),"overview"===w&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(i,{children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.summary.totalConfigs}),s.jsx("div",{className:"text-sm text-gray-600",children:"总配置项"})]})}),s.jsx(i,{children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.summary.validConfigs}),s.jsx("div",{className:"text-sm text-gray-600",children:"有效配置"})]})}),s.jsx(i,{children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.summary.requiredConfigs}),s.jsx("div",{className:"text-sm text-gray-600",children:"必需配置"})]})}),s.jsx(i,{children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.summary.requiredValid}),s.jsx("div",{className:"text-sm text-gray-600",children:"必需有效"})]})})]}),x.errors.length>0&&s.jsxs(i,{className:"border-red-200",children:[s.jsx(l,{children:s.jsxs(n,{className:"text-red-600 flex items-center gap-2",children:[s.jsx(N,{className:"w-5 h-5"}),"配置错误 (",x.errors.length,")"]})}),s.jsx(t,{children:s.jsx("ul",{className:"space-y-2",children:x.errors.map((e,a)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx(N,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:e})]},a))})})]}),x.warnings.length>0&&s.jsxs(i,{className:"border-yellow-200",children:[s.jsx(l,{children:s.jsxs(n,{className:"text-yellow-600 flex items-center gap-2",children:[s.jsx(g,{className:"w-5 h-5"}),"配置警告 (",x.warnings.length,")"]})}),s.jsx(t,{children:s.jsx("ul",{className:"space-y-2",children:x.warnings.map((e,a)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx(g,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:e})]},a))})})]}),x.recommendations.length>0&&s.jsxs(i,{className:"border-blue-200",children:[s.jsx(l,{children:s.jsxs(n,{className:"text-blue-600 flex items-center gap-2",children:[s.jsx(f,{className:"w-5 h-5"}),"配置建议"]})}),s.jsx(t,{children:s.jsx("ul",{className:"space-y-2",children:x.recommendations.map((e,a)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx(f,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:e})]},a))})})]})]}),"details"===w&&s.jsx("div",{className:"space-y-4",children:x.details.map((e,a)=>s.jsx(i,{children:s.jsxs(t,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[_(e.status),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(c,{className:k(e.status),children:["valid"===e.status&&"有效","invalid"===e.status&&"无效","missing"===e.status&&"缺失","optional"===e.status&&"可选"]}),e.value&&s.jsx(r,{variant:"ghost",size:"sm",onClick:()=>P(e.value),children:s.jsx(v,{className:"w-4 h-4"})})]})]}),e.value&&s.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-sm font-mono",children:e.value})]})},a))}),"deployment"===w&&s.jsx("div",{className:"space-y-6",children:[{platform:"Netlify",variables:[{name:"VITE_OPENAI_API_KEY",value:"sk-your-openai-api-key",required:!0,description:"OpenAI API密钥"},{name:"VITE_AUTHING_APP_ID",value:"6867fdc88034eb95ae86167d",required:!0,description:"Authing应用ID"},{name:"VITE_AUTHING_HOST",value:"https://qutkgzkfaezk-demo.authing.cn",required:!0,description:"Authing域名"},{name:"VITE_DEEPSEEK_API_KEY",value:"sk-your-deepseek-api-key",required:!1,description:"DeepSeek API密钥（可选）"},{name:"VITE_GEMINI_API_KEY",value:"your-gemini-api-key",required:!1,description:"Gemini API密钥（可选）"},{name:"VITE_CREEM_API_KEY",value:"creem_your-creem-api-key",required:!1,description:"Creem支付API密钥（可选）"},{name:"VITE_API_BASE_URL",value:"https://www.wenpai.xyz/api",required:!1,description:"后端API基础URL（可选）"}],instructions:["1. 登录Netlify控制台","2. 进入项目设置 → Environment variables","3. 添加上述环境变量","4. 重新部署项目"]},{platform:"Vercel",variables:[{name:"VITE_OPENAI_API_KEY",value:"sk-your-openai-api-key",required:!0,description:"OpenAI API密钥"},{name:"VITE_AUTHING_APP_ID",value:"6867fdc88034eb95ae86167d",required:!0,description:"Authing应用ID"},{name:"VITE_AUTHING_HOST",value:"https://qutkgzkfaezk-demo.authing.cn",required:!0,description:"Authing域名"}],instructions:["1. 登录Vercel控制台","2. 进入项目设置 → Environment Variables","3. 添加上述环境变量","4. 重新部署项目"]}].map((e,a)=>s.jsxs(i,{children:[s.jsx(l,{children:s.jsxs(n,{className:"flex items-center gap-2",children:[s.jsx(y,{className:"w-5 h-5"}),e.platform," 部署配置"]})}),s.jsx(t,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3",children:"环境变量配置"}),s.jsx("div",{className:"space-y-2",children:e.variables.map((e,a)=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-mono text-sm",children:e.name}),e.required&&s.jsx(c,{variant:"destructive",className:"text-xs",children:"必需"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("code",{className:"text-sm bg-gray-100 px-2 py-1 rounded",children:e.value}),s.jsx(r,{variant:"ghost",size:"sm",onClick:()=>P(e.name),children:s.jsx(v,{className:"w-4 h-4"})})]})]},a))})]}),s.jsx(m,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3",children:"配置步骤"}),s.jsx("ol",{className:"space-y-2",children:e.instructions.map((e,a)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx("span",{className:"bg-blue-100 text-blue-600 rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:a+1}),s.jsx("span",{children:e})]},a))})]})]})})]},a))})]})]})})}export{w as default};
