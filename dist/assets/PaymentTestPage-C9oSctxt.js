import{u as e,_ as s,r as t,j as r,C as n,e as l,f as a,i,B as c,bn as d,bo as x}from"./index-BuR5xlXm.js";import{A as o}from"./AlipayQRCode-DJxkOHJh.js";import{C as m}from"./credit-card-CMjqDMcN.js";import"./creemClientService-CRnFWG6U.js";import"./browser-Il7jAgTf.js";import"./smartphone-SbHUnXyW.js";function h(){const{toast:h}=e(),{user:j,isAuthenticated:g}=s(),[u,b]=t.useState(0),[f,p]=t.useState(!1),[N]=t.useState({name:"Pro月付",tier:"pro"}),[v]=t.useState("monthly"),w=()=>{if(!j)return;const e=localStorage.getItem("user_registration_time");if(e)return new Date(parseInt(e,10));const s=new Date;return localStorage.setItem("user_registration_time",s.getTime().toString()),s},y=()=>{if(u<=0)return"已结束";const e=Math.floor(u/1e3),s=Math.floor(e/60),t=Math.floor(s/60);return t>0?`${t}小时${s%60}分钟${e%60}秒`:s>0?`${s}分钟${e%60}秒`:`${e}秒`},P=()=>{if(!g)return!1;const e=w();return!!e&&d(e)};t.useEffect(()=>{if(!g)return;const e=w();if(!e)return;const s=()=>{const s=x(e);b(s)};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[g]);const S=P()&&u>0?{currentPrice:69,originalPrice:99,savedAmount:30,isDiscount:!0}:{currentPrice:99,originalPrice:99,savedAmount:0,isDiscount:!1};return r.jsxs("div",{className:"container mx-auto py-16 px-4 max-w-4xl",children:[r.jsxs("div",{className:"mb-12 text-center",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"支付测试页面"}),r.jsx("p",{className:"text-muted-foreground",children:"验证限时优惠和支付二维码联动"})]}),u>0&&r.jsx("div",{className:"mb-8 p-4 bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-200 rounded-lg shadow-lg",children:r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx("div",{className:"text-lg font-bold text-red-600",children:"新用户限时优惠：30分钟"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-xl font-bold text-red-600",children:"优惠倒计时："}),r.jsx("span",{className:"text-2xl font-bold bg-red-100 px-4 py-2 rounded-lg border-2 border-red-300",children:y()})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs(n,{className:"border-green-100 bg-gradient-to-br from-green-50 to-white",children:[r.jsx(l,{children:r.jsxs(a,{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center shadow-sm",children:r.jsx(m,{className:"h-4 w-4 text-white"})}),"价格信息"]})}),r.jsxs(i,{className:"space-y-4",children:[r.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-green-900",children:N.name}),r.jsx("span",{className:"text-sm text-green-700",children:"monthly"===v?"月付":"年付"})]}),S.isDiscount?r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-green-700",children:"限时优惠价"}),r.jsxs("span",{className:"text-2xl font-bold text-red-600",children:["¥",S.currentPrice]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-green-700",children:"原价"}),r.jsxs("span",{className:"text-lg text-gray-400 line-through",children:["¥",S.originalPrice]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-green-700",children:"节省金额"}),r.jsxs("span",{className:"text-lg font-bold text-green-600",children:["¥",S.savedAmount]})]})]}):r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-green-700",children:"支付金额"}),r.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["¥",S.currentPrice]})]})]}),!f&&r.jsx(c,{onClick:()=>{p(!0),h({title:"支付二维码已显示",description:"请使用手机扫码完成支付"})},className:"w-full bg-green-500 hover:bg-green-600",size:"lg",children:"立即支付"})]})]}),f&&r.jsxs(n,{"data-qr-code":!0,className:"border-blue-100 bg-gradient-to-br from-blue-50 to-white",children:[r.jsx(l,{children:r.jsxs(a,{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center shadow-sm",children:r.jsx("span",{className:"text-white text-sm font-bold",children:"支"})}),"支付宝扫码支付"]})}),r.jsxs(i,{children:[r.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:r.jsx(m,{className:"h-5 w-5 text-white"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-blue-900",children:N.name}),r.jsx("p",{className:"text-sm text-blue-700",children:"monthly"===v?"月付":"年付"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["¥",S.currentPrice]}),S.isDiscount&&r.jsx("div",{className:"text-sm text-green-600",children:"限时优惠中"})]})]})}),r.jsx(o,{priceId:"prod_3nJOuQeVStqkp6JaDcrKHf",title:`${N.name} - 扫码支付`,showPrice:!0})]})]})]}),r.jsxs("div",{className:"mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[r.jsx("h3",{className:"font-semibold mb-2",children:"测试信息"}),r.jsxs("div",{className:"text-sm space-y-1",children:[r.jsxs("p",{children:["用户认证状态: ",g?"已登录":"未登录"]}),r.jsxs("p",{children:["优惠期状态: ",P()?"在优惠期内":"不在优惠期内"]}),r.jsxs("p",{children:["倒计时剩余: ",y()]}),r.jsxs("p",{children:["当前价格: ¥",S.currentPrice]}),r.jsxs("p",{children:["原价: ¥",S.originalPrice]}),r.jsxs("p",{children:["节省金额: ¥",S.savedAmount]})]})]})]})}export{h as default};
