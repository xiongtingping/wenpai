import{r as e,j as s,C as a,e as l,f as t,i as r,ae as i,B as c,R as n,g as x,k as d}from"./index-CYvVoP-H.js";import{g as m}from"./creemClientService-hzbV9p0u.js";import{S as h}from"./smartphone-Bju1SvB9.js";const o=({size:e=24,className:a="text-blue-500"})=>s.jsxs("svg",{viewBox:"0 0 1024 1024",className:a,style:{width:e,height:e},fill:"currentColor",children:[s.jsx("rect",{x:"128",y:"128",width:"768",height:"768",rx:"128",fill:"#1677FF"}),s.jsx("text",{x:"512",y:"580",textAnchor:"middle",fill:"white",fontSize:"320",fontWeight:"bold",fontFamily:"Arial, sans-serif",children:"支"})]});function j({priceId:j,customerEmail:u,title:b="使用支付宝扫码付款",showPrice:f=!0,onRefresh:N}){const[p,g]=e.useState(""),[w,y]=e.useState(null),[v,F]=e.useState(!0),[z,S]=e.useState(null),[C,k]=e.useState(!1),A=async()=>{try{F(!0),S(null);const e=await m(j,u);if(!e.success)throw new Error("二维码生成失败");g(e.qrCodeDataURL),y(e.price)}catch(e){S((null==e?void 0:e.message)||"二维码生成失败"),g(""),y(null)}finally{F(!1)}},E=async()=>{k(!0),await A(),k(!1),null==N||N()};return e.useEffect(()=>{j&&A()},[j,u]),v?s.jsxs(a,{className:"w-full max-w-sm mx-auto",children:[s.jsx(l,{children:s.jsxs(t,{className:"text-center flex items-center justify-center gap-2",children:[s.jsx(o,{size:24}),b]})}),s.jsx(r,{className:"text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(i,{className:"h-6 w-6 animate-spin text-blue-500"}),s.jsx("span",{children:"正在生成二维码..."})]})})]}):z?s.jsxs(a,{className:"w-full max-w-sm mx-auto border-red-200",children:[s.jsx(l,{children:s.jsxs(t,{className:"text-center text-red-600 flex items-center justify-center gap-2",children:[s.jsx(o,{size:24,className:"text-red-500"}),b]})}),s.jsx(r,{className:"text-center",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-red-600 text-sm",children:z}),s.jsx(c,{onClick:E,variant:"outline",size:"sm",disabled:C,children:C?s.jsxs(s.Fragment,{children:[s.jsx(i,{className:"h-4 w-4 mr-2 animate-spin"}),"刷新中..."]}):s.jsxs(s.Fragment,{children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"重新生成"]})})]})})]}):s.jsxs(a,{className:"w-full max-w-sm mx-auto border-blue-100 bg-gradient-to-br from-blue-50 to-white",children:[s.jsx(l,{className:"pb-4",children:s.jsxs(t,{className:"text-center flex items-center justify-center gap-2",children:[s.jsx(o,{size:32}),s.jsx("span",{className:"text-blue-900",children:b})]})}),s.jsxs(r,{className:"text-center space-y-4",children:[f&&null!==w&&s.jsx("div",{className:"space-y-2",children:s.jsxs(x,{variant:"outline",className:"text-xl px-6 py-3 bg-blue-50 border-blue-200 text-blue-700 font-semibold",children:["¥",w.toFixed(2)]})}),p&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:p,alt:"支付宝二维码",className:"border-4 border-blue-200 rounded-xl shadow-lg",style:{width:220,height:220}}),f&&null!==w&&s.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:s.jsx("div",{className:"bg-white bg-opacity-95 rounded-lg px-3 py-2 shadow-md border border-blue-200",children:s.jsxs("div",{className:"text-blue-600 font-bold text-lg",children:["¥",w.toFixed(2)]})})}),s.jsx("div",{className:"absolute bottom-2 right-2",children:s.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md border border-blue-200",children:s.jsx(o,{size:20})})})]})}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700",children:[s.jsx(d,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"安全支付"})]}),s.jsx("p",{className:"text-xs text-blue-600 leading-relaxed",children:"扫码后会跳转到Creem安全支付页，请放心支付"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[s.jsx(h,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"使用手机支付宝扫码"})]}),s.jsx(c,{onClick:E,variant:"outline",size:"sm",disabled:C,className:"border-blue-200 text-blue-600 hover:bg-blue-50",children:C?s.jsxs(s.Fragment,{children:[s.jsx(i,{className:"h-4 w-4 mr-2 animate-spin"}),"刷新中..."]}):s.jsxs(s.Fragment,{children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"刷新二维码"]})})]})]})]})}export{j as A};
