import{j as e}from"./ui-core-BoM6Gtru.js";import{r as n}from"./router-CDHmMMQ-.js";import{g as i,i as s}from"./pages-home-B2qezEHm.js";import"./react-vendor-D7XYiaTe.js";import"./components-landing-Bf3ZBHM2.js";import"./components-layout-MG0qUfcO.js";import"./utils-Ck01-_Du.js";import"./pages-brand-Be4bUKpb.js";import"./pages-adapt-BAX30gfz.js";import"./api-services-h5tHo7Hg.js";import"./pages-content-extractor-Caq7DiWW.js";import"./components-auth-rO0vuiGv.js";function a(){const e=i(),n=[],a=[],d=!!e.openai.apiKey,r=s(e.openai.apiKey,"openai");!d&&e.features.enableAI?n.push("OpenAI API密钥未配置 (VITE_OPENAI_API_KEY)"):d&&!r&&n.push("OpenAI API密钥格式无效");const t=!!e.deepseek.apiKey,o=s(e.deepseek.apiKey,"deepseek");t&&!o&&a.push("DeepSeek API密钥格式可能无效");const l=!!e.gemini.apiKey,c=s(e.gemini.apiKey,"gemini");l&&!c&&a.push("Gemini API密钥格式可能无效");const g=!(!e.authing.appId||!e.authing.host),m=g&&!!e.authing.redirectUri;g?m||n.push("Authing回调地址未配置"):n.push("Authing配置不完整 (需要VITE_AUTHING_APP_ID和VITE_AUTHING_HOST)");const u=!!e.backend.baseUrl,h=u&&e.backend.baseUrl.startsWith("http");u?h||n.push("后端API基础URL格式无效"):n.push("后端API基础URL未配置 (VITE_API_BASE_URL)");const p=!(!e.payment.alipay.appId||!e.payment.alipay.publicKey),x=!(!e.payment.wechat.appId||!e.payment.wechat.mchId),b=p||x;return b||a.push("支付配置未设置 (支付宝或微信支付)"),{isValid:0===n.length,errors:n,warnings:a,config:{openai:{configured:d,valid:r},deepseek:{configured:t,valid:o},gemini:{configured:l,valid:c},authing:{configured:g,valid:m},backend:{configured:u,valid:h},payment:{configured:b,valid:b}}}}function d(){const e=a(),n=i();let s="🔧 API配置状态:\n";return s+="\n🌍 环境: "+(n.environment.isDev?"开发":"生产"),s+="\n🔍 调试模式: "+(n.environment.debugMode?"开启":"关闭"),s+="\n\n🤖 AI服务:",s+="\n  OpenAI: "+(e.config.openai.configured?e.config.openai.valid?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"),s+="\n  DeepSeek: "+(e.config.deepseek.configured?e.config.deepseek.valid?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"),s+="\n  Gemini: "+(e.config.gemini.configured?e.config.gemini.valid?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"),s+="\n\n🔐 认证服务:",s+="\n  Authing: "+(e.config.authing.configured?e.config.authing.valid?"✅ 已配置":"⚠️ 回调地址缺失":"❌ 未配置"),s+="\n\n🔧 后端服务:",s+="\n  API: "+(e.config.backend.configured?e.config.backend.valid?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"),s+="\n\n💳 支付服务:",s+="\n  支付: "+(e.config.payment.configured?"✅ 已配置":"❌ 未配置"),e.errors.length>0&&(s+="\n\n❌ 错误:",e.errors.forEach(e=>{s+=`\n  - ${e}`})),e.warnings.length>0&&(s+="\n\n⚠️ 警告:",e.warnings.forEach(e=>{s+=`\n  - ${e}`})),s}function r(){const e=a(),n=[];return e.config.openai.configured||n.push("配置OpenAI API密钥以启用AI功能"),e.config.authing.configured||n.push("配置Authing认证服务以启用用户登录"),e.config.backend.configured||n.push("配置后端API地址以启用完整功能"),e.config.payment.configured||n.push("配置支付服务以启用付费功能"),e.config.openai.configured&&!e.config.deepseek.configured&&n.push("考虑配置DeepSeek API作为备用AI服务"),n}const t=()=>{var s,t,o,l,c,g,m,u;const[h,p]=n.useState(null),[x,b]=n.useState(""),[f,v]=n.useState([]),[j,y]=n.useState(!0),[N,k]=n.useState({});return n.useEffect(()=>{const e=a(),n=d(),i=r();p(e),b(n),v(i),y(!1)},[]),j?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"正在检查API配置..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"API配置测试"}),e.jsx("p",{className:"text-gray-600",children:"验证所有API配置是否正确设置"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"配置状态概览"}),e.jsx("button",{onClick:()=>{y(!0),setTimeout(()=>{const e=a(),n=d(),i=r();p(e),b(n),v(i),y(!1)},100)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"刷新配置"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.openai.configured)&&(null==h?void 0:h.config.openai.valid)?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"OpenAI"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.openai.configured)?(null==h?void 0:h.config.openai.valid)?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"})]}),e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.deepseek.configured)&&(null==h?void 0:h.config.deepseek.valid)?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"DeepSeek"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.deepseek.configured)?(null==h?void 0:h.config.deepseek.valid)?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"})]}),e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.gemini.configured)&&(null==h?void 0:h.config.gemini.valid)?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Gemini"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.gemini.configured)?(null==h?void 0:h.config.gemini.valid)?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"})]}),e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.authing.configured)&&(null==h?void 0:h.config.authing.valid)?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Authing"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.authing.configured)?(null==h?void 0:h.config.authing.valid)?"✅ 已配置":"⚠️ 回调地址缺失":"❌ 未配置"})]}),e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.backend.configured)&&(null==h?void 0:h.config.backend.valid)?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"后端API"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.backend.configured)?(null==h?void 0:h.config.backend.valid)?"✅ 已配置":"⚠️ 格式错误":"❌ 未配置"})]}),e.jsxs("div",{className:"p-4 rounded-lg border "+((null==h?void 0:h.config.payment.configured)?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"支付服务"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==h?void 0:h.config.payment.configured)?"✅ 已配置":"❌ 未配置"})]})]}),(null==h?void 0:h.errors.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-red-600 font-medium mb-2",children:"❌ 配置错误:"}),e.jsx("ul",{className:"list-disc list-inside text-red-600 space-y-1",children:h.errors.map((n,i)=>e.jsx("li",{children:n},i))})]}),(null==h?void 0:h.warnings.length)>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-yellow-600 font-medium mb-2",children:"⚠️ 配置警告:"}),e.jsx("ul",{className:"list-disc list-inside text-yellow-600 space-y-1",children:h.warnings.map((n,i)=>e.jsx("li",{children:n},i))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"API连接测试"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"OpenAI API"}),e.jsx("button",{onClick:async()=>{k(e=>({...e,openai:{loading:!0}}));try{const e=await fetch("/.netlify/functions/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"openai",action:"status"})}),n=await e.json();k(i=>({...i,openai:{loading:!1,success:e.ok,data:n}}))}catch(e){k(n=>({...n,openai:{loading:!1,success:!1,error:e instanceof Error?e.message:"未知错误"}}))}},disabled:null==(s=N.openai)?void 0:s.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:(null==(t=N.openai)?void 0:t.loading)?"测试中...":"测试连接"}),N.openai&&e.jsx("div",{className:"mt-2 text-sm",children:N.openai.success?e.jsx("span",{className:"text-green-600",children:"✅ 连接成功"}):e.jsxs("span",{className:"text-red-600",children:["❌ 连接失败: ",N.openai.error]})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"DeepSeek API"}),e.jsx("button",{onClick:async()=>{k(e=>({...e,deepseek:{loading:!0}}));try{const e=await fetch("/.netlify/functions/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"deepseek",action:"status"})}),n=await e.json();k(i=>({...i,deepseek:{loading:!1,success:e.ok,data:n}}))}catch(e){k(n=>({...n,deepseek:{loading:!1,success:!1,error:e instanceof Error?e.message:"未知错误"}}))}},disabled:null==(o=N.deepseek)?void 0:o.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:(null==(l=N.deepseek)?void 0:l.loading)?"测试中...":"测试连接"}),N.deepseek&&e.jsx("div",{className:"mt-2 text-sm",children:N.deepseek.success?e.jsx("span",{className:"text-green-600",children:"✅ 连接成功"}):e.jsxs("span",{className:"text-red-600",children:["❌ 连接失败: ",N.deepseek.error]})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Authing配置"}),e.jsx("button",{onClick:async()=>{k(e=>({...e,authing:{loading:!0}}));try{const e=i(),n=!!(e.authing.appId&&e.authing.host&&e.authing.redirectUri);k(i=>({...i,authing:{loading:!1,success:n,data:{appId:e.authing.appId,host:e.authing.host,redirectUri:e.authing.redirectUri}}}))}catch(e){k(n=>({...n,authing:{loading:!1,success:!1,error:e instanceof Error?e.message:"未知错误"}}))}},disabled:null==(c=N.authing)?void 0:c.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:(null==(g=N.authing)?void 0:g.loading)?"测试中...":"测试配置"}),N.authing&&e.jsx("div",{className:"mt-2 text-sm",children:N.authing.success?e.jsx("span",{className:"text-green-600",children:"✅ 配置正确"}):e.jsxs("span",{className:"text-red-600",children:["❌ 配置错误: ",N.authing.error]})})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"后端API"}),e.jsx("button",{onClick:async()=>{k(e=>({...e,backend:{loading:!0}}));try{const e=i(),n=await fetch(`${e.backend.baseUrl}/health`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await n.json();k(e=>({...e,backend:{loading:!1,success:n.ok,data:s}}))}catch(e){k(n=>({...n,backend:{loading:!1,success:!1,error:e instanceof Error?e.message:"未知错误"}}))}},disabled:null==(m=N.backend)?void 0:m.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:(null==(u=N.backend)?void 0:u.loading)?"测试中...":"测试连接"}),N.backend&&e.jsx("div",{className:"mt-2 text-sm",children:N.backend.success?e.jsx("span",{className:"text-green-600",children:"✅ 连接成功"}):e.jsxs("span",{className:"text-red-600",children:["❌ 连接失败: ",N.backend.error]})})]})]})]}),f.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"配置建议"}),e.jsx("ul",{className:"list-disc list-inside text-gray-700 space-y-2",children:f.map((n,i)=>e.jsx("li",{children:n},i))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"详细配置信息"}),e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg text-sm overflow-x-auto whitespace-pre-wrap",children:x})]})]})})};export{t as default};
