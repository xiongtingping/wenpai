const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aiService-C8Za63DW.js","assets/index-Cu70HESd.js","assets/index-TzzW6MqQ.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,s=(s,a,t)=>((s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t)(s,"symbol"!=typeof a?a+"":a,t);import{c as a,r as t,j as i,B as l,F as r,X as n,t as o,p as c,_ as d}from"./index-Cu70HESd.js";import{C as m,a as u,b as h,d as x,c as p}from"./card-C_loCoFD.js";import{I as j}from"./input-iNWycu-N.js";import{B as g}from"./badge-CIOmyheZ.js";import{T as f,a as v,b as N,c as y,S as b,e as w,f as k,g as S,h as C}from"./select-CyUPdBGJ.js";import{L as E}from"./label-CiijFGu1.js";import{T as $}from"./textarea-DylBDHiN.js";import T from"./aiService-C8Za63DW.js";import{P as M}from"./progress-x2mm98pu.js";import{A as D,a as P}from"./alert-uwy97Dud.js";import{U as z}from"./upload-ZA6D-pIW.js";import{C as I}from"./circle-check-big-P3EWXA1B.js";import{S as A}from"./slider-T1R8_6uU.js";import{S as U}from"./switch-BPRhG9t4.js";import{W as G}from"./wand-sparkles-Dz-EzHrr.js";import{R as F}from"./refresh-cw-DxcdbKGG.js";import{C as R}from"./copy-BOz6b4UI.js";import{B}from"./CreativeStudioPage-YHuKq-kc.js";import{S as q}from"./search-CdF4BiAP.js";import{E as L}from"./eye-17IbxXW1.js";import{H as O}from"./heart-DWZr1VDh.js";import{D as _}from"./download-BkaKNVvD.js";import{S as V}from"./star-S72kKK2c.js";import{T as H}from"./trash-2-Bbk5Qu_n.js";import{I as J}from"./info-BSqS0fyx.js";import"./index-i7flwvb1.js";import"./rotate-ccw-DgoSx0Gs.js";import"./lightbulb-DrDJpklV.js";import"./save-Dyhx6hr6.js";import"./clock-BD23zlwU.js";import"./circle-alert-BGkMlRh1.js";import"./palette-BOgGCsp6.js";import"./plus-DyQmYra5.js";import"./zap-B-n6G30_.js";import"./gift-CKSiFvpI.js";import"./PageNavigation-DDP3eurv.js";import"./crown-BXlF8AAg.js";
/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=a("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),K=a("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Y=a("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),Z=["Smileys & Emotion","People & Body","Component","Animals & Nature","Food & Drink","Travel & Places","Activities","Objects","Symbols","Flags"],Q={light:{unicode:"🏻",hex:"F7D7C4",name:"浅肤色"},"medium-light":{unicode:"🏼",hex:"D4A574",name:"中浅肤色"},medium:{unicode:"🏽",hex:"A0754D",name:"中等肤色"},"medium-dark":{unicode:"🏾",hex:"825C42",name:"中深肤色"},dark:{unicode:"🏿",hex:"5C4033",name:"深肤色"}},X={"1f468-2764-1f48b-1f468":"Kiss","1f469-2764-1f48b-1f469":"Kiss","1f469-2764-1f48b-1f468":"Kiss","1f469-2764-1f468":"Couple with Heart","1f468-2764-1f468":"Couple with Heart","1f469-2764-1f469":"Couple with Heart","1f468-1f467":"Family","1f468-1f466":"Family","1f469-1f467":"Family","1f469-1f466":"Family"},ee={"1f441-1f5e8":"I Witness","1f3f3-1f308":"Rainbow Flag",2695:"Health Worker",2696:"Judge","26f7":"Skiing","26f9":"Bouncing a Ball",2708:"Pilot","1f33e":"Farmer","1f373":"Cook","1f393":"Student","1f3a4":"Singer","1f3a8":"Artist","1f3c3":"Running","1f3c4":"Surfing","1f3ca":"Swimming","1f46e":"Police Officer","1f477":"Construction Worker","1f4bb":"Technologist","1f527":"Mechanic","1f52c":"Scientist","1f680":"Astronaut","1f692":"Firefighter"},se={color:{name:"Noto Color",description:"Google官方彩色设计",baseUrl:"https://raw.githubusercontent.com/googlefonts/noto-emoji/main/png",format:"png"},outline:{name:"Noto Outline",description:"黑白描边风格",baseUrl:"/assets/noto-emoji",format:"png"},material:{name:"Material Design",description:"Material Design风格",baseUrl:"https://fonts.gstatic.com/s/e/notoemoji/latest",format:"webp"}},ae=[{unicode:"😀",codepoint:"1f600",name:"笑脸",group:"Smileys & Emotion",subgroup:"face-smiling",keywords:["笑","开心","高兴","快乐","grinning"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"😃",codepoint:"1f603",name:"张嘴笑脸",group:"Smileys & Emotion",subgroup:"face-smiling",keywords:["笑","开心","张嘴","兴奋","grinning","big eyes"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"👍",codepoint:"1f44d",name:"竖起大拇指",group:"People & Body",subgroup:"hand-fingers-closed",keywords:["好","赞","同意","手势","thumbs up","like"],hasSkinTone:!0,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🐶",codepoint:"1f436",name:"狗脸",group:"Animals & Nature",subgroup:"animal-mammal",keywords:["狗","小狗","宠物","动物","dog","face"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🍎",codepoint:"1f34e",name:"红苹果",group:"Food & Drink",subgroup:"food-fruit",keywords:["苹果","水果","红色","健康","apple","red"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"❤️",codepoint:"2764",name:"红心",group:"Symbols",subgroup:"heart",keywords:["爱","心","红色","感情","heart","love"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🚗",codepoint:"1f697",name:"汽车",group:"Travel & Places",subgroup:"transport-ground",keywords:["汽车","车","交通","驾驶","car","automobile"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"⚽",codepoint:"26bd",name:"足球",group:"Activities",subgroup:"sport",keywords:["足球","运动","球","比赛","soccer","football"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"💡",codepoint:"1f4a1",name:"电灯泡",group:"Objects",subgroup:"light & video",keywords:["灯泡","想法","创意","电","bulb","idea"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🏳️",codepoint:"1f3f3",name:"白旗",group:"Flags",subgroup:"flag",keywords:["旗帜","白色","投降","和平","flag","white"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"}],te=class e{constructor(){s(this,"emojiData",[]),s(this,"emojiMap",new Map),this.initializeData()}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeData(){this.emojiData=[...ae],this.buildEmojiMap()}buildEmojiMap(){this.emojiMap.clear(),this.emojiData.forEach(e=>{this.emojiMap.set(e.unicode,e),this.emojiMap.set(e.codepoint,e)})}getAllEmojis(){return[...this.emojiData]}getEmojisByGroup(e){return this.emojiData.filter(s=>s.group===e)}searchEmojis(e){const s=e.toLowerCase();return this.emojiData.filter(a=>a.name.toLowerCase().includes(s)||a.keywords.some(e=>e.toLowerCase().includes(s))||a.unicode.includes(e))}getEmojiByUnicode(e){return this.emojiMap.get(e)}getEmojiByCodepoint(e){return this.emojiMap.get(e)}generateEmojiUrl(e,s="color",a=128){const t=se[s];return"color"===s?`${t.baseUrl}/${a}/emoji_u${e}.${t.format}`:"material"===s?`${t.baseUrl}/${e}/${a}.${t.format}`:`${t.baseUrl}/emoji_u${e}.${t.format}`}applySkinToneModifier(e,s){if(!e)return"";const a=this.getEmojiByUnicode(e);return a&&a.hasSkinTone&&s&&Q[s]?e+Q[s].unicode:e}getEmojiVariants(e){const s=this.getEmojiByUnicode(e);if(!s)return[e];const a=[e];return s.hasSkinTone&&Object.keys(Q).forEach(s=>{a.push(this.applySkinToneModifier(e,s))}),a}getCustomName(e){return ee[e]||X[e]||null}unicodeToCodepoint(e){return Array.from(e).map(e=>{var s;return null==(s=e.codePointAt(0))?void 0:s.toString(16).padStart(4,"0")}).join("_")}codepointToUnicode(e){return e.split("_").map(e=>String.fromCodePoint(parseInt(e,16))).join("")}isEmojiSupported(e){return this.emojiMap.has(e)}getEmojiStats(){const e={total:this.emojiData.length,byGroup:{},withSkinTone:0,withGender:0};return this.emojiData.forEach(s=>{e.byGroup[s.group]=(e.byGroup[s.group]||0)+1,s.hasSkinTone&&e.withSkinTone++,s.hasGender&&e.withGender++}),e}batchGenerateUrls(e,s="color",a=128){return e.map(e=>({codepoint:e,url:this.generateEmojiUrl(e,s,a)}))}exportData(){return JSON.stringify({metadata:{total:this.emojiData.length,generated:(new Date).toISOString(),source:"Google Noto Emoji Project"},groups:Z,skinTones:Q,styles:se,emojis:this.emojiData},null,2)}};s(te,"instance");const ie=te.getInstance();function le({onUploadComplete:e,onReset:s}){const[a,o]=t.useState("image"),[c,d]=t.useState(null),[p,j]=t.useState(""),[f,v]=t.useState(!1),[N,y]=t.useState(null),b=t.useRef(null),w=()=>{d(null),j(""),y(null),v(!1),b.current&&(b.current.value=""),s()},k=()=>{var e;null==(e=b.current)||e.click()};return i.jsxs(m,{className:"w-full max-w-2xl mx-auto",children:[i.jsx(u,{children:i.jsxs(h,{className:"flex items-center gap-2",children:[i.jsx(z,{className:"w-5 h-5"}),"上传品牌素材"]})}),i.jsxs(x,{className:"space-y-6",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(l,{variant:"image"===a?"default":"outline",onClick:()=>o("image"),className:"flex-1",children:[i.jsx(K,{className:"w-4 h-4 mr-2"}),"上传图片"]}),i.jsxs(l,{variant:"description"===a?"default":"outline",onClick:()=>o("description"),className:"flex-1",children:[i.jsx(r,{className:"w-4 h-4 mr-2"}),"文字描述"]})]}),N&&i.jsx(D,{variant:"destructive",children:i.jsx(P,{children:N})}),"image"===a&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-gray-400 transition-colors",onClick:k,children:c?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"relative inline-block",children:[i.jsx("img",{src:URL.createObjectURL(c),alt:"预览",className:"w-32 h-32 object-cover rounded-lg"}),i.jsxs(g,{className:"absolute -top-2 -right-2 bg-green-500",children:[i.jsx(I,{className:"w-3 h-3 mr-1"}),"已上传"]})]}),i.jsx("p",{className:"text-sm text-gray-600",children:c.name})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsx(z,{className:"w-12 h-12 mx-auto text-gray-400"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-medium",children:"点击上传品牌图片"}),i.jsx("p",{className:"text-sm text-gray-500",children:"支持 JPG、PNG 格式，最大 5MB"})]})]})}),i.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:s=>{var a;const t=null==(a=s.target.files)?void 0:a[0];t&&(t.type.startsWith("image/")?t.size>5242880?y("图片大小不能超过5MB"):(y(null),d(t),v(!0),setTimeout(()=>{v(!1),e({image:t})},1e3)):y("请上传图片文件"))},className:"hidden"}),c&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{onClick:k,variant:"outline",className:"flex-1",children:"重新选择"}),i.jsx(l,{onClick:w,variant:"outline",children:i.jsx(n,{className:"w-4 h-4"})})]})]}),"description"===a&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(E,{htmlFor:"description",children:"品牌描述"}),i.jsx($,{id:"description",placeholder:"请描述您的品牌特点，例如：科技公司，蓝色主题，简约现代风格...",value:p,onChange:e=>j(e.target.value),rows:4,className:"resize-none"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{onClick:()=>{p.trim()?(y(null),v(!0),setTimeout(()=>{v(!1),e({description:p.trim()})},500)):y("请输入品牌描述")},disabled:f||!p.trim(),className:"flex-1",children:f?"处理中...":"提交描述"}),i.jsx(l,{onClick:w,variant:"outline",children:i.jsx(n,{className:"w-4 h-4"})})]})]}),f&&i.jsxs("div",{className:"text-center py-4",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"image"===a?"正在上传图片...":"正在处理描述..."})]})]})]})}const re=["开心微笑","大笑","生气","哭泣","惊讶","疑惑","睡觉","吐舌","鼓掌","比心","点赞","OK 手势","拒绝","拍头","举手提问","加油","挑眉","害羞","眨眼","黑脸","鼻涕泡","流口水","咀嚼","偷笑","吓到","打喷嚏","爱心眼","庆祝","拿红包","举杯微笑"],ne=[{value:"cute",label:"可爱风格",emoji:"🥰"},{value:"modern",label:"现代简约",emoji:"✨"},{value:"vintage",label:"复古经典",emoji:"📷"},{value:"cartoon",label:"卡通动漫",emoji:"🎨"},{value:"minimalist",label:"极简主义",emoji:"⚪"},{value:"3d",label:"3D立体",emoji:"🎯"}],oe=["简单","适中","复杂","非常复杂","极度复杂"];function ce(e,s){return re.map(a=>({emotion:a,prompt:`一个${s}品牌卡通形象正在${a}，${e}，表情风格为 emoji，扁平卡通风，透明背景`}))}function de(e,s,a){const t=function(e,s){var a;if(!e)return"";let t="";const i=(null==(a=ne.find(e=>e.value===s))?void 0:a.label)||"可爱";return e.image?t=`基于上传的品牌图片，创建一个${i}的Emoji表情`:e.description&&(t=`基于描述"${e.description}"，创建一个${i}的Emoji表情`),t}(e,s);let i=`${t}，${oe[a-1]}程度的设计，`;switch(s){case"cute":i+="圆润的线条，温暖的色彩，充满亲和力";break;case"modern":i+="简洁的几何形状，清晰的轮廓，现代感十足";break;case"vintage":i+="复古色调，经典元素，怀旧风格";break;case"cartoon":i+="夸张的表情，鲜艳的色彩，卡通风格";break;case"minimalist":i+="极简设计，单一色彩，简洁明了";break;case"3d":i+="立体效果，光影层次，3D渲染风格"}return i}function me({uploadedData:e,onPromptReady:s,onBatchPromptsReady:a,onBrandChange:r,onBack:n}){const[d,p]=t.useState(""),[f,v]=t.useState(""),[N,y]=t.useState(!1),[b,w]=t.useState("cute"),[k,S]=t.useState([3]),[C,T]=t.useState(!1),[M,D]=t.useState(""),[P,z]=t.useState("single"),[I,B]=t.useState([]),{toast:q}=o();return t.useEffect(()=>{if(e&&"single"===P){const s=de(e,b,k[0]);p(s),C||v(s)}},[e,b,k,P,C]),i.jsxs(m,{className:"w-full max-w-2xl mx-auto",children:[i.jsx(u,{children:i.jsxs(h,{className:"flex items-center gap-2",children:[i.jsx(G,{className:"w-5 h-5"}),"构建生成提示词"]})}),i.jsxs(x,{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(E,{children:"生成模式"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(l,{variant:"single"===P?"default":"outline",onClick:()=>z("single"),className:"flex-1",children:[i.jsx(Y,{className:"w-4 h-4 mr-2"}),"单个提示词"]}),i.jsxs(l,{variant:"batch"===P?"default":"outline",onClick:()=>z("batch"),className:"flex-1",children:[i.jsx(W,{className:"w-4 h-4 mr-2"}),"批量情绪"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(E,{htmlFor:"brand-name",children:"品牌名称"}),i.jsx(j,{id:"brand-name",placeholder:"请输入您的品牌名称",value:M,onChange:e=>{D(e.target.value),null==r||r(e.target.value)}})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(E,{children:"选择风格"}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:ne.map(e=>i.jsxs(l,{variant:b===e.value?"default":"outline",onClick:()=>w(e.value),className:"flex flex-col items-center gap-1 h-auto py-3",children:[i.jsx("span",{className:"text-lg",children:e.emoji}),i.jsx("span",{className:"text-xs",children:e.label})]},e.value))})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs(E,{children:["设计复杂度: ",oe[k[0]-1]]}),i.jsx(A,{value:k,onValueChange:S,max:5,min:1,step:1,className:"w-full"})]}),i.jsx(l,{onClick:async()=>{y(!0),setTimeout(()=>{if("single"===P){const s=de(e,b,k[0]);p(s),v(s)}else{const s=function(e,s,a,t="品牌"){return ce((null==e?void 0:e.description)||"卡通形象",t).map(({emotion:e,prompt:t})=>{var i;return{emotion:e,prompt:`${t}，${(null==(i=ne.find(e=>e.value===s))?void 0:i.label)||"可爱"}风格，${oe[a-1]}程度的设计`}})}(e,b,k[0],M);B(s)}y(!1),q({title:"Prompt生成完成",description:"single"===P?"已为您生成个性化的Emoji生成提示词":`已生成${I.length}个情绪提示词`})},2e3)},disabled:N||!e||"batch"===P&&!M.trim(),className:"w-full",children:N?i.jsxs(i.Fragment,{children:[i.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}),"生成中..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{className:"w-4 h-4 mr-2"}),"single"===P?"自动生成Prompt":"生成批量情绪Prompt"]})}),"single"===P&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(E,{htmlFor:"custom-prompt",children:"自定义Prompt"}),i.jsx(U,{id:"custom-prompt",checked:C,onCheckedChange:T})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(E,{children:"生成提示词"}),i.jsxs("div",{className:"relative",children:[i.jsx($,{value:C?f:d,onChange:e=>v(e.target.value),placeholder:"正在生成个性化提示词...",rows:4,className:"resize-none pr-12",disabled:!C}),i.jsx(l,{size:"sm",variant:"ghost",onClick:async()=>{const e=C?f:d;try{await navigator.clipboard.writeText(e),q({title:"复制成功",description:"Prompt已复制到剪贴板"})}catch(s){q({title:"复制失败",description:"请手动复制文本",variant:"destructive"})}},className:"absolute top-2 right-2",children:i.jsx(R,{className:"w-4 h-4"})})]})]})]}),"batch"===P&&I.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs(E,{children:["批量情绪提示词 (",I.length,"个)"]}),i.jsxs(l,{size:"sm",variant:"ghost",onClick:async()=>{const e=I.map(e=>`${e.emotion}: ${e.prompt}`).join("\n\n");try{await navigator.clipboard.writeText(e),q({title:"复制成功",description:"批量提示词已复制到剪贴板"})}catch(s){q({title:"复制失败",description:"请手动复制文本",variant:"destructive"})}},children:[i.jsx(R,{className:"w-4 h-4 mr-1"}),"复制全部"]})]}),i.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded-lg p-3",children:I.map((e,s)=>i.jsxs("div",{className:"p-2 bg-muted rounded",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx(g,{variant:"secondary",children:e.emotion}),i.jsx(l,{size:"sm",variant:"ghost",onClick:()=>navigator.clipboard.writeText(e.prompt),children:i.jsx(R,{className:"w-3 h-3"})})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.prompt})]},s))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{onClick:n,variant:"outline",className:"flex-1",children:"返回"}),i.jsx(l,{onClick:()=>{if("single"===P){const e=C?f:d;if(!e.trim())return void q({title:"提示词不能为空",description:"请先生成或输入提示词",variant:"destructive"});s(e)}else{if(0===I.length)return void q({title:"批量提示词为空",description:"请先生成批量提示词",variant:"destructive"});null==a||a(I)}},disabled:"single"===P?!d.trim()&&!f.trim():0===I.length,className:"flex-1",children:"single"===P?"确认使用":"开始批量生成"})]})]})]})}function ue({character:e,brand:s,uploadedImage:a}){const[r,n]=t.useState([]),[c,p]=t.useState(!1),[j,g]=t.useState(0),[f,v]=t.useState(""),[N,y]=t.useState(0),[b,w]=t.useState(0),{toast:k}=o(),S=(e,s="生成失败")=>`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(`\n      <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">\n        <rect width="64" height="64" fill="#f3f4f6"/>\n        <text x="32" y="32" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="8">${e}</text>\n        <text x="32" y="44" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="6">${s}</text>\n      </svg>\n    `)))}`,C=async e=>{var s,t,i,l,r,n;let o=null;for(let m=1;m<=3;m++)try{const o=(await d(async()=>{const{default:e}=await import("./aiService-C8Za63DW.js");return{default:e}},__vite__mapDeps([0,1,2]))).default,c={prompt:e,n:1,size:"512x512",response_format:"url"};if(a){const l=await E(a),r={...c,reference_image:l,prompt:`基于参考图片的风格和特征，${e}`},n=await o.generateImage(r);if(n.success&&(null==(i=null==(t=null==(s=n.data)?void 0:s.images)?void 0:t[0])?void 0:i.url))return n.data.images[0].url;throw new Error(n.error||"图像生成失败")}{const e=await o.generateImage(c);if(e.success&&(null==(n=null==(r=null==(l=e.data)?void 0:l.images)?void 0:r[0])?void 0:n.url))return e.data.images[0].url;throw new Error(e.error||"图像生成失败")}}catch(c){if(o=c instanceof Error?c:new Error(String(c)),m<3){const e=1e3*m;await new Promise(s=>setTimeout(s,e))}}throw new Error(`图像生成失败，已重试3次: ${null==o?void 0:o.message}`)};function E(e){return new Promise((s,a)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=a=>{const i=t.result;if(e.size<1048576){const e=i.split(",")[1];return void s(e)}const l=new Image;l.onload=()=>{const e=document.createElement("canvas"),a=e.getContext("2d");let{width:t,height:i}=l;const r=512;t>i?t>r&&(i=i*r/t,t=r):i>r&&(t=t*r/i,i=r),e.width=t,e.height=i,null==a||a.drawImage(l,0,0,t,i);const n=e.toDataURL("image/jpeg",.7).split(",")[1];s(n)},l.onerror=()=>{const e=i.split(",")[1];s(e)},l.src=i},t.onerror=e=>a(e)})}return i.jsxs(m,{className:"w-full",children:[i.jsx(u,{children:i.jsx(h,{className:"text-xl font-bold",children:"Step 3：AI 生成品牌 Emoji"})}),i.jsxs(x,{className:"space-y-4",children:[i.jsx(l,{onClick:async()=>{p(!0),n([]),g(0),v(""),w(0);try{const t=ce(e,s);y(t.length);const i=[],l=t.length;for(let e=0;e<l;e++){const{prompt:s,emotion:r}=t[e];try{v(r),w(e+1),g((e+1)/l*100);const a=await C(s);i.push({emotion:r,url:a}),(e+1)%3==0&&e<l-1&&await new Promise(e=>setTimeout(e,3e3))}catch(a){i.push({emotion:r,url:S(r,"生成失败")}),i.slice(-2).filter(e=>e.url.includes("生成失败")).length>=2&&await new Promise(e=>setTimeout(e,8e3))}}n(i),k({title:"生成完成",description:`成功生成 ${i.length} 个个性化Emoji`})}catch(a){k({title:"生成失败",description:a instanceof Error?a.message:"请重试",variant:"destructive"})}finally{p(!1),g(0),v(""),w(0),y(0)}},disabled:c,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:c?"生成中...":"开始生成"}),c&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[i.jsx("span",{children:"生成进度"}),i.jsxs("span",{children:[b,"/",N," (",Math.round(j),"%)"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${j}%`}})}),f&&i.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["正在生成: ",f]}),i.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["预计剩余时间: ",Math.ceil(8*(N-b))," 秒"]})]}),r.length>0&&i.jsx("div",{className:"grid grid-cols-5 gap-4 mt-4",children:r.map(({emotion:e,url:s})=>i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:s,alt:e,className:"w-16 h-16 object-contain mx-auto border rounded-lg"}),i.jsx("p",{className:"text-xs mt-1 text-gray-600",children:e})]},e))})]})]})}function he({emojis:e,onDelete:s,onRegenerate:a}){return i.jsx("div",{className:"grid grid-cols-5 gap-4",children:e.map(({emotion:e,url:t})=>i.jsxs("div",{className:"text-center",children:[i.jsx("img",{src:t,alt:e,className:"w-16 h-16 mx-auto cursor-pointer",onClick:()=>navigator.clipboard.writeText(t),title:"点击复制链接"}),i.jsx("p",{className:"text-xs",children:e}),i.jsxs("div",{className:"flex justify-center space-x-2 mt-1",children:[i.jsx("button",{className:"text-red-500 text-xs",onClick:()=>s(e),children:"删除"}),i.jsx("button",{className:"text-blue-500 text-xs",onClick:()=>a(e),children:"重生"})]})]},e))})}function xe(){const[e,s]=t.useState("upload"),[a,r]=t.useState(null),[n,o]=t.useState(""),[d,u]=t.useState([]),[h,p]=t.useState([]),[j,g]=t.useState(!1),[f,v]=t.useState("single"),[N,y]=t.useState(""),[b,w]=t.useState(""),k=[{id:"upload",title:"上传素材",description:"上传品牌图片或输入描述"},{id:"build",title:"构建提示词",description:"生成个性化生成提示词"},{id:"generate",title:"生成Emoji",description:"AI生成个性化Emoji"},{id:"gallery",title:"作品展示",description:"查看和管理生成的Emoji"}],S=k.findIndex(s=>s.id===e),C=e=>{r(e),e.description&&y(e.description),s("build")},E=e=>{o(e),v("single"),s("generate")},$=e=>{u(e),v("batch"),s("generate")},T=e=>{w(e)},D=()=>{switch(e){case"build":s("upload");break;case"generate":s("build");break;case"gallery":s("generate")}},P=()=>{s("upload"),r(null),o(""),u([]),p([]),v("single"),y(""),w("")};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:i.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[i.jsxs("div",{className:"text-center space-y-2",children:[i.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"个性化品牌 Emoji 生成器"}),i.jsx("p",{className:"text-gray-600",children:"基于您的品牌特色，AI智能生成专属Emoji表情"})]}),i.jsx(m,{children:i.jsxs(x,{className:"p-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:k.map((e,s)=>i.jsxs("div",{className:"flex items-center",children:[i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:`\n                      w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\n                      ${s<=S?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}\n                    `,children:s<S?i.jsx(I,{className:"w-5 h-5"}):s+1}),i.jsxs("div",{className:"text-xs mt-2 text-center max-w-20",children:[i.jsx("div",{className:"font-medium",children:e.title}),i.jsx("div",{className:"text-gray-500",children:e.description})]})]}),s<k.length-1&&i.jsx("div",{className:`\n                      w-16 h-0.5 mx-4\n                      ${s<S?"bg-blue-500":"bg-gray-200"}\n                    `})]},e.id))}),i.jsxs("div",{className:"mt-6",children:[i.jsx(M,{value:S/(k.length-1)*100,className:"w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[i.jsxs("span",{children:["步骤 ",S+1," / ",k.length]}),i.jsxs("span",{children:[Math.round(S/(k.length-1)*100),"% 完成"]})]})]})]})}),i.jsx("div",{className:"min-h-[600px]",children:(()=>{switch(e){case"upload":return i.jsx(le,{onUploadComplete:C,onReset:P});case"build":return i.jsx(me,{uploadedData:a,onPromptReady:E,onBatchPromptsReady:$,onBack:D,onBrandChange:T});case"generate":return i.jsx(ue,{character:N||"卡通形象",brand:b||"品牌",uploadedImage:null==a?void 0:a.image});case"gallery":return i.jsx(he,{emojis:h.map(e=>({emotion:e.emotion||"未知",url:e.url})),onDelete:e=>{const s=h.find(s=>s.emotion===e);var a;s&&(a=s.id,p(e=>e.filter(e=>e.id!==a)))},onRegenerate:e=>{s("generate")}});default:return null}})()}),i.jsx(m,{children:i.jsx(x,{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(c,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-600",children:["已生成 ",h.length," 个个性化Emoji","batch"===f&&d.length>0&&i.jsxs("span",{className:"ml-2 text-blue-600",children:["(批量模式: ",d.length,"个情绪)"]})]})]}),i.jsxs("div",{className:"flex gap-2",children:["upload"!==e&&i.jsx(l,{onClick:P,variant:"outline",size:"sm",children:"重新开始"}),h.length>0&&i.jsx(l,{onClick:()=>s("gallery"),variant:"outline",size:"sm",children:"查看作品集"})]})]})})})]})})}const pe=()=>{const[e,s]=t.useState([]),[a,r]=t.useState([]),[n,d]=t.useState(""),[M,D]=t.useState("all"),[P,z]=t.useState("color"),[I,A]=t.useState(null),[U,G]=t.useState("gallery"),[K,Y]=t.useState(!1),[Q,X]=t.useState("grid"),[ee,ae]=t.useState(new Set),[te,le]=t.useState(""),[re,ne]=t.useState(!1),[oe,ce]=t.useState([]),[de,me]=t.useState(""),{toast:ue}=o(),he=t.useMemo(()=>ie.getEmojiStats().byGroup,[]);t.useEffect(()=>{const e=ie.getAllEmojis();s(e),r(e)},[]),t.useEffect(()=>{let s=e;n&&(s=ie.searchEmojis(n)),"all"!==M&&(s=s.filter(e=>e.group===M)),r(s)},[e,n,M]);const pe=async e=>{try{let s=e.unicode;e.hasSkinTone&&(s=ie.applySkinToneModifier(e.unicode,"medium")),await navigator.clipboard.writeText(s),ue({title:"复制成功",description:`已复制 ${s} 到剪贴板`})}catch(s){ue({title:"复制失败",description:"请手动复制",variant:"destructive"})}},je=e=>e.hasSkinTone?ie.applySkinToneModifier(e.unicode,"medium"):e.unicode;return i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsx("div",{className:"container mx-auto px-4 py-8 space-y-6",children:i.jsxs(f,{value:U,onValueChange:G,children:[i.jsxs(v,{className:"grid w-full grid-cols-3",children:[i.jsxs(N,{value:"gallery",className:"flex items-center gap-2",children:[i.jsx(W,{className:"w-4 h-4"}),"Emoji图库"]}),i.jsxs(N,{value:"ai-recommend",className:"flex items-center gap-2",children:[i.jsx(c,{className:"w-4 h-4"}),"AI推荐"]}),i.jsxs(N,{value:"brand-emoji",className:"flex items-center gap-2",children:[i.jsx(B,{className:"w-4 h-4"}),"品牌Emoji生成器"]})]}),i.jsxs(y,{value:"gallery",className:"space-y-6",children:[i.jsx(m,{children:i.jsx(x,{className:"p-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),i.jsx(j,{placeholder:"搜索emoji、名称或关键词...",value:n,onChange:e=>d(e.target.value),className:"pl-10"})]}),i.jsxs(b,{value:M,onValueChange:D,children:[i.jsx(w,{className:"w-48",children:i.jsx(k,{placeholder:"选择分类"})}),i.jsxs(S,{children:[i.jsx(C,{value:"all",children:"全部分类"}),Z.map(e=>i.jsxs(C,{value:e,children:[e," (",he[e]||0,")"]},e))]})]}),i.jsxs(b,{value:P,onValueChange:e=>z(e),children:[i.jsx(w,{className:"w-40",children:i.jsx(k,{placeholder:"选择风格"})}),i.jsx(S,{children:Object.entries(se).map(([e,s])=>i.jsx(C,{value:e,children:s.name},e))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{variant:"grid"===Q?"default":"outline",size:"sm",onClick:()=>X("grid"),children:i.jsx(W,{className:"w-4 h-4"})}),i.jsx(l,{variant:"list"===Q?"default":"outline",size:"sm",onClick:()=>X("list"),children:i.jsx(L,{className:"w-4 h-4"})})]})]})})}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(l,{variant:"all"===M?"default":"outline",size:"sm",onClick:()=>D("all"),children:"全部"}),Z.map(e=>i.jsxs(l,{variant:M===e?"default":"outline",size:"sm",onClick:()=>D(e),className:"flex items-center gap-2",children:[i.jsx("span",{className:"hidden sm:inline",children:e}),i.jsx(g,{variant:"secondary",className:"text-xs",children:he[e]||0})]},e))]}),i.jsx("div",{className:"grid"===Q?"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 gap-4":"space-y-2",children:a.map(e=>i.jsx(m,{className:"group cursor-pointer hover:shadow-lg transition-all duration-200 "+("grid"===Q?"aspect-square":"flex-row"),children:i.jsxs(x,{className:"p-4 "+("list"===Q?"flex items-center gap-4":""),children:[i.jsxs("div",{className:`relative ${"grid"===Q?"aspect-square mb-2":"w-12 h-12"} flex items-center justify-center`,children:[i.jsx("div",{className:"text-4xl cursor-pointer hover:scale-110 transition-transform",onClick:()=>pe(e),title:`${e.name} (${e.unicode})`,children:je(e)}),i.jsx(l,{variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity "+("list"===Q?"relative opacity-100":""),onClick:s=>{var a;s.stopPropagation(),a=e.unicode,ae(e=>{const s=new Set(e);return s.has(a)?s.delete(a):s.add(a),s})},children:i.jsx(O,{className:"w-3 h-3 "+(ee.has(e.unicode)?"fill-red-500 text-red-500":"")})})]}),i.jsxs("div",{className:"text-center "+("list"===Q?"flex-1 text-left":""),children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 truncate",children:e.name}),"list"===Q&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.jsx("span",{className:"mr-2",children:e.group}),e.hasSkinTone&&i.jsx(g,{variant:"outline",className:"text-xs mr-1",children:"肤色"}),e.hasGender&&i.jsx(g,{variant:"outline",className:"text-xs",children:"性别"})]})]}),"list"===Q&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{variant:"outline",size:"sm",onClick:s=>{s.stopPropagation(),pe(e)},children:i.jsx(R,{className:"w-4 h-4"})}),i.jsx(l,{variant:"outline",size:"sm",onClick:s=>{s.stopPropagation(),(async e=>{try{const s=ie.generateEmojiUrl(e.codepoint,"color",128),a=await fetch(s);if(!a.ok)throw new Error("下载失败");const t=await a.blob(),i=window.URL.createObjectURL(t),l=document.createElement("a");l.href=i,l.download=`${e.name.replace(/\s+/g,"-")}-${e.unicode}-noto-color.png`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(i),document.body.removeChild(l),ue({title:"下载成功",description:`已下载 ${e.name}`})}catch(s){ue({title:"下载失败",description:"图片资源可能不可用，请稍后重试",variant:"destructive"})}})(e)},children:i.jsx(_,{className:"w-4 h-4"})})]})]})},e.codepoint))}),0===a.length&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"没有找到相关emoji"}),i.jsx("p",{className:"text-gray-500",children:"尝试调整搜索条件或选择其他分类"})]})]}),i.jsx(y,{value:"ai-recommend",className:"space-y-6",children:i.jsxs(m,{children:[i.jsxs(u,{children:[i.jsxs(h,{className:"flex items-center gap-2",children:[i.jsx(c,{className:"w-5 h-5"}),"AI Emoji推荐"]}),i.jsx(p,{children:"输入内容场景，AI将为您推荐最合适的emoji表情符号"})]}),i.jsxs(x,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(E,{className:"text-sm font-medium mb-2 block",children:"内容场景"}),i.jsx($,{placeholder:"请输入需要emoji的内容场景，例如：分享一个健身减肥的成功案例、庆祝项目完成、表达对美食的喜爱等...",value:te,onChange:e=>le(e.target.value),rows:4,className:"w-full"})]}),i.jsx(l,{onClick:async()=>{var e,s,a;if(te.trim()){ne(!0);try{const t=await T.recommendEmojis(te),i=t.data,l=null==i?void 0:i.data;if(!t.success||!(null==(a=null==(s=null==(e=null==l?void 0:l.choices)?void 0:e[0])?void 0:s.message)?void 0:a.content))throw new Error("AI响应格式异常");{const e=l.choices[0].message.content,s=e.match(/推荐emoji[:：]\s*(.+?)(?:\n|推荐理由|$)/i);if(s){const e=s[1].split(/\s+/).filter(e=>e.trim());ce(e)}const a=e.match(/推荐理由[:：]\s*(.+?)$/is);me(a?a[1].trim():e),ue({title:"AI推荐完成",description:`已为您推荐 ${oe.length} 个emoji`})}}catch(t){ue({title:"推荐失败",description:"请稍后重试AI推荐功能",variant:"destructive"})}finally{ne(!1)}}else ue({title:"请输入内容",description:"请提供需要推荐emoji的内容场景",variant:"destructive"})},disabled:re||!te.trim(),className:"w-full",children:re?i.jsxs(i.Fragment,{children:[i.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}),"AI推荐中..."]}):i.jsxs(i.Fragment,{children:[i.jsx(c,{className:"w-4 h-4 mr-2"}),"获取AI推荐"]})}),oe.length>0&&i.jsxs(m,{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200",children:[i.jsx(u,{children:i.jsxs(h,{className:"text-lg flex items-center gap-2",children:[i.jsx(V,{className:"w-5 h-5 text-purple-600"}),"AI推荐结果"]})}),i.jsxs(x,{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(E,{className:"text-sm font-medium mb-2 block",children:"推荐的Emoji"}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:oe.map((e,s)=>i.jsx(l,{variant:"outline",size:"lg",className:"text-2xl h-12 w-12 p-0",onClick:()=>{navigator.clipboard.writeText(e),ue({title:"已复制",description:`已复制 ${e}`})},children:e},s))}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(l,{onClick:async()=>{try{const e=oe.join(" ");await navigator.clipboard.writeText(e),ue({title:"复制成功",description:`已复制推荐的emoji: ${e}`})}catch(e){ue({title:"复制失败",description:"请手动复制",variant:"destructive"})}},variant:"outline",size:"sm",children:[i.jsx(R,{className:"w-4 h-4 mr-2"}),"复制所有"]}),i.jsxs(l,{onClick:()=>{ce([]),me("")},variant:"outline",size:"sm",children:[i.jsx(H,{className:"w-4 h-4 mr-2"}),"清空结果"]})]})]}),de&&i.jsxs("div",{children:[i.jsx(E,{className:"text-sm font-medium mb-2 block",children:"推荐理由"}),i.jsx("div",{className:"bg-white p-4 rounded-lg border",children:i.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:de})})]})]})]}),i.jsxs(m,{className:"bg-gradient-to-r from-green-50 to-teal-50 border-green-200",children:[i.jsx(u,{children:i.jsxs(h,{className:"text-lg flex items-center gap-2",children:[i.jsx(J,{className:"w-5 h-5 text-green-600"}),"使用建议"]})}),i.jsx(x,{children:i.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[i.jsxs("p",{children:["• ",i.jsx("strong",{children:"标题使用："}),"在标题中放置1-2个最关键的emoji增强吸引力"]}),i.jsxs("p",{children:["• ",i.jsx("strong",{children:"正文穿插："}),"在正文段落间适量使用emoji增加节奏感"]}),i.jsxs("p",{children:["• ",i.jsx("strong",{children:"结尾强化："}),"在结尾使用emoji增强情感表达和互动性"]}),i.jsxs("p",{children:["• ",i.jsx("strong",{children:"平台适配："}),"不同平台的emoji使用习惯有差异，注意调整"]})]})})]})]})]})}),i.jsx(y,{value:"brand-emoji",className:"space-y-6",children:i.jsxs(m,{children:[i.jsxs(u,{children:[i.jsxs(h,{className:"flex items-center gap-2",children:[i.jsx(B,{className:"w-5 h-5"}),"品牌Emoji生成器"]}),i.jsx(p,{children:"输入品牌角色和品牌名，AI将为您生成专属的品牌emoji"})]}),i.jsx(x,{className:"space-y-6",children:i.jsx(xe,{})})]})})]})})})};export{pe as default};
