const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Chh-bxyD-1752856120842.js","assets/index-CSRGcyVN-1752856120842.css"])))=>i.map(i=>d[i]);
var Ae=Object.defineProperty;var Re=(l,s,i)=>s in l?Ae(l,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[s]=i;var se=(l,s,i)=>Re(l,typeof s!="symbol"?s+"":s,i);import{q as ae,r as n,j as e,C as F,m as H,n as V,U as fe,e as z,B as h,s as Ue,A as _e,t as Fe,l as Q,v as Ee,X as ve,L as _,T as he,u as ue,I as Te,w as ze,R as $e,x as Y,y as De,p as X,_ as Be,z as Le,E as Oe,G as qe,J as ne,K as ye,N as re,S as He,f as Ne,g as be,h as we,i as Se,k as le,O as Ve,H as We,Q as Je,V as ke,W as Ke,Y as Qe,Z as Ye,$ as Xe}from"./index-Chh-bxyD-1752856120842.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],ce=ae("grid-3x3",Ze);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ss=ae("image",es);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],as=ae("list",ts);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ns=ae("wand-sparkles",is),oe=["Smileys & Emotion","People & Body","Component","Animals & Nature","Food & Drink","Travel & Places","Activities","Objects","Symbols","Flags"],te={light:{unicode:"🏻",hex:"F7D7C4",name:"浅肤色"},"medium-light":{unicode:"🏼",hex:"D4A574",name:"中浅肤色"},medium:{unicode:"🏽",hex:"A0754D",name:"中等肤色"},"medium-dark":{unicode:"🏾",hex:"825C42",name:"中深肤色"},dark:{unicode:"🏿",hex:"5C4033",name:"深肤色"}},rs={"1f468-2764-1f48b-1f468":"Kiss","1f469-2764-1f48b-1f469":"Kiss","1f469-2764-1f48b-1f468":"Kiss","1f469-2764-1f468":"Couple with Heart","1f468-2764-1f468":"Couple with Heart","1f469-2764-1f469":"Couple with Heart","1f468-1f467":"Family","1f468-1f466":"Family","1f469-1f467":"Family","1f469-1f466":"Family"},ls={"1f441-1f5e8":"I Witness","1f3f3-1f308":"Rainbow Flag",2695:"Health Worker",2696:"Judge","26f7":"Skiing","26f9":"Bouncing a Ball",2708:"Pilot","1f33e":"Farmer","1f373":"Cook","1f393":"Student","1f3a4":"Singer","1f3a8":"Artist","1f3c3":"Running","1f3c4":"Surfing","1f3ca":"Swimming","1f46e":"Police Officer","1f477":"Construction Worker","1f4bb":"Technologist","1f527":"Mechanic","1f52c":"Scientist","1f680":"Astronaut","1f692":"Firefighter"},de={color:{name:"Noto Color",description:"Google官方彩色设计",baseUrl:"https://raw.githubusercontent.com/googlefonts/noto-emoji/main/png",format:"png"},outline:{name:"Noto Outline",description:"黑白描边风格",baseUrl:"/assets/noto-emoji",format:"png"},material:{name:"Material Design",description:"Material Design风格",baseUrl:"https://fonts.gstatic.com/s/e/notoemoji/latest",format:"webp"}},cs=[{unicode:"😀",codepoint:"1f600",name:"笑脸",group:"Smileys & Emotion",subgroup:"face-smiling",keywords:["笑","开心","高兴","快乐","grinning"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"😃",codepoint:"1f603",name:"张嘴笑脸",group:"Smileys & Emotion",subgroup:"face-smiling",keywords:["笑","开心","张嘴","兴奋","grinning","big eyes"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"👍",codepoint:"1f44d",name:"竖起大拇指",group:"People & Body",subgroup:"hand-fingers-closed",keywords:["好","赞","同意","手势","thumbs up","like"],hasSkinTone:!0,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🐶",codepoint:"1f436",name:"狗脸",group:"Animals & Nature",subgroup:"animal-mammal",keywords:["狗","小狗","宠物","动物","dog","face"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🍎",codepoint:"1f34e",name:"红苹果",group:"Food & Drink",subgroup:"food-fruit",keywords:["苹果","水果","红色","健康","apple","red"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"❤️",codepoint:"2764",name:"红心",group:"Symbols",subgroup:"heart",keywords:["爱","心","红色","感情","heart","love"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🚗",codepoint:"1f697",name:"汽车",group:"Travel & Places",subgroup:"transport-ground",keywords:["汽车","车","交通","驾驶","car","automobile"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"⚽",codepoint:"26bd",name:"足球",group:"Activities",subgroup:"sport",keywords:["足球","运动","球","比赛","soccer","football"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"💡",codepoint:"1f4a1",name:"电灯泡",group:"Objects",subgroup:"light & video",keywords:["灯泡","想法","创意","电","bulb","idea"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"},{unicode:"🏳️",codepoint:"1f3f3",name:"白旗",group:"Flags",subgroup:"flag",keywords:["旗帜","白色","投降","和平","flag","white"],hasSkinTone:!1,hasGender:!1,version:"1.0",status:"fully-qualified"}],q=class q{constructor(){se(this,"emojiData",[]);se(this,"emojiMap",new Map);this.initializeData()}static getInstance(){return q.instance||(q.instance=new q),q.instance}initializeData(){this.emojiData=[...cs],this.buildEmojiMap()}buildEmojiMap(){this.emojiMap.clear(),this.emojiData.forEach(s=>{this.emojiMap.set(s.unicode,s),this.emojiMap.set(s.codepoint,s)})}getAllEmojis(){return[...this.emojiData]}getEmojisByGroup(s){return this.emojiData.filter(i=>i.group===s)}searchEmojis(s){const i=s.toLowerCase();return this.emojiData.filter(r=>r.name.toLowerCase().includes(i)||r.keywords.some(c=>c.toLowerCase().includes(i))||r.unicode.includes(s))}getEmojiByUnicode(s){return this.emojiMap.get(s)}getEmojiByCodepoint(s){return this.emojiMap.get(s)}generateEmojiUrl(s,i="color",r=128){const c=de[i];return i==="color"?`${c.baseUrl}/${r}/emoji_u${s}.${c.format}`:i==="material"?`${c.baseUrl}/${s}/${r}.${c.format}`:`${c.baseUrl}/emoji_u${s}.${c.format}`}applySkinToneModifier(s,i){if(!s)return console.warn("[applySkinToneModifier] unicode参数为空"),"";const r=this.getEmojiByUnicode(s);return r?r.hasSkinTone&&i&&te[i]?s+te[i].unicode:s:(console.warn(`[applySkinToneModifier] 未找到unicode: ${s} 对应的emoji`),s)}getEmojiVariants(s){const i=this.getEmojiByUnicode(s);if(!i)return[s];const r=[s];return i.hasSkinTone&&Object.keys(te).forEach(c=>{r.push(this.applySkinToneModifier(s,c))}),r}getCustomName(s){return ls[s]||rs[s]||null}unicodeToCodepoint(s){return Array.from(s).map(i=>{var r;return(r=i.codePointAt(0))==null?void 0:r.toString(16).padStart(4,"0")}).join("_")}codepointToUnicode(s){return s.split("_").map(i=>String.fromCodePoint(parseInt(i,16))).join("")}isEmojiSupported(s){return this.emojiMap.has(s)}getEmojiStats(){const s={total:this.emojiData.length,byGroup:{},withSkinTone:0,withGender:0};return this.emojiData.forEach(i=>{s.byGroup[i.group]=(s.byGroup[i.group]||0)+1,i.hasSkinTone&&s.withSkinTone++,i.hasGender&&s.withGender++}),s}batchGenerateUrls(s,i="color",r=128){return s.map(c=>({codepoint:c,url:this.generateEmojiUrl(c,i,r)}))}exportData(){return JSON.stringify({metadata:{total:this.emojiData.length,generated:new Date().toISOString(),source:"Google Noto Emoji Project"},groups:oe,skinTones:te,styles:de,emojis:this.emojiData},null,2)}};se(q,"instance");let me=q;const J=me.getInstance();function os({onUploadComplete:l,onReset:s}){const[i,r]=n.useState("image"),[c,u]=n.useState(null),[j,S]=n.useState(""),[N,C]=n.useState(!1),[U,$]=n.useState(null),A=n.useRef(null),P=E=>{var x;const T=(x=E.target.files)==null?void 0:x[0];if(T){if(!T.type.startsWith("image/")){$("请上传图片文件");return}if(T.size>5*1024*1024){$("图片大小不能超过5MB");return}$(null),u(T),C(!0),setTimeout(()=>{C(!1),l({image:T})},1e3)}},D=()=>{if(!j.trim()){$("请输入品牌描述");return}$(null),C(!0),setTimeout(()=>{C(!1),l({description:j.trim()})},500)},I=()=>{u(null),S(""),$(null),C(!1),A.current&&(A.current.value=""),s()},k=()=>{var E;(E=A.current)==null||E.click()};return e.jsxs(F,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(H,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"上传品牌素材"]})}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:i==="image"?"default":"outline",onClick:()=>r("image"),className:"flex-1",children:[e.jsx(ss,{className:"w-4 h-4 mr-2"}),"上传图片"]}),e.jsxs(h,{variant:i==="description"?"default":"outline",onClick:()=>r("description"),className:"flex-1",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"文字描述"]})]}),U&&e.jsx(_e,{variant:"destructive",children:e.jsx(Fe,{children:U})}),i==="image"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-gray-400 transition-colors",onClick:k,children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:URL.createObjectURL(c),alt:"预览",className:"w-32 h-32 object-cover rounded-lg"}),e.jsxs(Q,{className:"absolute -top-2 -right-2 bg-green-500",children:[e.jsx(Ee,{className:"w-3 h-3 mr-1"}),"已上传"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:c.name})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{className:"w-12 h-12 mx-auto text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium",children:"点击上传品牌图片"}),e.jsx("p",{className:"text-sm text-gray-500",children:"支持 JPG、PNG 格式，最大 5MB"})]})]})}),e.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:P,className:"hidden"}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:k,variant:"outline",className:"flex-1",children:"重新选择"}),e.jsx(h,{onClick:I,variant:"outline",children:e.jsx(ve,{className:"w-4 h-4"})})]})]}),i==="description"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"description",children:"品牌描述"}),e.jsx(he,{id:"description",placeholder:"请描述您的品牌特点，例如：科技公司，蓝色主题，简约现代风格...",value:j,onChange:E=>S(E.target.value),rows:4,className:"resize-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:D,disabled:N||!j.trim(),className:"flex-1",children:N?"处理中...":"提交描述"}),e.jsx(h,{onClick:I,variant:"outline",children:e.jsx(ve,{className:"w-4 h-4"})})]})]}),N&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:i==="image"?"正在上传图片...":"正在处理描述..."})]})]})]})}const ds=["开心微笑","大笑","生气","哭泣","惊讶","疑惑","睡觉","吐舌","鼓掌","比心","点赞","OK 手势","拒绝","拍头","举手提问","加油","挑眉","害羞","眨眼","黑脸","鼻涕泡","流口水","咀嚼","偷笑","吓到","打喷嚏","爱心眼","庆祝","拿红包","举杯微笑"],xe=[{value:"cute",label:"可爱风格",emoji:"🥰"},{value:"modern",label:"现代简约",emoji:"✨"},{value:"vintage",label:"复古经典",emoji:"📷"},{value:"cartoon",label:"卡通动漫",emoji:"🎨"},{value:"minimalist",label:"极简主义",emoji:"⚪"},{value:"3d",label:"3D立体",emoji:"🎯"}],pe=["简单","适中","复杂","非常复杂","极度复杂"];function Pe(l,s){return ds.map(i=>({emotion:i,prompt:`一个${s}品牌卡通形象正在${i}，${l}，表情风格为 emoji，扁平卡通风，透明背景`}))}function ms(l,s){var c;if(!l)return"";let i="";const r=((c=xe.find(u=>u.value===s))==null?void 0:c.label)||"可爱";return l.image?i=`基于上传的品牌图片，创建一个${r}的Emoji表情`:l.description&&(i=`基于描述"${l.description}"，创建一个${r}的Emoji表情`),i}function Ce(l,s,i){const r=ms(l,s),c=pe[i-1];let u=`${r}，${c}程度的设计，`;switch(s){case"cute":u+="圆润的线条，温暖的色彩，充满亲和力";break;case"modern":u+="简洁的几何形状，清晰的轮廓，现代感十足";break;case"vintage":u+="复古色调，经典元素，怀旧风格";break;case"cartoon":u+="夸张的表情，鲜艳的色彩，卡通风格";break;case"minimalist":u+="极简设计，单一色彩，简洁明了";break;case"3d":u+="立体效果，光影层次，3D渲染风格";break}return u}function hs(l,s,i,r="品牌"){const c=(l==null?void 0:l.description)||"卡通形象";return Pe(c,r).map(({emotion:j,prompt:S})=>{var N;return{emotion:j,prompt:`${S}，${((N=xe.find(C=>C.value===s))==null?void 0:N.label)||"可爱"}风格，${pe[i-1]}程度的设计`}})}function us({uploadedData:l,onPromptReady:s,onBatchPromptsReady:i,onBrandChange:r,onBack:c}){const[u,j]=n.useState(""),[S,N]=n.useState(""),[C,U]=n.useState(!1),[$,A]=n.useState("cute"),[P,D]=n.useState([3]),[I,k]=n.useState(!1),[E,T]=n.useState(""),[x,d]=n.useState("single"),[p,f]=n.useState([]),{toast:m}=ue(),M=async()=>{U(!0),setTimeout(()=>{if(x==="single"){const t=Ce(l,$,P[0]);j(t),N(t)}else{const t=hs(l,$,P[0],E);f(t)}U(!1),m({title:"Prompt生成完成",description:x==="single"?"已为您生成个性化的Emoji生成提示词":`已生成${p.length}个情绪提示词`})},2e3)},b=async()=>{const t=I?S:u;try{await navigator.clipboard.writeText(t),m({title:"复制成功",description:"Prompt已复制到剪贴板"})}catch{m({title:"复制失败",description:"请手动复制文本",variant:"destructive"})}},w=async()=>{const t=p.map(o=>`${o.emotion}: ${o.prompt}`).join(`

`);try{await navigator.clipboard.writeText(t),m({title:"复制成功",description:"批量提示词已复制到剪贴板"})}catch{m({title:"复制失败",description:"请手动复制文本",variant:"destructive"})}},v=()=>{if(x==="single"){const t=I?S:u;if(!t.trim()){m({title:"提示词不能为空",description:"请先生成或输入提示词",variant:"destructive"});return}s(t)}else{if(p.length===0){m({title:"批量提示词为空",description:"请先生成批量提示词",variant:"destructive"});return}i==null||i(p)}};return n.useEffect(()=>{if(l&&x==="single"){const t=Ce(l,$,P[0]);j(t),I||N(t)}},[l,$,P,x,I]),e.jsxs(F,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(H,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"w-5 h-5"}),"构建生成提示词"]})}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"生成模式"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:x==="single"?"default":"outline",onClick:()=>d("single"),className:"flex-1",children:[e.jsx(as,{className:"w-4 h-4 mr-2"}),"单个提示词"]}),e.jsxs(h,{variant:x==="batch"?"default":"outline",onClick:()=>d("batch"),className:"flex-1",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"批量情绪"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"brand-name",children:"品牌名称"}),e.jsx(Te,{id:"brand-name",placeholder:"请输入您的品牌名称",value:E,onChange:t=>{T(t.target.value),r==null||r(t.target.value)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"选择风格"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:xe.map(t=>e.jsxs(h,{variant:$===t.value?"default":"outline",onClick:()=>A(t.value),className:"flex flex-col items-center gap-1 h-auto py-3",children:[e.jsx("span",{className:"text-lg",children:t.emoji}),e.jsx("span",{className:"text-xs",children:t.label})]},t.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(_,{children:["设计复杂度: ",pe[P[0]-1]]}),e.jsx(ze,{value:P,onValueChange:D,max:5,min:1,step:1,className:"w-full"})]}),e.jsx(h,{onClick:M,disabled:C||!l||x==="batch"&&!E.trim(),className:"w-full",children:C?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4 mr-2 animate-spin"}),"生成中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),x==="single"?"自动生成Prompt":"生成批量情绪Prompt"]})}),x==="single"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"custom-prompt",children:"自定义Prompt"}),e.jsx(De,{id:"custom-prompt",checked:I,onCheckedChange:k})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"生成提示词"}),e.jsxs("div",{className:"relative",children:[e.jsx(he,{value:I?S:u,onChange:t=>N(t.target.value),placeholder:"正在生成个性化提示词...",rows:4,className:"resize-none pr-12",disabled:!I}),e.jsx(h,{size:"sm",variant:"ghost",onClick:b,className:"absolute top-2 right-2",children:e.jsx(X,{className:"w-4 h-4"})})]})]})]}),x==="batch"&&p.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{children:["批量情绪提示词 (",p.length,"个)"]}),e.jsxs(h,{size:"sm",variant:"ghost",onClick:w,children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"复制全部"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border rounded-lg p-3",children:p.map((t,o)=>e.jsxs("div",{className:"p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(Q,{variant:"secondary",children:t.emotion}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>navigator.clipboard.writeText(t.prompt),children:e.jsx(X,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.prompt})]},o))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:c,variant:"outline",className:"flex-1",children:"返回"}),e.jsx(h,{onClick:v,disabled:x==="single"?!u.trim()&&!S.trim():p.length===0,className:"flex-1",children:x==="single"?"确认使用":"开始批量生成"})]})]})]})}function xs({character:l,brand:s,uploadedImage:i}){const[r,c]=n.useState([]),[u,j]=n.useState(!1),[S,N]=n.useState(0),[C,U]=n.useState(""),[$,A]=n.useState(0),[P,D]=n.useState(0),{toast:I}=ue(),k=(d,p="生成失败")=>{const f=`
      <svg width="64" height="64" xmlns="http://www.w3.org/2000/svg">
        <rect width="64" height="64" fill="#f3f4f6"/>
        <text x="32" y="32" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="8">${d}</text>
        <text x="32" y="44" text-anchor="middle" dy=".3em" fill="#9ca3af" font-size="6">${p}</text>
      </svg>
    `;return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(f)))}`},E=async d=>{var m,M,b,w,v,t;let f=null;for(let o=1;o<=3;o++)try{console.log(`尝试生成图像 (第${o}次): ${d.substring(0,30)}...`);const y=(await Be(async()=>{const{default:R}=await import("./index-Chh-bxyD-1752856120842.js").then(O=>O.a0);return{default:R}},__vite__mapDeps([0,1]))).default,G={prompt:d,n:1,size:"512x512",response_format:"url"};if(i){const R=await T(i),O={...G,reference_image:R,prompt:`基于参考图片的风格和特征，${d}`},W=await y.generateImage(O);if(W.success&&((b=(M=(m=W.data)==null?void 0:m.images)==null?void 0:M[0])!=null&&b.url))return console.log(`图像生成成功 (第${o}次尝试)`),W.data.images[0].url;throw new Error(W.error||"图像生成失败")}else{const R=await y.generateImage(G);if(R.success&&((t=(v=(w=R.data)==null?void 0:w.images)==null?void 0:v[0])!=null&&t.url))return console.log(`图像生成成功 (第${o}次尝试)`),R.data.images[0].url;throw new Error(R.error||"图像生成失败")}}catch(y){if(f=y instanceof Error?y:new Error(String(y)),console.error(`图像生成失败 (第${o}次尝试):`,f.message),o<3){const G=o*1e3;console.log(`等待${G}ms后重试...`),await new Promise(R=>setTimeout(R,G))}}throw new Error(`图像生成失败，已重试3次: ${f==null?void 0:f.message}`)};function T(d){return new Promise((p,f)=>{const m=new FileReader;m.readAsDataURL(d),m.onload=M=>{const b=m.result;if(d.size<1024*1024){const v=b.split(",")[1];p(v);return}const w=new Image;w.onload=()=>{const v=document.createElement("canvas"),t=v.getContext("2d");let{width:o,height:y}=w;const G=512;o>y?o>G&&(y=y*G/o,o=G):y>G&&(o=o*G/y,y=G),v.width=o,v.height=y,t==null||t.drawImage(w,0,0,o,y);const O=v.toDataURL("image/jpeg",.7).split(",")[1];p(O)},w.onerror=()=>{const v=b.split(",")[1];p(v)},w.src=b},m.onerror=M=>f(M)})}const x=async()=>{j(!0),c([]),N(0),U(""),D(0);try{const d=Pe(l,s);A(d.length);const p=[],f=d.length;for(let m=0;m<f;m++){const{prompt:M,emotion:b}=d[m];try{console.log(`正在生成${b}表情... (${m+1}/${f})`),U(b),D(m+1),N((m+1)/f*100);const w=await E(M);p.push({emotion:b,url:w}),console.log(`${b}表情生成成功 (${m+1}/${f})`),(m+1)%3===0&&m<f-1&&(console.log("暂停3秒，避免API限制..."),await new Promise(v=>setTimeout(v,3e3)))}catch(w){console.error(`生成${b}表情失败:`,w),p.push({emotion:b,url:k(b,"生成失败")}),p.slice(-2).filter(t=>t.url.includes("生成失败")).length>=2&&(console.log("检测到连续失败，暂停8秒..."),await new Promise(t=>setTimeout(t,8e3)))}}c(p),I({title:"生成完成",description:`成功生成 ${p.length} 个个性化Emoji`})}catch(d){console.error("批量生成失败:",d),I({title:"生成失败",description:d instanceof Error?d.message:"请重试",variant:"destructive"})}finally{j(!1),N(0),U(""),D(0),A(0)}};return e.jsxs(F,{className:"w-full",children:[e.jsx(H,{children:e.jsx(V,{className:"text-xl font-bold",children:"Step 3：AI 生成品牌 Emoji"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsx(h,{onClick:x,disabled:u,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:u?"生成中...":"开始生成"}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"生成进度"}),e.jsxs("span",{children:[P,"/",$," (",Math.round(S),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${S}%`}})}),C&&e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["正在生成: ",C]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["预计剩余时间: ",Math.ceil(($-P)*8)," 秒"]})]}),r.length>0&&e.jsx("div",{className:"grid grid-cols-5 gap-4 mt-4",children:r.map(({emotion:d,url:p})=>e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:p,alt:d,className:"w-16 h-16 object-contain mx-auto border rounded-lg"}),e.jsx("p",{className:"text-xs mt-1 text-gray-600",children:d})]},d))})]})]})}function ps({emojis:l,onDelete:s,onRegenerate:i}){return e.jsx("div",{className:"grid grid-cols-5 gap-4",children:l.map(({emotion:r,url:c})=>e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:c,alt:r,className:"w-16 h-16 mx-auto cursor-pointer",onClick:()=>navigator.clipboard.writeText(c),title:"点击复制链接"}),e.jsx("p",{className:"text-xs",children:r}),e.jsxs("div",{className:"flex justify-center space-x-2 mt-1",children:[e.jsx("button",{className:"text-red-500 text-xs",onClick:()=>s(r),children:"删除"}),e.jsx("button",{className:"text-blue-500 text-xs",onClick:()=>i(r),children:"重生"})]})]},r))})}function gs(){const[l,s]=n.useState("upload"),[i,r]=n.useState(null),[c,u]=n.useState(""),[j,S]=n.useState([]),[N,C]=n.useState([]),[U,$]=n.useState(!1),[A,P]=n.useState("single"),[D,I]=n.useState(""),[k,E]=n.useState(""),T=[{id:"upload",title:"上传素材",description:"上传品牌图片或输入描述"},{id:"build",title:"构建提示词",description:"生成个性化生成提示词"},{id:"generate",title:"生成Emoji",description:"AI生成个性化Emoji"},{id:"gallery",title:"作品展示",description:"查看和管理生成的Emoji"}],x=T.findIndex(t=>t.id===l),d=t=>{r(t),t.description&&I(t.description),s("build")},p=t=>{u(t),P("single"),s("generate")},f=t=>{S(t),P("batch"),s("generate")},m=t=>{E(t)},M=t=>{C(o=>o.filter(y=>y.id!==t))},b=()=>{switch(l){case"build":s("upload");break;case"generate":s("build");break;case"gallery":s("generate");break}},w=()=>{s("upload"),r(null),u(""),S([]),C([]),P("single"),I(""),E("")},v=()=>{switch(l){case"upload":return e.jsx(os,{onUploadComplete:d,onReset:w});case"build":return e.jsx(us,{uploadedData:i,onPromptReady:p,onBatchPromptsReady:f,onBack:b,onBrandChange:m});case"generate":return e.jsx(xs,{character:D||"卡通形象",brand:k||"品牌",uploadedImage:i==null?void 0:i.image});case"gallery":return e.jsx(ps,{emojis:N.map(t=>({emotion:t.emotion||"未知",url:t.url})),onDelete:t=>{const o=N.find(y=>y.emotion===t);o&&M(o.id)},onRegenerate:t=>{s("generate")}});default:return null}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"个性化品牌 Emoji 生成器"}),e.jsx("p",{className:"text-gray-600",children:"基于您的品牌特色，AI智能生成专属Emoji表情"})]}),e.jsx(F,{children:e.jsxs(z,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:T.map((t,o)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`
                      w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium
                      ${o<=x?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}
                    `,children:o<x?e.jsx(Ee,{className:"w-5 h-5"}):o+1}),e.jsxs("div",{className:"text-xs mt-2 text-center max-w-20",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsx("div",{className:"text-gray-500",children:t.description})]})]}),o<T.length-1&&e.jsx("div",{className:`
                      w-16 h-0.5 mx-4
                      ${o<x?"bg-blue-500":"bg-gray-200"}
                    `})]},t.id))}),e.jsxs("div",{className:"mt-6",children:[e.jsx(Le,{value:x/(T.length-1)*100,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:["步骤 ",x+1," / ",T.length]}),e.jsxs("span",{children:[Math.round(x/(T.length-1)*100),"% 完成"]})]})]})]})}),e.jsx("div",{className:"min-h-[600px]",children:v()}),e.jsx(F,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["已生成 ",N.length," 个个性化Emoji",A==="batch"&&j.length>0&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["(批量模式: ",j.length,"个情绪)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[l!=="upload"&&e.jsx(h,{onClick:w,variant:"outline",size:"sm",children:"重新开始"}),N.length>0&&e.jsx(h,{onClick:()=>s("gallery"),variant:"outline",size:"sm",children:"查看作品集"})]})]})})})]})})}const vs=()=>{const[l,s]=n.useState([]),[i,r]=n.useState([]),[c,u]=n.useState(""),[j,S]=n.useState("all"),[N,C]=n.useState("color"),[U,$]=n.useState(null),[A,P]=n.useState("gallery"),[D,I]=n.useState(!1),[k,E]=n.useState("grid"),[T,x]=n.useState(new Set),[d,p]=n.useState(""),[f,m]=n.useState(!1),[M,b]=n.useState([]),[w,v]=n.useState(""),{toast:t}=ue(),o=n.useMemo(()=>J.getEmojiStats().byGroup,[]);n.useEffect(()=>{const a=J.getAllEmojis();s(a),r(a)},[]),n.useEffect(()=>{let a=l;c&&(a=J.searchEmojis(c)),j!=="all"&&(a=a.filter(g=>g.group===j)),r(a)},[l,c,j]);const y=async a=>{try{let g=a.unicode;a.hasSkinTone&&(g=J.applySkinToneModifier(a.unicode,"medium")),await navigator.clipboard.writeText(g),t({title:"复制成功",description:`已复制 ${g} 到剪贴板`})}catch{t({title:"复制失败",description:"请手动复制",variant:"destructive"})}},G=async a=>{try{const g=J.generateEmojiUrl(a.codepoint,"color",128),B=await fetch(g);if(!B.ok)throw new Error("下载失败");const Z=await B.blob(),K=window.URL.createObjectURL(Z),L=document.createElement("a");L.href=K,L.download=`${a.name.replace(/\s+/g,"-")}-${a.unicode}-noto-color.png`,document.body.appendChild(L),L.click(),window.URL.revokeObjectURL(K),document.body.removeChild(L),t({title:"下载成功",description:`已下载 ${a.name}`})}catch{t({title:"下载失败",description:"图片资源可能不可用，请稍后重试",variant:"destructive"})}},R=a=>{x(g=>{const B=new Set(g);return B.has(a)?B.delete(a):B.add(a),B})},O=a=>a.hasSkinTone?J.applySkinToneModifier(a.unicode,"medium"):a.unicode,W=async()=>{var a,g,B;if(!d.trim()){t({title:"请输入内容",description:"请提供需要推荐emoji的内容场景",variant:"destructive"});return}m(!0);try{const Z=[{role:"user",content:`请为以下内容推荐合适的emoji表情符号：

内容场景: ${d}

请推荐5-10个最适合的emoji，并说明推荐理由。要求emoji能够增强内容的表达效果和情感共鸣。

请按照以下格式返回：
推荐emoji: 💪 🔥 ⭐ ✨ 🎯
推荐理由: 详细说明每个emoji的使用场景和情感表达效果`}],K=await Xe.recommendEmojis(d),L=K.data,ee=L==null?void 0:L.data;if(K.success&&((B=(g=(a=ee==null?void 0:ee.choices)==null?void 0:a[0])==null?void 0:g.message)!=null&&B.content)){const ie=ee.choices[0].message.content,ge=ie.match(/推荐emoji[:：]\s*(.+?)(?:\n|推荐理由|$)/i);if(ge){const Me=ge[1].split(/\s+/).filter(Ge=>Ge.trim());b(Me)}const je=ie.match(/推荐理由[:：]\s*(.+?)$/is);v(je?je[1].trim():ie),t({title:"AI推荐完成",description:`已为您推荐 ${M.length} 个emoji`})}else throw new Error("AI响应格式异常")}catch(Z){console.error("AI推荐失败:",Z),t({title:"推荐失败",description:"请稍后重试AI推荐功能",variant:"destructive"})}finally{m(!1)}},Ie=async()=>{try{const a=M.join(" ");await navigator.clipboard.writeText(a),t({title:"复制成功",description:`已复制推荐的emoji: ${a}`})}catch{t({title:"复制失败",description:"请手动复制",variant:"destructive"})}};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8 space-y-6",children:e.jsxs(Oe,{value:A,onValueChange:P,children:[e.jsxs(qe,{className:"grid w-full grid-cols-3",children:[e.jsxs(ne,{value:"gallery",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Emoji图库"]}),e.jsxs(ne,{value:"ai-recommend",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"AI推荐"]}),e.jsxs(ne,{value:"brand-emoji",className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"品牌Emoji生成器"]})]}),e.jsxs(re,{value:"gallery",className:"space-y-6",children:[e.jsx(F,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(He,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Te,{placeholder:"搜索emoji、名称或关键词...",value:c,onChange:a=>u(a.target.value),className:"pl-10"})]}),e.jsxs(Ne,{value:j,onValueChange:S,children:[e.jsx(be,{className:"w-48",children:e.jsx(we,{placeholder:"选择分类"})}),e.jsxs(Se,{children:[e.jsx(le,{value:"all",children:"全部分类"}),oe.map(a=>e.jsxs(le,{value:a,children:[a," (",o[a]||0,")"]},a))]})]}),e.jsxs(Ne,{value:N,onValueChange:a=>C(a),children:[e.jsx(be,{className:"w-40",children:e.jsx(we,{placeholder:"选择风格"})}),e.jsx(Se,{children:Object.entries(de).map(([a,g])=>e.jsx(le,{value:a,children:g.name},a))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:k==="grid"?"default":"outline",size:"sm",onClick:()=>E("grid"),children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(h,{variant:k==="list"?"default":"outline",size:"sm",onClick:()=>E("list"),children:e.jsx(Ve,{className:"w-4 h-4"})})]})]})})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(h,{variant:j==="all"?"default":"outline",size:"sm",onClick:()=>S("all"),children:"全部"}),oe.map(a=>e.jsxs(h,{variant:j===a?"default":"outline",size:"sm",onClick:()=>S(a),className:"flex items-center gap-2",children:[e.jsx("span",{className:"hidden sm:inline",children:a}),e.jsx(Q,{variant:"secondary",className:"text-xs",children:o[a]||0})]},a))]}),e.jsx("div",{className:k==="grid"?"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 gap-4":"space-y-2",children:i.map(a=>e.jsx(F,{className:`group cursor-pointer hover:shadow-lg transition-all duration-200 ${k==="grid"?"aspect-square":"flex-row"}`,children:e.jsxs(z,{className:`p-4 ${k==="list"?"flex items-center gap-4":""}`,children:[e.jsxs("div",{className:`relative ${k==="grid"?"aspect-square mb-2":"w-12 h-12"} flex items-center justify-center`,children:[e.jsx("div",{className:"text-4xl cursor-pointer hover:scale-110 transition-transform",onClick:()=>y(a),title:`${a.name} (${a.unicode})`,children:O(a)}),e.jsx(h,{variant:"ghost",size:"sm",className:`absolute top-0 right-0 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity ${k==="list"?"relative opacity-100":""}`,onClick:g=>{g.stopPropagation(),R(a.unicode)},children:e.jsx(We,{className:`w-3 h-3 ${T.has(a.unicode)?"fill-red-500 text-red-500":""}`})})]}),e.jsxs("div",{className:`text-center ${k==="list"?"flex-1 text-left":""}`,children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 truncate",children:a.name}),k==="list"&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsx("span",{className:"mr-2",children:a.group}),a.hasSkinTone&&e.jsx(Q,{variant:"outline",className:"text-xs mr-1",children:"肤色"}),a.hasGender&&e.jsx(Q,{variant:"outline",className:"text-xs",children:"性别"})]})]}),k==="list"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:g=>{g.stopPropagation(),y(a)},children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:g=>{g.stopPropagation(),G(a)},children:e.jsx(Je,{className:"w-4 h-4"})})]})]})},a.codepoint))}),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"没有找到相关emoji"}),e.jsx("p",{className:"text-gray-500",children:"尝试调整搜索条件或选择其他分类"})]})]}),e.jsx(re,{value:"ai-recommend",className:"space-y-6",children:e.jsxs(F,{children:[e.jsxs(H,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"}),"AI Emoji推荐"]}),e.jsx(ke,{children:"输入内容场景，AI将为您推荐最合适的emoji表情符号"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium mb-2 block",children:"内容场景"}),e.jsx(he,{placeholder:"请输入需要emoji的内容场景，例如：分享一个健身减肥的成功案例、庆祝项目完成、表达对美食的喜爱等...",value:d,onChange:a=>p(a.target.value),rows:4,className:"w-full"})]}),e.jsx(h,{onClick:W,disabled:f||!d.trim(),className:"w-full",children:f?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4 mr-2 animate-spin"}),"AI推荐中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"获取AI推荐"]})}),M.length>0&&e.jsxs(F,{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200",children:[e.jsx(H,{children:e.jsxs(V,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5 text-purple-600"}),"AI推荐结果"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium mb-2 block",children:"推荐的Emoji"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:M.map((a,g)=>e.jsx(h,{variant:"outline",size:"lg",className:"text-2xl h-12 w-12 p-0",onClick:()=>{navigator.clipboard.writeText(a),t({title:"已复制",description:`已复制 ${a}`})},children:a},g))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{onClick:Ie,variant:"outline",size:"sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"复制所有"]}),e.jsxs(h,{onClick:()=>{b([]),v("")},variant:"outline",size:"sm",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"清空结果"]})]})]}),w&&e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium mb-2 block",children:"推荐理由"}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:w})})]})]})]}),e.jsxs(F,{className:"bg-gradient-to-r from-green-50 to-teal-50 border-green-200",children:[e.jsx(H,{children:e.jsxs(V,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-green-600"}),"使用建议"]})}),e.jsx(z,{children:e.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"标题使用："}),"在标题中放置1-2个最关键的emoji增强吸引力"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"正文穿插："}),"在正文段落间适量使用emoji增加节奏感"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"结尾强化："}),"在结尾使用emoji增强情感表达和互动性"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"平台适配："}),"不同平台的emoji使用习惯有差异，注意调整"]})]})})]})]})]})}),e.jsx(re,{value:"brand-emoji",className:"space-y-6",children:e.jsxs(F,{children:[e.jsxs(H,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"品牌Emoji生成器"]}),e.jsx(ke,{children:"输入品牌角色和品牌名，AI将为您生成专属的品牌emoji"})]}),e.jsx(z,{className:"space-y-6",children:e.jsx(gs,{})})]})})]})})})};export{vs as default};
