import{j as e}from"./ui-core-BoM6Gtru.js";import{r as s}from"./router-CDHmMMQ-.js";import{g as a}from"./creemClientService-DNWMJNoV.js";import{C as t,a as l,b as r,e as i,B as c}from"./pages-home-B-YLcn0z.js";import{B as n}from"./pages-adapt-CSkmXLuc.js";import{ad as x,n as d,o as m,az as o}from"./utils-Ck01-_Du.js";const h=({size:s=24,className:a="text-blue-500"})=>e.jsxs("svg",{viewBox:"0 0 1024 1024",className:a,style:{width:s,height:s},fill:"currentColor",children:[e.jsx("rect",{x:"128",y:"128",width:"768",height:"768",rx:"128",fill:"#1677FF"}),e.jsx("text",{x:"512",y:"580",textAnchor:"middle",fill:"white",fontSize:"320",fontWeight:"bold",fontFamily:"Arial, sans-serif",children:"支"})]});function j({priceId:j,customerEmail:u,title:b="使用支付宝扫码付款",showPrice:f=!0,onRefresh:N}){const[p,g]=s.useState(""),[w,y]=s.useState(null),[v,z]=s.useState(!0),[F,C]=s.useState(null),[S,A]=s.useState(!1),B=async()=>{try{z(!0),C(null);const e=await a(j,u);if(!e.success)throw new Error("二维码生成失败");g(e.qrCodeDataURL),y(e.price)}catch(e){C((null==e?void 0:e.message)||"二维码生成失败"),g(""),y(null)}finally{z(!1)}},E=async()=>{A(!0),await B(),A(!1),null==N||N()};return s.useEffect(()=>{j&&B()},[j,u]),v?e.jsxs(t,{className:"w-full max-w-sm mx-auto",children:[e.jsx(l,{children:e.jsxs(r,{className:"text-center flex items-center justify-center gap-2",children:[e.jsx(h,{size:24}),b]})}),e.jsx(i,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(x,{className:"h-6 w-6 animate-spin text-blue-500"}),e.jsx("span",{children:"正在生成二维码..."})]})})]}):F?e.jsxs(t,{className:"w-full max-w-sm mx-auto border-red-200",children:[e.jsx(l,{children:e.jsxs(r,{className:"text-center text-red-600 flex items-center justify-center gap-2",children:[e.jsx(h,{size:24,className:"text-red-500"}),b]})}),e.jsx(i,{className:"text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-red-600 text-sm",children:F}),e.jsx(c,{onClick:E,variant:"outline",size:"sm",disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-4 w-4 mr-2 animate-spin"}),"刷新中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"重新生成"]})})]})})]}):e.jsxs(t,{className:"w-full max-w-sm mx-auto border-blue-100 bg-gradient-to-br from-blue-50 to-white",children:[e.jsx(l,{className:"pb-4",children:e.jsxs(r,{className:"text-center flex items-center justify-center gap-2",children:[e.jsx(h,{size:32}),e.jsx("span",{className:"text-blue-900",children:b})]})}),e.jsxs(i,{className:"text-center space-y-4",children:[f&&null!==w&&e.jsx("div",{className:"space-y-2",children:e.jsxs(n,{variant:"outline",className:"text-xl px-6 py-3 bg-blue-50 border-blue-200 text-blue-700 font-semibold",children:["¥",w.toFixed(2)]})}),p&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:p,alt:"支付宝二维码",className:"border-4 border-blue-200 rounded-xl shadow-lg",style:{width:220,height:220}}),f&&null!==w&&e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"bg-white bg-opacity-95 rounded-lg px-3 py-2 shadow-md border border-blue-200",children:e.jsxs("div",{className:"text-blue-600 font-bold text-lg",children:["¥",w.toFixed(2)]})})}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("div",{className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md border border-blue-200",children:e.jsx(h,{size:20})})})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"安全支付"})]}),e.jsx("p",{className:"text-xs text-blue-600 leading-relaxed",children:"扫码后会跳转到Creem安全支付页，请放心支付"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"使用手机支付宝扫码"})]}),e.jsx(c,{onClick:E,variant:"outline",size:"sm",disabled:S,className:"border-blue-200 text-blue-600 hover:bg-blue-50",children:S?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-4 w-4 mr-2 animate-spin"}),"刷新中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"刷新二维码"]})})]})]})]})}export{j as A};
