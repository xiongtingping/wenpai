import{r as e,j as i}from"./index-CYvVoP-H.js";function r(){const[r,d]=e.useState(""),[t,n]=e.useState(null),[s,o]=e.useState(!1),[l,a]=e.useState(null),[p,x]=e.useState(!1),[c,h]=e.useState("页面已加载"),f=async(e,i)=>{o(!0),a(null),h(`开始测试 ${i}...`);try{const r=await fetch("http://localhost:8888/.netlify/functions/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({priceId:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const t=await r.json();if(!t.success)throw new Error("二维码生成失败");d(t.qrCodeDataURL),n(t.price),h(`${i} 二维码生成成功`)}catch(r){a((null==r?void 0:r.message)||"二维码生成失败"),d(""),n(null),h(`错误: ${(null==r?void 0:r.message)||"二维码生成失败"}`)}finally{o(!1)}},g=async()=>{x(!0),await f("prod_3nJOuQeVStqkp6JaDcrKHf","专业版月付"),x(!1)};return e.useEffect(()=>{h("页面已加载，等待用户操作")},[]),i.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"24px"},children:[i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("h1",{style:{fontSize:"2rem",fontWeight:"bold",textAlign:"center",marginBottom:"8px"},children:"支付二维码测试"}),i.jsx("p",{style:{textAlign:"center",color:"#666"},children:"测试后端生成的支付二维码显示功能"})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px",backgroundColor:"#f9fafb"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"调试信息"}),i.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#666"},children:c})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"测试配置"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[{name:"专业版月付",priceId:"prod_3nJOuQeVStqkp6JaDcrKHf"},{name:"专业版年付",priceId:"prod_5qBlDTLpD3h9gvOZFd4Rgu"},{name:"高级版月付",priceId:"prod_4HYBfvrcbXYnbxjlswMj28"},{name:"高级版年付",priceId:"prod_6OfIoVnRg2pXsuYceVKOYk"}].map(e=>i.jsxs("button",{onClick:()=>f(e.priceId,e.name),disabled:s,style:{padding:"16px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:s?"#f3f4f6":"#ffffff",cursor:s?"not-allowed":"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{fontWeight:"500"},children:e.name}),i.jsx("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.priceId})]},e.priceId))})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"bold"},children:"支付二维码"}),i.jsx("button",{onClick:g,disabled:p||s,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#ffffff",cursor:p||s?"not-allowed":"pointer",fontSize:"0.875rem"},children:p?"刷新中...":"刷新"})]}),i.jsx("div",{style:{textAlign:"center"},children:s?i.jsxs("div",{style:{padding:"32px"},children:[i.jsx("div",{style:{display:"inline-block",width:"24px",height:"24px",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),i.jsx("p",{style:{margin:"8px 0 0 0"},children:"正在生成二维码..."})]}):l?i.jsxs("div",{style:{padding:"32px"},children:[i.jsx("div",{style:{color:"#dc2626",marginBottom:"16px"},children:l}),i.jsx("button",{onClick:g,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#ffffff",cursor:"pointer"},children:"重试"})]}):r?i.jsxs("div",{children:[null!==t&&i.jsx("div",{style:{marginBottom:"16px"},children:i.jsxs("span",{style:{display:"inline-block",padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"1.125rem",fontWeight:"500"},children:["¥",t.toFixed(2)]})}),i.jsx("div",{style:{marginBottom:"16px"},children:i.jsx("img",{src:r,alt:"支付宝二维码",style:{border:"2px solid #e5e7eb",borderRadius:"8px",width:"300px",height:"300px"}})}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:i.jsx("p",{style:{margin:"0 0 4px 0"},children:"扫码后会跳转到Creem安全支付页，请放心支付"})})]}):i.jsx("div",{style:{padding:"32px",color:"#6b7280"},children:"请选择测试配置生成二维码"})})]}),r&&i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"调试信息"}),i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("strong",{children:"二维码数据长度:"})," ",r.length," 字符"]}),i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("strong",{children:"价格:"})," ",null!==t?`¥${t.toFixed(2)}`:"未获取"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"二维码类型:"})," ",r.startsWith("data:image/png")?"PNG":"未知"]})]})]}),i.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})}export{r as default};
