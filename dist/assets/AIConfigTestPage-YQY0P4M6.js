import{r as s,j as e,B as t}from"./index-Cu70HESd.js";import{C as a,a as r,b as i,c as l,d as c}from"./card-C_loCoFD.js";import{B as n}from"./badge-CIOmyheZ.js";import{A as d,a as m}from"./alert-uwy97Dud.js";import{c as x}from"./localApiProxy-N9xYX3kf.js";import o from"./aiService-C8Za63DW.js";import{C as h}from"./circle-alert-BGkMlRh1.js";import{L as j}from"./loader-circle-DkAs3sDA.js";import{I as u}from"./info-BSqS0fyx.js";import{C as g}from"./circle-x-Wo4NID7o.js";import{C as p}from"./circle-check-big-P3EWXA1B.js";const f=()=>{const[f,y]=s.useState({netlify:{status:"idle"},dev:{status:"idle"}}),[N,v]=s.useState(!1),b=async()=>{y(s=>({...s,netlify:{status:"testing"}}));try{const s=await x([{role:"user",content:'请回复"测试成功"三个字'}],"gpt-4o",.1,50);s.success?y(s=>({...s,netlify:{status:"success",message:"Netlify Functions API 配置正确"}})):y(e=>({...e,netlify:{status:"error",message:s.error||"未知错误"}}))}catch(s){y(e=>({...e,netlify:{status:"error",message:s instanceof Error?s.message:"测试失败"}}))}},A=async()=>{y(s=>({...s,dev:{status:"testing"}}));try{const s=await o.generateText({messages:[{role:"user",content:"请用一句话介绍一下你自己。"}],provider:"openai"});s.success?y(s=>({...s,dev:{status:"success",message:"开发环境 API 配置正确"}})):y(e=>({...e,dev:{status:"error",message:s.error||"未知错误"}}))}catch(s){y(e=>({...e,dev:{status:"error",message:s instanceof Error?s.message:"测试失败"}}))}},I=s=>{switch(s){case"testing":return e.jsx(j,{className:"h-4 w-4 animate-spin"});case"success":return e.jsx(p,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(g,{className:"h-4 w-4 text-red-500"});default:return e.jsx(u,{className:"h-4 w-4 text-gray-500"})}},P=s=>{switch(s){case"success":return"bg-green-100 text-green-800";case"error":return"bg-red-100 text-red-800";case"testing":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"🤖 AI API 配置测试"}),e.jsx("p",{className:"text-gray-600",children:"测试您的 AI API 配置是否正确，确保所有 AI 功能正常工作。"})]}),e.jsxs(d,{className:"mb-6",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsxs(m,{children:[e.jsx("strong",{children:"重要提示："})," 请确保您已配置正确的 API 密钥。如果测试失败，请参考"," ",e.jsx("a",{href:"/ai-api-setup",className:"text-blue-600 hover:underline",children:"AI_API_SETUP.md"})," 进行配置。"]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[I(f.netlify.status),"Netlify Functions API"]}),e.jsx(l,{children:"测试生产环境的 Netlify Functions API 配置"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(n,{className:P(f.netlify.status),children:["idle"===f.netlify.status&&"未测试","testing"===f.netlify.status&&"测试中...","success"===f.netlify.status&&"配置正确","error"===f.netlify.status&&"配置错误"]}),f.netlify.message&&e.jsx("p",{className:"text-sm text-gray-600",children:f.netlify.message}),e.jsx(t,{onClick:b,disabled:"testing"===f.netlify.status,variant:"outline",className:"w-full",children:"testing"===f.netlify.status?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"测试中..."]}):"测试 Netlify Functions"})]})})]}),e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[I(f.dev.status),"开发环境 API"]}),e.jsx(l,{children:"测试开发环境的直接 API 调用配置"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(n,{className:P(f.dev.status),children:["idle"===f.dev.status&&"未测试","testing"===f.dev.status&&"测试中...","success"===f.dev.status&&"配置正确","error"===f.dev.status&&"配置错误"]}),f.dev.message&&e.jsx("p",{className:"text-sm text-gray-600",children:f.dev.message}),e.jsx(t,{onClick:A,disabled:"testing"===f.dev.status,variant:"outline",className:"w-full",children:"testing"===f.dev.status?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"测试中..."]}):"测试开发环境 API"})]})})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx(t,{onClick:async()=>{v(!0),await Promise.all([b(),A()]),v(!1)},disabled:N,size:"lg",className:"px-8",children:N?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-5 w-5 animate-spin"}),"运行所有测试..."]}):"运行所有测试"})}),e.jsxs(a,{className:"mt-8",children:[e.jsx(r,{children:e.jsx(i,{children:"📋 配置说明"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"开发环境配置："}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsxs("li",{children:["编辑 ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"src/api/devApiProxy.ts"})," 文件"]}),e.jsxs("li",{children:["或创建 ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:".env.local"})," 文件"]}),e.jsxs("li",{children:["运行 ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"./setup-ai-api.sh"})," 快速配置"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"生产环境配置："}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:"在 Netlify 控制台设置环境变量"}),e.jsxs("li",{children:["确保 ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"netlify/functions/api.js"})," 正确部署"]}),e.jsx("li",{children:"验证 Netlify Functions 是否正常工作"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"获取 API 密钥："}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:[e.jsx("li",{children:e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"OpenAI API Keys"})}),e.jsx("li",{children:e.jsx("a",{href:"https://platform.deepseek.com/api_keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"DeepSeek API Keys"})}),e.jsx("li",{children:e.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Gemini API Keys"})})]})]})]})})]})]})};export{f as default};
