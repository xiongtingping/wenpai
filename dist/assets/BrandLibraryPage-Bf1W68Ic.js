var e,t,n,i,r,a,s,o,c,l,h,d,u,f,p,g,m,b,v,y,w,x,_,T,D,E,A,k,S,C,U,F,I,R,N,M,O,P,L,W,B,j,z,H,V,G,q,X,K,Y,Z,J,Q,ee,te,ne,ie,re,ae,se,oe,ce,le,he,de,ue,fe,pe,ge,me,be,ve,ye,we,xe,_e,Te,De,Ee,Ae,ke,Se,Ce,Ue,Fe,Ie,Re,Ne,Me,Oe,Pe,Le,We,Be,je,ze,He,Ve,Ge,$e,qe,Xe,Ke,Ye,Ze,Je,Qe,et,tt,nt,it,rt,at,st,ot,ct,lt,ht,dt,ut,ft,pt,gt,mt,bt,vt,yt,wt,xt,_t,Tt,Dt,Et,At,kt,St,Ct,Ut,Ft,It,Rt,Nt,Mt,Ot,Pt,Lt,Wt,Bt,jt,zt,Ht,Vt,Gt,$t,qt,Xt,Kt,Yt,Zt,Jt,Qt,en,tn,nn,rn,an,sn,on,cn,ln,hn,dn,un,fn,pn,gn,mn,bn,vn,yn,wn,xn,_n,Tn,Dn,En,An,kn,Sn,Cn,Un,Fn,In,Rn,Nn,Mn,On,Pn,Ln,Wn,Bn,jn,zn,Hn,Vn,Gn,$n,qn,Xn,Kn,Yn,Zn,Jn,Qn,ei,ti,ni,ii,ri,ai,si,oi,ci,li,hi,di,ui,fi,pi,gi,mi,bi,vi,yi,wi,xi,_i,Ti,Di,Ei,Ai,ki,Si,Ci,Ui,Fi,Ii,Ri,Ni,Mi,Oi,Pi,Li,Wi,Bi,ji,zi,Hi,Vi,Gi,$i,qi,Xi,Ki,Yi,Zi,Ji,Qi,er,tr,nr,ir,rr,ar,sr,or,cr,lr,hr,dr,ur,fr,pr,gr,mr,br,vr,yr,wr,xr,_r,Tr,Dr,Er,Ar,kr,Sr,Cr,Ur,Fr,Ir,Rr,Nr,Mr,Or,Pr,Lr,Wr,Br,jr,zr,Hr,Vr,Gr,$r,qr,Xr,Kr,Yr,Zr,Jr,Qr,ea,ta,na,ia,ra,aa,sa,oa,ca,la,ha,da,ua,fa,pa,ga,ma,ba,va,ya,wa,xa,_a,Ta,Da,Ea,Aa,ka,Sa,Ca,Ua,Fa,Ia,Ra,Na,Ma,Oa,Pa,La,Wa,Ba,ja,za,Ha,Va,Ga,$a,qa,Xa,Ka,Ya,Za,Ja,Qa,es,ts,ns,is,rs,as,ss,os,cs,ls,hs,ds,us,fs,ps,gs,ms,bs,vs,ys,ws,xs,_s,Ts,Ds,Es,As,ks,Ss,Cs,Us,Fs,Is,Rs,Ns,Ms,Os,Ps,Ls,Ws,Bs,js,zs,Hs,Vs,Gs,$s,qs,Xs,Ks,Ys,Zs,Js,Qs,eo,to,no,io,ro,ao,so,oo,co,lo,ho,uo,fo,po,go,mo,bo,vo,yo,wo,xo,_o,To,Do,Eo,Ao,ko,So,Co,Uo,Fo,Io,Ro,No,Mo,Oo,Po,Lo,Wo,Bo,jo,zo,Ho,Vo,Go,$o,qo,Xo,Ko,Yo,Zo,Jo,Qo,ec,tc,nc,ic,rc,ac,sc,oc,cc,lc,hc,dc,uc,fc,pc,gc,mc,bc,vc,yc,wc,xc,_c,Tc,Dc,Ec,Ac,kc,Sc,Cc,Uc,Fc,Ic,Rc,Nc,Mc,Oc,Pc,Lc,Wc,Bc,jc,zc,Hc,Vc,Gc,$c,qc,Xc,Kc,Yc,Zc,Jc,Qc,el,tl,nl,il,rl,al,sl,ol,cl,ll,hl,dl,ul,fl,pl,gl,ml,bl,vl,yl,wl,xl,_l,Tl,Dl,El,Al,kl,Sl,Cl,Ul,Fl,Il,Rl,Nl,Ml,Ol,Pl,Ll,Wl,Bl,jl,zl,Hl,Vl,Gl,$l,ql,Xl,Kl,Yl,Zl,Jl,Ql,eh,th,nh,ih,rh=Object.defineProperty,ah=e=>{throw TypeError(e)},sh=(e,t,n)=>((e,t,n)=>t in e?rh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),oh=(e,t,n)=>t.has(e)||ah("Cannot "+n),ch=(e,t,n)=>(oh(e,t,"read from private field"),n?n.call(e):t.get(e)),lh=(e,t,n)=>t.has(e)?ah("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),hh=(e,t,n,i)=>(oh(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),dh=(e,t,n)=>(oh(e,t,"access private method"),n),uh=(e,t,n,i)=>({set _(i){hh(e,t,i,n)},get _(){return ch(e,t,i)}});import{c as fh,r as ph,j as gh,h as mh,w as bh,x as vh,P as yh,R as wh,y as xh,O as _h,z as Th,A as Dh,b as Eh,D as Ah,E as kh,G as Sh,H as Ch,t as Uh,k as Fh,F as Ih,T as Rh,B as Nh,C as Mh,X as Oh,I as Ph,J as Lh,K as Wh,N as Bh}from"./index-CZg_0vaA.js";import{C as jh,d as zh,a as Hh,b as Vh,c as Gh}from"./card-WrqbDkJy.js";import{I as $h,T as qh}from"./input-CZ5IVbsF.js";import{L as Xh}from"./label-C3olWSKx.js";import{T as Kh}from"./textarea-DEKtSbII.js";import{T as Yh,a as Zh,b as Jh,c as Qh,S as ed,d as td,e as nd,f as id,g as rd,F as ad,D as sd,h as od,i as cd,j as ld,k as hd,l as dd}from"./select-BO1vNXcf.js";import{U as ud,B as fd}from"./badge-Cg_l4nEW.js";import{M as pd,H as gd,S as md,P as bd,a as vd,b as yd}from"./popover-D4U3qpnf.js";import{S as wd,a as xd,B as _d,F as Td,L as Dd}from"./search-DLHhG8Zs.js";import{P as Ed}from"./PageNavigation-D6S86xqr.js";import{T as Ad}from"./target-CO6W9F3R.js";import{H as kd,A as Sd}from"./heart-gT3bsbBN.js";import{B as Cd}from"./book-open-CZOBdEgM.js";import{Z as Ud}from"./zap-oQG61wBn.js";import{P as Fd}from"./palette-CTMs4d6s.js";import{T as Id,S as Rd}from"./tag-gWAp2LQ4.js";import{L as Nd}from"./lightbulb-DuqPBAbV.js";import{C as Md}from"./clock-BozFoEYr.js";import{P as Od}from"./plus-CDKFTIIo.js";import"./index-PI-h6tk7.js";
/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=fh("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Ld=fh("file-image",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),Wd=fh("file-up",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]),Bd=fh("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),jd=fh("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),zd=fh("users-round",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),Hd=bh("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Vd=ph.forwardRef(({className:e,variant:t,...n},i)=>gh.jsx("div",{ref:i,role:"alert",className:mh(Hd({variant:t}),e),...n}));Vd.displayName="Alert",ph.forwardRef(({className:e,...t},n)=>gh.jsx("h5",{ref:n,className:mh("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";const Gd=ph.forwardRef(({className:e,...t},n)=>gh.jsx("div",{ref:n,className:mh("text-sm [&_p]:leading-relaxed",e),...t}));Gd.displayName="AlertDescription";var $d=.999,qd=/[\\\/_+.#"@\[\(\{&]/,Xd=/[\\\/_+.#"@\[\(\{&]/g,Kd=/[\s-]/,Yd=/[\s-]/g;function Zd(e,t,n,i,r,a,s){if(a===t.length)return r===e.length?1:.99;var o=`${r},${a}`;if(void 0!==s[o])return s[o];for(var c,l,h,d,u=i.charAt(a),f=n.indexOf(u,r),p=0;f>=0;)(c=Zd(e,t,n,i,f+1,a+1,s))>p&&(f===r?c*=1:qd.test(e.charAt(f-1))?(c*=.8,(h=e.slice(r,f-1).match(Xd))&&r>0&&(c*=Math.pow($d,h.length))):Kd.test(e.charAt(f-1))?(c*=.9,(d=e.slice(r,f-1).match(Yd))&&r>0&&(c*=Math.pow($d,d.length))):(c*=.17,r>0&&(c*=Math.pow($d,f-r))),e.charAt(f)!==t.charAt(a)&&(c*=.9999)),(c<.1&&n.charAt(f-1)===i.charAt(a+1)||i.charAt(a+1)===i.charAt(a)&&n.charAt(f-1)!==i.charAt(a))&&.1*(l=Zd(e,t,n,i,f+1,a+2,s))>c&&(c=.1*l),c>p&&(p=c),f=n.indexOf(u,f+1);return s[o]=p,p}function Jd(e){return e.toLowerCase().replace(Yd," ")}function Qd(e,t,n){return Zd(e=n&&n.length>0?e+" "+n.join(" "):e,t,Jd(e),Jd(t),0,0,{})}var eu='[cmdk-group=""]',tu='[cmdk-group-items=""]',nu='[cmdk-item=""]',iu=`${nu}:not([aria-disabled="true"])`,ru="cmdk-item-select",au="data-value",su=(e,t,n)=>Qd(e,t,n),ou=ph.createContext(void 0),cu=()=>ph.useContext(ou),lu=ph.createContext(void 0),hu=()=>ph.useContext(lu),du=ph.createContext(void 0),uu=ph.forwardRef((e,t)=>{let n=Au(()=>{var t,n;return{search:"",value:null!=(n=null!=(t=e.value)?t:e.defaultValue)?n:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),i=Au(()=>new Set),r=Au(()=>new Map),a=Au(()=>new Map),s=Au(()=>new Set),o=Du(e),{label:c,children:l,value:h,onValueChange:d,filter:u,shouldFilter:f,loop:p,disablePointerSelection:g=!1,vimBindings:m=!0,...b}=e,v=vh(),y=vh(),w=vh(),x=ph.useRef(null),_=Cu();Eu(()=>{if(void 0!==h){let e=h.trim();n.current.value=e,T.emit()}},[h]),Eu(()=>{_(6,C)},[]);let T=ph.useMemo(()=>({subscribe:e=>(s.current.add(e),()=>s.current.delete(e)),snapshot:()=>n.current,setState:(e,t,i)=>{var r,a,s,c;if(!Object.is(n.current[e],t)){if(n.current[e]=t,"search"===e)S(),A(),_(1,k);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(w);e?e.focus():null==(r=document.getElementById(v))||r.focus()}if(_(7,()=>{var e;n.current.selectedItemId=null==(e=U())?void 0:e.id,T.emit()}),i||_(5,C),void 0!==(null==(a=o.current)?void 0:a.value)){let e=null!=t?t:"";return void(null==(c=(s=o.current).onValueChange)||c.call(s,e))}}T.emit()}},emit:()=>{s.current.forEach(e=>e())}}),[]),D=ph.useMemo(()=>({value:(e,t,i)=>{var r;t!==(null==(r=a.current.get(e))?void 0:r.value)&&(a.current.set(e,{value:t,keywords:i}),n.current.filtered.items.set(e,E(t,i)),_(2,()=>{A(),T.emit()}))},item:(e,t)=>(i.current.add(e),t&&(r.current.has(t)?r.current.get(t).add(e):r.current.set(t,new Set([e]))),_(3,()=>{S(),A(),n.current.value||k(),T.emit()}),()=>{a.current.delete(e),i.current.delete(e),n.current.filtered.items.delete(e);let t=U();_(4,()=>{S(),(null==t?void 0:t.getAttribute("id"))===e&&k(),T.emit()})}),group:e=>(r.current.has(e)||r.current.set(e,new Set),()=>{a.current.delete(e),r.current.delete(e)}),filter:()=>o.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:v,inputId:w,labelId:y,listInnerRef:x}),[]);function E(e,t){var i,r;let a=null!=(r=null==(i=o.current)?void 0:i.filter)?r:su;return e?a(e,n.current.search,t):0}function A(){if(!n.current.search||!1===o.current.shouldFilter)return;let e=n.current.filtered.items,t=[];n.current.filtered.groups.forEach(n=>{let i=r.current.get(n),a=0;i.forEach(t=>{let n=e.get(t);a=Math.max(n,a)}),t.push([n,a])});let i=x.current;F().sort((t,n)=>{var i,r;let a=t.getAttribute("id"),s=n.getAttribute("id");return(null!=(i=e.get(s))?i:0)-(null!=(r=e.get(a))?r:0)}).forEach(e=>{let t=e.closest(tu);t?t.appendChild(e.parentElement===t?e:e.closest(`${tu} > *`)):i.appendChild(e.parentElement===i?e:e.closest(`${tu} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let n=null==(t=x.current)?void 0:t.querySelector(`${eu}[${au}="${encodeURIComponent(e[0])}"]`);null==n||n.parentElement.appendChild(n)})}function k(){let e=F().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(au);T.setState("value",t||void 0)}function S(){var e,t,s,c;if(!n.current.search||!1===o.current.shouldFilter)return void(n.current.filtered.count=i.current.size);n.current.filtered.groups=new Set;let l=0;for(let r of i.current){let i=E(null!=(t=null==(e=a.current.get(r))?void 0:e.value)?t:"",null!=(c=null==(s=a.current.get(r))?void 0:s.keywords)?c:[]);n.current.filtered.items.set(r,i),i>0&&l++}for(let[i,a]of r.current)for(let e of a)if(n.current.filtered.items.get(e)>0){n.current.filtered.groups.add(i);break}n.current.filtered.count=l}function C(){var e,t,n;let i=U();i&&((null==(e=i.parentElement)?void 0:e.firstChild)===i&&(null==(n=null==(t=i.closest(eu))?void 0:t.querySelector('[cmdk-group-heading=""]'))||n.scrollIntoView({block:"nearest"})),i.scrollIntoView({block:"nearest"}))}function U(){var e;return null==(e=x.current)?void 0:e.querySelector(`${nu}[aria-selected="true"]`)}function F(){var e;return Array.from((null==(e=x.current)?void 0:e.querySelectorAll(iu))||[])}function I(e){let t=F()[e];t&&T.setState("value",t.getAttribute(au))}function R(e){var t;let n=U(),i=F(),r=i.findIndex(e=>e===n),a=i[r+e];null!=(t=o.current)&&t.loop&&(a=r+e<0?i[i.length-1]:r+e===i.length?i[0]:i[r+e]),a&&T.setState("value",a.getAttribute(au))}function N(e){let t,n=U(),i=null==n?void 0:n.closest(eu);for(;i&&!t;)i=e>0?_u(i,eu):Tu(i,eu),t=null==i?void 0:i.querySelector(iu);t?T.setState("value",t.getAttribute(au)):R(e)}let M=()=>I(F().length-1),O=e=>{e.preventDefault(),e.metaKey?M():e.altKey?N(1):R(1)},P=e=>{e.preventDefault(),e.metaKey?I(0):e.altKey?N(-1):R(-1)};return ph.createElement(yh.div,{ref:t,tabIndex:-1,...b,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=b.onKeyDown)||t.call(b,e);let n=e.nativeEvent.isComposing||229===e.keyCode;if(!e.defaultPrevented&&!n)switch(e.key){case"n":case"j":m&&e.ctrlKey&&O(e);break;case"ArrowDown":O(e);break;case"p":case"k":m&&e.ctrlKey&&P(e);break;case"ArrowUp":P(e);break;case"Home":e.preventDefault(),I(0);break;case"End":e.preventDefault(),M();break;case"Enter":{e.preventDefault();let t=U();if(t){let e=new Event(ru);t.dispatchEvent(e)}}}}},ph.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:Fu},c),Uu(e,e=>ph.createElement(lu.Provider,{value:T},ph.createElement(ou.Provider,{value:D},e))))}),fu=ph.forwardRef((e,t)=>{var n,i;let r=vh(),a=ph.useRef(null),s=ph.useContext(du),o=cu(),c=Du(e),l=null!=(i=null==(n=c.current)?void 0:n.forceMount)?i:null==s?void 0:s.forceMount;Eu(()=>{if(!l)return o.item(r,null==s?void 0:s.id)},[l]);let h=Su(r,a,[e.value,e.children,a],e.keywords),d=hu(),u=ku(e=>e.value&&e.value===h.current),f=ku(e=>!(!l&&!1!==o.filter())||!e.search||e.filtered.items.get(r)>0);function p(){var e,t;g(),null==(t=(e=c.current).onSelect)||t.call(e,h.current)}function g(){d.setState("value",h.current,!0)}if(ph.useEffect(()=>{let t=a.current;if(t&&!e.disabled)return t.addEventListener(ru,p),()=>t.removeEventListener(ru,p)},[f,e.onSelect,e.disabled]),!f)return null;let{disabled:m,value:b,onSelect:v,forceMount:y,keywords:w,...x}=e;return ph.createElement(yh.div,{ref:Dh(a,t),...x,id:r,"cmdk-item":"",role:"option","aria-disabled":!!m,"aria-selected":!!u,"data-disabled":!!m,"data-selected":!!u,onPointerMove:m||o.getDisablePointerSelection()?void 0:g,onClick:m?void 0:p},e.children)}),pu=ph.forwardRef((e,t)=>{let{heading:n,children:i,forceMount:r,...a}=e,s=vh(),o=ph.useRef(null),c=ph.useRef(null),l=vh(),h=cu(),d=ku(e=>!(!r&&!1!==h.filter())||!e.search||e.filtered.groups.has(s));Eu(()=>h.group(s),[]),Su(s,o,[e.value,e.heading,c]);let u=ph.useMemo(()=>({id:s,forceMount:r}),[r]);return ph.createElement(yh.div,{ref:Dh(o,t),...a,"cmdk-group":"",role:"presentation",hidden:!d||void 0},n&&ph.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:l},n),Uu(e,e=>ph.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?l:void 0},ph.createElement(du.Provider,{value:u},e))))}),gu=ph.forwardRef((e,t)=>{let{alwaysRender:n,...i}=e,r=ph.useRef(null),a=ku(e=>!e.search);return n||a?ph.createElement(yh.div,{ref:Dh(r,t),...i,"cmdk-separator":"",role:"separator"}):null}),mu=ph.forwardRef((e,t)=>{let{onValueChange:n,...i}=e,r=null!=e.value,a=hu(),s=ku(e=>e.search),o=ku(e=>e.selectedItemId),c=cu();return ph.useEffect(()=>{null!=e.value&&a.setState("search",e.value)},[e.value]),ph.createElement(yh.input,{ref:t,...i,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":o,id:c.inputId,type:"text",value:r?e.value:s,onChange:e=>{r||a.setState("search",e.target.value),null==n||n(e.target.value)}})}),bu=ph.forwardRef((e,t)=>{let{children:n,label:i="Suggestions",...r}=e,a=ph.useRef(null),s=ph.useRef(null),o=ku(e=>e.selectedItemId),c=cu();return ph.useEffect(()=>{if(s.current&&a.current){let e,t=s.current,n=a.current,i=new ResizeObserver(()=>{e=requestAnimationFrame(()=>{let e=t.offsetHeight;n.style.setProperty("--cmdk-list-height",e.toFixed(1)+"px")})});return i.observe(t),()=>{cancelAnimationFrame(e),i.unobserve(t)}}},[]),ph.createElement(yh.div,{ref:Dh(a,t),...r,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":i,id:c.listId},Uu(e,e=>ph.createElement("div",{ref:Dh(s,c.listInnerRef),"cmdk-list-sizer":""},e)))}),vu=ph.forwardRef((e,t)=>{let{open:n,onOpenChange:i,overlayClassName:r,contentClassName:a,container:s,...o}=e;return ph.createElement(wh,{open:n,onOpenChange:i},ph.createElement(xh,{container:s},ph.createElement(_h,{"cmdk-overlay":"",className:r}),ph.createElement(Th,{"aria-label":e.label,"cmdk-dialog":"",className:a},ph.createElement(uu,{ref:t,...o}))))}),yu=ph.forwardRef((e,t)=>ku(e=>0===e.filtered.count)?ph.createElement(yh.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),wu=ph.forwardRef((e,t)=>{let{progress:n,children:i,label:r="Loading...",...a}=e;return ph.createElement(yh.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":r},Uu(e,e=>ph.createElement("div",{"aria-hidden":!0},e)))}),xu=Object.assign(uu,{List:bu,Item:fu,Input:mu,Group:pu,Separator:gu,Dialog:vu,Empty:yu,Loading:wu});function _u(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Tu(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function Du(e){let t=ph.useRef(e);return Eu(()=>{t.current=e}),t}var Eu="undefined"==typeof window?ph.useEffect:ph.useLayoutEffect;function Au(e){let t=ph.useRef();return void 0===t.current&&(t.current=e()),t}function ku(e){let t=hu(),n=()=>e(t.snapshot());return ph.useSyncExternalStore(t.subscribe,n,n)}function Su(e,t,n,i=[]){let r=ph.useRef(),a=cu();return Eu(()=>{var s;let o=(()=>{var e;for(let t of n){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():r.current}})(),c=i.map(e=>e.trim());a.value(e,o,c),null==(s=t.current)||s.setAttribute(au,o),r.current=o}),r}var Cu=()=>{let[e,t]=ph.useState(),n=Au(()=>new Map);return Eu(()=>{n.current.forEach(e=>e()),n.current=new Map},[e]),(e,i)=>{n.current.set(e,i),t({})}};function Uu({asChild:e,children:t},n){return e&&ph.isValidElement(t)?ph.cloneElement(function(e){let t=e.type;return"function"==typeof t?t(e.props):"render"in t?t.render(e.props):e}(t),{ref:t.ref},n(t.props.children)):n(t)}var Fu={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Iu=ph.forwardRef(({className:e,...t},n)=>gh.jsx(xu,{ref:n,className:mh("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));Iu.displayName=xu.displayName;const Ru=ph.forwardRef(({className:e,...t},n)=>gh.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[gh.jsx(wd,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),gh.jsx(xu.Input,{ref:n,className:mh("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));Ru.displayName=xu.Input.displayName;const Nu=ph.forwardRef(({className:e,...t},n)=>gh.jsx(xu.List,{ref:n,className:mh("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));Nu.displayName=xu.List.displayName;const Mu=ph.forwardRef((e,t)=>gh.jsx(xu.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));Mu.displayName=xu.Empty.displayName;const Ou=ph.forwardRef(({className:e,...t},n)=>gh.jsx(xu.Group,{ref:n,className:mh("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Ou.displayName=xu.Group.displayName,ph.forwardRef(({className:e,...t},n)=>gh.jsx(xu.Separator,{ref:n,className:mh("-mx-1 h-px bg-border",e),...t})).displayName=xu.Separator.displayName;const Pu=ph.forwardRef(({className:e,...t},n)=>gh.jsx(xu.Item,{ref:n,className:mh("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...t}));Pu.displayName=xu.Item.displayName;var Lu="Progress",[Wu,Bu]=Eh(Lu),[ju,zu]=Wu(Lu),Hu=ph.forwardRef((e,t)=>{const{__scopeProgress:n,value:i=null,max:r,getValueLabel:a=$u,...s}=e;(r||0===r)&&Ku(r);const o=Ku(r)?r:100;null!==i&&Yu(i,o);const c=Yu(i,o)?i:null,l=Xu(c)?a(c,o):void 0;return gh.jsx(ju,{scope:n,value:c,max:o,children:gh.jsx(yh.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Xu(c)?c:void 0,"aria-valuetext":l,role:"progressbar","data-state":qu(c,o),"data-value":c??void 0,"data-max":o,...s,ref:t})})});Hu.displayName=Lu;var Vu="ProgressIndicator",Gu=ph.forwardRef((e,t)=>{const{__scopeProgress:n,...i}=e,r=zu(Vu,n);return gh.jsx(yh.div,{"data-state":qu(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...i,ref:t})});function $u(e,t){return`${Math.round(e/t*100)}%`}function qu(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function Xu(e){return"number"==typeof e}function Ku(e){return Xu(e)&&!isNaN(e)&&e>0}function Yu(e,t){return Xu(e)&&!isNaN(e)&&e<=t&&e>=0}Gu.displayName=Vu;var Zu=Hu,Ju=Gu;const Qu=ph.forwardRef(({className:e,value:t,...n},i)=>gh.jsx(Zu,{ref:i,className:mh("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:gh.jsx(Ju,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Qu.displayName=Zu.displayName;async function ef(e,t="gpt-4o",n=.7,i=1e3){try{const r=await fetch("/.netlify/functions/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"openai",action:"generate",messages:e,model:t,temperature:n,maxTokens:i})}),a=r.headers.get("content-type");if(!a||!a.includes("application/json"))throw await r.text(),new Error("Netlify Functions不可用，请确保已正确部署到生产环境");const s=await r.json();if(!r.ok)throw new Error(`AI服务调用失败: ${s.error||s.message||`HTTP ${r.status}`}`);return{success:!0,data:s}}catch(r){throw new Error(`AI服务连接失败: ${r instanceof Error?r.message:"未知错误"}`)}}const tf=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),nf=[.001,0,0,.001,0,0],rf=1.35,af={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},sf="pdfjs_internal_editor_",of={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},cf={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},lf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},hf={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},df={ERRORS:0,WARNINGS:1,INFOS:5},uf={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94};let ff=df.WARNINGS;function pf(){return ff}function gf(e){}function mf(e){throw new Error(e)}function bf(e,t){e||mf(t)}function vf(e,t=null,n=null){if(!e)return null;if(n&&"string"==typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null==t?void 0:t.length)>=2&&(e=`http://${e}`)}if(n.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch{}}const i=t?URL.parse(e,t):URL.parse(e);return function(e){switch(null==e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i)?i:null}function yf(e,t,n=!1){const i=URL.parse(e);return i?(i.hash=t,i.href):n&&vf(e,"http://example.com")?e.split("#",1)[0]+""+(t?`#${t}`:""):""}function wf(e,t,n,i=!1){return Object.defineProperty(e,t,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const xf=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class _f extends xf{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Tf extends xf{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Df extends xf{constructor(e){super(e,"InvalidPDFException")}}class Ef extends xf{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class Af extends xf{constructor(e){super(e,"FormatError")}}class kf extends xf{constructor(e){super(e,"AbortException")}}function Sf(e){"object"==typeof e&&void 0!==(null==e?void 0:e.length)||mf("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const i=[];for(let r=0;r<t;r+=n){const a=Math.min(r+n,t),s=e.subarray(r,a);i.push(String.fromCharCode.apply(null,s))}return i.join("")}function Cf(e){"string"!=typeof e&&mf("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}class Uf{static get isLittleEndian(){return wf(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return wf(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return wf(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get isImageDecoderSupported(){return wf(this,"isImageDecoderSupported","undefined"!=typeof ImageDecoder)}static get platform(){const{platform:e,userAgent:t}=navigator;return wf(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return wf(this,"isCSSRoundSupported",null==(t=null==(e=globalThis.CSS)?void 0:e.supports)?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Ff=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class If{static makeHexColor(e,t,n){return`#${Ff[e]}${Ff[t]}${Ff[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,n=0){const i=e[n],r=e[n+1];e[n]=i*t[0]+r*t[2]+t[4],e[n+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],r=t[1],a=t[2],s=t[3],o=t[4],c=t[5];for(let l=0;l<6;l+=2){const t=e[n+l],h=e[n+l+1];e[n+l]=t*i+h*a+o,e[n+l+1]=t*r+h*s+c}}static applyInverseTransform(e,t){const n=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,n){const i=t[0],r=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=e[0],h=e[1],d=e[2],u=e[3];let f=i*l+o,p=f,g=i*d+o,m=g,b=s*h+c,v=b,y=s*u+c,w=y;if(0!==r||0!==a){const e=r*l,t=r*d,n=a*h,i=a*u;f+=n,m+=n,g+=i,p+=i,b+=e,w+=e,y+=t,v+=t}n[0]=Math.min(n[0],f,g,p,m),n[1]=Math.min(n[1],b,y,v,w),n[2]=Math.max(n[2],f,g,p,m),n[3]=Math.max(n[3],b,y,v,w)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],r=e[2],a=e[3],s=n**2+i**2,o=n*r+i*a,c=r**2+a**2,l=(s+c)/2,h=Math.sqrt(l**2-(s*c-o**2));t[0]=Math.sqrt(l+h||1),t[1]=Math.sqrt(l-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[n,r,i,a]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,r){r[0]=Math.min(r[0],e,n),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,n),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(t,i,r,a,s,o,c,l,h){h[0]=Math.min(h[0],t,c),h[1]=Math.min(h[1],i,l),h[2]=Math.max(h[2],t,c),h[3]=Math.max(h[3],i,l),dh(this,e,n).call(this,t,r,s,c,i,a,o,l,3*(3*(r-s)-t+c),6*(t-2*r+s),3*(r-t),h),dh(this,e,n).call(this,t,r,s,c,i,a,o,l,3*(3*(a-o)-i+l),6*(i-2*a+o),3*(a-i),h)}}e=new WeakSet,t=function(e,t,n,i,r,a,s,o,c,l){if(c<=0||c>=1)return;const h=1-c,d=c*c,u=d*c,f=h*(h*(h*e+3*c*t)+3*d*n)+u*i,p=h*(h*(h*r+3*c*a)+3*d*s)+u*o;l[0]=Math.min(l[0],f),l[1]=Math.min(l[1],p),l[2]=Math.max(l[2],f),l[3]=Math.max(l[3],p)},n=function(n,i,r,a,s,o,c,l,h,d,u,f){if(Math.abs(h)<1e-12)return void(Math.abs(d)>=1e-12&&dh(this,e,t).call(this,n,i,r,a,s,o,c,l,-u/d,f));const p=d**2-4*u*h;if(p<0)return;const g=Math.sqrt(p),m=2*h;dh(this,e,t).call(this,n,i,r,a,s,o,c,l,(-d+g)/m,f),dh(this,e,t).call(this,n,i,r,a,s,o,c,l,(-d-g)/m,f)},lh(If,e);let Rf=null,Nf=null;function Mf(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),Sf(e)}const Of="pdfjs_internal_id_";function Pf(e,t,n){return Math.min(Math.max(e,t),n)}function Lf(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(Sf(e))}"function"!=typeof Promise.try&&(Promise.try=function(e,...t){return new Promise(n=>{n(e(...t))})}),"function"!=typeof Math.sumPrecise&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});const Wf="http://www.w3.org/2000/svg",Bf=class{};sh(Bf,"CSS",96),sh(Bf,"PDF",72),sh(Bf,"PDF_TO_CSS_UNITS",Bf.CSS/Bf.PDF);let jf=Bf;async function zf(e,t="text"){if(Xf(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);switch(t){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,i)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE)if(200!==r.status&&0!==r.status)i(new Error(r.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void n(r.response)}n(r.responseText)}},r.send(null)})}class Hf{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:s=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=r,this.offsetY=a,n*=t;const o=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let l,h,d,u,f,p,g,m;switch((i%=360)<0&&(i+=360),i){case 180:l=-1,h=0,d=0,u=1;break;case 90:l=0,h=1,d=1,u=0;break;case 270:l=0,h=-1,d=-1,u=0;break;case 0:l=1,h=0,d=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(d=-d,u=-u),0===l?(f=Math.abs(c-e[1])*n+r,p=Math.abs(o-e[0])*n+a,g=(e[3]-e[1])*n,m=(e[2]-e[0])*n):(f=Math.abs(o-e[0])*n+r,p=Math.abs(c-e[1])*n+a,g=(e[2]-e[0])*n,m=(e[3]-e[1])*n),this.transform=[l*n,h*n,d*n,u*n,f-l*n*o-d*n*c,p-h*n*o-u*n*c],this.width=g,this.height=m}get rawDims(){const e=this.viewBox;return wf(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Hf({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const n=[e,t];return If.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];If.applyTransform(t,this.transform);const n=[e[2],e[3]];return If.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return If.applyInverseTransform(n,this.transform),n}}class Vf extends xf{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Gf(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function $f(e){return"string"==typeof e&&/\.pdf$/i.test(e)}class qf{constructor(){sh(this,"started",Object.create(null)),sh(this,"times",[])}time(e){this.started,this.started[e]=Date.now()}timeEnd(e){this.started,this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:r}of this.times)e.push(`${n.padEnd(t)} ${r-i}ms\n`);return e.join("")}}function Xf(e,t){const n=t?URL.parse(e,t):URL.parse(e);return"http:"===(null==n?void 0:n.protocol)||"https:"===(null==n?void 0:n.protocol)}function Kf(e){e.preventDefault()}function Yf(e){e.preventDefault(),e.stopPropagation()}class Zf{static toDateObject(e){if(!e||"string"!=typeof e)return null;ch(this,i)||hh(this,i,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=ch(this,i).exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const l=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(s+=h,o+=d):"+"===l&&(s-=h,o-=d),new Date(Date.UTC(n,r,a,s,o,c))}}function Jf(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):[0,0,0]}function Qf(e){const{a:t,b:n,c:i,d:r,e:a,f:s}=e.getTransform();return[t,n,i,r,a,s]}function ep(e){const{a:t,b:n,c:i,d:r,e:a,f:s}=e.getTransform().invertSelf();return[t,n,i,r,a,s]}function tp(e,t,n=!1,i=!0){if(t instanceof Hf){const{pageWidth:i,pageHeight:r}=t.rawDims,{style:a}=e,s=Uf.isCSSRoundSupported,o=`var(--total-scale-factor) * ${i}px`,c=`var(--total-scale-factor) * ${r}px`,l=s?`round(down, ${o}, var(--scale-round-x))`:`calc(${o})`,h=s?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;n&&t.rotation%180!=0?(a.width=h,a.height=l):(a.width=l,a.height=h)}i&&e.setAttribute("data-main-rotation",t.rotation)}i=new WeakMap,lh(Zf,i);class np{constructor(){const{pixelRatio:e}=np;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,r=-1){let a=1/0,s=1/0,o=1/0;(n=np.capPixels(n,r))>0&&(a=Math.sqrt(n/(e*t))),-1!==i&&(s=i/e,o=i/t);const c=Math.min(a,s,o);return(this.sx>c||this.sy>c)&&(this.sx=c,this.sy=c,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const ip=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"],rp=class e{constructor(t){lh(this,f),lh(this,r,null),lh(this,a,null),lh(this,s),lh(this,o,null),lh(this,c,null),lh(this,l,null),hh(this,s,t),ch(e,h)||hh(e,h,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=hh(this,r,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const n=ch(this,s)._uiManager._signal;t.addEventListener("contextmenu",Kf,{signal:n}),t.addEventListener("pointerdown",dh(e,d,u),{signal:n});const i=hh(this,o,document.createElement("div"));i.className="buttons",t.append(i);const a=ch(this,s).toolbarPosition;if(a){const{style:e}=t,n="ltr"===ch(this,s)._uiManager.direction?1-a[0]:a[0];e.insetInlineEnd=100*n+"%",e.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return ch(this,r)}hide(){var e;ch(this,r).classList.add("hidden"),null==(e=ch(this,a))||e.hideDropdown()}show(){var e;ch(this,r).classList.remove("hidden"),null==(e=ch(this,c))||e.shown()}addDeleteButton(){const{editorType:t,_uiManager:n}=ch(this,s),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",ch(e,h)[t]),dh(this,f,m).call(this,i),i.addEventListener("click",e=>{n.delete()},{signal:n._signal}),ch(this,o).append(i)}async addAltText(e){const t=await e.render();dh(this,f,m).call(this,t),ch(this,o).append(t,ch(this,f,b)),hh(this,c,e)}addColorPicker(e){hh(this,a,e);const t=e.renderButton();dh(this,f,m).call(this,t),ch(this,o).append(t,ch(this,f,b))}async addEditSignatureButton(e){const t=hh(this,l,await e.renderEditButton(ch(this,s)));dh(this,f,m).call(this,t),ch(this,o).append(t,ch(this,f,b))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton()}}updateEditSignatureButton(e){ch(this,l)&&(ch(this,l).title=e)}remove(){var e;ch(this,r).remove(),null==(e=ch(this,a))||e.destroy(),hh(this,a,null)}};r=new WeakMap,a=new WeakMap,s=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,h=new WeakMap,d=new WeakSet,u=function(e){e.stopPropagation()},f=new WeakSet,p=function(e){ch(this,s)._focusEventsAllowed=!1,Yf(e)},g=function(e){ch(this,s)._focusEventsAllowed=!0,Yf(e)},m=function(e){const t=ch(this,s)._uiManager._signal;e.addEventListener("focusin",dh(this,f,p).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",dh(this,f,g).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Kf,{signal:t})},b=function(){const e=document.createElement("div");return e.className="divider",e},lh(rp,d),lh(rp,h,null);let ap=rp;class sp{constructor(e){lh(this,x),lh(this,v,null),lh(this,y,null),lh(this,w),hh(this,w,e)}show(e,t,n){const[i,r]=dh(this,x,T).call(this,t,n),{style:a}=ch(this,y)||hh(this,y,dh(this,x,_).call(this));e.append(ch(this,y)),a.insetInlineEnd=100*i+"%",a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){ch(this,y).remove()}}function op(e,t,n){for(const i of n)t.addEventListener(i,e[i].bind(e))}v=new WeakMap,y=new WeakMap,w=new WeakMap,x=new WeakSet,_=function(){const e=hh(this,y,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Kf,{signal:ch(this,w)._signal});const t=hh(this,v,document.createElement("div"));return t.className="buttons",e.append(t),dh(this,x,D).call(this),e},T=function(e,t){let n=0,i=0;for(const r of e){const e=r.y+r.height;if(e<n)continue;const a=r.x+(t?r.width:0);e>n?(i=a,n=e):t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,n]},D=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=ch(this,w)._signal;e.addEventListener("contextmenu",Kf,{signal:n}),e.addEventListener("click",()=>{ch(this,w).highlightSelection("floating_button")},{signal:n}),ch(this,v).append(e)};class cp{constructor(){lh(this,E,0)}get id(){return`${sf}${uh(this,E)._++}`}}E=new WeakMap;const lp=class{constructor(){lh(this,C),lh(this,A,Mf()),lh(this,k,0),lh(this,S,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',wf(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(e){const{lastModified:t,name:n,size:i,type:r}=e;return dh(this,C,U).call(this,`${t}_${n}_${i}_${r}`,e)}async getFromUrl(e){return dh(this,C,U).call(this,e,e)}async getFromBlob(e,t){const n=await t;return dh(this,C,U).call(this,e,n)}async getFromId(e){ch(this,S)||hh(this,S,new Map);const t=ch(this,S).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){ch(this,S)||hh(this,S,new Map);let n=ch(this,S).get(e);if(null==n?void 0:n.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${ch(this,A)}_${uh(this,k)._++}`,refCounter:1,isSvg:!1},ch(this,S).set(e,n),ch(this,S).set(n.id,n),n}getSvgUrl(e){const t=ch(this,S).get(e);return(null==t?void 0:t.isSvg)?t.svgUrl:null}deleteId(e){var t;ch(this,S)||hh(this,S,new Map);const n=ch(this,S).get(e);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:i}=n;if(!n.url&&!n.file){const e=new OffscreenCanvas(i.width,i.height);e.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=e.convertToBlob()}null==(t=i.close)||t.call(i),n.bitmap=null}isValidId(e){return e.startsWith(`image_${ch(this,A)}_`)}};A=new WeakMap,k=new WeakMap,S=new WeakMap,C=new WeakSet,U=async function(e,t){ch(this,S)||hh(this,S,new Map);let n=ch(this,S).get(e);if(null===n)return null;if(null==n?void 0:n.bitmap)return n.refCounter+=1,n;try{let e;if(n||(n={bitmap:null,id:`image_${ch(this,A)}_${uh(this,k)._++}`,refCounter:0,isSvg:!1}),"string"==typeof t?(n.url=t,e=await zf(t,"blob")):t instanceof File?e=n.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=lp._isSVGFittingCanvas,i=new FileReader,r=new Image,a=new Promise((e,a)=>{r.onload=()=>{n.bitmap=r,n.isSvg=!0,e()},i.onload=async()=>{const e=n.svgUrl=i.result;r.src=await t?`${e}#svgView(preserveAspectRatio(none))`:e},r.onerror=i.onerror=a});i.readAsDataURL(e),await a}else n.bitmap=await createImageBitmap(e);n.refCounter=1}catch(i){n=null}return ch(this,S).set(e,n),n&&ch(this,S).set(n.id,n),n};let hp=lp;class dp{constructor(e=128){lh(this,F,[]),lh(this,I,!1),lh(this,R),lh(this,N,-1),hh(this,R,e)}add({cmd:e,undo:t,post:n,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:s=!1}){if(i&&e(),ch(this,I))return;const o={cmd:e,undo:t,post:n,type:r};if(-1===ch(this,N))return ch(this,F).length>0&&(ch(this,F).length=0),hh(this,N,0),void ch(this,F).push(o);if(a&&ch(this,F)[ch(this,N)].type===r)return s&&(o.undo=ch(this,F)[ch(this,N)].undo),void(ch(this,F)[ch(this,N)]=o);const c=ch(this,N)+1;c===ch(this,R)?ch(this,F).splice(0,1):(hh(this,N,c),c<ch(this,F).length&&ch(this,F).splice(c)),ch(this,F).push(o)}undo(){if(-1===ch(this,N))return;hh(this,I,!0);const{undo:e,post:t}=ch(this,F)[ch(this,N)];e(),null==t||t(),hh(this,I,!1),hh(this,N,ch(this,N)-1)}redo(){if(ch(this,N)<ch(this,F).length-1){hh(this,N,ch(this,N)+1),hh(this,I,!0);const{cmd:e,post:t}=ch(this,F)[ch(this,N)];e(),null==t||t(),hh(this,I,!1)}}hasSomethingToUndo(){return-1!==ch(this,N)}hasSomethingToRedo(){return ch(this,N)<ch(this,F).length-1}cleanType(e){if(-1!==ch(this,N)){for(let t=ch(this,N);t>=0;t--)if(ch(this,F)[t].type!==e)return ch(this,F).splice(t+1,ch(this,N)-t),void hh(this,N,t);ch(this,F).length=0,hh(this,N,-1)}}destroy(){hh(this,F,null)}}F=new WeakMap,I=new WeakMap,R=new WeakMap,N=new WeakMap;class up{constructor(e){lh(this,M),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Uf.platform;for(const[n,i,r={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(dh(this,M,O).call(this,t));if(!n)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:s=null}}=n;s&&!s(e,t)||(i.bind(e,...a,t)(),r||Yf(t))}}M=new WeakSet,O=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const fp=class e{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const n of e.keys()){t.style.color=n;const i=window.getComputedStyle(t).color;e.set(n,Jf(i))}t.remove()}(e),wf(this,"_colors",e)}convert(t){const n=Jf(t);if(!window.matchMedia("(forced-colors: active)").matches)return n;for(const[i,r]of this._colors)if(r.every((e,t)=>e===n[t]))return e._colorsMapping.get(i);return n}getHexCode(e){const t=this._colors.get(e);return t?If.makeHexColor(...t):e}};sh(fp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let pp=fp;const gp=class e{constructor(e,t,n,i,r,a,s,o,c,l,h,d,u,f,p){lh(this,Ce),lh(this,P,new AbortController),lh(this,L,null),lh(this,W,new Map),lh(this,B,new Map),lh(this,j,null),lh(this,z,null),lh(this,H,null),lh(this,V,new dp),lh(this,G,null),lh(this,q,null),lh(this,X,0),lh(this,K,new Set),lh(this,Y,null),lh(this,Z,null),lh(this,J,new Set),sh(this,"_editorUndoBar",null),lh(this,Q,!1),lh(this,ee,!1),lh(this,te,!1),lh(this,ne,null),lh(this,ie,null),lh(this,re,null),lh(this,ae,null),lh(this,se,!1),lh(this,oe,null),lh(this,ce,new cp),lh(this,le,!1),lh(this,he,!1),lh(this,de,null),lh(this,ue,null),lh(this,fe,null),lh(this,pe,null),lh(this,ge,null),lh(this,me,of.NONE),lh(this,be,new Set),lh(this,ve,null),lh(this,ye,null),lh(this,we,null),lh(this,xe,null),lh(this,_e,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),lh(this,Te,[0,0]),lh(this,De,null),lh(this,Ee,null),lh(this,Ae,null),lh(this,ke,null),lh(this,Se,null);const g=this._signal=ch(this,P).signal;hh(this,Ee,e),hh(this,Ae,t),hh(this,ke,n),hh(this,j,i),hh(this,ye,r),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:g}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),a._on("setpreference",this.onSetPreference.bind(this),{signal:g}),a._on("switchannotationeditorparams",e=>this.updateParams(e.type,e.value),{signal:g}),dh(this,Ce,Me).call(this),dh(this,Ce,ze).call(this),dh(this,Ce,Le).call(this),hh(this,z,s.annotationStorage),hh(this,ne,s.filterFactory),hh(this,we,o),hh(this,ae,c||null),hh(this,Q,l),hh(this,ee,h),hh(this,te,d),hh(this,ge,u||null),this.viewParameters={realScale:jf.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=!1!==p}static get _keyboardManager(){const t=e.prototype,n=e=>ch(e,Ee).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),i=(e,{target:t})=>{if(t instanceof HTMLInputElement){const{type:e}=t;return"text"!==e&&"number"!==e}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return wf(this,"_keyboardManager",new up([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(e,{target:t})=>!(t instanceof HTMLButtonElement)&&ch(e,Ee).contains(t)&&!e.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(e,{target:t})=>!(t instanceof HTMLButtonElement)&&ch(e,Ee).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:n}]]))}destroy(){var e,t,n,i,r,a,s,o;null==(e=ch(this,Se))||e.resolve(),hh(this,Se,null),null==(t=ch(this,P))||t.abort(),hh(this,P,null),this._signal=null;for(const c of ch(this,B).values())c.destroy();ch(this,B).clear(),ch(this,W).clear(),ch(this,J).clear(),null==(n=ch(this,pe))||n.clear(),hh(this,L,null),ch(this,be).clear(),ch(this,V).destroy(),null==(i=ch(this,j))||i.destroy(),null==(r=ch(this,ye))||r.destroy(),null==(a=ch(this,oe))||a.hide(),hh(this,oe,null),null==(s=ch(this,fe))||s.destroy(),hh(this,fe,null),ch(this,ie)&&(clearTimeout(ch(this,ie)),hh(this,ie,null)),ch(this,De)&&(clearTimeout(ch(this,De)),hh(this,De,null)),null==(o=this._editorUndoBar)||o.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return ch(this,ge)}get useNewAltTextFlow(){return ch(this,ee)}get useNewAltTextWhenAddingImage(){return ch(this,te)}get hcmFilter(){return wf(this,"hcmFilter",ch(this,we)?ch(this,ne).addHCMFilter(ch(this,we).foreground,ch(this,we).background):"none")}get direction(){return wf(this,"direction",getComputedStyle(ch(this,Ee)).direction)}get highlightColors(){return wf(this,"highlightColors",ch(this,ae)?new Map(ch(this,ae).split(",").map(e=>((e=e.split("=").map(e=>e.trim()))[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return wf(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),hh(this,q,e)}setMainHighlightColorPicker(e){hh(this,fe,e)}editAltText(e,t=!1){var n;null==(n=ch(this,j))||n.editAltText(this,e,t)}getSignature(e){var t;null==(t=ch(this,ye))||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return ch(this,ye)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){"enableNewAltTextWhenAddingImage"===e&&hh(this,te,t)}onPageChanging({pageNumber:e}){hh(this,X,e-1)}focusMainContainer(){ch(this,Ee).focus()}findParent(e,t){for(const n of ch(this,B).values()){const{x:i,y:r,width:a,height:s}=n.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+s)return n}return null}disableUserSelect(e=!1){ch(this,Ae).classList.toggle("noUserSelect",e)}addShouldRescale(e){ch(this,J).add(e)}removeShouldRescale(e){ch(this,J).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*jf.PDF_TO_CSS_UNITS;for(const n of ch(this,J))n.onScaleChanging();null==(t=ch(this,q))||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:a}=t,s=t.toString(),o=dh(this,Ce,Ue).call(this,t).closest(".textLayer"),c=this.getSelectionBoxes(o);if(!c)return;t.empty();const l=dh(this,Ce,Fe).call(this,o),h=ch(this,me)===of.NONE,d=()=>{null==l||l.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:a,text:s}),h&&this.showAllEditors("highlight",!0,!0)};h?this.switchToMode(of.HIGHLIGHT,d):d()}addToAnnotationStorage(e){e.isEmpty()||!ch(this,z)||ch(this,z).has(e.id)||ch(this,z).setValue(e.id,e)}a11yAlert(e,t=null){const n=ch(this,ke);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,ch(this,se)&&(hh(this,se,!1),dh(this,Ce,Ne).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of ch(this,be))if(t.div.contains(e)){hh(this,ue,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!ch(this,ue))return;const[e,t]=ch(this,ue);hh(this,ue,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){dh(this,Ce,Le).call(this),dh(this,Ce,Be).call(this)}removeEditListeners(){dh(this,Ce,We).call(this),dh(this,Ce,je).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of ch(this,Z))if(n.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const n of ch(this,Z))if(n.isHandlingMimeForPasting(t.type))return n.paste(t,this.currentLayer),void e.preventDefault()}copy(e){var t;if(e.preventDefault(),null==(t=ch(this,L))||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of ch(this,be)){const e=i.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const e of ch(this,Z))if(e.isHandlingMimeForPasting(a.type))return void e.paste(a,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(r){return void r.message}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const e=[];for(const a of n){const t=await i.deserialize(a);if(!t)return;e.push(t)}const t=()=>{for(const t of e)dh(this,Ce,qe).call(this,t);dh(this,Ce,Ye).call(this,e)},r=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:r,mustExec:!0})}catch(r){r.message}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),ch(this,me)===of.NONE||this.isEditorHandlingKeyboard||e._keyboardManager.exec(this,t)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,ch(this,se)&&(hh(this,se,!1),dh(this,Ce,Ne).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu")}}setEditingState(e){e?(dh(this,Ce,Oe).call(this),dh(this,Ce,Be).call(this),dh(this,Ce,He).call(this,{isEditing:ch(this,me)!==of.NONE,isEmpty:dh(this,Ce,Ke).call(this),hasSomethingToUndo:ch(this,V).hasSomethingToUndo(),hasSomethingToRedo:ch(this,V).hasSomethingToRedo(),hasSelectedEditor:!1})):(dh(this,Ce,Pe).call(this),dh(this,Ce,je).call(this),dh(this,Ce,He).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!ch(this,Z)){hh(this,Z,e);for(const e of ch(this,Z))dh(this,Ce,Ve).call(this,e.defaultPropertiesToUpdate)}}getId(){return ch(this,ce).id}get currentLayer(){return ch(this,B).get(ch(this,X))}getLayer(e){return ch(this,B).get(e)}get currentPageIndex(){return ch(this,X)}addLayer(e){ch(this,B).set(e.pageIndex,e),ch(this,le)?e.enable():e.disable()}removeLayer(e){ch(this,B).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1){var r,a,s;if(ch(this,me)!==e&&(!ch(this,Se)||(await ch(this,Se).promise,ch(this,Se)))){if(hh(this,Se,Promise.withResolvers()),null==(r=ch(this,q))||r.commitOrRemove(),hh(this,me,e),e===of.NONE)return this.setEditingState(!1),dh(this,Ce,$e).call(this),null==(a=this._editorUndoBar)||a.hide(),void ch(this,Se).resolve();e===of.SIGNATURE&&await(null==(s=ch(this,ye))?void 0:s.loadSignatures()),this.setEditingState(!0),await dh(this,Ce,Ge).call(this),this.unselectAll();for(const t of ch(this,B).values())t.updateMode(e);if(!t)return n&&this.addNewEditorFromKeyboard(),void ch(this,Se).resolve();for(const e of ch(this,W).values())e.annotationElementId===t||e.id===t?(this.setSelected(e),i&&e.enterInEditMode()):e.unselect();ch(this,Se).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==ch(this,me)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var n;if(ch(this,Z)){switch(e){case cf.CREATE:return void this.currentLayer.addNewEditor(t);case cf.HIGHLIGHT_DEFAULT_COLOR:null==(n=ch(this,fe))||n.updateColor(t);break;case cf.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(ch(this,xe)||hh(this,xe,new Map)).set(e,t),this.showAllEditors("highlight",t)}for(const n of ch(this,be))n.updateParams(e,t);for(const n of ch(this,Z))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var i;for(const r of ch(this,W).values())r.editorType===e&&r.show(t);((null==(i=ch(this,xe))?void 0:i.get(cf.HIGHLIGHT_SHOW_ALL))??!0)!==t&&dh(this,Ce,Ve).call(this,[[cf.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(ch(this,he)!==e){hh(this,he,e);for(const t of ch(this,B).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of ch(this,W).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return ch(this,W).get(e)}addEditor(e){ch(this,W).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(ch(this,ie)&&clearTimeout(ch(this,ie)),hh(this,ie,setTimeout(()=>{this.focusMainContainer(),hh(this,ie,null)},0))),ch(this,W).delete(e.id),e.annotationElementId&&(null==(t=ch(this,pe))||t.delete(e.annotationElementId)),this.unselect(e),e.annotationElementId&&ch(this,K).has(e.annotationElementId)||null==(n=ch(this,z))||n.remove(e.id)}addDeletedAnnotationElement(e){ch(this,K).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return ch(this,K).has(e)}removeDeletedAnnotationElement(e){ch(this,K).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){ch(this,L)!==e&&(hh(this,L,e),e&&dh(this,Ce,Ve).call(this,e.propertiesToUpdate))}updateUI(e){ch(this,Ce,Xe)===e&&dh(this,Ce,Ve).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){dh(this,Ce,Ve).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(ch(this,be).has(e))return ch(this,be).delete(e),e.unselect(),void dh(this,Ce,He).call(this,{hasSelectedEditor:this.hasSelection});ch(this,be).add(e),e.select(),dh(this,Ce,Ve).call(this,e.propertiesToUpdate),dh(this,Ce,He).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),null==(t=ch(this,q))||t.commitOrRemove();for(const n of ch(this,be))n!==e&&n.unselect();ch(this,be).clear(),ch(this,be).add(e),e.select(),dh(this,Ce,Ve).call(this,e.propertiesToUpdate),dh(this,Ce,He).call(this,{hasSelectedEditor:!0})}isSelected(e){return ch(this,be).has(e)}get firstSelectedEditor(){return ch(this,be).values().next().value}unselect(e){e.unselect(),ch(this,be).delete(e),dh(this,Ce,He).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==ch(this,be).size}get isEnterHandled(){return 1===ch(this,be).size&&this.firstSelectedEditor.isEnterHandled}undo(){var e;ch(this,V).undo(),dh(this,Ce,He).call(this,{hasSomethingToUndo:ch(this,V).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:dh(this,Ce,Ke).call(this)}),null==(e=this._editorUndoBar)||e.hide()}redo(){ch(this,V).redo(),dh(this,Ce,He).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:ch(this,V).hasSomethingToRedo(),isEmpty:dh(this,Ce,Ke).call(this)})}addCommands(e){ch(this,V).add(e),dh(this,Ce,He).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:dh(this,Ce,Ke).call(this)})}cleanUndoStack(e){ch(this,V).cleanType(e)}delete(){var e;this.commitOrRemove();const t=null==(e=this.currentLayer)?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const n=t?[t]:[...ch(this,be)],i=()=>{for(const e of n)dh(this,Ce,qe).call(this,e)};this.addCommands({cmd:()=>{var e;null==(e=this._editorUndoBar)||e.show(i,1===n.length?n[0].editorType:n.length);for(const t of n)t.remove()},undo:i,mustExec:!0})}commitOrRemove(){var e;null==(e=ch(this,L))||e.commitOrRemove()}hasSomethingToControl(){return ch(this,L)||this.hasSelection}selectAll(){for(const e of ch(this,be))e.commit();dh(this,Ce,Ye).call(this,ch(this,W).values())}unselectAll(){var e;if((!ch(this,L)||(ch(this,L).commitOrRemove(),ch(this,me)===of.NONE))&&!(null==(e=ch(this,q))?void 0:e.commitOrRemove())&&this.hasSelection){for(const e of ch(this,be))e.unselect();ch(this,be).clear(),dh(this,Ce,He).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;ch(this,Te)[0]+=e,ch(this,Te)[1]+=t;const[i,r]=ch(this,Te),a=[...ch(this,be)];ch(this,De)&&clearTimeout(ch(this,De)),hh(this,De,setTimeout(()=>{hh(this,De,null),ch(this,Te)[0]=ch(this,Te)[1]=0,this.addCommands({cmd:()=>{for(const e of a)ch(this,W).has(e.id)&&(e.translateInPage(i,r),e.translationDone())},undo:()=>{for(const e of a)ch(this,W).has(e.id)&&(e.translateInPage(-i,-r),e.translationDone())},mustExec:!1})},1e3));for(const s of a)s.translateInPage(e,t),s.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),hh(this,Y,new Map);for(const e of ch(this,be))ch(this,Y).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!ch(this,Y))return!1;this.disableUserSelect(!1);const e=ch(this,Y);hh(this,Y,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},s]of e)s.newX=i,s.newY=r,s.newPageIndex=a,t||(t=i!==s.savedX||r!==s.savedY||a!==s.savedPageIndex);if(!t)return!1;const n=(e,t,n,i)=>{if(ch(this,W).has(e.id)){const r=ch(this,B).get(i);r?e._setParentAndPosition(r,t,n):(e.pageIndex=i,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:r,newPageIndex:a}]of e)n(t,i,r,a)},undo:()=>{for(const[t,{savedX:i,savedY:r,savedPageIndex:a}]of e)n(t,i,r,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(ch(this,Y))for(const n of ch(this,Y).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return(null==(e=this.getActive())?void 0:e.shouldGetKeyboardEvents())||1===ch(this,be).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return ch(this,L)===e}getActive(){return ch(this,L)}getMode(){return ch(this,me)}get imageManager(){return wf(this,"imageManager",new hp)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,l=t.rangeCount;c<l;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:n,y:i,width:r,height:a}=e.getBoundingClientRect();let s;switch(e.getAttribute("data-main-rotation")){case"90":s=(e,t,s,o)=>({x:(t-i)/a,y:1-(e+s-n)/r,width:o/a,height:s/r});break;case"180":s=(e,t,s,o)=>({x:1-(e+s-n)/r,y:1-(t+o-i)/a,width:s/r,height:o/a});break;case"270":s=(e,t,s,o)=>({x:1-(t+o-i)/a,y:(e-n)/r,width:o/a,height:s/r});break;default:s=(e,t,s,o)=>({x:(e-n)/r,y:(t-i)/a,width:s/r,height:o/a})}const o=[];for(let c=0,l=t.rangeCount;c<l;c++){const e=t.getRangeAt(c);if(!e.collapsed)for(const{x:t,y:n,width:i,height:r}of e.getClientRects())0!==i&&0!==r&&o.push(s(t,n,i,r))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:e,id:t}){(ch(this,H)||hh(this,H,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;null==(t=ch(this,H))||t.delete(e)}renderAnnotationElement(e){var t;const n=null==(t=ch(this,H))?void 0:t.get(e.data.id);if(!n)return;const i=ch(this,z).getRawValue(n);i&&(ch(this,me)!==of.NONE||i.hasBeenModified)&&i.renderAnnotationElement(e)}setMissingCanvas(e,t,n){var i;const r=null==(i=ch(this,pe))?void 0:i.get(e);r&&(r.setCanvas(t,n),ch(this,pe).delete(e))}addMissingCanvas(e,t){(ch(this,pe)||hh(this,pe,new Map)).set(e,t)}};P=new WeakMap,L=new WeakMap,W=new WeakMap,B=new WeakMap,j=new WeakMap,z=new WeakMap,H=new WeakMap,V=new WeakMap,G=new WeakMap,q=new WeakMap,X=new WeakMap,K=new WeakMap,Y=new WeakMap,Z=new WeakMap,J=new WeakMap,Q=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,ie=new WeakMap,re=new WeakMap,ae=new WeakMap,se=new WeakMap,oe=new WeakMap,ce=new WeakMap,le=new WeakMap,he=new WeakMap,de=new WeakMap,ue=new WeakMap,fe=new WeakMap,pe=new WeakMap,ge=new WeakMap,me=new WeakMap,be=new WeakMap,ve=new WeakMap,ye=new WeakMap,we=new WeakMap,xe=new WeakMap,_e=new WeakMap,Te=new WeakMap,De=new WeakMap,Ee=new WeakMap,Ae=new WeakMap,ke=new WeakMap,Se=new WeakMap,Ce=new WeakSet,Ue=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Fe=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of ch(this,B).values())if(n.hasTextLayer(e))return n;return null},Ie=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=dh(this,Ce,Ue).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(t);n&&(ch(this,oe)||hh(this,oe,new sp(this)),ch(this,oe).show(t,n,"ltr"===this.direction))},Re=function(){var e,t,n;const i=document.getSelection();if(!i||i.isCollapsed)return void(ch(this,ve)&&(null==(e=ch(this,oe))||e.hide(),hh(this,ve,null),dh(this,Ce,He).call(this,{hasSelectedText:!1})));const{anchorNode:r}=i;if(r===ch(this,ve))return;const a=dh(this,Ce,Ue).call(this,i).closest(".textLayer");if(a){if(null==(n=ch(this,oe))||n.hide(),hh(this,ve,r),dh(this,Ce,He).call(this,{hasSelectedText:!0}),(ch(this,me)===of.HIGHLIGHT||ch(this,me)===of.NONE)&&(ch(this,me)===of.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),hh(this,se,this.isShiftKeyDown),!this.isShiftKeyDown)){const e=ch(this,me)===of.HIGHLIGHT?dh(this,Ce,Fe).call(this,a):null;null==e||e.toggleDrawing();const t=new AbortController,n=this.combinedSignal(t),i=n=>{"pointerup"===n.type&&0!==n.button||(t.abort(),null==e||e.toggleDrawing(!0),"pointerup"===n.type&&dh(this,Ce,Ne).call(this,"main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}}else ch(this,ve)&&(null==(t=ch(this,oe))||t.hide(),hh(this,ve,null),dh(this,Ce,He).call(this,{hasSelectedText:!1}))},Ne=function(e=""){ch(this,me)===of.HIGHLIGHT?this.highlightSelection(e):ch(this,Q)&&dh(this,Ce,Ie).call(this)},Me=function(){document.addEventListener("selectionchange",dh(this,Ce,Re).bind(this),{signal:this._signal})},Oe=function(){if(ch(this,re))return;hh(this,re,new AbortController);const e=this.combinedSignal(ch(this,re));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Pe=function(){var e;null==(e=ch(this,re))||e.abort(),hh(this,re,null)},Le=function(){if(ch(this,de))return;hh(this,de,new AbortController);const e=this.combinedSignal(ch(this,de));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},We=function(){var e;null==(e=ch(this,de))||e.abort(),hh(this,de,null)},Be=function(){if(ch(this,G))return;hh(this,G,new AbortController);const e=this.combinedSignal(ch(this,G));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},je=function(){var e;null==(e=ch(this,G))||e.abort(),hh(this,G,null)},ze=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},He=function(e){Object.entries(e).some(([e,t])=>ch(this,_e)[e]!==t)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(ch(this,_e),e)}),ch(this,me)===of.HIGHLIGHT&&!1===e.hasSelectedEditor&&dh(this,Ce,Ve).call(this,[[cf.HIGHLIGHT_FREE,!0]]))},Ve=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Ge=async function(){if(!ch(this,le)){hh(this,le,!0);const e=[];for(const t of ch(this,B).values())e.push(t.enable());await Promise.all(e);for(const t of ch(this,W).values())t.enable()}},$e=function(){if(this.unselectAll(),ch(this,le)){hh(this,le,!1);for(const e of ch(this,B).values())e.disable();for(const e of ch(this,W).values())e.disable()}},qe=function(e){const t=ch(this,B).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Xe=function(){let e=null;for(e of ch(this,be));return e},Ke=function(){if(0===ch(this,W).size)return!0;if(1===ch(this,W).size)for(const e of ch(this,W).values())return e.isEmpty();return!1},Ye=function(e){for(const t of ch(this,be))t.unselect();ch(this,be).clear();for(const t of e)t.isEmpty()||(ch(this,be).add(t),t.select());dh(this,Ce,He).call(this,{hasSelectedEditor:this.hasSelection})},sh(gp,"TRANSLATE_SMALL",1),sh(gp,"TRANSLATE_BIG",10);let mp=gp;const bp=class e{constructor(t){lh(this,ht),lh(this,Ze,null),lh(this,Je,!1),lh(this,Qe,null),lh(this,et,null),lh(this,tt,null),lh(this,nt,null),lh(this,it,!1),lh(this,rt,null),lh(this,at,null),lh(this,st,null),lh(this,ot,null),lh(this,ct,!1),hh(this,at,t),hh(this,ct,t._uiManager.useNewAltTextFlow),ch(e,lt)||hh(e,lt,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){e._l10n??(e._l10n=t)}async render(){const t=hh(this,Qe,document.createElement("button"));t.className="altText",t.tabIndex="0";const n=hh(this,et,document.createElement("span"));t.append(n),ch(this,ct)?(t.classList.add("new"),t.setAttribute("data-l10n-id",ch(e,lt).missing),n.setAttribute("data-l10n-id",ch(e,lt)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=ch(this,at)._uiManager._signal;t.addEventListener("contextmenu",Kf,{signal:i}),t.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:i});const r=e=>{e.preventDefault(),ch(this,at)._uiManager.editAltText(ch(this,at)),ch(this,ct)&&ch(this,at)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:ch(this,ht,dt)}})};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",e=>{e.target===t&&"Enter"===e.key&&(hh(this,it,!0),r(e))},{signal:i}),await dh(this,ht,ut).call(this),t}finish(){ch(this,Qe)&&(ch(this,Qe).focus({focusVisible:ch(this,it)}),hh(this,it,!1))}isEmpty(){return ch(this,ct)?null===ch(this,Ze):!ch(this,Ze)&&!ch(this,Je)}hasData(){return ch(this,ct)?null!==ch(this,Ze)||!!ch(this,st):this.isEmpty()}get guessedText(){return ch(this,st)}async setGuessedText(t){null===ch(this,Ze)&&(hh(this,st,t),hh(this,ot,await e._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),dh(this,ht,ut).call(this))}toggleAltTextBadge(e=!1){var t;if(!ch(this,ct)||ch(this,Ze))return null==(t=ch(this,rt))||t.remove(),void hh(this,rt,null);if(!ch(this,rt)){const e=hh(this,rt,document.createElement("div"));e.className="noAltTextBadge",ch(this,at).div.append(e)}ch(this,rt).classList.toggle("hidden",!e)}serialize(e){let t=ch(this,Ze);return e||ch(this,st)!==t||(t=ch(this,ot)),{altText:t,decorative:ch(this,Je),guessedText:ch(this,st),textWithDisclaimer:ch(this,ot)}}get data(){return{altText:ch(this,Ze),decorative:ch(this,Je)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:r=!1}){n&&(hh(this,st,n),hh(this,ot,i)),ch(this,Ze)===e&&ch(this,Je)===t||(r||(hh(this,Ze,e),hh(this,Je,t)),dh(this,ht,ut).call(this))}toggle(e=!1){ch(this,Qe)&&(!e&&ch(this,nt)&&(clearTimeout(ch(this,nt)),hh(this,nt,null)),ch(this,Qe).disabled=!e)}shown(){ch(this,at)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:ch(this,ht,dt)}})}destroy(){var e,t;null==(e=ch(this,Qe))||e.remove(),hh(this,Qe,null),hh(this,et,null),hh(this,tt,null),null==(t=ch(this,rt))||t.remove(),hh(this,rt,null)}};Ze=new WeakMap,Je=new WeakMap,Qe=new WeakMap,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,it=new WeakMap,rt=new WeakMap,at=new WeakMap,st=new WeakMap,ot=new WeakMap,ct=new WeakMap,lt=new WeakMap,ht=new WeakSet,dt=function(){return(ch(this,Ze)?"added":null===ch(this,Ze)&&this.guessedText&&"review")||"missing"},ut=async function(){var e,t,n;const i=ch(this,Qe);if(!i)return;if(ch(this,ct)){if(i.classList.toggle("done",!!ch(this,Ze)),i.setAttribute("data-l10n-id",ch(bp,lt)[ch(this,ht,dt)]),null==(e=ch(this,et))||e.setAttribute("data-l10n-id",ch(bp,lt)[`${ch(this,ht,dt)}-label`]),!ch(this,Ze))return void(null==(t=ch(this,tt))||t.remove())}else{if(!ch(this,Ze)&&!ch(this,Je))return i.classList.remove("done"),void(null==(n=ch(this,tt))||n.remove());i.classList.add("done"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let r=ch(this,tt);if(!r){hh(this,tt,r=document.createElement("span")),r.className="tooltip",r.setAttribute("role","tooltip"),r.id=`alt-text-tooltip-${ch(this,at).id}`;const e=100,t=ch(this,at)._uiManager._signal;t.addEventListener("abort",()=>{clearTimeout(ch(this,nt)),hh(this,nt,null)},{once:!0}),i.addEventListener("mouseenter",()=>{hh(this,nt,setTimeout(()=>{hh(this,nt,null),ch(this,tt).classList.add("show"),ch(this,at)._reportTelemetry({action:"alt_text_tooltip"})},e))},{signal:t}),i.addEventListener("mouseleave",()=>{var e;ch(this,nt)&&(clearTimeout(ch(this,nt)),hh(this,nt,null)),null==(e=ch(this,tt))||e.classList.remove("show")},{signal:t})}ch(this,Je)?r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(r.removeAttribute("data-l10n-id"),r.textContent=ch(this,Ze)),r.parentNode||i.append(r);const a=ch(this,at).getElementForAltText();null==a||a.setAttribute("aria-describedby",r.id)},lh(bp,lt,null),sh(bp,"_l10n",null);let vp=bp;const yp=class{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:s}){lh(this,Et),lh(this,ft),lh(this,pt,!1),lh(this,gt,null),lh(this,mt),lh(this,bt),lh(this,vt),lh(this,yt),lh(this,wt,null),lh(this,xt),lh(this,_t,null),lh(this,Tt),lh(this,Dt,null),hh(this,ft,e),hh(this,gt,n),hh(this,mt,t),hh(this,bt,i),hh(this,vt,r),hh(this,yt,a),hh(this,Tt,new AbortController),hh(this,xt,AbortSignal.any([s,ch(this,Tt).signal])),e.addEventListener("touchstart",dh(this,Et,At).bind(this),{passive:!1,signal:ch(this,xt)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/np.pixelRatio}destroy(){var e,t;null==(e=ch(this,Tt))||e.abort(),hh(this,Tt,null),null==(t=ch(this,wt))||t.abort(),hh(this,wt,null)}};ft=new WeakMap,pt=new WeakMap,gt=new WeakMap,mt=new WeakMap,bt=new WeakMap,vt=new WeakMap,yt=new WeakMap,wt=new WeakMap,xt=new WeakMap,_t=new WeakMap,Tt=new WeakMap,Dt=new WeakMap,Et=new WeakSet,At=function(e){var t,n,i;if(null==(t=ch(this,mt))?void 0:t.call(this))return;if(1===e.touches.length){if(ch(this,wt))return;const e=hh(this,wt,new AbortController),t=AbortSignal.any([ch(this,xt),e.signal]),n=ch(this,ft),i={capture:!0,signal:t,passive:!1},r=e=>{var t;"touch"===e.pointerType&&(null==(t=ch(this,wt))||t.abort(),hh(this,wt,null))};return n.addEventListener("pointerdown",e=>{"touch"===e.pointerType&&(Yf(e),r(e))},i),n.addEventListener("pointerup",r,i),void n.addEventListener("pointercancel",r,i)}if(!ch(this,Dt)){hh(this,Dt,new AbortController);const e=AbortSignal.any([ch(this,xt),ch(this,Dt).signal]),t=ch(this,ft),i={signal:e,capture:!1,passive:!1};t.addEventListener("touchmove",dh(this,Et,kt).bind(this),i);const r=dh(this,Et,St).bind(this);t.addEventListener("touchend",r,i),t.addEventListener("touchcancel",r,i),i.capture=!0,t.addEventListener("pointerdown",Yf,i),t.addEventListener("pointermove",Yf,i),t.addEventListener("pointercancel",Yf,i),t.addEventListener("pointerup",Yf,i),null==(n=ch(this,bt))||n.call(this)}if(Yf(e),2!==e.touches.length||(null==(i=ch(this,gt))?void 0:i.call(this)))return void hh(this,_t,null);let[r,a]=e.touches;r.identifier>a.identifier&&([r,a]=[a,r]),hh(this,_t,{touch0X:r.screenX,touch0Y:r.screenY,touch1X:a.screenX,touch1Y:a.screenY})},kt=function(e){var t;if(!ch(this,_t)||2!==e.touches.length)return;Yf(e);let[n,i]=e.touches;n.identifier>i.identifier&&([n,i]=[i,n]);const{screenX:r,screenY:a}=n,{screenX:s,screenY:o}=i,c=ch(this,_t),{touch0X:l,touch0Y:h,touch1X:d,touch1Y:u}=c,f=d-l,p=u-h,g=s-r,m=o-a,b=Math.hypot(g,m)||1,v=Math.hypot(f,p)||1;if(!ch(this,pt)&&Math.abs(v-b)<=yp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=r,c.touch0Y=a,c.touch1X=s,c.touch1Y=o,!ch(this,pt))return void hh(this,pt,!0);const y=[(r+s)/2,(a+o)/2];null==(t=ch(this,vt))||t.call(this,y,v,b)},St=function(e){var t;e.touches.length>=2||(ch(this,Dt)&&(ch(this,Dt).abort(),hh(this,Dt,null),null==(t=ch(this,yt))||t.call(this)),ch(this,_t)&&(Yf(e),hh(this,_t,null),hh(this,pt,!1)))};let wp=yp;const xp=class e{constructor(t){lh(this,Qt),lh(this,Ct,null),lh(this,Ut,null),lh(this,Ft,null),lh(this,It,!1),lh(this,Rt,null),lh(this,Nt,""),lh(this,Mt,!1),lh(this,Ot,null),lh(this,Pt,null),lh(this,Lt,null),lh(this,Wt,null),lh(this,Bt,""),lh(this,jt,!1),lh(this,zt,null),lh(this,Ht,!1),lh(this,Vt,!1),lh(this,Gt,!1),lh(this,$t,null),lh(this,qt,0),lh(this,Xt,0),lh(this,Kt,null),lh(this,Yt,null),sh(this,"isSelected",!1),sh(this,"_isCopy",!1),sh(this,"_editToolbar",null),sh(this,"_initialOptions",Object.create(null)),sh(this,"_initialData",null),sh(this,"_isVisible",!0),sh(this,"_uiManager",null),sh(this,"_focusEventsAllowed",!0),lh(this,Zt,!1),lh(this,Jt,e._zIndex++),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:n,rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:s}}=this.parent.viewport;this.rotation=n,this.pageRotation=(360+n-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[a,s];const[o,c]=this.parentDimensions;this.x=t.x/o,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=e.prototype._resizeWithKeyboard,n=mp.TRANSLATE_SMALL,i=mp.TRANSLATE_BIG;return wf(this,"_resizerKeyboardManager",new up([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-n,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[n,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-n]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,n]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],e.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return wf(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Tp({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(t,n){if(e._l10n??(e._l10n=t),e._l10nResizer||(e._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==e._borderLineWidth)return;const i=getComputedStyle(document.documentElement);e._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){mf("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return ch(this,Zt)}set _isDraggable(e){var t;hh(this,Zt,e),null==(t=this.div)||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=ch(this,Jt)}setParent(e){null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):dh(this,Qt,wn).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(ch(this,jt)?hh(this,jt,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;(null==n?void 0:n.closest(`#${this.id}`))||(e.preventDefault(),(null==(t=this.parent)?void 0:t.isMultipleSelection)||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[r,a]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/r,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}translate(e,t){dh(this,Qt,en).call(this,this.parentDimensions,e,t)}translateInPage(e,t){ch(this,zt)||hh(this,zt,[this.x,this.y,this.width,this.height]),dh(this,Qt,en).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){ch(this,zt)||hh(this,zt,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:s}=this;const[o,c]=this.getBaseTranslation();a+=o,s+=c;const{style:l}=n;l.left=`${(100*a).toFixed(2)}%`,l.top=`${(100*s).toFixed(2)}%`,this._onTranslating(a,s),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!ch(this,zt)&&(ch(this,zt)[0]!==this.x||ch(this,zt)[1]!==this.y)}get _hasBeenResized(){return!!ch(this,zt)&&(ch(this,zt)[2]!==this.width||ch(this,zt)[3]!==this.height)}getBaseTranslation(){const[t,n]=this.parentDimensions,{_borderLineWidth:i}=e,r=i/t,a=i/n;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:r,y:a,width:s,height:o}=this;if(s*=n,o*=i,r*=n,a*=i,this._mustFixPosition)switch(e){case 0:r=Pf(r,0,n-s),a=Pf(a,0,i-o);break;case 90:r=Pf(r,0,n-o),a=Pf(a,s,i);break;case 180:r=Pf(r,s,n),a=Pf(a,o,i);break;case 270:r=Pf(r,o,n),a=Pf(a,0,i-s)}this.x=r/=n,this.y=a/=i;const[c,l]=this.getBaseTranslation();r+=c,a+=l,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,n){var i;return dh(i=e,tn,nn).call(i,t,n,this.parentRotation)}pageTranslationToScreen(t,n){var i;return dh(i=e,tn,nn).call(i,t,n,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/n).toFixed(2)}%`,ch(this,Mt)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),r=!ch(this,Mt)&&t.endsWith("%");if(i&&r)return;const[a,s]=this.parentDimensions;i||(e.width=`${(100*parseFloat(n)/a).toFixed(2)}%`),ch(this,Mt)||r||(e.height=`${(100*parseFloat(t)/s).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(1e4*e)/1e4}_onResizing(){}altTextFinish(){var e;null==(e=ch(this,Ft))||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||ch(this,Vt))return this._editToolbar;this._editToolbar=new ap(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,null==(e=ch(this,Ft))||e.destroy())}addContainer(e){var t;const n=null==(t=this._editToolbar)?void 0:t.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return ch(this,Ft)||(vp.initialize(e._l10n),hh(this,Ft,new vp(this)),ch(this,Ct)&&(ch(this,Ft).data=ch(this,Ct),hh(this,Ct,null))),ch(this,Ft)}get altTextData(){var e;return null==(e=ch(this,Ft))?void 0:e.data}set altTextData(e){ch(this,Ft)&&(ch(this,Ft).data=e)}get guessedAltText(){var e;return null==(e=ch(this,Ft))?void 0:e.guessedText}async setGuessedAltText(e){var t;await(null==(t=ch(this,Ft))?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return null==(t=ch(this,Ft))?void 0:t.serialize(e)}hasAltText(){return!!ch(this,Ft)&&!ch(this,Ft).isEmpty()}hasAltTextData(){var e;return(null==(e=ch(this,Ft))?void 0:e.hasData())??!1}render(){var e;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=ch(this,It)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),dh(this,Qt,gn).call(this);const[n,i]=this.parentDimensions;this.parentRotation%180!=0&&(t.style.maxWidth=`${(100*i/n).toFixed(2)}%`,t.style.maxHeight=`${(100*n/i).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),op(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(ch(this,Yt)||hh(this,Yt,new wp({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:dh(this,Qt,hn).bind(this),onPinching:dh(this,Qt,dn).bind(this),onPinchEnd:dh(this,Qt,un).bind(this),signal:this._uiManager._signal}))),null==(e=this._uiManager._editorUndoBar)||e.hide(),t}pointerdown(e){const{isMac:t}=Uf.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(hh(this,jt,!0),this._isDraggable?dh(this,Qt,pn).call(this,e):dh(this,Qt,fn).call(this,e))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){ch(this,$t)&&clearTimeout(ch(this,$t)),hh(this,$t,setTimeout(()=>{var e;hh(this,$t,null),null==(e=this.parent)||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[s,o]=this.pageTranslation,c=e/i,l=t/i,h=this.x*r,d=this.y*a,u=this.width*r,f=this.height*a;switch(n){case 0:return[h+c+s,a-d-l-f+o,h+c+u+s,a-d-l+o];case 90:return[h+l+s,a-d+c+o,h+l+f+s,a-d+c+u+o];case 180:return[h-c-u+s,a-d+l+o,h-c+s,a-d+l+f+o];case 270:return[h-l-f+s,a-d-c-u+o,h-l+s,a-d-c+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,r,a]=e,s=r-n,o=a-i;switch(this.rotation){case 0:return[n,t-a,s,o];case 90:return[n,t-i,o,s];case 180:return[r,t-i,s,o];case 270:return[r,t-a,o,s];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),hh(this,Vt,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),hh(this,Vt,!1),!0)}isInEditMode(){return ch(this,Vt)}shouldGetKeyboardEvents(){return ch(this,Gt)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&n>0}rebuild(){dh(this,Qt,gn).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null==(e=this._initialData)?void 0:e.popupRef)||""}}serialize(e=!1,t=null){mf("An editor must be serializable")}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});i.rotation=e.rotation,hh(i,Ct,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,a]=i.pageDimensions,[s,o,c,l]=i.getRectInCurrentCoords(e.rect,a);return i.x=s/r,i.y=o/a,i.width=c/r,i.height=l/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var e,t;if(null==(e=ch(this,Wt))||e.abort(),hh(this,Wt,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),ch(this,$t)&&(clearTimeout(ch(this,$t)),hh(this,$t,null)),dh(this,Qt,wn).call(this),this.removeEditToolbar(),ch(this,Kt)){for(const e of ch(this,Kt).values())clearTimeout(e);hh(this,Kt,null)}this.parent=null,null==(t=ch(this,Yt))||t.destroy(),hh(this,Yt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(dh(this,Qt,an).call(this),ch(this,Ot).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),hh(this,Lt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const n=ch(this,Ot).children;if(!ch(this,Ut)){hh(this,Ut,Array.from(n));const t=dh(this,Qt,mn).bind(this),i=dh(this,Qt,bn).bind(this),r=this._uiManager._signal;for(const n of ch(this,Ut)){const a=n.getAttribute("data-resizer-name");n.setAttribute("role","spinbutton"),n.addEventListener("keydown",t,{signal:r}),n.addEventListener("blur",i,{signal:r}),n.addEventListener("focus",dh(this,Qt,vn).bind(this,a),{signal:r}),n.setAttribute("data-l10n-id",e._l10nResizer[a])}}const i=ch(this,Ut)[0];let r=0;for(const e of n){if(e===i)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(ch(this,Ut).length/4);if(a!==r){if(a<r)for(let e=0;e<r-a;e++)ch(this,Ot).append(ch(this,Ot).firstChild);else if(a>r)for(let e=0;e<a-r;e++)ch(this,Ot).firstChild.before(ch(this,Ot).lastChild);let t=0;for(const i of n){const n=ch(this,Ut)[t++].getAttribute("data-resizer-name");i.setAttribute("data-l10n-id",e._l10nResizer[n])}}dh(this,Qt,yn).call(this,0),hh(this,Gt,!0),ch(this,Ot).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(e,t){ch(this,Gt)&&dh(this,Qt,ln).call(this,ch(this,Bt),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){dh(this,Qt,wn).call(this),this.div.focus()}select(){var e,t,n;this.isSelected&&this._editToolbar||(this.isSelected=!0,this.makeResizable(),null==(e=this.div)||e.classList.add("selectedEditor"),this._editToolbar?(null==(t=this._editToolbar)||t.show(),null==(n=ch(this,Ft))||n.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var e,t;(null==(e=this.div)?void 0:e.classList.contains("selectedEditor"))&&(null==(t=this._editToolbar)||t.show())}))}unselect(){var e,t,n,i,r;this.isSelected&&(this.isSelected=!1,null==(e=ch(this,Ot))||e.classList.add("hidden"),null==(t=this.div)||t.classList.remove("selectedEditor"),(null==(n=this.div)?void 0:n.contains(document.activeElement))&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null==(i=this._editToolbar)||i.hide(),null==(r=ch(this,Ft))||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return ch(this,Ht)}set isEditing(e){hh(this,Ht,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){hh(this,Mt,!0);const n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,n=!1){if(n){ch(this,Kt)||hh(this,Kt,new Map);const{action:n}=t;let i=ch(this,Kt).get(n);return i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),ch(this,Kt).delete(n),0===ch(this,Kt).size&&hh(this,Kt,null)},e._telemetryTimeout),void ch(this,Kt).set(n,i)}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),hh(this,It,!1)}disable(){this.div&&(this.div.tabIndex=-1),hh(this,It,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstChild:t}=e.container;"DIV"===(null==t?void 0:t.nodeName)&&t.classList.contains("annotationContent")&&t.remove()}};Ct=new WeakMap,Ut=new WeakMap,Ft=new WeakMap,It=new WeakMap,Rt=new WeakMap,Nt=new WeakMap,Mt=new WeakMap,Ot=new WeakMap,Pt=new WeakMap,Lt=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,jt=new WeakMap,zt=new WeakMap,Ht=new WeakMap,Vt=new WeakMap,Gt=new WeakMap,$t=new WeakMap,qt=new WeakMap,Xt=new WeakMap,Kt=new WeakMap,Yt=new WeakMap,Zt=new WeakMap,Jt=new WeakMap,Qt=new WeakSet,en=function([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},tn=new WeakSet,nn=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},rn=function(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}},an=function(){if(ch(this,Ot))return;hh(this,Ot,document.createElement("div")),ch(this,Ot).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const e=document.createElement("div");ch(this,Ot).append(e),e.classList.add("resizer",n),e.setAttribute("data-resizer-name",n),e.addEventListener("pointerdown",dh(this,Qt,sn).bind(this,n),{signal:t}),e.addEventListener("contextmenu",Kf,{signal:t}),e.tabIndex=-1}this.div.prepend(ch(this,Ot))},sn=function(e,t){var n;t.preventDefault();const{isMac:i}=Uf.platform;if(0!==t.button||t.ctrlKey&&i)return;null==(n=ch(this,Ft))||n.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,hh(this,Pt,[t.screenX,t.screenY]);const a=new AbortController,s=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",dh(this,Qt,ln).bind(this,e),{passive:!0,capture:!0,signal:s}),window.addEventListener("touchmove",Yf,{passive:!1,signal:s}),window.addEventListener("contextmenu",Kf,{signal:s}),hh(this,Lt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const l=()=>{var e;a.abort(),this.parent.togglePointerEvents(!0),null==(e=ch(this,Ft))||e.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=c,dh(this,Qt,cn).call(this)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},on=function(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*n,a*i),this.fixAndSetPosition(),this._onResized()},cn=function(){if(!ch(this,Lt))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=ch(this,Lt);hh(this,Lt,null);const r=this.x,a=this.y,s=this.width,o=this.height;r===e&&a===t&&s===n&&o===i||this.addCommands({cmd:dh(this,Qt,on).bind(this,r,a,s,o),undo:dh(this,Qt,on).bind(this,e,t,n,i),mustExec:!0})},ln=function(e,t){const[n,i]=this.parentDimensions,r=this.x,a=this.y,s=this.width,o=this.height,c=xp.MIN_SIZE/n,l=xp.MIN_SIZE/i,h=dh(this,Qt,rn).call(this,this.rotation),d=(e,t)=>[h[0]*e+h[2]*t,h[1]*e+h[3]*t],u=dh(this,Qt,rn).call(this,360-this.rotation);let f,p,g=!1,m=!1;switch(e){case"topLeft":g=!0,f=(e,t)=>[0,0],p=(e,t)=>[e,t];break;case"topMiddle":f=(e,t)=>[e/2,0],p=(e,t)=>[e/2,t];break;case"topRight":g=!0,f=(e,t)=>[e,0],p=(e,t)=>[0,t];break;case"middleRight":m=!0,f=(e,t)=>[e,t/2],p=(e,t)=>[0,t/2];break;case"bottomRight":g=!0,f=(e,t)=>[e,t],p=(e,t)=>[0,0];break;case"bottomMiddle":f=(e,t)=>[e/2,t],p=(e,t)=>[e/2,0];break;case"bottomLeft":g=!0,f=(e,t)=>[0,t],p=(e,t)=>[e,0];break;case"middleLeft":m=!0,f=(e,t)=>[0,t/2],p=(e,t)=>[e,t/2]}const b=f(s,o),v=p(s,o);let y=d(...v);const w=xp._round(r+y[0]),x=xp._round(a+y[1]);let _,T,D=1,E=1;if(t.fromKeyboard)({deltaX:_,deltaY:T}=t);else{const{screenX:e,screenY:n}=t,[i,r]=ch(this,Pt);[_,T]=this.screenToPageTranslation(e-i,n-r),ch(this,Pt)[0]=e,ch(this,Pt)[1]=n}var A,k;if([_,T]=(A=_/n,k=T/i,[u[0]*A+u[2]*k,u[1]*A+u[3]*k]),g){const e=Math.hypot(s,o);D=E=Math.max(Math.min(Math.hypot(v[0]-b[0]-_,v[1]-b[1]-T)/e,1/s,1/o),c/s,l/o)}else m?D=Pf(Math.abs(v[0]-b[0]-_),c,1)/s:E=Pf(Math.abs(v[1]-b[1]-T),l,1)/o;const S=xp._round(s*D),C=xp._round(o*E);y=d(...p(S,C));const U=w-y[0],F=x-y[1];ch(this,zt)||hh(this,zt,[this.x,this.y,this.width,this.height]),this.width=S,this.height=C,this.x=U,this.y=F,this.setDims(n*S,i*C),this.fixAndSetPosition(),this._onResizing()},hn=function(){var e;hh(this,Lt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null==(e=ch(this,Ft))||e.toggle(!1),this.parent.togglePointerEvents(!1)},dn=function(e,t,n){let i=n/t*.7+1-.7;if(1===i)return;const r=dh(this,Qt,rn).call(this,this.rotation),a=(e,t)=>[r[0]*e+r[2]*t,r[1]*e+r[3]*t],[s,o]=this.parentDimensions,c=this.x,l=this.y,h=this.width,d=this.height,u=xp.MIN_SIZE/s,f=xp.MIN_SIZE/o;i=Math.max(Math.min(i,1/h,1/d),u/h,f/d);const p=xp._round(h*i),g=xp._round(d*i);if(p===h&&g===d)return;ch(this,zt)||hh(this,zt,[c,l,h,d]);const m=a(h/2,d/2),b=xp._round(c+m[0]),v=xp._round(l+m[1]),y=a(p/2,g/2);this.x=b-y[0],this.y=v-y[1],this.width=p,this.height=g,this.setDims(s*p,o*g),this.fixAndSetPosition(),this._onResizing()},un=function(){var e;null==(e=ch(this,Ft))||e.toggle(!0),this.parent.togglePointerEvents(!0),dh(this,Qt,cn).call(this)},fn=function(e){const{isMac:t}=Uf.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},pn=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},s=e=>{i.abort(),hh(this,Rt,null),hh(this,jt,!1),this._uiManager.endDragSession()||dh(this,Qt,fn).call(this,e),n&&this._onStopDragging()};t&&(hh(this,qt,e.clientX),hh(this,Xt,e.clientY),hh(this,Rt,e.pointerId),hh(this,Nt,e.pointerType),window.addEventListener("pointermove",e=>{n||(n=!0,this._onStartDragging());const{clientX:t,clientY:i,pointerId:r}=e;if(r!==ch(this,Rt))return void Yf(e);const[a,s]=this.screenToPageTranslation(t-ch(this,qt),i-ch(this,Xt));hh(this,qt,t),hh(this,Xt,i),this._uiManager.dragSelectedEditors(a,s)},a),window.addEventListener("touchmove",Yf,a),window.addEventListener("pointerdown",e=>{e.pointerType===ch(this,Nt)&&(ch(this,Yt)||e.isPrimary)&&s(e),Yf(e)},a));const o=e=>{ch(this,Rt)&&ch(this,Rt)!==e.pointerId?Yf(e):s(e)};window.addEventListener("pointerup",o,{signal:r}),window.addEventListener("blur",o,{signal:r})},gn=function(){if(ch(this,Wt)||!this.div)return;hh(this,Wt,new AbortController);const e=this._uiManager.combinedSignal(ch(this,Wt));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},mn=function(e){xp._resizerKeyboardManager.exec(this,e)},bn=function(e){var t;ch(this,Gt)&&(null==(t=e.relatedTarget)?void 0:t.parentNode)!==ch(this,Ot)&&dh(this,Qt,wn).call(this)},vn=function(e){hh(this,Bt,ch(this,Gt)?e:"")},yn=function(e){if(ch(this,Ut))for(const t of ch(this,Ut))t.tabIndex=e},wn=function(){hh(this,Gt,!1),dh(this,Qt,yn).call(this,-1),dh(this,Qt,cn).call(this)},lh(xp,tn),sh(xp,"_l10n",null),sh(xp,"_l10nResizer",null),sh(xp,"_borderLineWidth",-1),sh(xp,"_colorManager",new pp),sh(xp,"_zIndex",1),sh(xp,"_telemetryTimeout",1e3);let _p=xp;class Tp extends _p{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Dp=3285377520,Ep=4294901760,Ap=65535;class kp{constructor(e){this.h1=e?4294967295&e:Dp,this.h2=e?4294967295&e:Dp}update(e){let t,n;if("string"==typeof e){t=new Uint8Array(2*e.length),n=0;for(let i=0,r=e.length;i<r;i++){const r=e.charCodeAt(i);r<=255?t[n++]=r:(t[n++]=r>>>8,t[n++]=255&r)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),n=t.byteLength}const i=n>>2,r=n-4*i,a=new Uint32Array(t.buffer,0,i);let s=0,o=0,c=this.h1,l=this.h2;const h=3432918353,d=461845907,u=11601,f=13715;for(let p=0;p<i;p++)1&p?(s=a[p],s=s*h&Ep|s*u&Ap,s=s<<15|s>>>17,s=s*d&Ep|s*f&Ap,c^=s,c=c<<13|c>>>19,c=5*c+3864292196):(o=a[p],o=o*h&Ep|o*u&Ap,o=o<<15|o>>>17,o=o*d&Ep|o*f&Ap,l^=o,l=l<<13|l>>>19,l=5*l+3864292196);switch(s=0,r){case 3:s^=t[4*i+2]<<16;case 2:s^=t[4*i+1]<<8;case 1:s^=t[4*i],s=s*h&Ep|s*u&Ap,s=s<<15|s>>>17,s=s*d&Ep|s*f&Ap,1&i?c^=s:l^=s}this.h1=c,this.h2=l}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Ep|36045*e&Ap,t=4283543511*t&Ep|(2950163797*(t<<16|e>>>16)&Ep)>>>16,e^=t>>>1,e=444984403*e&Ep|60499*e&Ap,t=3301882366*t&Ep|(3120437893*(t<<16|e>>>16)&Ep)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Sp=Object.freeze({map:null,hash:"",transfer:void 0});class Cp{constructor(){lh(this,Dn),lh(this,xn,!1),lh(this,_n,null),lh(this,Tn,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=ch(this,Tn).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return ch(this,Tn).get(e)}remove(e){if(ch(this,Tn).delete(e),0===ch(this,Tn).size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const e of ch(this,Tn).values())if(e instanceof _p)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=ch(this,Tn).get(e);let i=!1;if(void 0!==n)for(const[r,a]of Object.entries(t))n[r]!==a&&(i=!0,n[r]=a);else i=!0,ch(this,Tn).set(e,t);i&&dh(this,Dn,En).call(this),t instanceof _p&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return ch(this,Tn).has(e)}get size(){return ch(this,Tn).size}resetModified(){ch(this,xn)&&(hh(this,xn,!1),"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new Up(this)}get serializable(){if(0===ch(this,Tn).size)return Sp;const e=new Map,t=new kp,n=[],i=Object.create(null);let r=!1;for(const[a,s]of ch(this,Tn)){const n=s instanceof _p?s.serialize(!1,i):s;n&&(e.set(a,n),t.update(`${a}:${JSON.stringify(n)}`),r||(r=!!n.bitmap))}if(r)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Sp}get editorStats(){let e=null;const t=new Map;for(const n of ch(this,Tn).values()){if(!(n instanceof _p))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[e,t]of Object.entries(i)){if("type"===e)continue;let n=a.get(e);n||(n=new Map,a.set(e,n));const i=n.get(t)??0;n.set(t,i+1)}}for(const[n,i]of t)e[n]=i.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){hh(this,_n,null)}get modifiedIds(){if(ch(this,_n))return ch(this,_n);const e=[];for(const t of ch(this,Tn).values())t instanceof _p&&t.annotationElementId&&t.serialize()&&e.push(t.annotationElementId);return hh(this,_n,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return ch(this,Tn).entries()}}xn=new WeakMap,_n=new WeakMap,Tn=new WeakMap,Dn=new WeakSet,En=function(){ch(this,xn)||(hh(this,xn,!0),"function"==typeof this.onSetModified&&this.onSetModified())};class Up extends Cp{constructor(e){super(),lh(this,An);const{map:t,hash:n,transfer:i}=e.serializable,r=structuredClone(t,i?{transfer:i}:null);hh(this,An,{map:r,hash:n,transfer:i})}get print(){mf("Should not call PrintAnnotationStorage.print")}get serializable(){return ch(this,An)}get modifiedIds(){return wf(this,"modifiedIds",{ids:new Set,hash:""})}}An=new WeakMap;class Fp{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){lh(this,kn,new Set),this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),ch(this,kn).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(e&&!ch(this,kn).has(e.loadedName)){if(bf(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:t,src:i,style:r}=e,a=new FontFace(t,i,r);this.addNativeFontFace(a);try{await a.load(),ch(this,kn).add(t),null==n||n(e)}catch{e.baseFontName,this.removeNativeFontFace(a)}return}mf("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void(await this.loadSystemFont(e));if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw t.family,e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;return wf(this,"isFontLoadingAPISupported",!!(null==(e=this._document)?void 0:e.fonts))}get isSyncFontLoadingSupported(){return wf(this,"isSyncFontLoadingSupported",tf||Uf.platform.isFirefox)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for(bf(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){return wf(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let r,a;const s=this._document.createElement("canvas");s.width=1,s.height=1;const o=s.getContext("2d");let c=0;const l=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=i(h,976,l.length,l);const d=1482184792;let u=n(h,16);for(r=0,a=l.length-3;r<a;r+=4)u=u-d+n(l,r)|0;var f;r<l.length&&(u=u-d+n(l+"XXX",r)|0),h=i(h,16,4,(f=u,String.fromCharCode(f>>24&255,f>>16&255,f>>8&255,255&f)));const p=`@font-face {font-family:"${l}";src:url(data:font/opentype;base64,${btoa(h)});}`;this.insertRule(p);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const m of[e.loadedName,l]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=m,g.append(e)}this._document.body.append(g),function e(t,n){++c>30?n():(o.font="30px "+t,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n)))}(l,()=>{g.remove(),t.complete()})}}kn=new WeakMap;class Ip{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null==(e=this._inspectFont)||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Lf(this.data)});`;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return null==(e=this._inspectFont)||e.call(this,this,t),n}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(a){}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=r}}function Rp(e){if("string"!=typeof e)return null;if(e.endsWith("/"))return e;throw new Error(`Invalid factory url: "${e}" must include trailing slash.`)}const Np=e=>"object"==typeof e&&Number.isInteger(null==e?void 0:e.num)&&e.num>=0&&Number.isInteger(null==e?void 0:e.gen)&&e.gen>=0,Mp=function(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;const[i,r,...a]=n;if(!e(i)&&!Number.isInteger(i))return!1;if(!t(r))return!1;const s=a.length;let o=!0;switch(r.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return 0===s;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(4!==s)return!1;o=!1;break;default:return!1}for(const c of a)if(!("number"==typeof c||o&&null===c))return!1;return!0}.bind(null,Np,e=>"object"==typeof e&&"string"==typeof(null==e?void 0:e.name));class Op{constructor(){lh(this,Sn,new Map),lh(this,Cn,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};ch(this,Cn).then(()=>{for(const[e]of ch(this,Sn))e.call(this,n)})}addEventListener(e,t,n=null){let i=null;if((null==n?void 0:n.signal)instanceof AbortSignal){const{signal:r}=n;if(r.aborted)return;const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}ch(this,Sn).set(t,i)}removeEventListener(e,t){const n=ch(this,Sn).get(t);null==n||n(),ch(this,Sn).delete(t)}terminate(){for(const[,e]of ch(this,Sn))null==e||e();ch(this,Sn).clear()}}Sn=new WeakMap,Cn=new WeakMap;function Pp(){}function Lp(e){if(e instanceof kf||e instanceof Df||e instanceof _f||e instanceof Ef||e instanceof Tf)return e;switch(e instanceof Error||"object"==typeof e&&null!==e||mf('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new kf(e.message);case"InvalidPDFException":return new Df(e.message);case"PasswordException":return new _f(e.message,e.code);case"ResponseException":return new Ef(e.message,e.status,e.missing);case"UnknownErrorException":return new Tf(e.message,e.details)}return new Tf(e.message,e.toString())}class Wp{constructor(e,t,n){lh(this,Fn),lh(this,Un,new AbortController),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",dh(this,Fn,In).bind(this),{signal:ch(this,Un).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,n,i){const r=this.streamId++,a=this.sourceName,s=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const c=Promise.withResolvers();return this.streamControllers[r]={controller:n,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:a,targetName:s,action:e,streamId:r,data:t,desiredSize:n.desiredSize},i),c.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[r].pullCall=t,o.postMessage({sourceName:a,targetName:s,stream:6,streamId:r,desiredSize:e.desiredSize}),t.promise},cancel:e=>{bf(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[r].cancelCall=t,this.streamControllers[r].isClosed=!0,o.postMessage({sourceName:a,targetName:s,stream:1,streamId:r,reason:Lp(e)}),t.promise}},n)}destroy(){var e;null==(e=ch(this,Un))||e.abort(),hh(this,Un,null)}}Un=new WeakMap,Fn=new WeakSet,In=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream)return void dh(this,Fn,Nn).call(this,e);if(e.callback){const t=e.callbackId,n=this.callbackCapabilities[t];if(!n)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],1===e.callback)n.resolve(e.data);else{if(2!==e.callback)throw new Error("Unexpected callback case");n.reject(Lp(e.reason))}return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,r=this.comObj;return void Promise.try(t,e.data).then(function(t){r.postMessage({sourceName:n,targetName:i,callback:1,callbackId:e.callbackId,data:t})},function(t){r.postMessage({sourceName:n,targetName:i,callback:2,callbackId:e.callbackId,reason:Lp(t)})})}e.streamId?dh(this,Fn,Rn).call(this,e):t(e.data)},Rn=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,r=this.comObj,a=this,s=this.actionHandler[e.action],o={enqueue(e,a=1,s){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=a,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:i,stream:4,streamId:t,chunk:e},s)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:3,streamId:t}),delete a.streamSinks[t])},error(e){bf(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:5,streamId:t,reason:Lp(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,Promise.try(s,e.data,o).then(function(){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:t,reason:Lp(e)})})},Nn=function(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],s=this.streamSinks[t];switch(e.stream){case 8:e.success?a.startCall.resolve():a.startCall.reject(Lp(e.reason));break;case 7:e.success?a.pullCall.resolve():a.pullCall.reject(Lp(e.reason));break;case 6:if(!s){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,success:!0});break}s.desiredSize<=0&&e.desiredSize>0&&s.sinkCapability.resolve(),s.desiredSize=e.desiredSize,Promise.try(s.onPull||Pp).then(function(){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,reason:Lp(e)})});break;case 4:if(bf(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case 3:if(bf(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),dh(this,Fn,Mn).call(this,a,t);break;case 5:bf(a,"error should have stream controller"),a.controller.error(Lp(e.reason)),dh(this,Fn,Mn).call(this,a,t);break;case 2:e.success?a.cancelCall.resolve():a.cancelCall.reject(Lp(e.reason)),dh(this,Fn,Mn).call(this,a,t);break;case 1:if(!s)break;const o=Lp(e.reason);Promise.try(s.onCancel||Pp,o).then(function(){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:t,success:!0})},function(e){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:t,reason:Lp(e)})}),s.sinkCapability.reject(o),s.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Mn=async function(e,t){var n,i,r;await Promise.allSettled([null==(n=e.startCall)?void 0:n.promise,null==(i=e.pullCall)?void 0:i.promise,null==(r=e.cancelCall)?void 0:r.promise]),delete this.streamControllers[t]};class Bp{constructor({enableHWA:e=!1}){lh(this,On,!1),hh(this,On,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!ch(this,On)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){mf("Abstract method `_createCanvas` called.")}}On=new WeakMap;class jp extends Bp{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class zp{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){mf("Abstract method `_fetch` called.")}}class Hp extends zp{async _fetch(e){const t=await zf(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Cf(t)}}class Vp{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,r){return"none"}destroy(e=!1){}}class Gp extends Vp{constructor({docId:e,ownerDocument:t=globalThis.document}){super(),lh(this,Vn),lh(this,Pn),lh(this,Ln),lh(this,Wn),lh(this,Bn),lh(this,jn),lh(this,zn),lh(this,Hn,0),hh(this,Bn,e),hh(this,jn,t)}addFilter(e){if(!e)return"none";let t=ch(this,Vn,Gn).get(e);if(t)return t;const[n,i,r]=dh(this,Vn,Xn).call(this,e),a=1===e.length?n:`${n}${i}${r}`;if(t=ch(this,Vn,Gn).get(a),t)return ch(this,Vn,Gn).set(e,t),t;const s=`g_${ch(this,Bn)}_transfer_map_${uh(this,Hn)._++}`,o=dh(this,Vn,Kn).call(this,s);ch(this,Vn,Gn).set(e,o),ch(this,Vn,Gn).set(a,o);const c=dh(this,Vn,Jn).call(this,s);return dh(this,Vn,ei).call(this,n,i,r,c),o}addHCMFilter(e,t){var n;const i=`${e}-${t}`,r="base";let a=ch(this,Vn,$n).get(r);if((null==a?void 0:a.key)===i)return a.url;if(a?(null==(n=a.filter)||n.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},ch(this,Vn,$n).set(r,a)),!e||!t)return a.url;const s=dh(this,Vn,ni).call(this,e);e=If.makeHexColor(...s);const o=dh(this,Vn,ni).call(this,t);if(t=If.makeHexColor(...o),ch(this,Vn,qn).style.color="","#000000"===e&&"#ffffff"===t||e===t)return a.url;const c=new Array(256);for(let f=0;f<=255;f++){const e=f/255;c[f]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=c.join(","),h=`g_${ch(this,Bn)}_hcm_filter`,d=a.filter=dh(this,Vn,Jn).call(this,h);dh(this,Vn,ei).call(this,l,l,l,d),dh(this,Vn,Zn).call(this,d);const u=(e,t)=>{const n=s[e]/255,i=o[e]/255,r=new Array(t+1);for(let a=0;a<=t;a++)r[a]=n+a/t*(i-n);return r.join(",")};return dh(this,Vn,ei).call(this,u(0,5),u(1,5),u(2,5),d),a.url=dh(this,Vn,Kn).call(this,h),a.url}addAlphaFilter(e){let t=ch(this,Vn,Gn).get(e);if(t)return t;const[n]=dh(this,Vn,Xn).call(this,[e]),i=`alpha_${n}`;if(t=ch(this,Vn,Gn).get(i),t)return ch(this,Vn,Gn).set(e,t),t;const r=`g_${ch(this,Bn)}_alpha_map_${uh(this,Hn)._++}`,a=dh(this,Vn,Kn).call(this,r);ch(this,Vn,Gn).set(e,a),ch(this,Vn,Gn).set(i,a);const s=dh(this,Vn,Jn).call(this,r);return dh(this,Vn,ti).call(this,n,s),a}addLuminosityFilter(e){let t,n,i=ch(this,Vn,Gn).get(e||"luminosity");if(i)return i;if(e?([t]=dh(this,Vn,Xn).call(this,[e]),n=`luminosity_${t}`):n="luminosity",i=ch(this,Vn,Gn).get(n),i)return ch(this,Vn,Gn).set(e,i),i;const r=`g_${ch(this,Bn)}_luminosity_map_${uh(this,Hn)._++}`,a=dh(this,Vn,Kn).call(this,r);ch(this,Vn,Gn).set(e,a),ch(this,Vn,Gn).set(n,a);const s=dh(this,Vn,Jn).call(this,r);return dh(this,Vn,Yn).call(this,s),e&&dh(this,Vn,ti).call(this,t,s),a}addHighlightHCMFilter(e,t,n,i,r){var a;const s=`${t}-${n}-${i}-${r}`;let o=ch(this,Vn,$n).get(e);if((null==o?void 0:o.key)===s)return o.url;if(o?(null==(a=o.filter)||a.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},ch(this,Vn,$n).set(e,o)),!t||!n)return o.url;const[c,l]=[t,n].map(dh(this,Vn,ni).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[u,f]=[i,r].map(dh(this,Vn,ni).bind(this));d<h&&([h,d,u,f]=[d,h,f,u]),ch(this,Vn,qn).style.color="";const p=(e,t,n)=>{const i=new Array(256),r=(d-h)/n,a=e/255,s=(t-e)/(255*n);let o=0;for(let c=0;c<=n;c++){const e=Math.round(h+c*r),t=a+c*s;for(let n=o;n<=e;n++)i[n]=t;o=e+1}for(let c=o;c<256;c++)i[c]=i[o-1];return i.join(",")},g=`g_${ch(this,Bn)}_hcm_${e}_filter`,m=o.filter=dh(this,Vn,Jn).call(this,g);return dh(this,Vn,Zn).call(this,m),dh(this,Vn,ei).call(this,p(u[0],f[0],5),p(u[1],f[1],5),p(u[2],f[2],5),m),o.url=dh(this,Vn,Kn).call(this,g),o.url}destroy(e=!1){var t,n,i,r;e&&(null==(t=ch(this,zn))?void 0:t.size)||(null==(n=ch(this,Wn))||n.parentNode.parentNode.remove(),hh(this,Wn,null),null==(i=ch(this,Ln))||i.clear(),hh(this,Ln,null),null==(r=ch(this,zn))||r.clear(),hh(this,zn,null),hh(this,Hn,0))}}Pn=new WeakMap,Ln=new WeakMap,Wn=new WeakMap,Bn=new WeakMap,jn=new WeakMap,zn=new WeakMap,Hn=new WeakMap,Vn=new WeakSet,Gn=function(){return ch(this,Ln)||hh(this,Ln,new Map)},$n=function(){return ch(this,zn)||hh(this,zn,new Map)},qn=function(){if(!ch(this,Wn)){const e=ch(this,jn).createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=ch(this,jn).createElementNS(Wf,"svg");n.setAttribute("width",0),n.setAttribute("height",0),hh(this,Wn,ch(this,jn).createElementNS(Wf,"defs")),e.append(n),n.append(ch(this,Wn)),ch(this,jn).body.append(e)}return ch(this,Wn)},Xn=function(e){if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;const i=n.join(",");return[i,i,i]}const[t,n,i]=e,r=new Array(256),a=new Array(256),s=new Array(256);for(let o=0;o<256;o++)r[o]=t[o]/255,a[o]=n[o]/255,s[o]=i[o]/255;return[r.join(","),a.join(","),s.join(",")]},Kn=function(e){if(void 0===ch(this,Pn)){hh(this,Pn,"");const e=ch(this,jn).URL;e!==ch(this,jn).baseURI&&(Gf(e)||hh(this,Pn,yf(e,"")))}return`url(${ch(this,Pn)}#${e})`},Yn=function(e){const t=ch(this,jn).createElementNS(Wf,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)},Zn=function(e){const t=ch(this,jn).createElementNS(Wf,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)},Jn=function(e){const t=ch(this,jn).createElementNS(Wf,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),ch(this,Vn,qn).append(t),t},Qn=function(e,t,n){const i=ch(this,jn).createElementNS(Wf,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)},ei=function(e,t,n,i){const r=ch(this,jn).createElementNS(Wf,"feComponentTransfer");i.append(r),dh(this,Vn,Qn).call(this,r,"feFuncR",e),dh(this,Vn,Qn).call(this,r,"feFuncG",t),dh(this,Vn,Qn).call(this,r,"feFuncB",n)},ti=function(e,t){const n=ch(this,jn).createElementNS(Wf,"feComponentTransfer");t.append(n),dh(this,Vn,Qn).call(this,n,"feFuncA",e)},ni=function(e){return ch(this,Vn,qn).style.color=e,Jf(getComputedStyle(ch(this,Vn,qn)).getPropertyValue("color"))};class $p{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(e=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){mf("Abstract method `_fetch` called.")}}class qp extends $p{async _fetch(e){const t=await zf(e,"arraybuffer");return new Uint8Array(t)}}class Xp{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(e=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){mf("Abstract method `_fetch` called.")}}class Kp extends Xp{async _fetch(e){const t=await zf(e,"arraybuffer");return new Uint8Array(t)}}async function Yp(e){const t=process.getBuiltinModule("fs"),n=await t.promises.readFile(e);return new Uint8Array(n)}class Zp extends Vp{}class Jp extends Bp{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Qp extends zp{async _fetch(e){return Yp(e)}}class eg extends $p{async _fetch(e){return Yp(e)}}class tg extends Xp{async _fetch(e){return Yp(e)}}const ng="Fill",ig="Stroke",rg="Shading";function ag(e,t){if(!t)return;const n=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],n,i),e.clip(r)}class sg{isModifyingCurrentTransform(){return!1}getPattern(){mf("Abstract method `getPattern` called.")}}class og extends sg{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let r;if(i===ig||i===ng){const a=t.current.getClippedPathBoundingBox(i,Qf(e))||[0,0,0,0],s=Math.ceil(a[2]-a[0])||1,o=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",s,o),l=c.context;l.clearRect(0,0,l.canvas.width,l.canvas.height),l.beginPath(),l.rect(0,0,l.canvas.width,l.canvas.height),l.translate(-a[0],-a[1]),n=If.transform(n,[1,0,0,1,a[0],a[1]]),l.transform(...t.baseTransform),this.matrix&&l.transform(...this.matrix),ag(l,this._bbox),l.fillStyle=this._createGradient(l),l.fill(),r=e.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(n);r.setTransform(h)}else ag(e,this._bbox),r=this._createGradient(e);return r}}function cg(e,t,n,i,r,a,s,o){const c=t.coords,l=t.colors,h=e.data,d=4*e.width;let u;c[n+1]>c[i+1]&&(u=n,n=i,i=u,u=a,a=s,s=u),c[i+1]>c[r+1]&&(u=i,i=r,r=u,u=s,s=o,o=u),c[n+1]>c[i+1]&&(u=n,n=i,i=u,u=a,a=s,s=u);const f=(c[n]+t.offsetX)*t.scaleX,p=(c[n+1]+t.offsetY)*t.scaleY,g=(c[i]+t.offsetX)*t.scaleX,m=(c[i+1]+t.offsetY)*t.scaleY,b=(c[r]+t.offsetX)*t.scaleX,v=(c[r+1]+t.offsetY)*t.scaleY;if(p>=v)return;const y=l[a],w=l[a+1],x=l[a+2],_=l[s],T=l[s+1],D=l[s+2],E=l[o],A=l[o+1],k=l[o+2],S=Math.round(p),C=Math.round(v);let U,F,I,R,N,M,O,P;for(let L=S;L<=C;L++){if(L<m){const e=L<p?0:(p-L)/(p-m);U=f-(f-g)*e,F=y-(y-_)*e,I=w-(w-T)*e,R=x-(x-D)*e}else{let e;e=L>v?1:m===v?0:(m-L)/(m-v),U=g-(g-b)*e,F=_-(_-E)*e,I=T-(T-A)*e,R=D-(D-k)*e}let e;e=L<p?0:L>v?1:(p-L)/(p-v),N=f-(f-b)*e,M=y-(y-E)*e,O=w-(w-A)*e,P=x-(x-k)*e;const t=Math.round(Math.min(U,N)),n=Math.round(Math.max(U,N));let i=d*L+4*t;for(let r=t;r<=n;r++)e=(U-r)/(U-N),e<0?e=0:e>1&&(e=1),h[i++]=F-(F-M)*e|0,h[i++]=I-(I-O)*e|0,h[i++]=R-(R-P)*e|0,h[i++]=255}}function lg(e,t,n){const i=t.coords,r=t.colors;let a,s;switch(t.type){case"lattice":const o=t.verticesPerRow,c=Math.floor(i.length/o)-1,l=o-1;for(a=0;a<c;a++){let t=a*o;for(let a=0;a<l;a++,t++)cg(e,n,i[t],i[t+1],i[t+o],r[t],r[t+1],r[t+o]),cg(e,n,i[t+o+1],i[t+1],i[t+o],r[t+o+1],r[t+1],r[t+o])}break;case"triangles":for(a=0,s=i.length;a<s;a+=3)cg(e,n,i[a],i[a+1],i[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class hg extends sg{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-i,s=Math.ceil(this._bounds[3])-r,o=Math.min(Math.ceil(Math.abs(a*e[0]*1.1)),3e3),c=Math.min(Math.ceil(Math.abs(s*e[1]*1.1)),3e3),l=a/o,h=s/c,d={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/l,scaleY:1/h},u=o+4,f=c+4,p=n.getCanvas("mesh",u,f),g=p.context,m=g.createImageData(o,c);if(t){const e=m.data;for(let n=0,i=e.length;n<i;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const b of this._figures)lg(m,b,d);return g.putImageData(m,2,2),{canvas:p.canvas,offsetX:i-2*l,offsetY:r-2*h,scaleX:l,scaleY:h}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){ag(e,this._bbox);const r=new Float32Array(2);if(i===rg)If.singularValueDecompose2dScale(Qf(e),r);else if(this.matrix){If.singularValueDecompose2dScale(this.matrix,r);const[e,n]=r;If.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=e,r[1]*=n}else If.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,i===rg?null:this._background,t.cachedCanvases);return i!==rg&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class dg extends sg{getPattern(){return"hotpink"}}const ug=class e{constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:s}=this;let{xstep:o,ystep:c}=this;o=Math.abs(o),c=Math.abs(c);const l=t[0],h=t[1],d=t[2],u=t[3],f=d-l,p=u-h,g=new Float32Array(2);If.singularValueDecompose2dScale(this.matrix,g);const[m,b]=g;If.singularValueDecompose2dScale(this.baseTransform,g);const v=m*g[0],y=b*g[1];let w=f,x=p,_=!1,T=!1;const D=Math.ceil(o*v),E=Math.ceil(c*y);D>=Math.ceil(f*v)?w=o:_=!0,E>=Math.ceil(p*y)?x=c:T=!0;const A=this.getSizeAndScale(w,this.ctx.canvas.width,v),k=this.getSizeAndScale(x,this.ctx.canvas.height,y),S=e.cachedCanvases.getCanvas("pattern",A.size,k.size),C=S.context,U=s.createCanvasGraphics(C);if(U.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(U,i,a),C.translate(-A.scale*l,-k.scale*h),U.transform(A.scale,0,0,k.scale,0,0),C.save(),this.clipBbox(U,l,h,d,u),U.baseTransform=Qf(U.ctx),U.executeOperatorList(n),U.endDrawing(),C.restore(),_||T){const t=S.canvas;_&&(w=o),T&&(x=c);const n=this.getSizeAndScale(w,this.ctx.canvas.width,v),i=this.getSizeAndScale(x,this.ctx.canvas.height,y),r=n.size,a=i.size,s=e.cachedCanvases.getCanvas("pattern-workaround",r,a),d=s.context,u=_?Math.floor(f/o):0,g=T?Math.floor(p/c):0;for(let e=0;e<=u;e++)for(let n=0;n<=g;n++)d.drawImage(t,r*e,a*n,r,a,0,0,r,a);return{canvas:s.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:l,offsetY:h}}return{canvas:S.canvas,scaleX:A.scale,scaleY:k.scale,offsetX:l,offsetY:h}}getSizeAndScale(t,n,i){const r=Math.max(e.MAX_PATTERN_SIZE,n);let a=Math.ceil(t*i);return a>=r?a=r:i=a/t,{scale:i,size:a}}clipBbox(e,t,n,i,r){const a=i-t,s=r-n;e.ctx.rect(t,n,a,s),If.axialAlignedBoundingBox([t,n,i,r],Qf(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,r=e.current;switch(t){case 1:const{fillStyle:e,strokeStyle:a}=this.ctx;i.fillStyle=r.fillColor=e,i.strokeStyle=r.strokeColor=a;break;case 2:i.fillStyle=i.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new Af(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i){let r=n;i!==rg&&(r=If.transform(r,t.baseTransform),this.matrix&&(r=If.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let s=new DOMMatrix(r);s=s.translate(a.offsetX,a.offsetY),s=s.scale(1/a.scaleX,1/a.scaleY);const o=e.createPattern(a.canvas,"repeat");return o.setTransform(s),o}};sh(ug,"MAX_PATTERN_SIZE",3e3);let fg=ug;function pg({src:e,srcPos:t=0,dest:n,width:i,height:r,nonBlackColor:a=4294967295,inverseDecode:s=!1}){const o=Uf.isLittleEndian?4278190080:255,[c,l]=s?[a,o]:[o,a],h=i>>3,d=7&i,u=e.length;n=new Uint32Array(n.buffer);let f=0;for(let p=0;p<r;p++){for(const r=t+h;t<r;t++){const i=t<u?e[t]:255;n[f++]=128&i?l:c,n[f++]=64&i?l:c,n[f++]=32&i?l:c,n[f++]=16&i?l:c,n[f++]=8&i?l:c,n[f++]=4&i?l:c,n[f++]=2&i?l:c,n[f++]=1&i?l:c}if(0===d)continue;const i=t<u?e[t++]:255;for(let e=0;e<d;e++)n[f++]=i&1<<7-e?l:c}return{srcPos:t,destPos:f}}const gg=16,mg=new DOMMatrix,bg=new Float32Array(2),vg=new Float32Array([1/0,1/0,-1/0,-1/0]);class yg{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function wg(e,t,n,i,r,a,s,o,c,l){const[h,d,u,f,p,g]=Qf(e);if(0===d&&0===u){const m=s*h+p,b=Math.round(m),v=o*f+g,y=Math.round(v),w=(s+c)*h+p,x=Math.abs(Math.round(w)-b)||1,_=(o+l)*f+g,T=Math.abs(Math.round(_)-y)||1;return e.setTransform(Math.sign(h),0,0,Math.sign(f),b,y),e.drawImage(t,n,i,r,a,0,0,x,T),e.setTransform(h,d,u,f,p,g),[x,T]}if(0===h&&0===f){const m=o*u+p,b=Math.round(m),v=s*d+g,y=Math.round(v),w=(o+l)*u+p,x=Math.abs(Math.round(w)-b)||1,_=(s+c)*d+g,T=Math.abs(Math.round(_)-y)||1;return e.setTransform(0,Math.sign(d),Math.sign(u),0,b,y),e.drawImage(t,n,i,r,a,0,0,T,x),e.setTransform(h,d,u,f,p,g),[T,x]}return e.drawImage(t,n,i,r,a,s,o,c,l),[Math.hypot(h,d)*c,Math.hypot(u,f)*l]}class xg{constructor(e,t){sh(this,"alphaIsShape",!1),sh(this,"fontSize",0),sh(this,"fontSizeScale",1),sh(this,"textMatrix",null),sh(this,"textMatrixScale",1),sh(this,"fontMatrix",nf),sh(this,"leading",0),sh(this,"x",0),sh(this,"y",0),sh(this,"lineX",0),sh(this,"lineY",0),sh(this,"charSpacing",0),sh(this,"wordSpacing",0),sh(this,"textHScale",1),sh(this,"textRenderingMode",0),sh(this,"textRise",0),sh(this,"fillColor","#000000"),sh(this,"strokeColor","#000000"),sh(this,"patternFill",!1),sh(this,"patternStroke",!1),sh(this,"fillAlpha",1),sh(this,"strokeAlpha",1),sh(this,"lineWidth",1),sh(this,"activeSMask",null),sh(this,"transferMaps","none"),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=vg.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ng,t=null){const n=this.minMax.slice();if(e===ig){t||mf("Stroke bounding box must include transform."),If.singularValueDecompose2dScale(t,bg);const e=bg[0]*this.lineWidth/2,i=bg[1]*this.lineWidth/2;n[0]-=e,n[1]-=i,n[2]+=e,n[3]+=i}return n}updateClipFromPath(){const e=If.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(vg,0)}getClippedPathBoundingBox(e=ng,t=null){return If.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function _g(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,i=t.width,r=n%gg,a=(n-r)/gg,s=0===r?a:a+1,o=e.createImageData(i,gg);let c,l=0;const h=t.data,d=o.data;let u,f,p,g;if(t.kind===lf.GRAYSCALE_1BPP){const t=h.byteLength,n=new Uint32Array(d.buffer,0,d.byteLength>>2),g=n.length,m=i+7>>3,b=4294967295,v=Uf.isLittleEndian?4278190080:255;for(u=0;u<s;u++){for(p=u<a?gg:r,c=0,f=0;f<p;f++){const e=t-l;let r=0;const a=e>m?i:8*e-7,s=-8&a;let o=0,d=0;for(;r<s;r+=8)d=h[l++],n[c++]=128&d?b:v,n[c++]=64&d?b:v,n[c++]=32&d?b:v,n[c++]=16&d?b:v,n[c++]=8&d?b:v,n[c++]=4&d?b:v,n[c++]=2&d?b:v,n[c++]=1&d?b:v;for(;r<a;r++)0===o&&(d=h[l++],o=128),n[c++]=d&o?b:v,o>>=1}for(;c<g;)n[c++]=0;e.putImageData(o,0,u*gg)}}else if(t.kind===lf.RGBA_32BPP){for(f=0,g=i*gg*4,u=0;u<a;u++)d.set(h.subarray(l,l+g)),l+=g,e.putImageData(o,0,f),f+=gg;u<s&&(g=i*r*4,d.set(h.subarray(l,l+g)),e.putImageData(o,0,f))}else{if(t.kind!==lf.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(p=gg,g=i*p,u=0;u<s;u++){for(u>=a&&(p=r,g=i*p),c=0,f=g;f--;)d[c++]=h[l++],d[c++]=h[l++],d[c++]=h[l++],d[c++]=255;e.putImageData(o,0,u*gg)}}}function Tg(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,i=t.width,r=n%gg,a=(n-r)/gg,s=0===r?a:a+1,o=e.createImageData(i,gg);let c=0;const l=t.data,h=o.data;for(let d=0;d<s;d++){const t=d<a?gg:r;({srcPos:c}=pg({src:l,srcPos:c,dest:h,width:i,height:t,nonBlackColor:0})),e.putImageData(o,0,d*gg)}}function Dg(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function Eg(e){e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0);const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}function Ag(e,t){if(t)return!0;If.singularValueDecompose2dScale(e,bg);const n=Math.fround(np.pixelRatio*jf.PDF_TO_CSS_UNITS);return bg[0]<=n&&bg[1]<=n}const kg=["butt","round","square"],Sg=["miter","round","bevel"],Cg={},Ug={};ii=new WeakSet,ri=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ai=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},si=function(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i};let Fg=class e{constructor(e,t,n,i,r,{optionalContentConfig:a,markedContentStack:s=null},o,c){lh(this,ii),this.ctx=e,this.current=new xg(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=s||[],this.optionalContentConfig=a,this.cachedCanvases=new yg(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,s=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=s,n){const e=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...Qf(this.compositeCtx))}this.ctx.save(),Eg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Qf(this.ctx)}executeOperatorList(e,t,n,i){const r=e.argsArray,a=e.fnArray;let s=t||0;const o=r.length;if(o===s)return s;const c=o-s>10&&"function"==typeof n,l=c?Date.now()+15:0;let h=0;const d=this.commonObjs,u=this.objs;let f;for(;;){if(void 0!==i&&s===i.nextBreakPoint)return i.breakIt(s,n),s;if(f=a[s],f!==uf.dependency)this[f].apply(this,r[s]);else for(const e of r[s]){const t=e.startsWith("g_")?d:u;if(!t.has(e))return t.get(e,n),s}if(s++,s===o)return s;if(c&&++h>10){if(Date.now()>l)return n(),s;h=0}}}endDrawing(){dh(this,ii,ri).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),dh(this,ii,ai).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let r,a,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=n,l=i,h="prescale1";for(;s>2&&c>1||o>2&&l>1;){let t=c,n=l;s>2&&c>1&&(t=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),s/=c/t),o>2&&l>1&&(n=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/n),r=this.cachedCanvases.getCanvas(h,t,n),a=r.context,a.clearRect(0,0,t,n),a.drawImage(e,0,0,c,l,0,0,t,n),e=r.canvas,c=t,l=n,h="prescale1"===h?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,s=Qf(t);let o,c,l,h;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;c=JSON.stringify(a?s:[s.slice(0,4),r]),o=this._cachedBitmapsMap.get(t),o||(o=new Map,this._cachedBitmapsMap.set(t,o));const n=o.get(c);if(n&&!a)return{canvas:n,offsetX:Math.round(Math.min(s[0],s[2])+s[4]),offsetY:Math.round(Math.min(s[1],s[3])+s[5])};l=n}l||(h=this.cachedCanvases.getCanvas("maskCanvas",n,i),Tg(h.context,e));let d=If.transform(s,[1/n,0,0,-1/i,0,0]);d=If.transform(d,[1,0,0,1,0,-i]);const u=vg.slice();If.axialAlignedBoundingBox([0,0,n,i],d,u);const[f,p,g,m]=u,b=Math.round(g-f)||1,v=Math.round(m-p)||1,y=this.cachedCanvases.getCanvas("fillCanvas",b,v),w=y.context,x=f,_=p;w.translate(-x,-_),w.transform(...d),l||(l=this._scaleImage(h.canvas,ep(w)),l=l.img,o&&a&&o.set(c,l)),w.imageSmoothingEnabled=Ag(Qf(w),e.interpolate),wg(w,l,0,0,l.width,l.height,0,0,n,i),w.globalCompositeOperation="source-in";const T=If.transform(ep(w),[1,0,0,1,-x,-_]);return w.fillStyle=a?r.getPattern(t,this,T,ng):r,w.fillRect(0,0,n,i),o&&!a&&(this.cachedCanvases.delete("fillCanvas"),o.set(c,y.canvas)),{canvas:y.canvas,offsetX:Math.round(x),offsetY:Math.round(_)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=kg[e]}setLineJoin(e){this.ctx.lineJoin=Sg[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),Dg(this.suspendedCtx,r),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,i,r,a,s){t.transform(e,n,i,r,a,s),this.__originalTransform(e,n,i,r,a,s)},e.setTransform=function(e,n,i,r,a,s){t.setTransform(e,n,i,r,a,s),this.__originalSetTransform(e,n,i,r,a,s)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,i,r,a,s){t.bezierCurveTo(e,n,i,r,a,s),this.__originalBezierCurveTo(e,n,i,r,a,s)},e.rect=function(e,n,i,r){t.rect(e,n,i,r),this.__originalRect(e,n,i,r)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Dg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const r=i[0],a=i[1],s=i[2]-r,o=i[3]-a;0!==s&&0!==o&&(this.genericComposeSMask(t.context,n,s,o,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,r,a,s,o,c,l,h){let d=e.canvas,u=o-l,f=c-h;if(a)if(u<0||f<0||u+n>d.width||f+i>d.height){const e=this.cachedCanvases.getCanvas("maskExtension",n,i),t=e.context;t.drawImage(d,-u,-f),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(0,0,n,i),t.globalCompositeOperation="source-over",d=e.canvas,u=f=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const t=new Path2D;t.rect(u,f,n,i),e.clip(t),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(u,f,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===r&&s?t.filter=this.filterFactory.addAlphaFilter(s):"Luminosity"===r&&(t.filter=this.filterFactory.addLuminosityFilter(s));const p=new Path2D;p.rect(o,c,n,i),t.clip(p),t.globalCompositeOperation="destination-in",t.drawImage(d,u,f,n,i,o,c,n,i),t.restore()}save(){this.inSMaskMode&&Dg(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Dg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(e,t,n,i,r,a){this.ctx.transform(e,t,n,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let[i]=t;if(!n)return i||(i=t[0]=new Path2D),void this[e](i);if(!(i instanceof Path2D)){const e=t[0]=new Path2D;for(let t=0,n=i.length;t<n;)switch(i[t++]){case 0:e.moveTo(i[t++],i[t++]);break;case 1:e.lineTo(i[t++],i[t++]);break;case 2:e.bezierCurveTo(i[t++],i[t++],i[t++],i[t++],i[t++],i[t++]);break;case 3:e.closePath();break;default:gf(i[t-1])}i=e}If.axialAlignedBoundingBox(n,Qf(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"==typeof i&&(null==i?void 0:i.getPattern)){const t=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,ep(n),ig),t){const i=new Path2D;i.addPath(e,n.getTransform().invertSelf().multiplySelf(t)),e=i}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(ig,Qf(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const n=this.ctx,i=this.current.fillColor;let r=!1;if(this.current.patternFill){const t=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=i.getPattern(n,this,ep(n),ng),t){const i=new Path2D;i.addPath(e,n.getTransform().invertSelf().multiplySelf(t)),e=i}r=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==a&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),r&&n.restore(),t&&this.consumePath(e,a)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=Cg}eoClip(){this.pendingClip=Ug}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return;const n=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:s,fontSize:o,path:c}of e)n.addPath(c,new DOMMatrix(r).preMultiplySelf(i).translate(a,s).scale(o,-o));t.clip(n),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var n;const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||nf,0===r.fontMatrix[0]||r.fontMatrix[3],t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const a=i.loadedName||"sans-serif",s=(null==(n=i.systemFontInfo)?void 0:n.css)||`"${a}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const c=i.italic?"italic":"normal";let l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font=`${c} ${o} ${l}px ${s}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i,r){const a=this.ctx,s=this.current,o=s.font,c=s.textRenderingMode,l=s.fontSize/s.fontSizeScale,h=3&c,d=!!(4&c),u=s.patternFill&&!o.missingFile,f=s.patternStroke&&!o.missingFile;let p;if((o.disableFontFace||d||u||f)&&(p=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||u||f){let e;if(a.save(),a.translate(t,n),a.scale(l,-l),0!==h&&2!==h||(i?(e=a.getTransform(),a.setTransform(...i),a.fill(dh(this,ii,si).call(this,p,e,i))):a.fill(p)),1===h||2===h)if(r){e||(e=a.getTransform()),a.setTransform(...r);const{a:t,b:n,c:i,d:s}=e,o=If.inverseTransform(r),c=If.transform([t,n,i,s,0,0],o);If.singularValueDecompose2dScale(c,bg),a.lineWidth*=Math.max(bg[0],bg[1])/l,a.stroke(dh(this,ii,si).call(this,p,e,r))}else a.lineWidth/=l,a.stroke(p);a.restore()}else 0!==h&&2!==h||a.fillText(e,t,n),1!==h&&2!==h||a.strokeText(e,t,n);d&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Qf(a),x:t,y:n,fontSize:l,path:p})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return wf(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(0===i)return;const r=this.ctx,a=t.fontSizeScale,s=t.charSpacing,o=t.wordSpacing,c=t.fontDirection,l=t.textHScale*c,h=e.length,d=n.vertical,u=d?1:-1,f=n.defaultVMetrics,p=i*t.fontMatrix[0],g=0===t.textRenderingMode&&!n.disableFontFace&&!t.patternFill;let m,b;if(r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(l,-1):r.scale(l,1),t.patternFill){r.save();const e=t.fillColor.getPattern(r,this,ep(r),ng);m=Qf(r),r.restore(),r.fillStyle=e}if(t.patternStroke){r.save();const e=t.strokeColor.getPattern(r,this,ep(r),ig);b=Qf(r),r.restore(),r.strokeStyle=e}let v=t.lineWidth;const y=t.textMatrixScale;if(0===y||0===v){const e=3&t.textRenderingMode;1!==e&&2!==e||(v=this.getSinglePixelWidth())}else v/=y;if(1!==a&&(r.scale(a,a),v/=a),r.lineWidth=v,n.isInvalidPDFjsFont){const n=[];let i=0;for(const t of e)n.push(t.unicode),i+=t.width;return r.fillText(n.join(""),0,0),t.x+=i*p*l,r.restore(),void this.compose()}let w,x=0;for(w=0;w<h;++w){const t=e[w];if("number"==typeof t){x+=u*t*i/1e3;continue}let l=!1;const h=(t.isSpace?o:0)+s,v=t.fontChar,y=t.accent;let _,T,D=t.width;if(d){const e=t.vmetric||f,n=-(t.vmetric?e[1]:.5*D)*p,i=e[2]*p;D=e?-e[0]:D,_=n/a,T=(x+i)/a}else _=x/a,T=0;if(n.remeasure&&D>0){const e=1e3*r.measureText(v).width/i*a;if(D<e&&this.isFontSubpixelAAEnabled){const t=D/e;l=!0,r.save(),r.scale(t,1),_/=t}else D!==e&&(_+=(D-e)/2e3*i/a)}if(this.contentVisible&&(t.isInFont||n.missingFile))if(g&&!y)r.fillText(v,_,T);else if(this.paintChar(v,_,T,m,b),y){const e=_+i*y.offset.x/a,t=T-i*y.offset.y/a;this.paintChar(y.fontChar,e,t,m,b)}x+=d?D*p-h*c:D*p+h*c,l&&r.restore()}d?t.y-=x:t.x+=x*l,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,i=n.font,r=n.fontSize,a=n.fontDirection,s=i.vertical?1:-1,o=n.charSpacing,c=n.wordSpacing,l=n.textHScale*a,h=n.fontMatrix||nf,d=e.length;let u,f,p,g;if(3!==n.textRenderingMode&&0!==r){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),n.textMatrix&&t.transform(...n.textMatrix),t.translate(n.x,n.y+n.textRise),t.scale(l,a),u=0;u<d;++u){if(f=e[u],"number"==typeof f){g=s*f*r/1e3,this.ctx.translate(g,0),n.x+=g*l;continue}const a=(f.isSpace?c:0)+o,d=i.charProcOperatorList[f.operatorListId];d?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...h),this.executeOperatorList(d),this.restore()):gf(f.operatorListId);const m=[f.width,0];If.applyTransform(m,h),p=m[0]*r+a,t.translate(p,0),n.x+=p*l}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,r,a){const s=new Path2D;s.rect(n,i,r-n,a-i),this.ctx.clip(s),this.endPath()}getColorN_Pattern(t){let n;if("TilingPattern"===t[0]){const i=this.baseTransform||Qf(this.ctx),r={createCanvasGraphics:t=>new e(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new fg(t,this.ctx,r,i)}else n=this._getPattern(t[1],t[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=function(e){switch(e[0]){case"RadialAxial":return new og(e);case"Mesh":return new hg(e);case"Dummy":return new dg}throw new Error(`Unknown IR type: ${e[0]}`)}(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,ep(t),rg);const i=ep(t);if(i){const{width:e,height:n}=t.canvas,r=vg.slice();If.axialAlignedBoundingBox([0,0,e,n],i,r);const[a,s,o,c]=r;this.ctx.fillRect(a,s,o-a,c-s)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){mf("Should not call beginInlineImage")}beginImageData(){mf("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Qf(this.ctx),t)){If.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[e,n,i,r]=t,a=new Path2D;a.rect(e,n,i-e,r-n),this.ctx.clip(a),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated,e.knockout;const n=Qf(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=vg.slice();If.axialAlignedBoundingBox(e.bbox,Qf(t),i);const r=[0,0,t.canvas.width,t.canvas.height];i=If.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),s=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-a,1),c=Math.max(Math.ceil(i[3])-s,1);this.current.startNewPathAndClipBox([0,0,o,c]);let l="groupAt"+this.groupLevel;e.smask&&(l+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(l,o,c),d=h.context;d.translate(-a,-s),d.transform(...n);let u=new Path2D;const[f,p,g,m]=e.bbox;if(u.rect(f,p,g-f,m-p),e.matrix){const t=new Path2D;t.addPath(u,new DOMMatrix(e.matrix)),u=t}d.clip(u),e.smask?this.smaskStack.push({canvas:h.canvas,context:d,offsetX:a,offsetY:s,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,s),t.save()),Dg(t,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=Qf(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const n=vg.slice();If.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e,n),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,r){if(dh(this,ii,ri).call(this),Eg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const i=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){(n=n.slice())[4]-=t[0],n[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=i,t[3]=a,If.singularValueDecompose2dScale(Qf(this.ctx),bg);const{viewportScale:r}=this,s=Math.ceil(i*this.outputScaleX*r),o=Math.ceil(a*this.outputScaleY*r);this.annotationCanvas=this.canvasFactory.create(s,o);const{canvas:c,context:l}=this.annotationCanvas;this.annotationCanvasMap.set(e,c),this.annotationCanvas.savedCtx=this.ctx,this.ctx=l,this.ctx.save(),this.ctx.setTransform(bg[0],0,0,-bg[1],0,a*bg[1]),Eg(this.ctx)}else{Eg(this.ctx),this.endPath();const e=new Path2D;e.rect(t[0],t[1],i,a),this.ctx.clip(e)}}this.current=new xg(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),dh(this,ii,ai).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const n=this.ctx,i=this._createMaskCanvas(e),r=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const s=this.ctx;s.save();const o=Qf(s);s.transform(t,n,i,r,0,0);const c=this._createMaskCanvas(e);s.setTransform(1,0,0,1,c.offsetX-o[4],c.offsetY-o[5]);for(let l=0,h=a.length;l<h;l+=2){const e=If.transform(o,[t,n,i,r,a[l],a[l+1]]);s.drawImage(c.canvas,e[4],e[5])}s.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:e,width:a,height:s,transform:o}=r,c=this.cachedCanvases.getCanvas("maskCanvas",a,s),l=c.context;l.save(),Tg(l,this.getObject(e,r)),l.globalCompositeOperation="source-in",l.fillStyle=i?n.getPattern(l,this,ep(t),ng):n,l.fillRect(0,0,a,s),l.restore(),t.save(),t.transform(...o),t.scale(1,-1),wg(t,c.canvas,0,0,a,s,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t&&this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r)return;const a=r.width,s=r.height,o=[];for(let c=0,l=i.length;c<l;c+=2)o.push({transform:[t,0,0,n,i[c],i[c+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(r,o)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",n,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;this.save();const{filter:r}=i;let a;if("none"!==r&&""!==r&&(i.filter="none"),i.scale(1/t,-1/n),e.bitmap)a=this.applyTransferMapsToBitmap(e);else if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)a=e;else{const i=this.cachedCanvases.getCanvas("inlineImage",t,n).context;_g(i,e),a=this.applyTransferMapsToCanvas(i)}const s=this._scaleImage(a,ep(i));i.imageSmoothingEnabled=Ag(Qf(i),e.interpolate),wg(i,s.img,0,0,s.paintWidth,s.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const t=e.width,n=e.height,r=this.cachedCanvases.getCanvas("inlineImage",t,n).context;_g(r,e),i=this.applyTransferMapsToCanvas(r)}for(const r of t)n.save(),n.transform(...r.transform),n.scale(1,-1),wg(n,i,r.x,r.y,r.w,r.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(n||(this.pendingClip===Ug?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Qf(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:r}=this.ctx.getTransform();let a,s;if(0===n&&0===i){const n=Math.abs(t),i=Math.abs(r);if(n===i)if(0===e)a=s=1/n;else{const t=n*e;a=s=t<1?1/t:1}else if(0===e)a=1/n,s=1/i;else{const t=n*e,r=i*e;a=t<1?1/t:1,s=r<1?1/r:1}}else{const o=Math.abs(t*r-n*i),c=Math.hypot(t,n),l=Math.hypot(i,r);if(0===e)a=l/o,s=c/o;else{const t=e*o;a=l>t?l/t:1,s=c>t?c/t:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=s}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[r,a]=this.getScaleForStroking();if(r===a)return n.lineWidth=(i||1)*r,void n.stroke(e);const s=n.getLineDash();t&&n.save(),n.scale(r,a),mg.a=1/r,mg.d=1/a;const o=new Path2D;if(o.addPath(e,mg),s.length>0){const e=Math.max(r,a);n.setLineDash(s.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=i||1,n.stroke(o),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(const $ in uf)void 0!==Fg.prototype[$]&&(Fg.prototype[uf[$]]=Fg.prototype[$]);class Ig{static get workerPort(){return ch(this,oi)}static set workerPort(e){if(!("undefined"!=typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");hh(this,oi,e)}static get workerSrc(){return ch(this,ci)}static set workerSrc(e){if("string"!=typeof e)throw new Error("Invalid `workerSrc` type.");hh(this,ci,e)}}oi=new WeakMap,ci=new WeakMap,lh(Ig,oi,null),lh(Ig,ci,"");class Rg{constructor({parsedData:e,rawData:t}){lh(this,li),lh(this,hi),hh(this,li,e),hh(this,hi,t)}getRaw(){return ch(this,hi)}get(e){return ch(this,li).get(e)??null}[Symbol.iterator](){return ch(this,li).entries()}}li=new WeakMap,hi=new WeakMap;const Ng=Symbol("INTERNAL");class Mg{constructor(e,{name:t,intent:n,usage:i,rbGroups:r}){lh(this,di,!1),lh(this,ui,!1),lh(this,fi,!1),lh(this,pi,!0),hh(this,di,!!(2&e)),hh(this,ui,!!(4&e)),this.name=t,this.intent=n,this.usage=i,this.rbGroups=r}get visible(){if(ch(this,fi))return ch(this,pi);if(!ch(this,pi))return!1;const{print:e,view:t}=this.usage;return ch(this,di)?"OFF"!==(null==t?void 0:t.viewState):!ch(this,ui)||"OFF"!==(null==e?void 0:e.printState)}_setVisible(e,t,n=!1){e!==Ng&&mf("Internal method `_setVisible` called."),hh(this,fi,n),hh(this,pi,t)}}di=new WeakMap,ui=new WeakMap,fi=new WeakMap,pi=new WeakMap;class Og{constructor(e,t=2){if(lh(this,yi),lh(this,gi,null),lh(this,mi,new Map),lh(this,bi,null),lh(this,vi,null),this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,hh(this,vi,e.order);for(const n of e.groups)ch(this,mi).set(n.id,new Mg(t,n));if("OFF"===e.baseState)for(const e of ch(this,mi).values())e._setVisible(Ng,!1);for(const t of e.on)ch(this,mi).get(t)._setVisible(Ng,!0);for(const t of e.off)ch(this,mi).get(t)._setVisible(Ng,!1);hh(this,bi,this.getHash())}}isVisible(e){if(0===ch(this,mi).size)return!0;if(!e)return!0;if("OCG"===e.type)return ch(this,mi).has(e.id)?ch(this,mi).get(e.id).visible:(e.id,!0);if("OCMD"===e.type){if(e.expression)return dh(this,yi,wi).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!ch(this,mi).has(t))return gf(),!0;if(ch(this,mi).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!ch(this,mi).has(t))return gf(),!0;if(!ch(this,mi).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!ch(this,mi).has(t))return gf(),!0;if(!ch(this,mi).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!ch(this,mi).has(t))return gf(),!0;if(ch(this,mi).get(t).visible)return!1}return!0}return e.policy,!0}return e.type,!0}setVisibility(e,t=!0,n=!0){var i;const r=ch(this,mi).get(e);if(r){if(n&&t&&r.rbGroups.length)for(const t of r.rbGroups)for(const n of t)n!==e&&(null==(i=ch(this,mi).get(n))||i._setVisible(Ng,!1,!0));r._setVisible(Ng,!!t,!0),hh(this,gi,null)}}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const e=ch(this,mi).get(i);if(e)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!e.visible,t)}}hh(this,gi,null)}get hasInitialVisibility(){return null===ch(this,bi)||this.getHash()===ch(this,bi)}getOrder(){return ch(this,mi).size?ch(this,vi)?ch(this,vi).slice():[...ch(this,mi).keys()]:null}getGroup(e){return ch(this,mi).get(e)||null}getHash(){if(null!==ch(this,gi))return ch(this,gi);const e=new kp;for(const[t,n]of ch(this,mi))e.update(`${t}:${n.visible}`);return hh(this,gi,e.hexdigest())}[Symbol.iterator](){return ch(this,mi).entries()}}gi=new WeakMap,mi=new WeakMap,bi=new WeakMap,vi=new WeakMap,yi=new WeakSet,wi=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const t=e[i];let r;if(Array.isArray(t))r=dh(this,yi,wi).call(this,t);else{if(!ch(this,mi).has(t))return gf(),!0;r=ch(this,mi).get(t).visible}switch(n){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return"And"===n};class Pg{constructor(e,{disableRange:t=!1,disableStream:n=!1}){bf(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:s}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=s,(null==r?void 0:r.length)>0){const e=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),e.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),e.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;void 0===e?this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n):bf(this._rangeReaders.some(function(t){return t._begin===e&&(t._enqueue(n),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){var e;return(null==(e=this._fullRequestReader)?void 0:e._loaded)??0}_onProgress(e){var t,n,i,r;void 0===e.total?null==(n=null==(t=this._rangeReaders[0])?void 0:t.onProgress)||n.call(t,{loaded:e.loaded}):null==(r=null==(i=this._fullRequestReader)?void 0:i.onProgress)||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;null==(e=this._fullRequestReader)||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){bf(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Lg(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Wg(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;null==(t=this._fullRequestReader)||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Lg{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=$f(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Wg{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Bg(e,t){const n=new Headers;if(!e||!t||"object"!=typeof t)return n;for(const i in t){const e=t[i];void 0!==e&&n.append(i,e)}return n}function jg(e){var t;return(null==(t=URL.parse(e))?void 0:t.origin)??null}function zg({responseHeaders:e,isHttp:t,rangeChunkSize:n,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(e.get("Content-Length"),10);return Number.isInteger(a)?(r.suggestedLength=a,a<=2*n||i||!t||"bytes"!==e.get("Accept-Ranges")||"identity"!==(e.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r):r}function Hg(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,n=i("filename\\*","i").exec(e);if(n){n=n[1];let e=s(n);return e=unescape(e),e=o(e),e=c(e),a(e)}if(n=function(e){const t=[];let n;const r=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(e));){let[,e,i,r]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,r]}const a=[];for(let i=0;i<t.length&&i in t;++i){let[e,n]=t[i];n=s(n),e&&(n=unescape(n),0===i&&(n=o(n))),a.push(n)}return a.join("")}(e),n)return a(c(n));if(n=i("filename","i").exec(e),n){n=n[1];let e=s(n);return e=c(e),a(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function r(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(e,{fatal:!0}),r=Cf(n);n=i.decode(r),t=!1}catch{}}return n}function a(e){return t&&/[\x80-\xff]/.test(e)&&(e=r("utf-8",e),t&&(e=r("iso-8859-1",e))),e}function s(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function o(e){const t=e.indexOf("'");return-1===t?e:r(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,i){if("q"===n||"Q"===n)return r(t,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{i=atob(i)}catch{}return r(t,i)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if($f(e))return e}return null}function Vg(e,t){return new Ef(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e,404===e||0===e&&t.startsWith("file:"))}function Gg(e){return 200===e||206===e}function $g(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function qg(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:new Uint8Array(e).buffer}class Xg{constructor(e){sh(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Bg(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return(null==(e=this._fullRequestReader)?void 0:e._loaded)??0}getFullReader(){return bf(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Kg(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Yg(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null==(t=this._fullRequestReader)||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Kg{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,$g(n,this._withCredentials,this._abortController)).then(t=>{if(e._responseOrigin=jg(t.url),!Gg(t.status))throw Vg(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const n=t.headers,{allowRangeRequests:r,suggestedLength:a}=zg({responseHeaders:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=Hg(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new kf("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null==(e=this.onProgress)||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:qg(t),done:!1})}cancel(e){var t;null==(t=this._reader)||t.cancel(e),this._abortController.abort()}}class Yg{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${n-1}`);const a=i.url;fetch(a,$g(r,this._withCredentials,this._abortController)).then(t=>{const n=jg(t.url);if(n!==e._responseOrigin)throw new Error(`Expected range response-origin "${n}" to match "${e._responseOrigin}".`);if(!Gg(t.status))throw Vg(t.status,a);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null==(e=this.onProgress)||e.call(this,{loaded:this._loaded}),{value:qg(t),done:!1})}cancel(e){var t;null==(t=this._reader)||t.cancel(e),this._abortController.abort()}}class Zg{constructor({url:e,httpHeaders:t,withCredentials:n}){sh(this,"_responseOrigin",null),this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Bg(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",bf(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var n;const i=this.pendingRequests[e];i&&(null==(n=i.onProgress)||n.call(i,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void n.onError(i.status);const r=i.status||200;if((200!==r||206!==n.expectedStatus)&&r!==n.expectedStatus)return void n.onError(i.status);const a=function(e){const t=e.response;return"string"!=typeof t?t:Cf(t).buffer}(i);if(206===r){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?n.onDone({begin:parseInt(t[1],10),chunk:a}):n.onError(0)}else a?n.onDone({begin:0,chunk:a}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Jg{constructor(e){this._source=e,this._manager=new Zg(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return bf(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Qg(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new em(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null==(t=this._fullRequestReader)||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Qg{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=jg(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(e=>{const[t,...n]=e.split(": ");return[t,n.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=zg({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Hg(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Vg(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;null==(t=this.onProgress)||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class em{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=jg(null==(e=this._manager.getRequestXhr(this._requestId))?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;null==(e=this.onClosed)||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Vg(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||null==(t=this.onProgress)||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const tm=/^[a-z][a-z0-9\-+.]+:/i;class nm{constructor(e){this.source=e,this.url=function(e){if(tm.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),bf("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return(null==(e=this._fullRequestReader)?void 0:e._loaded)??0}getFullReader(){return bf(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new im(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new rm(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null==(t=this._fullRequestReader)||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class im{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(e=>{this._contentLength=e.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},e=>{"ENOENT"===e.code&&(e=Vg(0,this._url.href)),this._storedError=e,this._headersCapability.reject(e)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,null==(e=this.onProgress)||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new kf("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class rm{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,null==(e=this.onProgress)||e.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const am=Symbol("INITIAL_DATA");class sm{constructor(){lh(this,_i),lh(this,xi,Object.create(null))}get(e,t=null){if(t){const n=dh(this,_i,Ti).call(this,e);return n.promise.then(()=>t(n.data)),null}const n=ch(this,xi)[e];if(!n||n.data===am)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=ch(this,xi)[e];return!!t&&t.data!==am}delete(e){const t=ch(this,xi)[e];return!(!t||t.data===am||(delete ch(this,xi)[e],0))}resolve(e,t=null){const n=dh(this,_i,Ti).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in ch(this,xi)){const{data:n}=ch(this,xi)[t];null==(e=null==n?void 0:n.bitmap)||e.close()}hh(this,xi,Object.create(null))}*[Symbol.iterator](){for(const e in ch(this,xi)){const{data:t}=ch(this,xi)[e];t!==am&&(yield[e,t])}}}xi=new WeakMap,_i=new WeakSet,Ti=function(e){var t;return(t=ch(this,xi))[e]||(t[e]={...Promise.withResolvers(),data:am})};const om=class e{constructor({textContentSource:t,container:n,viewport:i}){var r;if(lh(this,Xi),lh(this,Ei,Promise.withResolvers()),lh(this,Ai,null),lh(this,ki,!1),lh(this,Si,!!(null==(Di=globalThis.FontInspector)?void 0:Di.enabled)),lh(this,Ci,null),lh(this,Ui,null),lh(this,Fi,0),lh(this,Ii,0),lh(this,Ri,null),lh(this,Ni,null),lh(this,Mi,0),lh(this,Oi,0),lh(this,Pi,Object.create(null)),lh(this,Li,[]),lh(this,Wi,null),lh(this,Bi,[]),lh(this,ji,new WeakMap),lh(this,zi,null),t instanceof ReadableStream)hh(this,Wi,t);else{if("object"!=typeof t)throw new Error('No "textContentSource" parameter specified.');hh(this,Wi,new ReadableStream({start(e){e.enqueue(t),e.close()}}))}hh(this,Ai,hh(this,Ni,n)),hh(this,Oi,i.scale*np.pixelRatio),hh(this,Mi,i.rotation),hh(this,Ui,{div:null,properties:null,ctx:null});const{pageWidth:a,pageHeight:s,pageX:o,pageY:c}=i.rawDims;hh(this,zi,[1,0,0,-1,-o,c+s]),hh(this,Ii,a),hh(this,Fi,s),dh(r=e,Ji,tr).call(r),tp(n,i),ch(this,Ei).promise.finally(()=>{ch(e,qi).delete(this),hh(this,Ui,null),hh(this,Pi,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Uf.platform;return wf(this,"fontFamilyMap",new Map([["sans-serif",(e&&t?"Calibri, ":"")+"sans-serif"],["monospace",(e&&t?"Lucida Console, ":"")+"monospace"]]))}render(){const t=()=>{ch(this,Ri).read().then(({value:e,done:n})=>{n?ch(this,Ei).resolve():(ch(this,Ci)??hh(this,Ci,e.lang),Object.assign(ch(this,Pi),e.styles),dh(this,Xi,Ki).call(this,e.items),t())},ch(this,Ei).reject)};return hh(this,Ri,ch(this,Wi).getReader()),ch(e,qi).add(this),t(),ch(this,Ei).promise}update({viewport:t,onBefore:n=null}){var i;const r=t.scale*np.pixelRatio,a=t.rotation;if(a!==ch(this,Mi)&&(null==n||n(),hh(this,Mi,a),tp(ch(this,Ni),{rotation:a})),r!==ch(this,Oi)){null==n||n(),hh(this,Oi,r);const t={div:null,properties:null,ctx:dh(i=e,Ji,Qi).call(i,ch(this,Ci))};for(const e of ch(this,Bi))t.properties=ch(this,ji).get(e),t.div=e,dh(this,Xi,Zi).call(this,t)}}cancel(){var e;const t=new kf("TextLayer task cancelled.");null==(e=ch(this,Ri))||e.cancel(t).catch(()=>{}),hh(this,Ri,null),ch(this,Ei).reject(t)}get textDivs(){return ch(this,Bi)}get textContentItemsStr(){return ch(this,Li)}static cleanup(){if(!(ch(this,qi).size>0)){ch(this,Hi).clear();for(const{canvas:e}of ch(this,Vi).values())e.remove();ch(this,Vi).clear()}}};Ei=new WeakMap,Ai=new WeakMap,ki=new WeakMap,Si=new WeakMap,Ci=new WeakMap,Ui=new WeakMap,Fi=new WeakMap,Ii=new WeakMap,Ri=new WeakMap,Ni=new WeakMap,Mi=new WeakMap,Oi=new WeakMap,Pi=new WeakMap,Li=new WeakMap,Wi=new WeakMap,Bi=new WeakMap,ji=new WeakMap,zi=new WeakMap,Hi=new WeakMap,Vi=new WeakMap,Gi=new WeakMap,$i=new WeakMap,qi=new WeakMap,Xi=new WeakSet,Ki=function(e){var t,n;if(ch(this,ki))return;(n=ch(this,Ui)).ctx??(n.ctx=dh(t=om,Ji,Qi).call(t,ch(this,Ci)));const i=ch(this,Bi),r=ch(this,Li);for(const a of e){if(i.length>1e5)return gf(),void hh(this,ki,!0);if(void 0!==a.str)r.push(a.str),dh(this,Xi,Yi).call(this,a);else if("beginMarkedContentProps"===a.type||"beginMarkedContent"===a.type){const e=ch(this,Ai);hh(this,Ai,document.createElement("span")),ch(this,Ai).classList.add("markedContent"),null!==a.id&&ch(this,Ai).setAttribute("id",`${a.id}`),e.append(ch(this,Ai))}else"endMarkedContent"===a.type&&hh(this,Ai,ch(this,Ai).parentNode)}},Yi=function(e){var t;const n=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};ch(this,Bi).push(n);const r=If.transform(ch(this,zi),e.transform);let a=Math.atan2(r[1],r[0]);const s=ch(this,Pi)[e.fontName];s.vertical&&(a+=Math.PI/2);let o=ch(this,Si)&&s.fontSubstitution||s.fontFamily;o=om.fontFamilyMap.get(o)||o;const c=Math.hypot(r[2],r[3]),l=c*dh(t=om,Ji,nr).call(t,o,s,ch(this,Ci));let h,d;0===a?(h=r[4],d=r[5]-l):(h=r[4]+l*Math.sin(a),d=r[5]-l*Math.cos(a));const u="calc(var(--total-scale-factor) *",f=n.style;ch(this,Ai)===ch(this,Ni)?(f.left=`${(100*h/ch(this,Ii)).toFixed(2)}%`,f.top=`${(100*d/ch(this,Fi)).toFixed(2)}%`):(f.left=`${u}${h.toFixed(2)}px)`,f.top=`${u}${d.toFixed(2)}px)`),f.fontSize=`${u}${(ch(om,$i)*c).toFixed(2)}px)`,f.fontFamily=o,i.fontSize=c,n.setAttribute("role","presentation"),n.textContent=e.str,n.dir=e.dir,ch(this,Si)&&(n.dataset.fontName=s.fontSubstitutionLoadedName||e.fontName),0!==a&&(i.angle=a*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),n=Math.abs(e.transform[3]);t!==n&&Math.max(t,n)/Math.min(t,n)>1.5&&(p=!0)}if(p&&(i.canvasWidth=s.vertical?e.height:e.width),ch(this,ji).set(n,i),ch(this,Ui).div=n,ch(this,Ui).properties=i,dh(this,Xi,Zi).call(this,ch(this,Ui)),i.hasText&&ch(this,Ai).append(n),i.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),ch(this,Ai).append(e)}},Zi=function(e){var t;const{div:n,properties:i,ctx:r}=e,{style:a}=n;let s="";if(ch(om,$i)>1&&(s=`scale(${1/ch(om,$i)})`),0!==i.canvasWidth&&i.hasText){const{fontFamily:e}=a,{canvasWidth:o,fontSize:c}=i;dh(t=om,Ji,er).call(t,r,c*ch(this,Oi),e);const{width:l}=r.measureText(n.textContent);l>0&&(s=`scaleX(${o*ch(this,Oi)/l}) ${s}`)}0!==i.angle&&(s=`rotate(${i.angle}deg) ${s}`),s.length>0&&(a.transform=s)},Ji=new WeakSet,Qi=function(e=null){let t=ch(this,Vi).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),ch(this,Vi).set(e,t),ch(this,Gi).set(t,{size:0,family:""})}return t},er=function(e,t,n){const i=ch(this,Gi).get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)},tr=function(){if(null!==ch(this,$i))return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),hh(this,$i,e.getBoundingClientRect().height),e.remove()},nr=function(e,t,n){const i=ch(this,Hi).get(e);if(i)return i;const r=dh(this,Ji,Qi).call(this,n);r.canvas.width=r.canvas.height=30,dh(this,Ji,er).call(this,r,30,e);const a=r.measureText(""),s=a.fontBoundingBoxAscent,o=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return s?c=s/(s+o):(Uf.platform.isFirefox,t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),ch(this,Hi).set(e,c),c},lh(om,Ji),lh(om,Hi,new Map),lh(om,Vi,new Map),lh(om,Gi,new WeakMap),lh(om,$i,null),lh(om,qi,new Set);let cm=om;class lm{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};return function e(n){var i;if(!n)return;let r=null;const a=n.name;if("#text"===a)r=n.value;else{if(!lm.shouldBuildText(a))return;(null==(i=null==n?void 0:n.attributes)?void 0:i.textContent)?r=n.attributes.textContent:n.value&&(r=n.value)}if(null!==r&&t.push({str:r}),n.children)for(const t of n.children)e(t)}(e),n}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}function hm(e={}){"string"==typeof e||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=new um,{docId:n}=t,i=e.url?function(e){if(e instanceof URL)return e.href;if("string"==typeof e){if(tf)return e;const t=URL.parse(e,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(e.url):null,r=e.data?function(e){if(tf&&"undefined"!=typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"==typeof e)return Cf(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"==typeof e&&!isNaN(null==e?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(e.data):null,a=e.httpHeaders||null,s=!0===e.withCredentials,o=e.password??null,c=e.range instanceof fm?e.range:null,l=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:65536;let h=e.worker instanceof bm?e.worker:null;const d=e.verbosity,u="string"!=typeof e.docBaseUrl||Gf(e.docBaseUrl)?null:e.docBaseUrl,f=Rp(e.cMapUrl),p=!1!==e.cMapPacked,g=e.CMapReaderFactory||(tf?Qp:Hp),m=Rp(e.iccUrl),b=Rp(e.standardFontDataUrl),v=e.StandardFontDataFactory||(tf?eg:qp),y=Rp(e.wasmUrl),w=e.WasmFactory||(tf?tg:Kp),x=!0!==e.stopAtErrors,_=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,T=!1!==e.isEvalSupported,D="boolean"==typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!tf,E="boolean"==typeof e.isImageDecoderSupported?e.isImageDecoderSupported:!tf&&(Uf.platform.isFirefox||!globalThis.chrome),A=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,k="boolean"==typeof e.disableFontFace?e.disableFontFace:tf,S=!0===e.fontExtraProperties,C=!0===e.enableXfa,U=e.ownerDocument||globalThis.document,F=!0===e.disableRange,I=!0===e.disableStream,R=!0===e.disableAutoFetch,N=!0===e.pdfBug,M=e.CanvasFactory||(tf?Jp:jp),O=e.FilterFactory||(tf?Zp:Gp),P=!0===e.enableHWA,L=!1!==e.useWasm,W=c?c.length:e.length??NaN,B="boolean"==typeof e.useSystemFonts?e.useSystemFonts:!tf&&!k,j="boolean"==typeof e.useWorkerFetch?e.useWorkerFetch:!!(g===Hp&&v===qp&&w===Kp&&f&&b&&y&&Xf(f,document.baseURI)&&Xf(b,document.baseURI)&&Xf(y,document.baseURI));var z;z=d,Number.isInteger(z)&&(ff=z);const H={canvasFactory:new M({ownerDocument:U,enableHWA:P}),filterFactory:new O({docId:n,ownerDocument:U}),cMapReaderFactory:j?null:new g({baseUrl:f,isCompressed:p}),standardFontDataFactory:j?null:new v({baseUrl:b}),wasmFactory:j?null:new w({baseUrl:y})};h||(h=bm.create({verbosity:d,port:Ig.workerPort}),t._worker=h);const V={docId:n,apiVersion:"5.3.93",data:r,password:o,disableAutoFetch:R,rangeChunkSize:l,length:W,docBaseUrl:u,enableXfa:C,evaluatorOptions:{maxImageSize:_,disableFontFace:k,ignoreErrors:x,isEvalSupported:T,isOffscreenCanvasSupported:D,isImageDecoderSupported:E,canvasMaxAreaInBytes:A,fontExtraProperties:S,useSystemFonts:B,useWasm:L,useWorkerFetch:j,cMapUrl:f,iccUrl:m,standardFontDataUrl:b,wasmUrl:y}},G={ownerDocument:U,pdfBug:N,styleElement:null,loadingParams:{disableAutoFetch:R,enableXfa:C}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const e=h.messageHandler.sendWithPromise("GetDocRequest",V,r?[r.buffer]:null);let o;if(c)o=new Pg(c,{disableRange:F,disableStream:I});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const e=Xf(i)?Xg:tf?nm:Jg;o=new e({url:i,length:W,httpHeaders:a,withCredentials:s,rangeChunkSize:l,disableRange:F,disableStream:I})}return e.then(e=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const i=new Wp(n,e,h.port),r=new vm(i,t,o,G,H);t._transport=r,i.send("Ready",null)})}).catch(t._capability.reject),t}const dm=class e{constructor(){sh(this,"_capability",Promise.withResolvers()),sh(this,"_transport",null),sh(this,"_worker",null),sh(this,"docId","d"+uh(e,ir)._++),sh(this,"destroyed",!1),sh(this,"onPassword",null),sh(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,i;this.destroyed=!0;try{(null==(e=this._worker)?void 0:e.port)&&(this._worker._pendingDestroy=!0),await(null==(t=this._transport)?void 0:t.destroy())}catch(r){throw(null==(n=this._worker)?void 0:n.port)&&delete this._worker._pendingDestroy,r}this._transport=null,null==(i=this._worker)||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};ir=new WeakMap,lh(dm,ir,0);let um=dm;class fm{constructor(e,t,n=!1,i=null){lh(this,rr,Promise.withResolvers()),lh(this,ar,[]),lh(this,sr,[]),lh(this,or,[]),lh(this,cr,[]),this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){ch(this,cr).push(e)}addProgressListener(e){ch(this,or).push(e)}addProgressiveReadListener(e){ch(this,sr).push(e)}addProgressiveDoneListener(e){ch(this,ar).push(e)}onDataRange(e,t){for(const n of ch(this,cr))n(e,t)}onDataProgress(e,t){ch(this,rr).promise.then(()=>{for(const n of ch(this,or))n(e,t)})}onDataProgressiveRead(e){ch(this,rr).promise.then(()=>{for(const t of ch(this,sr))t(e)})}onDataProgressiveDone(){ch(this,rr).promise.then(()=>{for(const e of ch(this,ar))e()})}transportReady(){ch(this,rr).resolve()}requestDataRange(e,t){mf("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}rr=new WeakMap,ar=new WeakMap,sr=new WeakMap,or=new WeakMap,cr=new WeakMap;class pm{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return wf(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class gm{constructor(e,t,n,i=!1){lh(this,hr),lh(this,lr,!1),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new qf:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new sm,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}={}){return new Hf({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return wf(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null==(e=this._transport._htmlForXfa)?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=af.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:s=null,annotationCanvasMap:o=null,pageColors:c=null,printAnnotationStorage:l=null,isEditing:h=!1}){var d,u;null==(d=this._stats)||d.time("Overall");const f=this._transport.getRenderingIntent(n,i,l,h),{renderingIntent:p,cacheKey:g}=f;hh(this,lr,!1),s||(s=this._transport.getOptionalContentConfig(p));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const b=!!(4&p);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null==(u=this._stats)||u.time("Page Request"),this._pumpOperatorList(f));const v=e=>{var t;m.renderTasks.delete(y),b&&hh(this,lr,!0),dh(this,hr,dr).call(this),e?(y.capability.reject(e),this._abortOperatorList({intentState:m,reason:e instanceof Error?e:new Error(e)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(null==(t=globalThis.Stats)?void 0:t.enabled)&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new xm({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(y);const w=y.task;return Promise.all([m.displayReadyCapability.promise,s]).then(([e,t])=>{var n;if(this.destroyed)v();else{if(null==(n=this._stats)||n.time("Rendering"),!(t.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:e,optionalContentConfig:t}),y.operatorListChanged()}}).catch(v),w}getOperatorList({intent:e="display",annotationMode:t=af.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){var r;const a=this._transport.getRenderingIntent(e,t,n,i,!0);let s,o=this._intentStates.get(a.cacheKey);return o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o)),o.opListReadCapability||(s=Object.create(null),s.operatorListChanged=function(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(s))},o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(s),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null==(r=this._stats)||r.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>lm.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const i=t.getReader(),r={items:[],styles:Object.create(null),lang:null};!function t(){i.read().then(function({value:n,done:i}){i?e(r):(r.lang??(r.lang=n.lang),Object.assign(r.styles,n.styles),r.items.push(...n.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),hh(this,lr,!1),Promise.all(e)}cleanup(e=!1){hh(this,lr,!0);const t=dh(this,hr,dr).call(this);return e&&t&&this._stats&&(this._stats=new qf),t}_startRenderPage(e,t){var n,i;const r=this._intentStates.get(t);r&&(null==(n=this._stats)||n.timeEnd("Page Request"),null==(i=r.displayReadyCapability)||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&dh(this,hr,dr).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:r,transfer:a}=n,s=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),o=this._intentStates.get(t);o.streamReader=s;const c=()=>{s.read().then(({value:e,done:t})=>{t?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,o),c())},e=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const e of o.renderTasks)e.operatorListChanged();dh(this,hr,dr).call(this)}if(o.displayReadyCapability)o.displayReadyCapability.reject(e);else{if(!o.opListReadCapability)throw e;o.opListReadCapability.reject(e)}}})};c()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Vf){let n=100;return t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),void(e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n))}}if(e.streamReader.cancel(new kf(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}lr=new WeakMap,hr=new WeakSet,dr=function(){if(!ch(this,lr)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),hh(this,lr,!1),!0};const mm=class e{constructor({name:t=null,port:n=null,verbosity:i=pf()}={}){if(lh(this,yr),lh(this,ur,Promise.withResolvers()),lh(this,fr,null),lh(this,pr,null),lh(this,gr,null),this.name=t,this.destroyed=!1,this.verbosity=i,n){if(ch(e,vr).has(n))throw new Error("Cannot use more than one PDFWorker per port.");ch(e,vr).set(n,this),dh(this,yr,xr).call(this,n)}else dh(this,yr,_r).call(this)}get promise(){return ch(this,ur).promise}get port(){return ch(this,pr)}get messageHandler(){return ch(this,fr)}destroy(){var t,n;this.destroyed=!0,null==(t=ch(this,gr))||t.terminate(),hh(this,gr,null),ch(e,vr).delete(ch(this,pr)),hh(this,pr,null),null==(n=ch(this,fr))||n.destroy(),hh(this,fr,null)}static create(t){const n=ch(this,vr).get(null==t?void 0:t.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new e(t)}static get workerSrc(){if(Ig.workerSrc)return Ig.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return wf(this,"_setupFakeWorkerGlobal",(async()=>ch(this,Dr,Er)?ch(this,Dr,Er):(await import(this.workerSrc)).WorkerMessageHandler)())}};ur=new WeakMap,fr=new WeakMap,pr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,vr=new WeakMap,yr=new WeakSet,wr=function(){ch(this,ur).resolve(),ch(this,fr).send("configure",{verbosity:this.verbosity})},xr=function(e){hh(this,pr,e),hh(this,fr,new Wp("main","worker",e)),ch(this,fr).on("ready",()=>{}),dh(this,yr,wr).call(this)},_r=function(){if(ch(mm,br)||ch(mm,Dr,Er))return void dh(this,yr,Tr).call(this);let{workerSrc:e}=mm;try{mm._isSameOrigin(window.location,e)||(e=mm._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Wp("main","worker",t),i=()=>{r.abort(),n.destroy(),t.terminate(),this.destroyed?ch(this,ur).reject(new Error("Worker was destroyed")):dh(this,yr,Tr).call(this)},r=new AbortController;t.addEventListener("error",()=>{ch(this,gr)||i()},{signal:r.signal}),n.on("test",e=>{r.abort(),!this.destroyed&&e?(hh(this,fr,n),hh(this,pr,t),hh(this,gr,t),dh(this,yr,wr).call(this)):i()}),n.on("ready",e=>{if(r.abort(),this.destroyed)i();else try{a()}catch{dh(this,yr,Tr).call(this)}});const a=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void a()}catch{}dh(this,yr,Tr).call(this)},Tr=function(){ch(mm,br)||hh(mm,br,!0),mm._setupFakeWorkerGlobal.then(e=>{if(this.destroyed)return void ch(this,ur).reject(new Error("Worker was destroyed"));const t=new Op;hh(this,pr,t);const n="fake"+uh(mm,mr)._++,i=new Wp(n+"_worker",n,t);e.setup(i,t),hh(this,fr,new Wp(n,n+"_worker",t)),dh(this,yr,wr).call(this)}).catch(e=>{ch(this,ur).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Dr=new WeakSet,Er=function(){var e;try{return(null==(e=globalThis.pdfjsWorker)?void 0:e.WorkerMessageHandler)||null}catch{return null}},lh(mm,Dr),lh(mm,mr,0),lh(mm,br,!1),lh(mm,vr,new WeakMap),tf&&(hh(mm,br,!0),Ig.workerSrc||(Ig.workerSrc="./pdf.worker.mjs")),mm._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(null==n?void 0:n.origin)||"null"===n.origin)return!1;const i=new URL(t,n);return n.origin===i.origin},mm._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},mm.fromPort=e=>{if(!(null==e?void 0:e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return mm.create(e)};let bm=mm;class vm{constructor(e,t,n,i,r){lh(this,Fr),lh(this,Ar,new Map),lh(this,kr,new Map),lh(this,Sr,new Map),lh(this,Cr,new Map),lh(this,Ur,null),this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sm,this.fontLoader=new Fp({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return wf(this,"annotationStorage",new Cp)}getRenderingIntent(e,t=af.ENABLE,n=null,i=!1,r=!1){let a=2,s=Sp;switch(e){case"any":a=1;break;case"display":break;case"print":a=4}const o=4&a&&n instanceof Up?n:this.annotationStorage;switch(t){case af.DISABLE:a+=64;break;case af.ENABLE:break;case af.ENABLE_FORMS:a+=16;break;case af.ENABLE_STORAGE:a+=32,s=o.serializable}i&&(a+=128),r&&(a+=256);const{ids:c,hash:l}=o.modifiedIds;return{renderingIntent:a,cacheKey:[a,s.hash,l].join("_"),annotationStorageSerializable:s,modifiedIds:c}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null==(e=ch(this,Ur))||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of ch(this,kr).values())t.push(i._destroy());ch(this,kr).clear(),ch(this,Sr).clear(),ch(this,Cr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e,t;this.commonObjs.clear(),this.fontLoader.clear(),ch(this,Ar).clear(),this.filterFactory.destroy(),cm.cleanup(),null==(e=this._networkStream)||e.cancelAllRequests(new kf("Worker was terminated.")),null==(t=this.messageHandler)||t.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{bf(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function({value:e,done:n}){n?t.close():(bf(e instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",async e=>{var n;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return i&&r||(this._lastProgress&&(null==(n=t.onProgress)||n.call(t,this._lastProgress)),this._fullReader.onProgress=e=>{var n;null==(n=t.onProgress)||n.call(t,{loaded:e.loaded,total:e.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(e,t)=>{bf(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function({value:e,done:n}){n?t.close():(bf(e instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new pm(e,this))}),e.on("DocException",e=>{t._capability.reject(Lp(e))}),e.on("PasswordRequest",e=>{hh(this,Ur,Promise.withResolvers());try{if(!t.onPassword)throw Lp(e);const n=e=>{e instanceof Error?ch(this,Ur).reject(e):ch(this,Ur).resolve({password:e})};t.onPassword(n,e.code)}catch(n){ch(this,Ur).reject(n)}return ch(this,Ur).promise}),e.on("DataLoaded",e=>{var n;null==(n=t.onProgress)||n.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{this.destroyed||ch(this,kr).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",([t,n,i])=>{var r;if(this.destroyed)return null;if(this.commonObjs.has(t))return null;switch(n){case"Font":if("error"in i){const e=i.error;this.commonObjs.resolve(t,e);break}const a=this._params.pdfBug&&(null==(r=globalThis.FontInspector)?void 0:r.enabled)?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,s=new Ip(i,a);this.fontLoader.bind(s).catch(()=>e.sendWithPromise("FontFallback",{id:t})).finally(()=>{!s.fontExtraProperties&&s.data&&(s.data=null),this.commonObjs.resolve(t,s)});break;case"CopyLocalImage":const{imageRef:o}=i;bf(o,"The imageRef must be defined.");for(const e of ch(this,kr).values())for(const[,n]of e.objs)if((null==n?void 0:n.ref)===o)return n.dataLen?(this.commonObjs.resolve(t,structuredClone(n)),n.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(t,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([e,t,n,i])=>{var r;if(this.destroyed)return;const a=ch(this,kr).get(t);if(!a.objs.has(e))if(0!==a._intentStates.size)switch(n){case"Image":case"Pattern":a.objs.resolve(e,i);break;default:throw new Error(`Got unknown object type ${n}`)}else null==(r=null==i?void 0:i.bitmap)||r.close()}),e.on("DocProgress",e=>{var n;this.destroyed||null==(n=t.onProgress)||n.call(t,{loaded:e.loaded,total:e.total})}),e.on("FetchBinaryData",async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");const t=this[e.type];if(!t)throw new Error(`${e.type} not initialized, see the \`useWorkerFetch\` parameter.`);return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e;this.annotationStorage.size;const{map:t,transfer:n}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:(null==(e=this._fullReader)?void 0:e.filename)??null},n).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=ch(this,Sr).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&ch(this,Cr).set(n.refStr,e);const i=new gm(t,n,this,this._params.pdfBug);return ch(this,kr).set(t,i),i});return ch(this,Sr).set(t,i),i}getPageIndex(e){return Np(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return dh(this,Fr,Ir).call(this,"GetFieldObjects")}hasJSActions(){return dh(this,Fr,Ir).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return dh(this,Fr,Ir).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return dh(this,Fr,Ir).call(this,"GetOptionalContentConfig").then(t=>new Og(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=ch(this,Ar).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n;return{info:e[0],metadata:e[1]?new Rg(e[1]):null,contentDispositionFilename:(null==(t=this._fullReader)?void 0:t.filename)??null,contentLength:(null==(n=this._fullReader)?void 0:n.contentLength)??null}});return ch(this,Ar).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of ch(this,kr).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),ch(this,Ar).clear(),this.filterFactory.destroy(!0),cm.cleanup()}}cachedPageNumber(e){if(!Np(e))return null;const t=0===e.gen?`${e.num}R`:`${e.num}R${e.gen}`;return ch(this,Cr).get(t)??null}}Ar=new WeakMap,kr=new WeakMap,Sr=new WeakMap,Cr=new WeakMap,Ur=new WeakMap,Fr=new WeakSet,Ir=function(e,t=null){const n=ch(this,Ar).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return ch(this,Ar).set(e,i),i};class ym{constructor(e){lh(this,Rr,null),sh(this,"onContinue",null),sh(this,"onError",null),hh(this,Rr,e)}get promise(){return ch(this,Rr).capability.promise}cancel(e=0){ch(this,Rr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=ch(this,Rr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=ch(this,Rr);return e.form||e.canvas&&(null==t?void 0:t.size)>0}}Rr=new WeakMap;const wm=class e{constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:s,canvasFactory:o,filterFactory:c,useRequestAnimationFrame:l=!1,pdfBug:h=!1,pageColors:d=null}){lh(this,Nr,null),this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=s,this.canvasFactory=o,this.filterFactory=c,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===l&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ym(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:n}){var i,r;if(this.cancelled)return;if(this._canvas){if(ch(e,Mr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ch(e,Mr).add(this._canvas)}this._pdfBug&&(null==(i=globalThis.StepperManager)?void 0:i.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:s,transform:o,background:c}=this.params;this.gfx=new Fg(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:s,transparency:t,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,null==(r=this.graphicsReadyCallback)||r.call(this)}cancel(t=null,n=0){var i,r,a;this.running=!1,this.cancelled=!0,null==(i=this.gfx)||i.endDrawing(),ch(this,Nr)&&(window.cancelAnimationFrame(ch(this,Nr)),hh(this,Nr,null)),ch(e,Mr).delete(this._canvas),t||(t=new Vf(`Rendering cancelled, page ${this._pageIndex+1}`,n)),this.callback(t),null==(a=(r=this.task).onError)||a.call(r,t)}operatorListChanged(){var e;this.graphicsReady?(null==(e=this.stepper)||e.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?hh(this,Nr,window.requestAnimationFrame(()=>{hh(this,Nr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ch(e,Mr).delete(this._canvas),this.callback())))}};Nr=new WeakMap,Mr=new WeakMap,lh(wm,Mr,new WeakSet);let xm=wm;function _m(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function Tm(e){return Math.max(0,Math.min(255,255*e))}class Dm{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return[e=Tm(e),e,e]}static G_HTML([e]){const t=_m(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Tm)}static RGB_HTML(e){return`#${e.map(_m).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[Tm(1-Math.min(1,e+i)),Tm(1-Math.min(1,n+i)),Tm(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,r=1-t,a=1-n;return["CMYK",i,r,a,Math.min(i,r,a)]}}class Em{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if("string"!=typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){mf("Abstract method `_createSVG` called.")}}class Am extends Em{_createSVG(e){return document.createElementNS(Wf,e)}}class km{static setupStorage(e,t,n,i,r){const a=i.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==a.value&&(e.textContent=a.value),"print"===r)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(a.value===n.attributes.xfaOn?e.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===r)break;e.addEventListener("change",e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==a.value&&e.setAttribute("value",a.value),"print"===r)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})})}break;case"select":if(null!==a.value){e.setAttribute("value",a.value);for(const e of n.children)e.attributes.value===a.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(t,{value:r})})}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:r}){const{attributes:a}=t,s=e instanceof HTMLAnchorElement;"radio"===a.type&&(a.name=`${a.name}-${i}`);for(const[o,c]of Object.entries(a))if(null!=c)switch(o){case"class":c.length&&e.setAttribute(o,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!s||"href"!==o&&"newWindow"!==o)&&e.setAttribute(o,c)}s&&r.addLinkAttributes(e,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(e,a.dataId,t,n)}static render(e){var t,n;const i=e.annotationStorage,r=e.linkService,a=e.xfaHtml,s=e.intent||"display",o=document.createElement(a.name);a.attributes&&this.setAttributes({html:o,element:a,intent:s,linkService:r});const c="richText"!==s,l=e.div;if(l.append(o),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=t}c&&l.setAttribute("class","xfaLayer xfaFont");const h=[];if(0===a.children.length){if(a.value){const e=document.createTextNode(a.value);o.append(e),c&&lm.shouldBuildText(a.name)&&h.push(e)}return{textDivs:h}}const d=[[a,-1,o]];for(;d.length>0;){const[e,a,o]=d.at(-1);if(a+1===e.children.length){d.pop();continue}const l=e.children[++d.at(-1)[1]];if(null===l)continue;const{name:u}=l;if("#text"===u){const e=document.createTextNode(l.value);h.push(e),o.append(e);continue}const f=(null==(t=null==l?void 0:l.attributes)?void 0:t.xmlns)?document.createElementNS(l.attributes.xmlns,u):document.createElement(u);if(o.append(f),l.attributes&&this.setAttributes({html:f,element:l,storage:i,intent:s,linkService:r}),(null==(n=l.children)?void 0:n.length)>0)d.push([l,-1,f]);else if(l.value){const e=document.createTextNode(l.value);c&&lm.shouldBuildText(u)&&h.push(e),f.append(e)}}for(const u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Sm=new WeakSet;class Cm{static create(e){switch(e.data.annotationType){case hf.LINK:return new Fm(e);case hf.TEXT:return new Im(e);case hf.WIDGET:switch(e.data.fieldType){case"Tx":return new Nm(e);case"Btn":return e.data.radioButton?new Pm(e):e.data.checkBox?new Om(e):new Lm(e);case"Ch":return new Wm(e);case"Sig":return new Mm(e)}return new Rm(e);case hf.POPUP:return new Bm(e);case hf.FREETEXT:return new zm(e);case hf.LINE:return new Hm(e);case hf.SQUARE:return new Vm(e);case hf.CIRCLE:return new Gm(e);case hf.POLYLINE:return new $m(e);case hf.CARET:return new Xm(e);case hf.INK:return new Km(e);case hf.POLYGON:return new qm(e);case hf.HIGHLIGHT:return new Ym(e);case hf.UNDERLINE:return new Zm(e);case hf.SQUIGGLY:return new Jm(e);case hf.STRIKEOUT:return new Qm(e);case hf.STAMP:return new eb(e);case hf.FILEATTACHMENT:return new tb(e);default:return new Um(e)}}}Or=new WeakMap,Pr=new WeakMap,Lr=new WeakMap,Wr=new WeakSet,Br=function(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:s,pageY:o}}}}=this;null==n||n.splice(0,4,...e),t.left=100*(e[0]-s)/r+"%",t.top=100*(a-e[3]+o)/a+"%",0===i?(t.width=100*(e[2]-e[0])/r+"%",t.height=100*(e[3]-e[1])/a+"%"):this.setRotation(i)};let Um=class e{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){lh(this,Wr),lh(this,Or,null),lh(this,Pr,!1),lh(this,Lr,null),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!(!(null==e?void 0:e.str)&&!(null==t?void 0:t.str))}get _isEditable(){return this.data.isEditable}get hasPopupData(){return e._hasPopupData(this.data)}updateEdited(e){var t;if(!this.container)return;ch(this,Or)||hh(this,Or,{rect:this.data.rect.slice(0)});const{rect:n}=e;n&&dh(this,Wr,Br).call(this,n),null==(t=ch(this,Lr))||t.popup.updateEdited(e)}resetEdited(){var e;ch(this,Or)&&(dh(this,Wr,Br).call(this,ch(this,Or).rect),null==(e=ch(this,Lr))||e.popup.resetEdited(),hh(this,Or,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Rm||(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Bm){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,r),r}const{width:s,height:o}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t=`calc(${e}px * var(--total-scale-factor)) / calc(${n}px * var(--total-scale-factor))`;a.borderRadius=t}else if(this instanceof Pm){const e=`calc(${s}px * var(--total-scale-factor)) / calc(${o}px * var(--total-scale-factor))`;a.borderRadius=e}switch(t.borderStyle.style){case 1:a.borderStyle="solid";break;case 2:a.borderStyle="dashed";break;case 3:case 4:break;case 5:a.borderBottomStyle="solid"}const i=t.borderColor||null;i?(hh(this,Pr,!0),a.borderColor=If.makeHexColor(0|i[0],0|i[1],0|i[2])):a.borderWidth=0}const c=If.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:l,pageHeight:h,pageX:d,pageY:u}=i.rawDims;a.left=100*(c[0]-d)/l+"%",a.top=100*(c[1]-u)/h+"%";const{rotation:f}=t;return t.hasOwnCanvas||0===f?(a.width=100*s/l+"%",a.height=100*o/h+"%"):this.setRotation(f,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!=0&&([r,a]=[a,r]),t.style.width=100*r/n+"%",t.style.height=100*a/i+"%",t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const i=n.detail[e],r=i[0],a=i.slice(1);n.target.style[t]=Dm[`${r}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[t]:Dm[`${r}_rgb`](a)})};return wf(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||n[i];null==r||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,r]of Object.entries(t)){const a=n[i];a&&(a({detail:{[i]:r},target:e}),delete t[i])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,r]=this.data.rect.map(e=>Math.fround(e));if(8===e.length){const[a,s,o,c]=e.subarray(2,6);if(i===a&&r===s&&t===o&&n===c)return}const{style:a}=this.container;let s;if(ch(this,Pr)){const{borderColor:e,borderWidth:t}=a;a.borderWidth=0,s=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add("hasBorder")}const o=i-t,c=r-n,{svgFactory:l}=this,h=l.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const d=l.createElement("defs");h.append(d);const u=l.createElement("clipPath"),f=`clippath_${this.data.id}`;u.setAttribute("id",f),u.setAttribute("clipPathUnits","objectBoundingBox"),d.append(u);for(let p=2,g=e.length;p<g;p+=8){const n=e[p],i=e[p+1],a=e[p+2],h=e[p+3],d=l.createElement("rect"),f=(a-t)/o,g=(r-i)/c,m=(n-a)/o,b=(i-h)/c;d.setAttribute("x",f),d.setAttribute("y",g),d.setAttribute("width",m),d.setAttribute("height",b),u.append(d),null==s||s.push(`<rect vector-effect="non-scaling-stroke" x="${f}" y="${g}" width="${m}" height="${b}"/>`)}ch(this,Pr)&&(s.push("</g></svg>')"),a.backgroundImage=s.join("")),this.container.append(h),this.container.style.clipPath=`url(#${f})`}_createPopup(){const{data:e}=this,t=hh(this,Lr,new Bm({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){mf("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:e,id:r,exportValues:a}of i){if(-1===e)continue;if(r===t)continue;const i="string"==typeof a?a:null,s=document.querySelector(`[data-element-id="${r}"]`);!s||Sm.has(s)?n.push({id:r,exportValue:i,domElement:s}):gf()}return n}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,r=i.getAttribute("data-element-id");r!==t&&Sm.has(i)&&n.push({id:r,exportValue:e,domElement:i})}return n}show(){var e;this.container&&(this.container.hidden=!1),null==(e=this.popup)||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null==(e=this.popup)||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null==(n=this.linkService.eventBus)||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};class Fm extends Um{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!(null==t?void 0:t.ignoreBorder),createQuadrilaterals:!0}),lh(this,jr),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action),i=!0):e.attachment?(dh(this,jr,Hr).call(this,n,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(dh(this,jr,Vr).call(this,n,e.setOCGState),i=!0):e.dest?(this._bindLink(n,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&dh(this,jr,zr).call(this)}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),dh(this,jr,zr).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const r=n.get(i);r&&(e[r]=()=>{var e;return null==(e=this.linkService.eventBus)||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1})}e.onclick||(e.onclick=()=>!1),dh(this,jr,zr).call(this)}_bindResetFormAction(e,t){const n=e.onclick;n||(e.href=this.linkService.getAnchorUrl("")),dh(this,jr,zr).call(this),this._fieldObjects?e.onclick=()=>{var e;null==n||n();const{fields:i,refs:r,include:a}=t,s=[];if(0!==i.length||0!==r.length){const e=new Set(r);for(const t of i){const n=this._fieldObjects[t]||[];for(const{id:t}of n)e.add(t)}for(const t of Object.values(this._fieldObjects))for(const n of t)e.has(n.id)===a&&s.push(n)}else for(const t of Object.values(this._fieldObjects))s.push(...t);const o=this.annotationStorage,c=[];for(const t of s){const{id:e}=t;switch(c.push(e),t.type){case"text":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;o.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${e}"]`);n&&(Sm.has(n)?n.dispatchEvent(new Event("resetform")):gf())}return this.enableScripting&&(null==(e=this.linkService.eventBus)||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}:n||(e.onclick=()=>!1)}}jr=new WeakSet,zr=function(){this.container.setAttribute("data-internal-link","")},Hr=function(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>{var e;return null==(e=this.downloadManager)||e.openOrDownloadData(t.content,t.filename,n),!1},dh(this,jr,zr).call(this)},Vr=function(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),dh(this,jr,zr).call(this)};class Im extends Um{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Rm extends Um{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null==(t=e.previousSibling)?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Uf.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,r){n.includes("mouse")?e.addEventListener(n,e=>{var t;null==(t=this.linkService.eventBus)||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var a;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}r&&(null==(a=this.linkService.eventBus)||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e)}}))})}_setEventListeners(e,t,n,i){var r,a,s;for(const[o,c]of n)("Action"===c||(null==(r=this.data.actions)?void 0:r[c]))&&("Focus"!==c&&"Blur"!==c||t||(t={focused:!1}),this._setEventListener(e,t,o,c,i),"Focus"!==c||(null==(a=this.data.actions)?void 0:a.Blur)?"Blur"!==c||(null==(s=this.data.actions)?void 0:s.Focus)||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":If.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const{fontColor:t}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,i=e.style;let r;const a=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(rf*n))||1);r=Math.min(n,a(t/rf))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(n,a(e/rf))}i.fontSize=`calc(${r}px * var(--total-scale-factor))`,i.color=If.makeHexColor(t[0],t[1],t[2]),null!==this.data.textAlignment&&(i.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Nm extends Rm{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),r.setValue(a.id,{[i]:n})}render(){var e,t;const n=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=n.getValue(i,{value:this.data.fieldValue});let s=a.value||"";const o=n.getValue(i,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let c=a.formattedValue||(null==(e=this.data.textContent)?void 0:e.join("\n"))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const l={userValue:s,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",c??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Sm.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const h=this.data.dateFormat||this.data.timeFormat;h&&(r.title=h),this._setRequired(r,this.data.required),o&&(r.maxLength=o),r.addEventListener("input",e=>{n.setValue(i,{value:e.target.value}),this.setPropertyOnSiblings(r,"value",e.target.value,"value"),l.formattedValue=null}),r.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue??"";r.value=l.userValue=t,l.formattedValue=null});let d=e=>{const{formattedValue:t}=l;null!=t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",e=>{var t;if(l.focused)return;const{target:n}=e;l.userValue&&(n.value=l.userValue),l.lastCommittedValue=n.value,l.commitKey=1,(null==(t=this.data.actions)?void 0:t.Focus)||(l.focused=!0)}),r.addEventListener("updatefromsandbox",e=>{this.showElementAndHideCanvas(e.target);const t={value(e){l.userValue=e.detail.value??"",n.setValue(i,{value:l.userValue.toString()}),e.target.value=l.userValue},formattedValue(e){const{formattedValue:t}=e.detail;l.formattedValue=t,null!=t&&e.target!==document.activeElement&&(e.target.value=t),n.setValue(i,{formattedValue:t})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:e=>{var t;const{charLimit:r}=e.detail,{target:a}=e;if(0===r)return void a.removeAttribute("maxLength");a.setAttribute("maxLength",r);let s=l.userValue;!s||s.length<=r||(s=s.slice(0,r),a.value=l.userValue=s,n.setValue(i,{value:s}),null==(t=this.linkService.eventBus)||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:s,willCommit:!0,commitKey:1,selStart:a.selectionStart,selEnd:a.selectionEnd}}))}};this._dispatchEventFromSandbox(t,e)}),r.addEventListener("keydown",e=>{var t;l.commitKey=1;let n=-1;if("Escape"===e.key?n=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(l.commitKey=3):n=2,-1===n)return;const{value:r}=e.target;l.lastCommittedValue!==r&&(l.lastCommittedValue=r,l.userValue=r,null==(t=this.linkService.eventBus)||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:r,willCommit:!0,commitKey:n,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const e=d;d=null,r.addEventListener("blur",t=>{var n,r;if(!l.focused||!t.relatedTarget)return;(null==(n=this.data.actions)?void 0:n.Blur)||(l.focused=!1);const{value:a}=t.target;l.userValue=a,l.lastCommittedValue!==a&&(null==(r=this.linkService.eventBus)||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:a,willCommit:!0,commitKey:l.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}})),e(t)}),(null==(t=this.data.actions)?void 0:t.Keystroke)&&r.addEventListener("beforeinput",e=>{var t;l.lastCommittedValue=null;const{data:n,target:r}=e,{value:a,selectionStart:s,selectionEnd:o}=r;let c=s,h=o;switch(e.inputType){case"deleteWordBackward":{const e=a.substring(0,s).match(/\w*[^\w]*$/);e&&(c-=e[0].length);break}case"deleteWordForward":{const e=a.substring(s).match(/^[^\w]*\w*/);e&&(h+=e[0].length);break}case"deleteContentBackward":s===o&&(c-=1);break;case"deleteContentForward":s===o&&(h+=1)}e.preventDefault(),null==(t=this.linkService.eventBus)||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:a,change:n||"",willCommit:!1,selStart:c,selEnd:h}})}),this._setEventListeners(r,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(d&&r.addEventListener("blur",d),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/o;r.classList.add("comb"),r.style.letterSpacing=`calc(${e}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Mm extends Rm{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Om extends Rm{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Sm.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",i=>{const{name:r,checked:a}=i.target;for(const s of this._getElementsByName(r,n)){const n=a&&s.exportValue===t.exportValue;s.domElement&&(s.domElement.checked=n),e.setValue(s.id,{value:n})}e.setValue(n,{value:a})}),r.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Pm extends Rm{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if("string"==typeof i&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,n))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Sm.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",t=>{const{name:i,checked:r}=t.target;for(const a of this._getElementsByName(i,n))e.setValue(a.id,{value:!1});e.setValue(n,{value:r})}),r.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!=n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;r.addEventListener("updatefromsandbox",t=>{const r={value:t=>{const r=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=r&&i.id===n;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(r,t)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Lm extends Fm{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class Wm extends Rm{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Sm.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of i.options)n.selected=n.value===t});for(const l of this.data.options){const e=document.createElement("option");e.textContent=l.displayValue,e.value=l.exportValue,n.value.includes(l.exportValue)&&(e.setAttribute("selected",!0),r=!1),i.append(e)}let a=null;if(r){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),a=()=>{e.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const s=e=>{const t=e?"value":"textContent",{options:n,multiple:r}=i;return r?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let o=s(!1);const c=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",n=>{const r={value(n){null==a||a();const r=n.detail.value,c=new Set(Array.isArray(r)?r:[r]);for(const e of i.options)e.selected=c.has(e.value);e.setValue(t,{value:s(!0)}),o=s(!1)},multipleSelection(e){i.multiple=!0},remove(n){const r=i.options,a=n.detail.remove;r[a].selected=!1,i.remove(a),r.length>0&&-1===Array.prototype.findIndex.call(r,e=>e.selected)&&(r[0].selected=!0),e.setValue(t,{value:s(!0),items:c(n)}),o=s(!1)},clear(n){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),o=s(!1)},insert(n){const{index:r,displayValue:a,exportValue:l}=n.detail.insert,h=i.children[r],d=document.createElement("option");d.textContent=a,d.value=l,h?h.before(d):i.append(d),e.setValue(t,{value:s(!0),items:c(n)}),o=s(!1)},items(n){const{items:r}=n.detail;for(;0!==i.length;)i.remove(0);for(const e of r){const{displayValue:t,exportValue:n}=e,r=document.createElement("option");r.textContent=t,r.value=n,i.append(r)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:s(!0),items:c(n)}),o=s(!1)},indices(n){const i=new Set(n.detail.indices);for(const e of n.target.options)e.selected=i.has(e.index);e.setValue(t,{value:s(!0)}),o=s(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(r,n)}),i.addEventListener("input",n=>{var i;const r=s(!0),a=s(!1);e.setValue(t,{value:r}),n.preventDefault(),null==(i=this.linkService.eventBus)||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,change:a,changeEx:r,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):i.addEventListener("input",function(n){e.setValue(t,{value:s(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Bm extends Um{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Um._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new jm({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(e=>`${Of}${e}`).join(",")),this.container}}class jm{constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:r,contentsObj:a,richText:s,parent:o,rect:c,parentRect:l,open:h}){var d;lh(this,ha),lh(this,Gr,dh(this,ha,ga).bind(this)),lh(this,$r,dh(this,ha,ya).bind(this)),lh(this,qr,dh(this,ha,va).bind(this)),lh(this,Xr,dh(this,ha,ba).bind(this)),lh(this,Kr,null),lh(this,Yr,null),lh(this,Zr,null),lh(this,Jr,null),lh(this,Qr,null),lh(this,ea,null),lh(this,ta,null),lh(this,na,!1),lh(this,ia,null),lh(this,ra,null),lh(this,aa,null),lh(this,sa,null),lh(this,oa,null),lh(this,ca,null),lh(this,la,!1),hh(this,Yr,e),hh(this,oa,i),hh(this,Zr,a),hh(this,sa,s),hh(this,ea,o),hh(this,Kr,t),hh(this,aa,c),hh(this,ta,l),hh(this,Qr,n),hh(this,Jr,Zf.toDateObject(r)),this.trigger=n.flatMap(e=>e.getElementsToTriggerPopup());for(const u of this.trigger)u.addEventListener("click",ch(this,Xr)),u.addEventListener("mouseenter",ch(this,qr)),u.addEventListener("mouseleave",ch(this,$r)),u.classList.add("popupTriggerArea");for(const u of n)null==(d=u.container)||d.addEventListener("keydown",ch(this,Gr));ch(this,Yr).hidden=!0,h&&dh(this,ha,ba).call(this)}render(){if(ch(this,ia))return;const e=hh(this,ia,document.createElement("div"));if(e.className="popup",ch(this,Kr)){const t=e.style.outlineColor=If.makeHexColor(...ch(this,Kr));e.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),({dir:n.dir,str:n.textContent}=ch(this,oa)),e.append(t),ch(this,Jr)){const e=document.createElement("time");e.classList.add("popupDate"),e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:ch(this,Jr).valueOf()})),e.dateTime=ch(this,Jr).toISOString(),t.append(e)}const i=ch(this,ha,da);if(i)km.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const t=this._formatContents(ch(this,Zr));e.append(t)}ch(this,Yr).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const e=i[r];n.append(document.createTextNode(e)),r<a-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;ch(this,ca)||hh(this,ca,{contentsObj:ch(this,Zr),richText:ch(this,sa)}),e&&hh(this,ra,null),t&&(hh(this,sa,dh(this,ha,pa).call(this,t)),hh(this,Zr,null)),null==(n=ch(this,ia))||n.remove(),hh(this,ia,null)}resetEdited(){var e;ch(this,ca)&&(({contentsObj:uh(this,Zr)._,richText:uh(this,sa)._}=ch(this,ca)),hh(this,ca,null),null==(e=ch(this,ia))||e.remove(),hh(this,ia,null),hh(this,ra,null))}forceHide(){hh(this,la,this.isVisible),ch(this,la)&&(ch(this,Yr).hidden=!0)}maybeShow(){ch(this,la)&&(ch(this,ia)||dh(this,ha,va).call(this),hh(this,la,!1),ch(this,Yr).hidden=!1)}get isVisible(){return!1===ch(this,Yr).hidden}}Gr=new WeakMap,$r=new WeakMap,qr=new WeakMap,Xr=new WeakMap,Kr=new WeakMap,Yr=new WeakMap,Zr=new WeakMap,Jr=new WeakMap,Qr=new WeakMap,ea=new WeakMap,ta=new WeakMap,na=new WeakMap,ia=new WeakMap,ra=new WeakMap,aa=new WeakMap,sa=new WeakMap,oa=new WeakMap,ca=new WeakMap,la=new WeakMap,ha=new WeakSet,da=function(){const e=ch(this,sa),t=ch(this,Zr);return!(null==e?void 0:e.str)||(null==t?void 0:t.str)&&t.str!==e.str?null:ch(this,sa).html||null},ua=function(){var e,t,n;return(null==(n=null==(t=null==(e=ch(this,ha,da))?void 0:e.attributes)?void 0:t.style)?void 0:n.fontSize)||0},fa=function(){var e,t,n;return(null==(n=null==(t=null==(e=ch(this,ha,da))?void 0:e.attributes)?void 0:t.style)?void 0:n.color)||null},pa=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:ch(this,ha,fa),fontSize:ch(this,ha,ua)?`calc(${ch(this,ha,ua)}px * var(--total-scale-factor))`:""}};for(const r of e.split("\n"))t.push({name:"span",value:r,attributes:i});return n},ga=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&ch(this,na))&&dh(this,ha,ba).call(this)},ma=function(){if(null!==ch(this,ra))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:r}}}=ch(this,ea);let a=!!ch(this,ta),s=ch(this,a?ta:aa);for(const u of ch(this,Qr))if(!s||null!==If.intersect(u.data.rect,s)){s=u.data.rect,a=!0;break}const o=If.normalizeRect([s[0],e[3]-s[1]+e[1],s[2],e[3]-s[3]+e[1]]),c=a?s[2]-s[0]+5:0,l=o[0]+c,h=o[1];hh(this,ra,[100*(l-i)/t,100*(h-r)/n]);const{style:d}=ch(this,Yr);d.left=`${ch(this,ra)[0]}%`,d.top=`${ch(this,ra)[1]}%`},ba=function(){hh(this,na,!ch(this,na)),ch(this,na)?(dh(this,ha,va).call(this),ch(this,Yr).addEventListener("click",ch(this,Xr)),ch(this,Yr).addEventListener("keydown",ch(this,Gr))):(dh(this,ha,ya).call(this),ch(this,Yr).removeEventListener("click",ch(this,Xr)),ch(this,Yr).removeEventListener("keydown",ch(this,Gr)))},va=function(){ch(this,ia)||this.render(),this.isVisible?ch(this,na)&&ch(this,Yr).classList.add("focused"):(dh(this,ha,ma).call(this),ch(this,Yr).hidden=!1,ch(this,Yr).style.zIndex=parseInt(ch(this,Yr).style.zIndex)+1e3)},ya=function(){ch(this,Yr).classList.remove("focused"),!ch(this,na)&&this.isVisible&&(ch(this,Yr).hidden=!0,ch(this,Yr).style.zIndex=parseInt(ch(this,Yr).style.zIndex)-1e3)};class zm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=of.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Hm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),lh(this,wa,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=hh(this,wa,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ch(this,wa)}addHighlightArea(){this.container.classList.add("highlightArea")}}wa=new WeakMap;class Vm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),lh(this,xa,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,a=hh(this,xa,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",t-r),a.setAttribute("height",n-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ch(this,xa)}addHighlightArea(){this.container.classList.add("highlightArea")}}xa=new WeakMap;class Gm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),lh(this,_a,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,a=hh(this,_a,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",t/2),a.setAttribute("cy",n/2),a.setAttribute("rx",t/2-r/2),a.setAttribute("ry",n/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ch(this,_a)}addHighlightArea(){this.container.classList.add("highlightArea")}}_a=new WeakMap;class $m extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),lh(this,Ta,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:r,height:a}=this;if(!t)return this.container;const s=this.svgFactory.create(r,a,!0);let o=[];for(let l=0,h=t.length;l<h;l+=2){const n=t[l]-e[0],i=e[3]-t[l+1];o.push(`${n},${i}`)}o=o.join(" ");const c=hh(this,Ta,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",o),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ch(this,Ta)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ta=new WeakMap;class qm extends $m{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Xm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Km extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),lh(this,Aa),lh(this,Da,null),lh(this,Ea,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?of.HIGHLIGHT:of.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:r}}=this,{transform:a,width:s,height:o}=dh(this,Aa,ka).call(this,t,e),c=this.svgFactory.create(s,o,!0),l=hh(this,Da,this.svgFactory.createElement("svg:g"));c.append(l),l.setAttribute("stroke-width",i.width||1),l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-linejoin","round"),l.setAttribute("stroke-miterlimit",10),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),l.setAttribute("transform",a);for(let h=0,d=n.length;h<d;h++){const e=this.svgFactory.createElement(this.svgElementName);ch(this,Ea).push(e),e.setAttribute("points",n[h].join(",")),l.append(e)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,r=ch(this,Da);if(t>=0&&r.setAttribute("stroke-width",t||1),n)for(let a=0,s=ch(this,Ea).length;a<s;a++)ch(this,Ea)[a].setAttribute("points",n[a].join(","));if(i){const{transform:e,width:t,height:n}=dh(this,Aa,ka).call(this,this.data.rotation,i);r.parentElement.setAttribute("viewBox",`0 0 ${t} ${n}`),r.setAttribute("transform",e)}}getElementsToTriggerPopup(){return ch(this,Ea)}addHighlightArea(){this.container.classList.add("highlightArea")}}Da=new WeakMap,Ea=new WeakMap,Aa=new WeakSet,ka=function(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}};class Ym extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=of.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const t=document.createElement("mark");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Zm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Jm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Qm extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const t=document.createElement("s");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class eb extends Um{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=of.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class tb extends Um{constructor(e){var t;super(e,{isRenderable:!0}),lh(this,Ca),lh(this,Sa,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null==(t=this.linkService.eventBus)||t.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*t.fillAlpha)}%);`)),n.addEventListener("dblclick",dh(this,Ca,Ua).bind(this)),hh(this,Sa,n);const{isMac:i}=Uf.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(i?e.metaKey:e.ctrlKey)&&dh(this,Ca,Ua).call(this)}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return ch(this,Sa)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sa=new WeakMap,Ca=new WeakSet,Ua=function(){var e;null==(e=this.downloadManager)||e.openOrDownloadData(this.content,this.filename)},Fa=new WeakMap,Ia=new WeakMap,Ra=new WeakMap,Na=new WeakMap,Ma=new WeakSet,Oa=async function(e,t,n){var i,r;const a=e.firstChild||e,s=a.id=`${Of}${t}`,o=await(null==(i=ch(this,Na))?void 0:i.getAriaAttributes(s));if(o)for(const[c,l]of o)a.setAttribute(c,l);n?n.at(-1).container.after(e):(this.div.append(e),null==(r=ch(this,Fa))||r.moveElementInDOM(this.div,e,a,!1))},Pa=function(){var e;if(!ch(this,Ia))return;const t=this.div;for(const[n,i]of ch(this,Ia)){const r=t.querySelector(`[data-annotation-id="${n}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?"CANVAS"===a.nodeName?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const s=ch(this,Ra).get(n);s&&(s._hasNoCanvas?(null==(e=this._annotationEditorUIManager)||e.setMissingCanvas(n,r.id,i),s._hasNoCanvas=!1):s.canvas=i)}ch(this,Ia).clear()};const nb=/\r\n?|\n/g,ib=class e extends _p{constructor(t){super({...t,name:"freeTextEditor"}),lh(this,Ha),lh(this,La),lh(this,Wa,""),lh(this,Ba,`${this.id}-editor`),lh(this,ja,null),lh(this,za),hh(this,La,t.color||e._defaultColor||_p._defaultLineColor),hh(this,za,t.fontSize||e._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=e.prototype,n=e=>e.isEmpty(),i=mp.TRANSLATE_SMALL,r=mp.TRANSLATE_BIG;return wf(this,"_keyboardManager",new up([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:n}]]))}static initialize(e,t){_p.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case cf.FREETEXT_SIZE:e._defaultFontSize=n;break;case cf.FREETEXT_COLOR:e._defaultColor=n}}updateParams(e,t){switch(e){case cf.FREETEXT_SIZE:dh(this,Ha,Va).call(this,t);break;case cf.FREETEXT_COLOR:dh(this,Ha,Ga).call(this,t)}}static get defaultPropertiesToUpdate(){return[[cf.FREETEXT_SIZE,e._defaultFontSize],[cf.FREETEXT_COLOR,e._defaultColor||_p._defaultLineColor]]}get propertiesToUpdate(){return[[cf.FREETEXT_SIZE,ch(this,za)],[cf.FREETEXT_COLOR,ch(this,La)]]}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const t=this.parentScale;return[-e._internalPadding*t,-(e._internalPadding+ch(this,za))*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),hh(this,ja,new AbortController);const e=this._uiManager.combinedSignal(ch(this,ja));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",ch(this,Ba)),this._isDraggable=!0,null==(e=ch(this,ja))||e.abort(),hh(this,ja,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var t;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(null==(t=this._initialOptions)?void 0:t.isCentered)&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=ch(this,Wa),t=hh(this,Wa,dh(this,Ha,$a).call(this).trimEnd());if(e===t)return;const n=e=>{hh(this,Wa,e),e?(dh(this,Ha,Ya).call(this),this._uiManager.rebuild(this),dh(this,Ha,qa).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),dh(this,Ha,qa).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(t){e._keyboardManager.exec(this,t)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",ch(this,Ba)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${ch(this,za)}px * var(--total-scale-factor))`,n.color=ch(this,La),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[a,s]=this.getInitialTranslation();[a,s]=this.pageTranslationToScreen(a,s);const[o,c]=this.pageDimensions,[l,h]=this.pageTranslation;let d,u;switch(this.rotation){case 0:d=e+(r[0]-l)/o,u=t+this.height-(r[1]-h)/c;break;case 90:d=e+(r[0]-l)/o,u=t-(r[1]-h)/c,[a,s]=[s,-a];break;case 180:d=e-this.width+(r[0]-l)/o,u=t-(r[1]-h)/c,[a,s]=[-a,-s];break;case 270:d=e+(r[0]-l-this.height*c)/o,u=t+(r[1]-h-this.width*o)/c,[a,s]=[-s,a]}this.setAt(d*n,u*i,a,s)}else this._moveAfterPaste(e,t);dh(this,Ha,Ya).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var n,i,r;const a=t.clipboardData||window.clipboardData,{types:s}=a;if(1===s.length&&"text/plain"===s[0])return;t.preventDefault();const o=dh(n=e,Xa,Ja).call(n,a.getData("text")||"").replaceAll(nb,"\n");if(!o)return;const c=window.getSelection();if(!c.rangeCount)return;this.editorDiv.normalize(),c.deleteFromDocument();const l=c.getRangeAt(0);if(!o.includes("\n"))return l.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),void c.collapseToStart();const{startContainer:h,startOffset:d}=l,u=[],f=[];if(h.nodeType===Node.TEXT_NODE){const t=h.parentElement;if(f.push(h.nodeValue.slice(d).replaceAll(nb,"")),t!==this.editorDiv){let n=u;for(const r of this.editorDiv.childNodes)r!==t?n.push(dh(i=e,Xa,Ka).call(i,r)):n=f}u.push(h.nodeValue.slice(0,d).replaceAll(nb,""))}else if(h===this.editorDiv){let t=u,n=0;for(const i of this.editorDiv.childNodes)n++===d&&(t=f),t.push(dh(r=e,Xa,Ka).call(r,i))}hh(this,Wa,`${u.join("\n")}${o}${f.join("\n")}`),dh(this,Ha,Ya).call(this);const p=new Range;let g=Math.sumPrecise(u.map(e=>e.length));for(const{firstChild:e}of this.editorDiv.childNodes)if(e.nodeType===Node.TEXT_NODE){const t=e.nodeValue.length;if(g<=t){p.setStart(e,g),p.setEnd(e,g);break}g-=t}c.removeAllRanges(),c.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,i){var r;let a=null;if(t instanceof zm){const{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:i,rotation:r,id:s,popupRef:o},textContent:c,textPosition:l,parent:{page:{pageNumber:h}}}=t;if(!c||0===c.length)return null;a=t={annotationType:of.FREETEXT,color:Array.from(n),fontSize:e,value:c.join("\n"),position:l,pageIndex:h-1,rect:i.slice(0),rotation:r,annotationElementId:s,id:s,deleted:!1,popupRef:o}}const s=await super.deserialize(t,n,i);return hh(s,za,t.fontSize),hh(s,La,If.makeHexColor(...t.color)),hh(s,Wa,dh(r=e,Xa,Ja).call(r,t.value)),s._initialData=a,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=e._internalPadding*this.parentScale,i=this.getRect(n,n),r=_p._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:ch(this,La)),a={annotationType:of.FREETEXT,color:r,fontSize:ch(this,za),value:dh(this,Ha,Za).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!dh(this,Ha,Qa).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:i}=n;i.fontSize=`calc(${ch(this,za)}px * var(--total-scale-factor))`,i.color=ch(this,La),n.replaceChildren();for(const e of ch(this,Wa).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),n.append(t)}const r=e._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:ch(this,Wa)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};La=new WeakMap,Wa=new WeakMap,Ba=new WeakMap,ja=new WeakMap,za=new WeakMap,Ha=new WeakSet,Va=function(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--total-scale-factor))`,this.translate(0,-(e-ch(this,za))*this.parentScale),hh(this,za,e),dh(this,Ha,qa).call(this)},n=ch(this,za);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cf.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ga=function(e){const t=e=>{hh(this,La,this.editorDiv.style.color=e)},n=ch(this,La);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cf.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},$a=function(){var e;const t=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(null==n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===i.nodeName||(t.push(dh(e=ib,Xa,Ka).call(e,i)),n=i);return t.join("\n")},qa=function(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display,r=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=i,t.classList.toggle("hidden",r)}this.rotation%180==this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()},Xa=new WeakSet,Ka=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(nb,"")},Ya=function(){if(this.editorDiv.replaceChildren(),ch(this,Wa))for(const e of ch(this,Wa).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}},Za=function(){return ch(this,Wa).replaceAll(" "," ")},Ja=function(e){return e.replaceAll(" "," ")},Qa=function(e){const{value:t,fontSize:n,color:i,pageIndex:r}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==i[t])||e.pageIndex!==r},lh(ib,Xa),sh(ib,"_freeTextDefaultContent",""),sh(ib,"_internalPadding",0),sh(ib,"_defaultColor",null),sh(ib,"_defaultFontSize",10),sh(ib,"_type","freetext"),sh(ib,"_editorType",of.FREETEXT);let rb=ib;class ab{toSVGPath(){mf("Abstract method `toSVGPath` must be implemented.")}get box(){mf("Abstract getter `box` must be implemented.")}serialize(e,t){mf("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,r,a){a||(a=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)a[s]=t+e[s]*i,a[s+1]=n+e[s+1]*r;return a}static _rescaleAndSwap(e,t,n,i,r,a){a||(a=new Float32Array(e.length));for(let s=0,o=e.length;s<o;s+=2)a[s]=t+e[s+1]*i,a[s+1]=n+e[s]*r;return a}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=n+e[r+1];return i}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,n,i,r){switch(r){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,r,a){return[(e+5*n)/6,(t+5*i)/6,(5*n+r)/6,(5*i+a)/6,(n+r)/2,(i+a)/2]}}sh(ab,"PRECISION",1e-4);const sb=class e{constructor({x:t,y:n},i,r,a,s,o=0){lh(this,ms),lh(this,es),lh(this,ts,[]),lh(this,ns),lh(this,is),lh(this,rs,[]),lh(this,as,new Float32Array(18)),lh(this,ss),lh(this,os),lh(this,cs),lh(this,ls),lh(this,hs),lh(this,ds),lh(this,us,[]),hh(this,es,i),hh(this,ds,a*r),hh(this,is,s),ch(this,as).set([NaN,NaN,NaN,NaN,t,n],6),hh(this,ns,o),hh(this,ls,ch(e,fs)*r),hh(this,cs,ch(e,gs)*r),hh(this,hs,r),ch(this,us).push(t,n)}isEmpty(){return isNaN(ch(this,as)[8])}add({x:e,y:t}){var n;hh(this,ss,e),hh(this,os,t);const[i,r,a,s]=ch(this,es);let[o,c,l,h]=ch(this,as).subarray(8,12);const d=e-l,u=t-h,f=Math.hypot(d,u);if(f<ch(this,cs))return!1;const p=f-ch(this,ls),g=p/f,m=g*d,b=g*u;let v=o,y=c;o=l,c=h,l+=m,h+=b,null==(n=ch(this,us))||n.push(e,t);const w=m/p,x=-b/p*ch(this,ds),_=w*ch(this,ds);return ch(this,as).set(ch(this,as).subarray(2,8),0),ch(this,as).set([l+x,h+_],4),ch(this,as).set(ch(this,as).subarray(14,18),12),ch(this,as).set([l-x,h-_],16),isNaN(ch(this,as)[6])?(0===ch(this,rs).length&&(ch(this,as).set([o+x,c+_],2),ch(this,rs).push(NaN,NaN,NaN,NaN,(o+x-i)/a,(c+_-r)/s),ch(this,as).set([o-x,c-_],14),ch(this,ts).push(NaN,NaN,NaN,NaN,(o-x-i)/a,(c-_-r)/s)),ch(this,as).set([v,y,o,c,l,h],6),!this.isEmpty()):(ch(this,as).set([v,y,o,c,l,h],6),Math.abs(Math.atan2(y-c,v-o)-Math.atan2(b,m))<Math.PI/2?([o,c,l,h]=ch(this,as).subarray(2,6),ch(this,rs).push(NaN,NaN,NaN,NaN,((o+l)/2-i)/a,((c+h)/2-r)/s),[o,c,v,y]=ch(this,as).subarray(14,18),ch(this,ts).push(NaN,NaN,NaN,NaN,((v+o)/2-i)/a,((y+c)/2-r)/s),!0):([v,y,o,c,l,h]=ch(this,as).subarray(0,6),ch(this,rs).push(((v+5*o)/6-i)/a,((y+5*c)/6-r)/s,((5*o+l)/6-i)/a,((5*c+h)/6-r)/s,((o+l)/2-i)/a,((c+h)/2-r)/s),[l,h,o,c,v,y]=ch(this,as).subarray(12,18),ch(this,ts).push(((v+5*o)/6-i)/a,((y+5*c)/6-r)/s,((5*o+l)/6-i)/a,((5*c+h)/6-r)/s,((o+l)/2-i)/a,((c+h)/2-r)/s),!0))}toSVGPath(){if(this.isEmpty())return"";const e=ch(this,rs),t=ch(this,ts);if(isNaN(ch(this,as)[6])&&!this.isEmpty())return dh(this,ms,vs).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);dh(this,ms,ws).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return dh(this,ms,ys).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,r,a){return new cb(e,t,n,i,r,a)}getOutlines(){var e;const t=ch(this,rs),n=ch(this,ts),i=ch(this,as),[r,a,s,o]=ch(this,es),c=new Float32Array(((null==(e=ch(this,us))?void 0:e.length)??0)+2);for(let d=0,u=c.length-2;d<u;d+=2)c[d]=(ch(this,us)[d]-r)/s,c[d+1]=(ch(this,us)[d+1]-a)/o;if(c[c.length-2]=(ch(this,ss)-r)/s,c[c.length-1]=(ch(this,os)-a)/o,isNaN(i[6])&&!this.isEmpty())return dh(this,ms,xs).call(this,c);const l=new Float32Array(ch(this,rs).length+24+ch(this,ts).length);let h=t.length;for(let d=0;d<h;d+=2)isNaN(t[d])?l[d]=l[d+1]=NaN:(l[d]=t[d],l[d+1]=t[d+1]);h=dh(this,ms,Ts).call(this,l,h);for(let d=n.length-6;d>=6;d-=6)for(let e=0;e<6;e+=2)isNaN(n[d+e])?(l[h]=l[h+1]=NaN,h+=2):(l[h]=n[d+e],l[h+1]=n[d+e+1],h+=2);return dh(this,ms,_s).call(this,l,h),this.newFreeDrawOutline(l,c,ch(this,es),ch(this,hs),ch(this,ns),ch(this,is))}};es=new WeakMap,ts=new WeakMap,ns=new WeakMap,is=new WeakMap,rs=new WeakMap,as=new WeakMap,ss=new WeakMap,os=new WeakMap,cs=new WeakMap,ls=new WeakMap,hs=new WeakMap,ds=new WeakMap,us=new WeakMap,fs=new WeakMap,ps=new WeakMap,gs=new WeakMap,ms=new WeakSet,bs=function(){const e=ch(this,as).subarray(4,6),t=ch(this,as).subarray(16,18),[n,i,r,a]=ch(this,es);return[(ch(this,ss)+(e[0]-t[0])/2-n)/r,(ch(this,os)+(e[1]-t[1])/2-i)/a,(ch(this,ss)+(t[0]-e[0])/2-n)/r,(ch(this,os)+(t[1]-e[1])/2-i)/a]},vs=function(){const[e,t,n,i]=ch(this,es),[r,a,s,o]=dh(this,ms,bs).call(this);return`M${(ch(this,as)[2]-e)/n} ${(ch(this,as)[3]-t)/i} L${(ch(this,as)[4]-e)/n} ${(ch(this,as)[5]-t)/i} L${r} ${a} L${s} ${o} L${(ch(this,as)[16]-e)/n} ${(ch(this,as)[17]-t)/i} L${(ch(this,as)[14]-e)/n} ${(ch(this,as)[15]-t)/i} Z`},ys=function(e){const t=ch(this,ts);e.push(`L${t[4]} ${t[5]} Z`)},ws=function(e){const[t,n,i,r]=ch(this,es),a=ch(this,as).subarray(4,6),s=ch(this,as).subarray(16,18),[o,c,l,h]=dh(this,ms,bs).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-n)/r} L${o} ${c} L${l} ${h} L${(s[0]-t)/i} ${(s[1]-n)/r}`)},xs=function(e){const t=ch(this,as),[n,i,r,a]=ch(this,es),[s,o,c,l]=dh(this,ms,bs).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-n)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-n)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,s,o,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,(t[16]-n)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-n)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(h,e,ch(this,es),ch(this,hs),ch(this,ns),ch(this,is))},_s=function(e,t){const n=ch(this,ts);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+6},Ts=function(e,t){const n=ch(this,as).subarray(4,6),i=ch(this,as).subarray(16,18),[r,a,s,o]=ch(this,es),[c,l,h,d]=dh(this,ms,bs).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-r)/s,(n[1]-a)/o,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(i[0]-r)/s,(i[1]-a)/o],t),t+24},lh(sb,fs,8),lh(sb,ps,2),lh(sb,gs,ch(sb,fs)+ch(sb,ps));let ob=sb;class cb extends ab{constructor(e,t,n,i,r,a){super(),lh(this,Fs),lh(this,Ds),lh(this,Es,new Float32Array(4)),lh(this,As),lh(this,ks),lh(this,Ss),lh(this,Cs),lh(this,Us),hh(this,Us,e),hh(this,Ss,t),hh(this,Ds,n),hh(this,Cs,i),hh(this,As,r),hh(this,ks,a),this.lastPoint=[NaN,NaN],dh(this,Fs,Is).call(this,a);const[s,o,c,l]=ch(this,Es);for(let h=0,d=e.length;h<d;h+=2)e[h]=(e[h]-s)/c,e[h+1]=(e[h+1]-o)/l;for(let h=0,d=t.length;h<d;h+=2)t[h]=(t[h]-s)/c,t[h+1]=(t[h+1]-o)/l}toSVGPath(){const e=[`M${ch(this,Us)[4]} ${ch(this,Us)[5]}`];for(let t=6,n=ch(this,Us).length;t<n;t+=6)isNaN(ch(this,Us)[t])?e.push(`L${ch(this,Us)[t+4]} ${ch(this,Us)[t+5]}`):e.push(`C${ch(this,Us)[t]} ${ch(this,Us)[t+1]} ${ch(this,Us)[t+2]} ${ch(this,Us)[t+3]} ${ch(this,Us)[t+4]} ${ch(this,Us)[t+5]}`);return e.push("Z"),e.join(" ")}serialize([e,t,n,i],r){const a=n-e,s=i-t;let o,c;switch(r){case 0:o=ab._rescale(ch(this,Us),e,i,a,-s),c=ab._rescale(ch(this,Ss),e,i,a,-s);break;case 90:o=ab._rescaleAndSwap(ch(this,Us),e,t,a,s),c=ab._rescaleAndSwap(ch(this,Ss),e,t,a,s);break;case 180:o=ab._rescale(ch(this,Us),n,t,-a,s),c=ab._rescale(ch(this,Ss),n,t,-a,s);break;case 270:o=ab._rescaleAndSwap(ch(this,Us),n,i,-a,-s),c=ab._rescaleAndSwap(ch(this,Ss),n,i,-a,-s)}return{outline:Array.from(o),points:[Array.from(c)]}}get box(){return ch(this,Es)}newOutliner(e,t,n,i,r,a=0){return new ob(e,t,n,i,r,a)}getNewOutline(e,t){const[n,i,r,a]=ch(this,Es),[s,o,c,l]=ch(this,Ds),h=r*c,d=a*l,u=n*c+s,f=i*l+o,p=this.newOutliner({x:ch(this,Ss)[0]*h+u,y:ch(this,Ss)[1]*d+f},ch(this,Ds),ch(this,Cs),e,ch(this,ks),t??ch(this,As));for(let g=2;g<ch(this,Ss).length;g+=2)p.add({x:ch(this,Ss)[g]*h+u,y:ch(this,Ss)[g+1]*d+f});return p.getOutlines()}}Ds=new WeakMap,Es=new WeakMap,As=new WeakMap,ks=new WeakMap,Ss=new WeakMap,Cs=new WeakMap,Us=new WeakMap,Fs=new WeakSet,Is=function(e){const t=ch(this,Us);let n=t[4],i=t[5];const r=[n,i,n,i];let a=n,s=i;const o=e?Math.max:Math.min;for(let l=6,h=t.length;l<h;l+=6){const e=t[l+4],c=t[l+5];if(isNaN(t[l]))If.pointBoundingBox(e,c,r),s<c?(a=e,s=c):s===c&&(a=o(a,e));else{const e=[1/0,1/0,-1/0,-1/0];If.bezierBoundingBox(n,i,...t.slice(l,l+6),e),If.rectBoundingBox(...e,r),s<e[3]?(a=e[2],s=e[3]):s===e[3]&&(a=o(a,e[2]))}n=e,i=c}const c=ch(this,Es);c[0]=r[0]-ch(this,As),c[1]=r[1]-ch(this,As),c[2]=r[2]-r[0]+2*ch(this,As),c[3]=r[3]-r[1]+2*ch(this,As),this.lastPoint=[a,s]};class lb{constructor(e,t=0,n=0,i=!0){lh(this,Ps),lh(this,Rs),lh(this,Ns),lh(this,Ms,[]),lh(this,Os,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:u,y:f,width:p,height:g}of e){const e=Math.floor((u-t)/a)*a,n=Math.ceil((u+p+t)/a)*a,i=Math.floor((f-t)/a)*a,s=Math.ceil((f+g+t)/a)*a,o=[e,i,s,!0],c=[n,i,s,!1];ch(this,Ms).push(o,c),If.rectBoundingBox(e,i,n,s,r)}const s=r[2]-r[0]+2*n,o=r[3]-r[1]+2*n,c=r[0]-n,l=r[1]-n,h=ch(this,Ms).at(i?-1:-2),d=[h[0],h[2]];for(const u of ch(this,Ms)){const[e,t,n]=u;u[0]=(e-c)/s,u[1]=(t-l)/o,u[2]=(n-l)/o}hh(this,Rs,new Float32Array([c,l,s,o])),hh(this,Ns,d)}getOutlines(){ch(this,Ms).sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);const e=[];for(const t of ch(this,Ms))t[3]?(e.push(...dh(this,Ps,zs).call(this,t)),dh(this,Ps,Bs).call(this,t)):(dh(this,Ps,js).call(this,t),e.push(...dh(this,Ps,zs).call(this,t)));return dh(this,Ps,Ls).call(this,e)}}Rs=new WeakMap,Ns=new WeakMap,Ms=new WeakMap,Os=new WeakMap,Ps=new WeakSet,Ls=function(e){const t=[],n=new Set;for(const a of e){const[e,n,i]=a;t.push([e,n,a],[e,i,a])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let a=0,s=t.length;a<s;a+=2){const e=t[a][2],i=t[a+1][2];e.push(i),i.push(e),n.add(e),n.add(i)}const i=[];let r;for(;n.size>0;){const e=n.values().next().value;let[t,a,s,o,c]=e;n.delete(e);let l=t,h=a;for(r=[t,s],i.push(r);;){let e;if(n.has(o))e=o;else{if(!n.has(c))break;e=c}n.delete(e),[t,a,s,o,c]=e,l!==t&&(r.push(l,h,t,h===a?a:s),l=t),h=h===a?s:a}r.push(l,h)}return new hb(i,ch(this,Rs),ch(this,Ns))},Ws=function(e){const t=ch(this,Os);let n=0,i=t.length-1;for(;n<=i;){const r=n+i>>1,a=t[r][0];if(a===e)return r;a<e?n=r+1:i=r-1}return i+1},Bs=function([,e,t]){const n=dh(this,Ps,Ws).call(this,e);ch(this,Os).splice(n,0,[e,t])},js=function([,e,t]){const n=dh(this,Ps,Ws).call(this,e);for(let i=n;i<ch(this,Os).length;i++){const[n,r]=ch(this,Os)[i];if(n!==e)break;if(n===e&&r===t)return void ch(this,Os).splice(i,1)}for(let i=n-1;i>=0;i--){const[n,r]=ch(this,Os)[i];if(n!==e)break;if(n===e&&r===t)return void ch(this,Os).splice(i,1)}},zs=function(e){const[t,n,i]=e,r=[[t,n,i]],a=dh(this,Ps,Ws).call(this,i);for(let s=0;s<a;s++){const[e,n]=ch(this,Os)[s];for(let i=0,a=r.length;i<a;i++){const[,s,o]=r[i];if(!(n<=s||o<=e))if(s>=e)if(o>n)r[i][1]=n;else{if(1===a)return[];r.splice(i,1),i--,a--}else r[i][2]=e,o>n&&r.push([t,n,o])}}return r};class hb extends ab{constructor(e,t,n){super(),lh(this,Hs),lh(this,Vs),hh(this,Vs,e),hh(this,Hs,t),this.lastPoint=n}toSVGPath(){const e=[];for(const t of ch(this,Vs)){let[n,i]=t;e.push(`M${n} ${i}`);for(let r=2;r<t.length;r+=2){const a=t[r],s=t[r+1];a===n?(e.push(`V${s}`),i=s):s===i&&(e.push(`H${a}`),n=a)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],r){const a=[],s=n-e,o=i-t;for(const c of ch(this,Vs)){const t=new Array(c.length);for(let n=0;n<c.length;n+=2)t[n]=e+c[n]*s,t[n+1]=i-c[n+1]*o;a.push(t)}return a}get box(){return ch(this,Hs)}get classNamesForOutlining(){return["highlightOutline"]}}Hs=new WeakMap,Vs=new WeakMap;class db extends ob{newFreeDrawOutline(e,t,n,i,r,a){return new ub(e,t,n,i,r,a)}}class ub extends cb{newOutliner(e,t,n,i,r,a=0){return new db(e,t,n,i,r,a)}}const fb=class e{constructor({editor:t=null,uiManager:n=null}){var i,r;lh(this,io),lh(this,Gs,null),lh(this,$s,null),lh(this,qs),lh(this,Xs,null),lh(this,Ks,!1),lh(this,Ys,!1),lh(this,Zs,null),lh(this,Js),lh(this,Qs,null),lh(this,eo,null),lh(this,to),t?(hh(this,Ys,!1),hh(this,to,cf.HIGHLIGHT_COLOR),hh(this,Zs,t)):(hh(this,Ys,!0),hh(this,to,cf.HIGHLIGHT_DEFAULT_COLOR)),hh(this,eo,(null==t?void 0:t._uiManager)||n),hh(this,Js,ch(this,eo)._eventBus),hh(this,qs,(null==(i=null==t?void 0:t.color)?void 0:i.toUpperCase())||(null==(r=ch(this,eo))?void 0:r.highlightColors.values().next().value)||"#FFFF98"),ch(e,no)||hh(e,no,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return wf(this,"_keyboardManager",new up([[["Escape","mac+Escape"],e.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],e.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],e.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],e.prototype._moveToPrevious],[["Home","mac+Home"],e.prototype._moveToBeginning],[["End","mac+End"],e.prototype._moveToEnd]]))}renderButton(){const e=hh(this,Gs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",ch(this,Zs)&&(e.ariaControls=`${ch(this,Zs).id}_colorpicker_dropdown`);const t=ch(this,eo)._signal;e.addEventListener("click",dh(this,io,oo).bind(this),{signal:t}),e.addEventListener("keydown",dh(this,io,so).bind(this),{signal:t});const n=hh(this,$s,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=ch(this,qs),e.append(n),e}renderMainDropdown(){const e=hh(this,Xs,dh(this,io,ro).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===ch(this,Gs))return void dh(this,io,oo).call(this,e);const t=e.target.getAttribute("data-color");t&&dh(this,io,ao).call(this,t,e)}_moveToNext(e){var t,n;ch(this,io,lo)?e.target!==ch(this,Gs)?null==(n=e.target.nextSibling)||n.focus():null==(t=ch(this,Xs).firstChild)||t.focus():dh(this,io,oo).call(this,e)}_moveToPrevious(e){var t,n;e.target!==(null==(t=ch(this,Xs))?void 0:t.firstChild)&&e.target!==ch(this,Gs)?(ch(this,io,lo)||dh(this,io,oo).call(this,e),null==(n=e.target.previousSibling)||n.focus()):ch(this,io,lo)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;ch(this,io,lo)?null==(t=ch(this,Xs).firstChild)||t.focus():dh(this,io,oo).call(this,e)}_moveToEnd(e){var t;ch(this,io,lo)?null==(t=ch(this,Xs).lastChild)||t.focus():dh(this,io,oo).call(this,e)}hideDropdown(){var e,t;null==(e=ch(this,Xs))||e.classList.add("hidden"),ch(this,Gs).ariaExpanded="false",null==(t=ch(this,Qs))||t.abort(),hh(this,Qs,null)}_hideDropdownFromKeyboard(){var e;ch(this,Ys)||(ch(this,io,lo)?(this.hideDropdown(),ch(this,Gs).focus({preventScroll:!0,focusVisible:ch(this,Ks)})):null==(e=ch(this,Zs))||e.unselect())}updateColor(e){if(ch(this,$s)&&(ch(this,$s).style.backgroundColor=e),!ch(this,Xs))return;const t=ch(this,eo).highlightColors.values();for(const n of ch(this,Xs).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;null==(e=ch(this,Gs))||e.remove(),hh(this,Gs,null),hh(this,$s,null),null==(t=ch(this,Xs))||t.remove(),hh(this,Xs,null)}};Gs=new WeakMap,$s=new WeakMap,qs=new WeakMap,Xs=new WeakMap,Ks=new WeakMap,Ys=new WeakMap,Zs=new WeakMap,Js=new WeakMap,Qs=new WeakMap,eo=new WeakMap,to=new WeakMap,no=new WeakMap,io=new WeakSet,ro=function(){const e=document.createElement("div"),t=ch(this,eo)._signal;e.addEventListener("contextmenu",Kf,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),ch(this,Zs)&&(e.id=`${ch(this,Zs).id}_colorpicker_dropdown`);for(const[n,i]of ch(this,eo).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=n,r.setAttribute("data-l10n-id",ch(fb,no)[n]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.ariaSelected=i===ch(this,qs),r.addEventListener("click",dh(this,io,ao).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",dh(this,io,so).bind(this),{signal:t}),e},ao=function(e,t){t.stopPropagation(),ch(this,Js).dispatch("switchannotationeditorparams",{source:this,type:ch(this,to),value:e})},so=function(e){fb._keyboardManager.exec(this,e)},oo=function(e){if(ch(this,io,lo))return void this.hideDropdown();if(hh(this,Ks,0===e.detail),ch(this,Qs)||(hh(this,Qs,new AbortController),window.addEventListener("pointerdown",dh(this,io,co).bind(this),{signal:ch(this,eo).combinedSignal(ch(this,Qs))})),ch(this,Gs).ariaExpanded="true",ch(this,Xs))return void ch(this,Xs).classList.remove("hidden");const t=hh(this,Xs,dh(this,io,ro).call(this));ch(this,Gs).append(t)},co=function(e){var t;(null==(t=ch(this,Xs))?void 0:t.contains(e.target))||this.hideDropdown()},lo=function(){return ch(this,Xs)&&!ch(this,Xs).classList.contains("hidden")},lh(fb,no,null);let pb=fb;const gb=class e extends _p{constructor(t){super({...t,name:"highlightEditor"}),lh(this,Co),lh(this,ho,null),lh(this,uo,0),lh(this,fo),lh(this,po,null),lh(this,go,null),lh(this,mo,null),lh(this,bo,null),lh(this,vo,0),lh(this,yo,null),lh(this,wo,null),lh(this,xo,null),lh(this,_o,!1),lh(this,To,null),lh(this,Do),lh(this,Eo,null),lh(this,Ao,""),lh(this,ko),lh(this,So,""),this.color=t.color||e._defaultColor,hh(this,ko,t.thickness||e._defaultThickness),hh(this,Do,t.opacity||e._defaultOpacity),hh(this,fo,t.boxes||null),hh(this,So,t.methodOfCreation||""),hh(this,Ao,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(hh(this,_o,!0),dh(this,Co,Fo).call(this,t),dh(this,Co,Oo).call(this)):ch(this,fo)&&(hh(this,ho,t.anchorNode),hh(this,uo,t.anchorOffset),hh(this,bo,t.focusNode),hh(this,vo,t.focusOffset),dh(this,Co,Uo).call(this),dh(this,Co,Oo).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=e.prototype;return wf(this,"_keyboardManager",new up([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:ch(this,_o)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:ch(this,ko),methodOfCreation:ch(this,So)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(t,n){var i;_p.initialize(t,n),e._defaultColor||(e._defaultColor=(null==(i=n.highlightColors)?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case cf.HIGHLIGHT_DEFAULT_COLOR:e._defaultColor=n;break;case cf.HIGHLIGHT_THICKNESS:e._defaultThickness=n}}translateInPage(e,t){}get toolbarPosition(){return ch(this,To)}updateParams(e,t){switch(e){case cf.HIGHLIGHT_COLOR:dh(this,Co,Io).call(this,t);break;case cf.HIGHLIGHT_THICKNESS:dh(this,Co,Ro).call(this,t)}}static get defaultPropertiesToUpdate(){return[[cf.HIGHLIGHT_DEFAULT_COLOR,e._defaultColor],[cf.HIGHLIGHT_THICKNESS,e._defaultThickness]]}get propertiesToUpdate(){return[[cf.HIGHLIGHT_COLOR,this.color||e._defaultColor],[cf.HIGHLIGHT_THICKNESS,ch(this,ko)||e._defaultThickness],[cf.HIGHLIGHT_FREE,ch(this,_o)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",hh(this,go,new pb({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(dh(this,Co,jo).call(this))}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,dh(this,Co,jo).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){dh(this,Co,Mo).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(dh(this,Co,Oo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var t;let n=!1;this.parent&&!e?dh(this,Co,Mo).call(this):e&&(dh(this,Co,Oo).call(this,e),n=!this.parent&&(null==(t=this.div)?void 0:t.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(t){var n,i,r;const{drawLayer:a}=this.parent;let s;ch(this,_o)?(t=(t-this.rotation+360)%360,s=dh(n=e,Po,Lo).call(n,ch(this,wo).box,t)):s=dh(i=e,Po,Lo).call(i,[this.x,this.y,this.width,this.height],t),a.updateProperties(ch(this,xo),{bbox:s,root:{"data-main-rotation":t}}),a.updateProperties(ch(this,Eo),{bbox:dh(r=e,Po,Lo).call(r,ch(this,mo).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const e=super.render();ch(this,Ao)&&(e.setAttribute("aria-label",ch(this,Ao)),e.setAttribute("role","mark")),ch(this,_o)?e.classList.add("free"):this.div.addEventListener("keydown",dh(this,Co,Wo).bind(this),{signal:this._uiManager._signal});const t=hh(this,yo,document.createElement("div"));e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=ch(this,po);const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),op(this,ch(this,yo),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||null==(e=this.parent)||e.drawLayer.updateProperties(ch(this,Eo),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||null==(e=this.parent)||e.drawLayer.updateProperties(ch(this,Eo),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:dh(this,Co,Bo).call(this,!0);break;case 1:case 3:dh(this,Co,Bo).call(this,!1)}}select(){var e;super.select(),ch(this,Eo)&&(null==(e=this.parent)||e.drawLayer.updateProperties(ch(this,Eo),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),ch(this,Eo)&&(null==(e=this.parent)||e.drawLayer.updateProperties(ch(this,Eo),{rootClass:{selected:!1}}),ch(this,_o)||dh(this,Co,Bo).call(this,!1))}get _mustFixPosition(){return!ch(this,_o)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(ch(this,xo),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(ch(this,Eo),{rootClass:{hidden:!e}}))}static startHighlighting(e,t,{target:n,x:i,y:r}){const{x:a,y:s,width:o,height:c}=n.getBoundingClientRect(),l=new AbortController,h=e.combinedSignal(l),d=t=>{l.abort(),dh(this,Po,Go).call(this,e,t)};window.addEventListener("blur",d,{signal:h}),window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("pointerdown",Yf,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Kf,{signal:h}),n.addEventListener("pointermove",dh(this,Po,Vo).bind(this,e),{signal:h}),this._freeHighlight=new db({x:i,y:r},[a,s,o,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(e,t,n){var i,r,a,s;let o=null;if(e instanceof Ym){const{data:{quadPoints:t,rect:n,rotation:i,id:r,color:a,opacity:s,popupRef:c},parent:{page:{pageNumber:l}}}=e;o=e={annotationType:of.HIGHLIGHT,color:Array.from(a),opacity:s,quadPoints:t,boxes:null,pageIndex:l-1,rect:n.slice(0),rotation:i,annotationElementId:r,id:r,deleted:!1,popupRef:c}}else if(e instanceof Km){const{data:{inkLists:t,rect:n,rotation:i,id:r,color:a,borderStyle:{rawWidth:s},popupRef:c},parent:{page:{pageNumber:l}}}=e;o=e={annotationType:of.HIGHLIGHT,color:Array.from(a),thickness:s,inkLists:t,boxes:null,pageIndex:l-1,rect:n.slice(0),rotation:i,annotationElementId:r,id:r,deleted:!1,popupRef:c}}const{color:c,quadPoints:l,inkLists:h,opacity:d}=e,u=await super.deserialize(e,t,n);u.color=If.makeHexColor(...c),hh(u,Do,d||1),h&&hh(u,ko,e.thickness),u._initialData=o;const[f,p]=u.pageDimensions,[g,m]=u.pageTranslation;if(l){const e=hh(u,fo,[]);for(let t=0;t<l.length;t+=8)e.push({x:(l[t]-g)/f,y:1-(l[t+1]-m)/p,width:(l[t+2]-l[t])/f,height:(l[t+1]-l[t+5])/p});dh(i=u,Co,Uo).call(i),dh(r=u,Co,Oo).call(r),u.rotate(u.rotation)}else if(h){hh(u,_o,!0);const e=h[0],n={x:e[0]-g,y:p-(e[1]-m)},i=new db(n,[0,0,f,p],1,ch(u,ko)/2,!0,.001);for(let t=0,a=e.length;t<a;t+=2)n.x=e[t]-g,n.y=p-(e[t+1]-m),i.add(n);const{id:r,clipPathId:o}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);dh(a=u,Co,Fo).call(a,{highlightOutlines:i.getOutlines(),highlightId:r,clipPathId:o}),dh(s=u,Co,Oo).call(s),u.rotate(u.parentRotation)}return u}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),n=_p._colorManager.convert(this.color),i={annotationType:of.HIGHLIGHT,color:n,opacity:ch(this,Do),thickness:ch(this,ko),quadPoints:dh(this,Co,zo).call(this),outlines:dh(this,Co,Ho).call(this,t),pageIndex:this.pageIndex,rect:t,rotation:dh(this,Co,jo).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!dh(this,Co,$o).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ho=new WeakMap,uo=new WeakMap,fo=new WeakMap,po=new WeakMap,go=new WeakMap,mo=new WeakMap,bo=new WeakMap,vo=new WeakMap,yo=new WeakMap,wo=new WeakMap,xo=new WeakMap,_o=new WeakMap,To=new WeakMap,Do=new WeakMap,Eo=new WeakMap,Ao=new WeakMap,ko=new WeakMap,So=new WeakMap,Co=new WeakSet,Uo=function(){const e=new lb(ch(this,fo),.001);hh(this,wo,e.getOutlines()),[this.x,this.y,this.width,this.height]=ch(this,wo).box;const t=new lb(ch(this,fo),.0025,.001,"ltr"===this._uiManager.direction);hh(this,mo,t.getOutlines());const{lastPoint:n}=ch(this,mo);hh(this,To,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},Fo=function({highlightOutlines:e,highlightId:t,clipPathId:n}){var i,r;if(hh(this,wo,e),hh(this,mo,e.getNewOutline(ch(this,ko)/2+1.5,.0025)),t>=0)hh(this,xo,t),hh(this,po,n),this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),hh(this,Eo,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:ch(this,mo).box,path:{d:ch(this,mo).toSVGPath()}},!0));else if(this.parent){const t=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(ch(this,xo),{bbox:dh(i=gb,Po,Lo).call(i,ch(this,wo).box,(t-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(ch(this,Eo),{bbox:dh(r=gb,Po,Lo).call(r,ch(this,mo).box,t),path:{d:ch(this,mo).toSVGPath()}})}const[a,s,o,c]=e.box;switch(this.rotation){case 0:this.x=a,this.y=s,this.width=o,this.height=c;break;case 90:{const[e,t]=this.parentDimensions;this.x=s,this.y=1-a,this.width=o*t/e,this.height=c*e/t;break}case 180:this.x=1-a,this.y=1-s,this.width=o,this.height=c;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-s,this.y=a,this.width=o*t/e,this.height=c*e/t;break}}const{lastPoint:l}=ch(this,mo);hh(this,To,[(l[0]-a)/o,(l[1]-s)/c])},Io=function(e){const t=(e,t)=>{var n,i;this.color=e,hh(this,Do,t),null==(n=this.parent)||n.drawLayer.updateProperties(ch(this,xo),{root:{fill:e,"fill-opacity":t}}),null==(i=ch(this,go))||i.updateColor(e)},n=this.color,i=ch(this,Do);this.addCommands({cmd:t.bind(this,e,gb._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cf.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},Ro=function(e){const t=ch(this,ko),n=e=>{hh(this,ko,e),dh(this,Co,No).call(this,e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cf.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},No=function(e){if(!ch(this,_o))return;dh(this,Co,Fo).call(this,{highlightOutlines:ch(this,wo).getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)},Mo=function(){null!==ch(this,xo)&&this.parent&&(this.parent.drawLayer.remove(ch(this,xo)),hh(this,xo,null),this.parent.drawLayer.remove(ch(this,Eo)),hh(this,Eo,null))},Oo=function(e=this.parent){null===ch(this,xo)&&(({id:uh(this,xo)._,clipPathId:uh(this,po)._}=e.drawLayer.draw({bbox:ch(this,wo).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":ch(this,Do)},rootClass:{highlight:!0,free:ch(this,_o)},path:{d:ch(this,wo).toSVGPath()}},!1,!0)),hh(this,Eo,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:ch(this,_o)},bbox:ch(this,mo).box,path:{d:ch(this,mo).toSVGPath()}},ch(this,_o))),ch(this,yo)&&(ch(this,yo).style.clipPath=ch(this,po)))},Po=new WeakSet,Lo=function([e,t,n,i],r){switch(r){case 90:return[1-t-i,e,i,n];case 180:return[1-e-n,1-t-i,n,i];case 270:return[t,1-e-n,i,n]}return[e,t,n,i]},Wo=function(e){gb._keyboardManager.exec(this,e)},Bo=function(e){if(!ch(this,ho))return;const t=window.getSelection();e?t.setPosition(ch(this,ho),ch(this,uo)):t.setPosition(ch(this,bo),ch(this,vo))},jo=function(){return ch(this,_o)?this.rotation:0},zo=function(){if(ch(this,_o))return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,r=ch(this,fo),a=new Float32Array(8*r.length);let s=0;for(const{x:o,y:c,width:l,height:h}of r){const r=o*e+n,d=(1-c)*t+i;a[s]=a[s+4]=r,a[s+1]=a[s+3]=d,a[s+2]=a[s+6]=r+l*e,a[s+5]=a[s+7]=d-h*t,s+=8}return a},Ho=function(e){return ch(this,wo).serialize(e,dh(this,Co,jo).call(this))},Vo=function(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Go=function(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},$o=function(e){const{color:t}=this._initialData;return e.color.some((e,n)=>e!==t[n])},lh(gb,Po),sh(gb,"_defaultColor",null),sh(gb,"_defaultOpacity",1),sh(gb,"_defaultThickness",12),sh(gb,"_type","highlight"),sh(gb,"_editorType",of.HIGHLIGHT),sh(gb,"_freeHighlightId",-1),sh(gb,"_freeHighlight",null),sh(gb,"_freeHighlightClipId","");let mb=gb;class bb{constructor(){lh(this,qo,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){ch(this,qo)[e]=t}toSVGProperties(){const e=ch(this,qo);return hh(this,qo,Object.create(null)),{root:e}}reset(){hh(this,qo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){mf("Not implemented")}}qo=new WeakMap;const vb=class e extends _p{constructor(e){super(e),lh(this,ic),lh(this,Xo,null),lh(this,Ko),sh(this,"_drawId",null),hh(this,Ko,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(dh(this,ic,rc).call(this,e),dh(this,ic,oc).call(this))}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,r]of Object.entries(t))n.has(i)?Object.assign(e[i],r):e[i]=r;return e}static getDefaultDrawingOptions(e){mf("Not implemented")}static get typesMap(){mf("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,n),this._currentParent&&(ch(e,Yo).updateProperty(i,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,r=i[t],a=e=>{var n;i.updateProperty(t,e);const r=ch(this,Xo).updateProperty(t,e);r&&dh(this,ic,hc).call(this,r),null==(n=this.parent)||n.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;null==(t=this.parent)||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(ch(this,Xo).getPathResizingSVGProperties(dh(this,ic,lc).call(this)),{bbox:dh(this,ic,dc).call(this)}))}_onResized(){var t;null==(t=this.parent)||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(ch(this,Xo).getPathResizedSVGProperties(dh(this,ic,lc).call(this)),{bbox:dh(this,ic,dc).call(this)}))}_onTranslating(e,t){var n;null==(n=this.parent)||n.drawLayer.updateProperties(this._drawId,{bbox:dh(this,ic,dc).call(this)})}_onTranslated(){var t;null==(t=this.parent)||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(ch(this,Xo).getPathTranslatedSVGProperties(dh(this,ic,lc).call(this),this.parentDimensions),{bbox:dh(this,ic,dc).call(this)}))}_onStartDragging(){var e;null==(e=this.parent)||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;null==(e=this.parent)||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,ch(this,Ko)&&(hh(this,Ko,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){dh(this,ic,sc).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(dh(this,ic,oc).call(this),dh(this,ic,hc).call(this,ch(this,Xo).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var t;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),dh(this,ic,sc).call(this)):e&&(this._uiManager.addShouldRescale(this),dh(this,ic,oc).call(this,e),n=!this.parent&&(null==(t=this.div)?void 0:t.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties({bbox:dh(this,ic,dc).call(this)},ch(this,Xo).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&dh(this,ic,hc).call(this,ch(this,Xo).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[r,a]=this.parentDimensions;return this.setDims(this.width*r,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,r){mf("Not implemented")}static startDrawing(t,n,i,r){var a;const{target:s,offsetX:o,offsetY:c,pointerId:l,pointerType:h}=r;if(ch(e,ec)&&ch(e,ec)!==h)return;const{viewport:{rotation:d}}=t,{width:u,height:f}=s.getBoundingClientRect(),p=hh(e,Zo,new AbortController),g=t.combinedSignal(p);ch(e,Qo)||hh(e,Qo,l),ch(e,ec)??hh(e,ec,h),window.addEventListener("pointerup",t=>{var n;ch(e,Qo)===t.pointerId?this._endDraw(t):null==(n=ch(e,tc))||n.delete(t.pointerId)},{signal:g}),window.addEventListener("pointercancel",t=>{var n;ch(e,Qo)===t.pointerId?this._currentParent.endDrawingSession():null==(n=ch(e,tc))||n.delete(t.pointerId)},{signal:g}),window.addEventListener("pointerdown",t=>{ch(e,ec)===t.pointerType&&((ch(e,tc)||hh(e,tc,new Set)).add(t.pointerId),ch(e,Yo).isCancellable()&&(ch(e,Yo).removeLastElement(),ch(e,Yo).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Kf,{signal:g}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),s.addEventListener("touchmove",t=>{t.timeStamp===ch(e,nc)&&Yf(t)},{signal:g}),t.toggleDrawing(),null==(a=n._editorUndoBar)||a.hide(),ch(e,Yo)?t.drawLayer.updateProperties(this._currentDrawId,ch(e,Yo).startNew(o,c,u,f,d)):(n.updateUIForDefaultProperties(this),hh(e,Yo,this.createDrawerInstance(o,c,u,f,d)),hh(e,Jo,this.getDefaultDrawingOptions()),this._currentParent=t,({id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(ch(e,Jo).toSVGProperties(),ch(e,Yo).defaultSVGProperties),!0,!1)))}static _drawMove(t){var n;if(hh(e,nc,-1),!ch(e,Yo))return;const{offsetX:i,offsetY:r,pointerId:a}=t;ch(e,Qo)===a&&((null==(n=ch(e,tc))?void 0:n.size)>=1?this._endDraw(t):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,ch(e,Yo).add(i,r)),hh(e,nc,t.timeStamp),Yf(t)))}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,hh(e,Yo,null),hh(e,Jo,null),hh(e,ec,null),hh(e,nc,NaN)),ch(e,Zo)&&(ch(e,Zo).abort(),hh(e,Zo,null),hh(e,Qo,NaN),hh(e,tc,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(null==t?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,ch(e,Yo).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const t=ch(e,Yo),i=this._currentDrawId,r=t.getLastElement();return void n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,t.setLastElement(r))},undo:()=>{n.drawLayer.updateProperties(i,t.removeLastElement())},mustExec:!1,type:cf.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(cf.DRAW_STEP),!ch(e,Yo).isEmpty()){const{pageDimensions:[i,r],scale:a}=n,s=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ch(e,Yo).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:ch(e,Jo),mustBeCommitted:!t});return this._cleanup(!0),s}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,r,a){mf("Not implemented")}static async deserialize(e,t,n){var i,r;const{rawDims:{pageWidth:a,pageHeight:s,pageX:o,pageY:c}}=t.viewport,l=this.deserializeDraw(o,c,a,s,this._INNER_MARGIN,e),h=await super.deserialize(e,t,n);return h.createDrawingOptions(e),dh(i=h,ic,rc).call(i,{drawOutlines:l}),dh(r=h,ic,oc).call(r),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[t,n]=this.pageTranslation,[i,r]=this.pageDimensions;return ch(this,Xo).serialize([t,n,i,r],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Xo=new WeakMap,Ko=new WeakMap,Yo=new WeakMap,Zo=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,ec=new WeakMap,tc=new WeakMap,nc=new WeakMap,ic=new WeakSet,rc=function({drawOutlines:e,drawId:t,drawingOptions:n}){hh(this,Xo,e),this._drawingOptions||(this._drawingOptions=n),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=dh(this,ic,ac).call(this,e,this.parent),dh(this,ic,hc).call(this,e.box)},ac=function(e,t){const{id:n}=t.drawLayer.draw(vb._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n},sc=function(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},oc=function(e=this.parent){null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=dh(this,ic,ac).call(this,ch(this,Xo),e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))},cc=function([e,t,n,i]){const{parentDimensions:[r,a],rotation:s}=this;switch(s){case 90:return[t,1-e,n*(a/r),i*(r/a)];case 180:return[1-e,1-t,n,i];case 270:return[1-t,e,n*(a/r),i*(r/a)];default:return[e,t,n,i]}},lc=function(){const{x:e,y:t,width:n,height:i,parentDimensions:[r,a],rotation:s}=this;switch(s){case 90:return[1-t,e,n*(r/a),i*(a/r)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(r/a),i*(a/r)];default:return[e,t,n,i]}},hc=function(e){if([this.x,this.y,this.width,this.height]=dh(this,ic,cc).call(this,e),this.div){this.fixAndSetPosition();const[e,t]=this.parentDimensions;this.setDims(this.width*e,this.height*t)}this._onResized()},dc=function(){const{x:e,y:t,width:n,height:i,rotation:r,parentRotation:a,parentDimensions:[s,o]}=this;switch((4*r+a)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(s/o),i*(o/s),n*(s/o)];case 5:return[1-t,e,n*(s/o),i*(o/s)];case 6:return[1-e-i*(o/s),1-t,i*(o/s),n*(s/o)];case 7:return[t-n*(s/o),1-e-i*(o/s),n*(s/o),i*(o/s)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(o/s),t,i*(o/s),n*(s/o)];case 13:return[1-t-n*(s/o),e-i*(o/s),n*(s/o),i*(o/s)];case 14:return[1-e,1-t-n*(s/o),i*(o/s),n*(s/o)];case 15:return[t,1-e,n*(s/o),i*(o/s)];default:return[e,t,n,i]}},sh(vb,"_currentDrawId",-1),sh(vb,"_currentParent",null),lh(vb,Yo,null),lh(vb,Zo,null),lh(vb,Jo,null),lh(vb,Qo,NaN),lh(vb,ec,null),lh(vb,tc,null),lh(vb,nc,NaN),sh(vb,"_INNER_MARGIN",3);let yb=vb;class wb{constructor(e,t,n,i,r,a){lh(this,Tc),lh(this,uc,new Float64Array(6)),lh(this,fc),lh(this,pc),lh(this,gc),lh(this,mc),lh(this,bc),lh(this,vc,""),lh(this,yc,0),lh(this,wc,new xb),lh(this,xc),lh(this,_c),hh(this,xc,n),hh(this,_c,i),hh(this,gc,r),hh(this,mc,a),[e,t]=dh(this,Tc,Dc).call(this,e,t);const s=hh(this,fc,[NaN,NaN,NaN,NaN,e,t]);hh(this,bc,[e,t]),hh(this,pc,[{line:s,points:ch(this,bc)}]),ch(this,uc).set(s,0)}updateProperty(e,t){"stroke-width"===e&&hh(this,mc,t)}isEmpty(){return!ch(this,pc)||0===ch(this,pc).length}isCancellable(){return ch(this,bc).length<=10}add(e,t){[e,t]=dh(this,Tc,Dc).call(this,e,t);const[n,i,r,a]=ch(this,uc).subarray(2,6),s=e-r,o=t-a;return Math.hypot(ch(this,xc)*s,ch(this,_c)*o)<=2?null:(ch(this,bc).push(e,t),isNaN(n)?(ch(this,uc).set([r,a,e,t],2),ch(this,fc).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(ch(this,uc)[0])&&ch(this,fc).splice(6,6),ch(this,uc).set([n,i,r,a,e,t],0),ch(this,fc).push(...ab.createBezierPoints(n,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){return this.add(e,t)||(2===ch(this,bc).length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,r){hh(this,xc,n),hh(this,_c,i),hh(this,gc,r),[e,t]=dh(this,Tc,Dc).call(this,e,t);const a=hh(this,fc,[NaN,NaN,NaN,NaN,e,t]);hh(this,bc,[e,t]);const s=ch(this,pc).at(-1);return s&&(s.line=new Float32Array(s.line),s.points=new Float32Array(s.points)),ch(this,pc).push({line:a,points:ch(this,bc)}),ch(this,uc).set(a,0),hh(this,yc,0),this.toSVGPath(),null}getLastElement(){return ch(this,pc).at(-1)}setLastElement(e){return ch(this,pc)?(ch(this,pc).push(e),hh(this,fc,e.line),hh(this,bc,e.points),hh(this,yc,0),{path:{d:this.toSVGPath()}}):ch(this,wc).setLastElement(e)}removeLastElement(){if(!ch(this,pc))return ch(this,wc).removeLastElement();ch(this,pc).pop(),hh(this,vc,"");for(let e=0,t=ch(this,pc).length;e<t;e++){const{line:t,points:n}=ch(this,pc)[e];hh(this,fc,t),hh(this,bc,n),hh(this,yc,0),this.toSVGPath()}return{path:{d:ch(this,vc)}}}toSVGPath(){const e=ab.svgRound(ch(this,fc)[4]),t=ab.svgRound(ch(this,fc)[5]);if(2===ch(this,bc).length)return hh(this,vc,`${ch(this,vc)} M ${e} ${t} Z`),ch(this,vc);if(ch(this,bc).length<=6){const n=ch(this,vc).lastIndexOf("M");hh(this,vc,`${ch(this,vc).slice(0,n)} M ${e} ${t}`),hh(this,yc,6)}if(4===ch(this,bc).length){const e=ab.svgRound(ch(this,fc)[10]),t=ab.svgRound(ch(this,fc)[11]);return hh(this,vc,`${ch(this,vc)} L ${e} ${t}`),hh(this,yc,12),ch(this,vc)}const n=[];0===ch(this,yc)&&(n.push(`M ${e} ${t}`),hh(this,yc,6));for(let i=ch(this,yc),r=ch(this,fc).length;i<r;i+=6){const[e,t,r,a,s,o]=ch(this,fc).slice(i,i+6).map(ab.svgRound);n.push(`C${e} ${t} ${r} ${a} ${s} ${o}`)}return hh(this,vc,ch(this,vc)+n.join(" ")),hh(this,yc,ch(this,fc).length),ch(this,vc)}getOutlines(e,t,n,i){const r=ch(this,pc).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),ch(this,wc).build(ch(this,pc),e,t,n,ch(this,gc),ch(this,mc),i),hh(this,uc,null),hh(this,fc,null),hh(this,pc,null),hh(this,vc,null),ch(this,wc)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}uc=new WeakMap,fc=new WeakMap,pc=new WeakMap,gc=new WeakMap,mc=new WeakMap,bc=new WeakMap,vc=new WeakMap,yc=new WeakMap,wc=new WeakMap,xc=new WeakMap,_c=new WeakMap,Tc=new WeakSet,Dc=function(e,t){return ab._normalizePoint(e,t,ch(this,xc),ch(this,_c),ch(this,gc))};class xb extends ab{constructor(){super(...arguments),lh(this,Nc),lh(this,Ec),lh(this,Ac,0),lh(this,kc),lh(this,Sc),lh(this,Cc),lh(this,Uc),lh(this,Fc),lh(this,Ic),lh(this,Rc)}build(e,t,n,i,r,a,s){hh(this,Cc,t),hh(this,Uc,n),hh(this,Fc,i),hh(this,Ic,r),hh(this,Rc,a),hh(this,kc,s??0),hh(this,Sc,e),dh(this,Nc,Pc).call(this)}get thickness(){return ch(this,Rc)}setLastElement(e){return ch(this,Sc).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return ch(this,Sc).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of ch(this,Sc))if(e.push(`M${ab.svgRound(t[4])} ${ab.svgRound(t[5])}`),6!==t.length)if(12===t.length&&isNaN(t[6]))e.push(`L${ab.svgRound(t[10])} ${ab.svgRound(t[11])}`);else for(let n=6,i=t.length;n<i;n+=6){const[i,r,a,s,o,c]=t.subarray(n,n+6).map(ab.svgRound);e.push(`C${i} ${r} ${a} ${s} ${o} ${c}`)}else e.push("Z");return e.join("")}serialize([e,t,n,i],r){const a=[],s=[],[o,c,l,h]=dh(this,Nc,Oc).call(this);let d,u,f,p,g,m,b,v,y;switch(ch(this,Ic)){case 0:y=ab._rescale,d=e,u=t+i,f=n,p=-i,g=e+o*n,m=t+(1-c-h)*i,b=e+(o+l)*n,v=t+(1-c)*i;break;case 90:y=ab._rescaleAndSwap,d=e,u=t,f=n,p=i,g=e+c*n,m=t+o*i,b=e+(c+h)*n,v=t+(o+l)*i;break;case 180:y=ab._rescale,d=e+n,u=t,f=-n,p=i,g=e+(1-o-l)*n,m=t+c*i,b=e+(1-o)*n,v=t+(c+h)*i;break;case 270:y=ab._rescaleAndSwap,d=e+n,u=t+i,f=-n,p=-i,g=e+(1-c-h)*n,m=t+(1-o-l)*i,b=e+(1-c)*n,v=t+(1-o)*i}for(const{line:w,points:x}of ch(this,Sc))a.push(y(w,d,u,f,p,r?new Array(w.length):null)),s.push(y(x,d,u,f,p,r?new Array(x.length):null));return{lines:a,points:s,rect:[g,m,b,v]}}static deserialize(e,t,n,i,r,{paths:{lines:a,points:s},rotation:o,thickness:c}){const l=[];let h,d,u,f,p;switch(o){case 0:p=ab._rescale,h=-e/n,d=t/i+1,u=1/n,f=-1/i;break;case 90:p=ab._rescaleAndSwap,h=-t/i,d=-e/n,u=1/i,f=1/n;break;case 180:p=ab._rescale,h=e/n+1,d=-t/i,u=-1/n,f=1/i;break;case 270:p=ab._rescaleAndSwap,h=t/i+1,d=e/n+1,u=-1/i,f=-1/n}if(!a){a=[];for(const e of s){const t=e.length;if(2===t){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const n=new Float32Array(3*(t-2));a.push(n);let[i,r,s,o]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,r],0);for(let a=4;a<t;a+=2){const t=e[a],c=e[a+1];n.set(ab.createBezierPoints(i,r,s,o,t,c),3*(a-2)),[i,r,s,o]=[s,o,t,c]}}}for(let m=0,b=a.length;m<b;m++)l.push({line:p(a[m].map(e=>e??NaN),h,d,u,f),points:p(s[m].map(e=>e??NaN),h,d,u,f)});const g=new this.prototype.constructor;return g.build(l,n,i,1,o,c,r),g}get box(){return ch(this,Ec)}updateProperty(e,t){return"stroke-width"===e?dh(this,Nc,Lc).call(this,t):null}updateParentDimensions([e,t],n){const[i,r]=dh(this,Nc,Mc).call(this);hh(this,Cc,e),hh(this,Uc,t),hh(this,Fc,n);const[a,s]=dh(this,Nc,Mc).call(this),o=a-i,c=s-r,l=ch(this,Ec);return l[0]-=o,l[1]-=c,l[2]+=2*o,l[3]+=2*c,l}updateRotation(e){return hh(this,Ac,e),{path:{transform:this.rotationTransform}}}get viewBox(){return ch(this,Ec).map(ab.svgRound).join(" ")}get defaultProperties(){const[e,t]=ch(this,Ec);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ab.svgRound(e)} ${ab.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=ch(this,Ec);let n=0,i=0,r=0,a=0,s=0,o=0;switch(ch(this,Ac)){case 90:i=t/e,r=-e/t,s=e;break;case 180:n=-1,a=-1,s=e,o=t;break;case 270:i=-t/e,r=e/t,o=t;break;default:return""}return`matrix(${n} ${i} ${r} ${a} ${ab.svgRound(s)} ${ab.svgRound(o)})`}getPathResizingSVGProperties([e,t,n,i]){const[r,a]=dh(this,Nc,Mc).call(this),[s,o,c,l]=ch(this,Ec);if(Math.abs(c-r)<=ab.PRECISION||Math.abs(l-a)<=ab.PRECISION){const r=e+n/2-(s+c/2),a=t+i/2-(o+l/2);return{path:{"transform-origin":`${ab.svgRound(e)} ${ab.svgRound(t)}`,transform:`${this.rotationTransform} translate(${r} ${a})`}}}const h=(n-2*r)/(c-2*r),d=(i-2*a)/(l-2*a),u=c/n,f=l/i;return{path:{"transform-origin":`${ab.svgRound(s)} ${ab.svgRound(o)}`,transform:`${this.rotationTransform} scale(${u} ${f}) translate(${ab.svgRound(r)} ${ab.svgRound(a)}) scale(${h} ${d}) translate(${ab.svgRound(-r)} ${ab.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,n,i]){const[r,a]=dh(this,Nc,Mc).call(this),s=ch(this,Ec),[o,c,l,h]=s;if(s[0]=e,s[1]=t,s[2]=n,s[3]=i,Math.abs(l-r)<=ab.PRECISION||Math.abs(h-a)<=ab.PRECISION){const r=e+n/2-(o+l/2),a=t+i/2-(c+h/2);for(const{line:e,points:t}of ch(this,Sc))ab._translate(e,r,a,e),ab._translate(t,r,a,t);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ab.svgRound(e)} ${ab.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(n-2*r)/(l-2*r),u=(i-2*a)/(h-2*a),f=-d*(o+r)+e+r,p=-u*(c+a)+t+a;if(1!==d||1!==u||0!==f||0!==p)for(const{line:g,points:m}of ch(this,Sc))ab._rescale(g,f,p,d,u,g),ab._rescale(m,f,p,d,u,m);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ab.svgRound(e)} ${ab.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[i,r]=n,a=ch(this,Ec),s=e-a[0],o=t-a[1];if(ch(this,Cc)===i&&ch(this,Uc)===r)for(const{line:c,points:l}of ch(this,Sc))ab._translate(c,s,o,c),ab._translate(l,s,o,l);else{const e=ch(this,Cc)/i,t=ch(this,Uc)/r;hh(this,Cc,i),hh(this,Uc,r);for(const{line:n,points:i}of ch(this,Sc))ab._rescale(n,s,o,e,t,n),ab._rescale(i,s,o,e,t,i);a[2]*=e,a[3]*=t}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ab.svgRound(e)} ${ab.svgRound(t)}`}}}get defaultSVGProperties(){const e=ch(this,Ec);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ab.svgRound(e[0])} ${ab.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}Ec=new WeakMap,Ac=new WeakMap,kc=new WeakMap,Sc=new WeakMap,Cc=new WeakMap,Uc=new WeakMap,Fc=new WeakMap,Ic=new WeakMap,Rc=new WeakMap,Nc=new WeakSet,Mc=function(e=ch(this,Rc)){const t=ch(this,kc)+e/2*ch(this,Fc);return ch(this,Ic)%180==0?[t/ch(this,Cc),t/ch(this,Uc)]:[t/ch(this,Uc),t/ch(this,Cc)]},Oc=function(){const[e,t,n,i]=ch(this,Ec),[r,a]=dh(this,Nc,Mc).call(this,0);return[e+r,t+a,n-2*r,i-2*a]},Pc=function(){const e=hh(this,Ec,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of ch(this,Sc)){if(i.length<=12){for(let t=4,n=i.length;t<n;t+=6)If.pointBoundingBox(i[t],i[t+1],e);continue}let t=i[4],n=i[5];for(let r=6,a=i.length;r<a;r+=6){const[a,s,o,c,l,h]=i.subarray(r,r+6);If.bezierBoundingBox(t,n,a,s,o,c,l,h,e),t=l,n=h}}const[t,n]=dh(this,Nc,Mc).call(this);e[0]=Pf(e[0]-t,0,1),e[1]=Pf(e[1]-n,0,1),e[2]=Pf(e[2]+t,0,1),e[3]=Pf(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]},Lc=function(e){const[t,n]=dh(this,Nc,Mc).call(this);hh(this,Rc,e);const[i,r]=dh(this,Nc,Mc).call(this),[a,s]=[i-t,r-n],o=ch(this,Ec);return o[0]-=a,o[1]-=s,o[2]+=2*a,o[3]+=2*s,o};class _b extends bb{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:_p._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new _b(this._viewParameters);return e.updateAll(this),e}}const Tb=class e extends yb{constructor(e){super({...e,name:"inkEditor"}),lh(this,Wc),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){_p.initialize(e,t),this._defaultDrawingOptions=new _b(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return wf(this,"typesMap",new Map([[cf.INK_THICKNESS,"stroke-width"],[cf.INK_COLOR,"stroke"],[cf.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,r){return new wb(e,t,n,i,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,r,a){return xb.deserialize(e,t,n,i,r,a)}static async deserialize(e,t,n){let i=null;if(e instanceof Km){const{data:{inkLists:t,rect:n,rotation:r,id:a,color:s,opacity:o,borderStyle:{rawWidth:c},popupRef:l},parent:{page:{pageNumber:h}}}=e;i=e={annotationType:of.INK,color:Array.from(s),thickness:c,opacity:o,paths:{points:t},boxes:null,pageIndex:h-1,rect:n.slice(0),rotation:r,annotationElementId:a,id:a,deleted:!1,popupRef:l}}const r=await super.deserialize(e,t,n);return r._initialData=i,r}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:i}){this._drawingOptions=e.getDefaultDrawingOptions({stroke:If.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":s}}=this,o={annotationType:of.INK,color:_p._colorManager.convert(r),opacity:a,thickness:s,paths:{lines:t,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(o.isCopy=!0,o):this.annotationElementId&&!dh(this,Wc,Bc).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t}),null}};Wc=new WeakSet,Bc=function(e){const{color:t,thickness:n,opacity:i,pageIndex:r}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==i||e.pageIndex!==r},sh(Tb,"_type","ink"),sh(Tb,"_editorType",of.INK),sh(Tb,"_defaultDrawingOptions",null);let Db=Tb;class Eb extends xb{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}class Ab{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},r,a,s,o){let c=new OffscreenCanvas(1,1),l=c.getContext("2d",{alpha:!1});const h=l.font=`${n} ${i} 200px ${t}`,{actualBoundingBoxLeft:d,actualBoundingBoxRight:u,actualBoundingBoxAscent:f,actualBoundingBoxDescent:p,fontBoundingBoxAscent:g,fontBoundingBoxDescent:m,width:b}=l.measureText(e),v=Math.ceil(1.5*Math.max(Math.abs(d)+Math.abs(u)||0,b)),y=Math.ceil(1.5*Math.max(Math.abs(f)+Math.abs(p)||200,Math.abs(g)+Math.abs(m)||200));c=new OffscreenCanvas(v,y),l=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),l.font=h,l.filter="grayscale(1)",l.fillStyle="white",l.fillRect(0,0,v,y),l.fillStyle="black",l.fillText(e,.5*v/2,1.5*y/2);const w=dh(this,zc,Jc).call(this,l.getImageData(0,0,v,y).data),x=dh(this,zc,Zc).call(this,w),_=dh(this,zc,Qc).call(this,x),T=dh(this,zc,qc).call(this,w,v,y,_);return this.processDrawnLines({lines:{curves:T,width:v,height:y},pageWidth:r,pageHeight:a,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,r){const[a,s,o]=dh(this,zc,el).call(this,e),[c,l]=dh(this,zc,Yc).call(this,a,s,o,Math.hypot(s,o)*ch(this,jc).sigmaSFactor,ch(this,jc).sigmaR,ch(this,jc).kernelSize),h=dh(this,zc,Qc).call(this,l),d=dh(this,zc,qc).call(this,c,s,o,h);return this.processDrawnLines({lines:{curves:d,width:s,height:o},pageWidth:t,pageHeight:n,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:r,mustSmooth:a,areContours:s}){i%180!=0&&([t,n]=[n,t]);const{curves:o,width:c,height:l}=e,h=e.thickness??0,d=[],u=Math.min(t/c,n/l),f=u/t,p=u/n,g=[];for(const{points:b}of o){const e=a?dh(this,zc,Kc).call(this,b):b;if(!e)continue;g.push(e);const t=e.length,n=new Float32Array(t),i=new Float32Array(3*(2===t?2:t-2));if(d.push({line:i,points:n}),2===t){n[0]=e[0]*f,n[1]=e[1]*p,i.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[r,s,o,c]=e;r*=f,s*=p,o*=f,c*=p,n.set([r,s,o,c],0),i.set([NaN,NaN,NaN,NaN,r,s],0);for(let a=4;a<t;a+=2){const t=n[a]=e[a]*f,l=n[a+1]=e[a+1]*p;i.set(ab.createBezierPoints(r,s,o,c,t,l),3*(a-2)),[r,s,o,c]=[o,c,t,l]}}if(0===d.length)return null;const m=s?new Eb:new xb;return m.build(d,t,n,1,i,s?0:h,r),{outline:m,newCurves:g,areContours:s,thickness:h,width:c,height:l}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:r}){let a,s=1/0,o=-1/0,c=0;for(const b of e){c+=b.length;for(let e=2,t=b.length;e<t;e++){const t=b[e]-b[e-2];s=Math.min(s,t),o=Math.max(o,t)}}a=s>=-128&&o<=127?Int8Array:s>=-32768&&o<=32767?Int16Array:Int32Array;const l=e.length,h=8+3*l,d=new Uint32Array(h);let u=0;d[u++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*l)*a.BYTES_PER_ELEMENT,d[u++]=0,d[u++]=i,d[u++]=r,d[u++]=t?0:1,d[u++]=Math.max(0,Math.floor(n??0)),d[u++]=l,d[u++]=a.BYTES_PER_ELEMENT;for(const b of e)d[u++]=b.length-2,d[u++]=b[0],d[u++]=b[1];const f=new CompressionStream("deflate-raw"),p=f.writable.getWriter();await p.ready,p.write(d);const g=a.prototype.constructor;for(const b of e){const e=new g(b.length-2);for(let t=2,n=b.length;t<n;t++)e[t-2]=b[t]-b[t-2];p.write(e)}p.close();const m=await new Response(f.readable).arrayBuffer();return Lf(new Uint8Array(m))}static async decompressSignature(e){try{const n=(t=e,Uint8Array.fromBase64?Uint8Array.fromBase64(t):Cf(atob(t))),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),a=r.getWriter();await a.ready,a.write(n).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let s=null,o=0;for await(const e of i)s||(s=new Uint8Array(new Uint32Array(e.buffer,0,4)[0])),s.set(e,o),o+=e.length;const c=new Uint32Array(s.buffer,0,s.length>>2),l=c[1];if(0!==l)throw new Error(`Invalid version: ${l}`);const h=c[2],d=c[3],u=0===c[4],f=c[5],p=c[6],g=c[7],m=[],b=(8+3*p)*Uint32Array.BYTES_PER_ELEMENT;let v;switch(g){case Int8Array.BYTES_PER_ELEMENT:v=new Int8Array(s.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:v=new Int16Array(s.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:v=new Int32Array(s.buffer,b)}o=0;for(let e=0;e<p;e++){const t=c[3*e+8],n=new Float32Array(t+2);m.push(n);for(let i=0;i<2;i++)n[i]=c[3*e+8+i+1];for(let e=0;e<t;e++)n[e+2]=n[e]+v[o++]}return{areContours:u,thickness:f,outlines:m,width:h,height:d}}catch(n){return null}var t}}jc=new WeakMap,zc=new WeakSet,Hc=function(e,t,n,i){return i-=t,0===(n-=e)?i>0?0:4:1===n?i+6:2-i},Vc=new WeakMap,Gc=function(e,t,n,i,r,a,s){const o=dh(this,zc,Hc).call(this,n,i,r,a);for(let c=0;c<8;c++){const r=(-c+o-s+16)%8;if(0!==e[(n+ch(this,Vc)[2*r])*t+(i+ch(this,Vc)[2*r+1])])return r}return-1},$c=function(e,t,n,i,r,a,s){const o=dh(this,zc,Hc).call(this,n,i,r,a);for(let c=0;c<8;c++){const r=(c+o+s+16)%8;if(0!==e[(n+ch(this,Vc)[2*r])*t+(i+ch(this,Vc)[2*r+1])])return r}return-1},qc=function(e,t,n,i){const r=e.length,a=new Int32Array(r);for(let l=0;l<r;l++)a[l]=e[l]<=i?1:0;for(let l=1;l<n-1;l++)a[l*t]=a[l*t+t-1]=0;for(let l=0;l<t;l++)a[l]=a[t*n-1-l]=0;let s,o=1;const c=[];for(let l=1;l<n-1;l++){s=1;for(let e=1;e<t-1;e++){const n=l*t+e,i=a[n];if(0===i)continue;let r=l,h=e;if(1===i&&0===a[n-1])o+=1,h-=1;else{if(!(i>=1&&0===a[n+1])){1!==i&&(s=Math.abs(i));continue}o+=1,h+=1,i>1&&(s=i)}const d=[e,l],u=h===e+1,f={isHole:u,points:d,id:o,parent:0};let p;c.push(f);for(const e of c)if(e.id===s){p=e;break}p?p.isHole?f.parent=u?p.parent:s:f.parent=u?s:p.parent:f.parent=u?s:0;const g=dh(this,zc,Gc).call(this,a,t,l,e,r,h,0);if(-1===g){a[n]=-o,1!==a[n]&&(s=Math.abs(a[n]));continue}let m=ch(this,Vc)[2*g],b=ch(this,Vc)[2*g+1];const v=l+m,y=e+b;r=v,h=y;let w=l,x=e;for(;;){const i=dh(this,zc,$c).call(this,a,t,w,x,r,h,1);m=ch(this,Vc)[2*i],b=ch(this,Vc)[2*i+1];const c=w+m,u=x+b;d.push(u,c);const f=w*t+x;if(0===a[f+1]?a[f]=-o:1===a[f]&&(a[f]=o),c===l&&u===e&&w===v&&x===y){1!==a[n]&&(s=Math.abs(a[n]));break}r=w,h=x,w=c,x=u}}}return c},Xc=function(e,t,n,i){if(n-t<=4){for(let r=t;r<n-2;r+=2)i.push(e[r],e[r+1]);return}const r=e[t],a=e[t+1],s=e[n-4]-r,o=e[n-3]-a,c=Math.hypot(s,o),l=s/c,h=o/c,d=l*a-h*r,u=o/s,f=1/c,p=Math.atan(u),g=Math.cos(p),m=Math.sin(p),b=f*(Math.abs(g)+Math.abs(m)),v=f*(1-b+b**2),y=Math.max(Math.atan(Math.abs(m+g)*v),Math.atan(Math.abs(m-g)*v));let w=0,x=t;for(let _=t+2;_<n-2;_+=2){const t=Math.abs(d-l*e[_+1]+h*e[_]);t>w&&(x=_,w=t)}w>(c*y)**2?(dh(this,zc,Xc).call(this,e,t,x+2,i),dh(this,zc,Xc).call(this,e,x,n,i)):i.push(r,a)},Kc=function(e){const t=[],n=e.length;return dh(this,zc,Xc).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},Yc=function(e,t,n,i,r,a){const s=new Float32Array(a**2),o=-2*i**2,c=a>>1;for(let p=0;p<a;p++){const e=(p-c)**2;for(let t=0;t<a;t++)s[p*a+t]=Math.exp((e+(t-c)**2)/o)}const l=new Float32Array(256),h=-2*r**2;for(let p=0;p<256;p++)l[p]=Math.exp(p**2/h);const d=e.length,u=new Uint8Array(d),f=new Uint32Array(256);for(let p=0;p<n;p++)for(let i=0;i<t;i++){const r=p*t+i,o=e[r];let h=0,d=0;for(let u=0;u<a;u++){const r=p+u-c;if(!(r<0||r>=n))for(let n=0;n<a;n++){const f=i+n-c;if(f<0||f>=t)continue;const p=e[r*t+f],g=s[u*a+n]*l[Math.abs(p-o)];h+=p*g,d+=g}}f[u[r]=Math.round(h/d)]++}return[u,f]},Zc=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},Jc=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let s=0,o=n.length;s<o;s++){if(0===e[3+(s<<2)]){i=n[s]=255;continue}const t=n[s]=e[s<<2];t>i&&(i=t),t<r&&(r=t)}const a=255/(i-r);for(let s=0;s<t;s++)n[s]=(n[s]-r)*a;return n},Qc=function(e){let t,n=-1/0,i=-1/0;const r=e.findIndex(e=>0!==e);let a=r,s=r;for(t=r;t<256;t++){const r=e[t];r>n&&(t-a>i&&(i=t-a,s=t-1),n=r,a=t)}for(t=s-1;t>=0&&!(e[t]>e[t+1]);t--);return t},el=function(e){const t=e,{width:n,height:i}=e,{maxDim:r}=ch(this,jc);let a=n,s=i;if(n>r||i>r){let o=n,c=i,l=Math.log2(Math.max(n,i)/r);const h=Math.floor(l);l=l===h?h-1:h;for(let n=0;n<l;n++){a=Math.ceil(o/2),s=Math.ceil(c/2);const n=new OffscreenCanvas(a,s);n.getContext("2d").drawImage(e,0,0,o,c,0,0,a,s),o=a,c=s,e!==t&&e.close(),e=n.transferToImageBitmap()}const d=Math.min(r/a,r/s);a=Math.round(a*d),s=Math.round(s*d)}const o=new OffscreenCanvas(a,s).getContext("2d",{willReadFrequently:!0});o.filter="grayscale(1)",o.drawImage(e,0,0,e.width,e.height,0,0,a,s);const c=o.getImageData(0,0,a,s).data;return[dh(this,zc,Jc).call(this,c),a,s]},lh(Ab,zc),lh(Ab,jc,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),lh(Ab,Vc,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class kb extends bb{constructor(){super(),super.updateProperties({fill:_p._defaultLineColor,"stroke-width":0})}clone(){const e=new kb;return e.updateAll(this),e}}class Sb extends _b{constructor(e){super(e),super.updateProperties({stroke:_p._defaultLineColor,"stroke-width":1})}clone(){const e=new Sb(this._viewParameters);return e.updateAll(this),e}}const Cb=class e extends yb{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),lh(this,tl,!1),lh(this,nl,null),lh(this,il,null),lh(this,rl,null),this._willKeepAspectRatio=!0,hh(this,il,e.signatureData||null),hh(this,nl,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){_p.initialize(e,t),this._defaultDrawingOptions=new kb,this._defaultDrawnSignatureOptions=new Sb(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return wf(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!ch(this,nl)}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),null===this._drawId)if(ch(this,il)){const{lines:t,mustSmooth:n,areContours:i,description:r,uuid:a,heightInPage:s}=ch(this,il),{rawDims:{pageWidth:o,pageHeight:c},rotation:l}=this.parent.viewport,h=Ab.processDrawnLines({lines:t,pageWidth:o,pageHeight:c,rotation:l,innerMargin:e._INNER_MARGIN,mustSmooth:n,areContours:i});this.addSignature(h,s,r,a)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(e){hh(this,rl,e),this.addEditToolbar()}getUuid(){return ch(this,rl)}get description(){return ch(this,nl)}set description(e){hh(this,nl,e),super.addEditToolbar().then(t=>{null==t||t.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:r}=ch(this,il),a=Math.max(i,r);return{areContours:t,outline:Ab.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:i,height:r},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,i,r){const{x:a,y:s}=this,{outline:o}=hh(this,il,t);let c;hh(this,tl,o instanceof Eb),this.description=i,this.div.setAttribute("data-l10n-args",JSON.stringify({description:i})),ch(this,tl)?c=e.getDefaultDrawingOptions():(c=e._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":o.thickness})),this._addOutlines({drawOutlines:o,drawingOptions:c});const[l,h]=this.parentDimensions,[,d]=this.pageDimensions;let u=n/d;u=u>=1?.5:u,this.width*=u/this.height,this.width>=1&&(u*=.9/this.width,this.width=.9),this.height=u,this.setDims(l*this.width,h*this.height),this.x=a,this.y=s,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:r}=this.parent.viewport;return Ab.process(t,n,i,r,e._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return Ab.extractContoursFromText(t,n,i,r,a,e._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:r}=this.parent.viewport;return Ab.processDrawnLines({lines:t,pageWidth:n,pageHeight:i,rotation:r,innerMargin:e._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=e.getDefaultDrawingOptions():(this._drawingOptions=e._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,a={annotationType:of.SIGNATURE,isSignature:!0,areContours:ch(this,tl),color:[0,0,0],thickness:ch(this,tl)?0:r,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(a.paths={lines:t,points:n},a.uuid=ch(this,rl),a.isCopy=!0):a.lines=t,ch(this,nl)&&(a.accessibilityData={type:"Figure",alt:ch(this,nl)}),a}static deserializeDraw(e,t,n,i,r,a){return a.areContours?Eb.deserialize(e,t,n,i,r,a):xb.deserialize(e,t,n,i,r,a)}static async deserialize(e,t,n){var i;const r=await super.deserialize(e,t,n);return hh(r,tl,e.areContours),hh(r,nl,(null==(i=e.accessibilityData)?void 0:i.alt)||""),hh(r,rl,e.uuid),r}};tl=new WeakMap,nl=new WeakMap,il=new WeakMap,rl=new WeakMap,sh(Cb,"_type","signature"),sh(Cb,"_editorType",of.SIGNATURE),sh(Cb,"_defaultDrawingOptions",null);let Ub=Cb;class Fb extends _p{constructor(e){super({...e,name:"stampEditor"}),lh(this,ml),lh(this,al,null),lh(this,sl,null),lh(this,ol,null),lh(this,cl,null),lh(this,ll,null),lh(this,hl,""),lh(this,dl,null),lh(this,ul,!1),lh(this,fl,null),lh(this,pl,!1),lh(this,gl,!1),hh(this,cl,e.bitmapUrl),hh(this,ll,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){_p.initialize(e,t)}static isHandlingMimeForPasting(e){return ip.includes(e)}static paste(e,t){t.pasteEditor({mode:of.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!(null==(e=this.altTextData)?void 0:e.altText)}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!(await n.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");const{data:i,width:r,height:a}=e||this.copyCanvas(null,null,!0).imageData,s=await n.guess({name:"altText",request:{data:i,width:r,height:a,channels:i.length/(r*a)}});if(!s)throw new Error("No response from the AI service.");if(s.error)throw new Error("Error from the AI service.");if(s.cancel)return null;if(!s.output)throw new Error("No valid response from the AI service.");const o=s.output;return await this.setGuessedAltText(o),t&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}remove(){var e;ch(this,sl)&&(hh(this,al,null),this._uiManager.imageManager.deleteId(ch(this,sl)),null==(e=ch(this,dl))||e.remove(),hh(this,dl,null),ch(this,fl)&&(clearTimeout(ch(this,fl)),hh(this,fl,null))),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(ch(this,sl)&&null===ch(this,dl)&&dh(this,ml,yl).call(this),this.isAttachedToDOM||this.parent.add(this))):ch(this,sl)&&dh(this,ml,yl).call(this)}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(ch(this,ol)||ch(this,al)||ch(this,cl)||ch(this,ll)||ch(this,sl)||ch(this,ul))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),ch(this,ul)||(ch(this,al)?dh(this,ml,wl).call(this):dh(this,ml,yl).call(this)),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(hh(this,sl,n),i&&hh(this,al,i),hh(this,ul,!1),dh(this,ml,wl).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(null!==ch(this,fl)&&clearTimeout(ch(this,fl)),hh(this,fl,setTimeout(()=>{hh(this,fl,null),dh(this,ml,_l).call(this)},200)))}copyCanvas(e,t,n=!1){var i;e||(e=224);const{width:r,height:a}=ch(this,al),s=new np;let o=ch(this,al),c=r,l=a,h=null;if(t){if(r>t||a>t){const e=Math.min(t/r,t/a);c=Math.floor(r*e),l=Math.floor(a*e)}h=document.createElement("canvas");const e=h.width=Math.ceil(c*s.sx),n=h.height=Math.ceil(l*s.sy);ch(this,pl)||(o=dh(this,ml,xl).call(this,e,n));const d=h.getContext("2d");d.filter=this._uiManager.hcmFilter;let u="white",f="#cfcfd8";"none"!==this._uiManager.hcmFilter?f="black":(null==(i=window.matchMedia)?void 0:i.call(window,"(prefers-color-scheme: dark)").matches)&&(u="#8f8f9d",f="#42414d");const p=15,g=p*s.sx,m=p*s.sy,b=new OffscreenCanvas(2*g,2*m),v=b.getContext("2d");v.fillStyle=u,v.fillRect(0,0,2*g,2*m),v.fillStyle=f,v.fillRect(0,0,g,m),v.fillRect(g,m,g,m),d.fillStyle=d.createPattern(b,"repeat"),d.fillRect(0,0,e,n),d.drawImage(o,0,0,o.width,o.height,0,0,e,n)}let d=null;if(n){let t,n;if(s.symmetric&&o.width<e&&o.height<e)t=o.width,n=o.height;else if(o=ch(this,al),r>e||a>e){const i=Math.min(e/r,e/a);t=Math.floor(r*i),n=Math.floor(a*i),ch(this,pl)||(o=dh(this,ml,xl).call(this,t,n))}const i=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});i.drawImage(o,0,0,o.width,o.height,0,0,t,n),d={width:t,height:n,data:i.getImageData(0,0,t,n).data}}return{canvas:h,width:c,height:l,imageData:d}}static async deserialize(e,t,n){var i;let r=null,a=!1;if(e instanceof eb){const{data:{rect:s,rotation:o,id:c,structParent:l,popupRef:h},container:d,parent:{page:{pageNumber:u}},canvas:f}=e;let p,g;f?(delete e.canvas,({id:p,bitmap:g}=n.imageManager.getFromCanvas(d.id,f)),f.remove()):(a=!0,e._hasNoCanvas=!0);const m=(null==(i=await t._structTree.getAriaAttributes(`${Of}${c}`))?void 0:i.get("aria-label"))||"";r=e={annotationType:of.STAMP,bitmapId:p,bitmap:g,pageIndex:u-1,rect:s.slice(0),rotation:o,annotationElementId:c,id:c,deleted:!1,accessibilityData:{decorative:!1,altText:m},isSvg:!1,structParent:l,popupRef:h}}const s=await super.deserialize(e,t,n),{rect:o,bitmap:c,bitmapUrl:l,bitmapId:h,isSvg:d,accessibilityData:u}=e;a?(n.addMissingCanvas(e.id,s),hh(s,ul,!0)):h&&n.imageManager.isValidId(h)?(hh(s,sl,h),c&&hh(s,al,c)):hh(s,cl,l),hh(s,pl,d);const[f,p]=s.pageDimensions;return s.width=(o[2]-o[0])/f,s.height=(o[3]-o[1])/p,u&&(s.altTextData=u),s._initialData=r,hh(s,gl,!!r),s}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:of.STAMP,bitmapId:ch(this,sl),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:ch(this,pl),structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=dh(this,ml,Tl).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:r}=this.serializeAltText(!1);if(!i&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const e=dh(this,ml,Dl).call(this,n);if(e.isSame)return null;e.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,null===t)return n;t.stamps||(t.stamps=new Map);const a=ch(this,pl)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(ch(this,sl))){if(ch(this,pl)){const e=t.stamps.get(ch(this,sl));a>e.area&&(e.area=a,e.serialized.bitmap.close(),e.serialized.bitmap=dh(this,ml,Tl).call(this,!1))}}else t.stamps.set(ch(this,sl),{area:a,serialized:n}),n.bitmap=dh(this,ml,Tl).call(this,!1);return n}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}al=new WeakMap,sl=new WeakMap,ol=new WeakMap,cl=new WeakMap,ll=new WeakMap,hl=new WeakMap,dl=new WeakMap,ul=new WeakMap,fl=new WeakMap,pl=new WeakMap,gl=new WeakMap,ml=new WeakSet,bl=function(e,t=!1){e?(hh(this,al,e.bitmap),t||(hh(this,sl,e.id),hh(this,pl,e.isSvg)),e.file&&hh(this,hl,e.file.name),dh(this,ml,wl).call(this)):this.remove()},vl=function(){if(hh(this,ol,null),this._uiManager.enableWaiting(!1),ch(this,dl))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&ch(this,al))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&ch(this,al)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},yl=function(){if(ch(this,sl))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(ch(this,sl)).then(e=>dh(this,ml,bl).call(this,e,!0)).finally(()=>dh(this,ml,vl).call(this));if(ch(this,cl)){const e=ch(this,cl);return hh(this,cl,null),this._uiManager.enableWaiting(!0),void hh(this,ol,this._uiManager.imageManager.getFromUrl(e).then(e=>dh(this,ml,bl).call(this,e)).finally(()=>dh(this,ml,vl).call(this)))}if(ch(this,ll)){const e=ch(this,ll);return hh(this,ll,null),this._uiManager.enableWaiting(!0),void hh(this,ol,this._uiManager.imageManager.getFromFile(e).then(e=>dh(this,ml,bl).call(this,e)).finally(()=>dh(this,ml,vl).call(this)))}const e=document.createElement("input");e.type="file",e.accept=ip.join(",");const t=this._uiManager._signal;hh(this,ol,new Promise(n=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),dh(this,ml,bl).call(this,t)}else this.remove();n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>dh(this,ml,vl).call(this))),e.click()},wl=function(){var e;const{div:t}=this;let{width:n,height:i}=ch(this,al);const[r,a]=this.pageDimensions,s=.75;if(this.width)n=this.width*r,i=this.height*a;else if(n>s*r||i>s*a){const e=Math.min(s*r/n,s*a/i);n*=e,i*=e}const[o,c]=this.parentDimensions;this.setDims(n*o/r,i*c/a),this._uiManager.enableWaiting(!1);const l=hh(this,dl,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=n/r,this.height=i/a,(null==(e=this._initialOptions)?void 0:e.isCentered)?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),dh(this,ml,_l).call(this),ch(this,gl)||(this.parent.addUndoableEditor(this),hh(this,gl,!0)),this._reportTelemetry({action:"inserted_image"}),ch(this,hl)&&this.div.setAttribute("aria-description",ch(this,hl)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},xl=function(e,t){const{width:n,height:i}=ch(this,al);let r=n,a=i,s=ch(this,al);for(;r>2*e||a>2*t;){const n=r,i=a;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const o=new OffscreenCanvas(r,a);o.getContext("2d").drawImage(s,0,0,n,i,0,0,r,a),s=o.transferToImageBitmap()}return s},_l=function(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,r=new np,a=Math.ceil(n*e*r.sx),s=Math.ceil(i*t*r.sy),o=ch(this,dl);if(!o||o.width===a&&o.height===s)return;o.width=a,o.height=s;const c=ch(this,pl)?ch(this,al):dh(this,ml,xl).call(this,a,s),l=o.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(c,0,0,c.width,c.height,0,0,a,s)},Tl=function(e){if(e){if(ch(this,pl)){const e=this._uiManager.imageManager.getSvgUrl(ch(this,sl));if(e)return e}const e=document.createElement("canvas");return({width:e.width,height:e.height}=ch(this,al)),e.getContext("2d").drawImage(ch(this,al),0,0),e.toDataURL()}if(ch(this,pl)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*jf.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*jf.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(n,i);return r.getContext("2d").drawImage(ch(this,al),0,0,ch(this,al).width,ch(this,al).height,0,0,n,i),r.transferToImageBitmap()}return structuredClone(ch(this,al))},Dl=function(e){var t;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===n,a=((null==(t=e.accessibilityData)?void 0:t.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},sh(Fb,"_type","stamp"),sh(Fb,"_editorType",of.STAMP);const Ib=class e{constructor({uiManager:t,pageIndex:n,div:i,structTreeLayer:r,accessibilityManager:a,annotationLayer:s,drawLayer:o,textLayer:c,viewport:l,l10n:h}){lh(this,zl),lh(this,El),lh(this,Al,!1),lh(this,kl,null),lh(this,Sl,null),lh(this,Cl,null),lh(this,Ul,new Map),lh(this,Fl,!1),lh(this,Il,!1),lh(this,Rl,!1),lh(this,Nl,null),lh(this,Ml,null),lh(this,Ol,null),lh(this,Pl,null),lh(this,Ll,null),lh(this,Wl,-1),lh(this,Bl);const d=[...ch(e,jl).values()];if(!e._initialized){e._initialized=!0;for(const e of d)e.initialize(h,t)}t.registerEditorTypes(d),hh(this,Bl,t),this.pageIndex=n,this.div=i,hh(this,El,a),hh(this,kl,s),this.viewport=l,hh(this,Ol,c),this.drawLayer=o,this._structTree=r,ch(this,Bl).addLayer(this)}get isEmpty(){return 0===ch(this,Ul).size}get isInvisible(){return this.isEmpty&&ch(this,Bl).getMode()===of.NONE}updateToolbar(e){ch(this,Bl).updateToolbar(e)}updateMode(t=ch(this,Bl).getMode()){switch(dh(this,zl,ql).call(this),t){case of.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case of.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case of.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:n}=this.div;for(const i of ch(e,jl).values())n.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===(null==(t=ch(this,Ol))?void 0:t.div)}setEditingState(e){ch(this,Bl).setEditingState(e)}addCommands(e){ch(this,Bl).addCommands(e)}cleanUndoStack(e){ch(this,Bl).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;null==(t=ch(this,kl))||t.div.classList.toggle("disabled",!e)}async enable(){var e;hh(this,Rl,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),null==(e=ch(this,Ll))||e.abort(),hh(this,Ll,null);const t=new Set;for(const i of ch(this,Ul).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(ch(this,Bl).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!ch(this,kl))return void hh(this,Rl,!1);const n=ch(this,kl).getEditableAnnotations();for(const i of n){if(i.hide(),ch(this,Bl).isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=await this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}hh(this,Rl,!1)}disable(){var t;if(hh(this,Il,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),ch(this,Ol)&&!ch(this,Ll)){hh(this,Ll,new AbortController);const e=ch(this,Bl).combinedSignal(ch(this,Ll));ch(this,Ol).div.addEventListener("pointerdown",e=>{const{clientX:t,clientY:n,timeStamp:i}=e;if(i-ch(this,Wl)>500)return void hh(this,Wl,i);hh(this,Wl,-1);const{classList:r}=this.div;r.toggle("getElements",!0);const a=document.elementsFromPoint(t,n);if(r.toggle("getElements",!1),!this.div.contains(a[0]))return;let s;const o=new RegExp(`^${sf}[0-9]+$`);for(const l of a)if(o.test(l.id)){s=l.id;break}if(!s)return;const c=ch(this,Ul).get(s);null===(null==c?void 0:c.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),c.dblclick())},{signal:e,capture:!0})}const n=new Map,i=new Map;for(const e of ch(this,Ul).values())e.disableEditing(),e.annotationElementId&&(null===e.serialize()?(i.set(e.annotationElementId,e),null==(t=this.getEditableAnnotation(e.annotationElementId))||t.show(),e.remove()):n.set(e.annotationElementId,e));if(ch(this,kl)){const e=ch(this,kl).getEditableAnnotations();for(const t of e){const{id:e}=t.data;if(ch(this,Bl).isDeletedAnnotationElement(e))continue;let r=i.get(e);r?(r.resetAnnotationElement(t),r.show(!1),t.show()):(r=n.get(e),r&&(ch(this,Bl).addChangedExistingAnnotation(r),r.renderAnnotationElement(t)&&r.show(!1)),t.show())}}dh(this,zl,ql).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const a of ch(e,jl).values())r.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),hh(this,Il,!1)}getEditableAnnotation(e){var t;return(null==(t=ch(this,kl))?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){ch(this,Bl).getActive()!==e&&ch(this,Bl).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(null==(e=ch(this,Ol))?void 0:e.div)&&!ch(this,Pl)){hh(this,Pl,new AbortController);const e=ch(this,Bl).combinedSignal(ch(this,Pl));ch(this,Ol).div.addEventListener("pointerdown",dh(this,zl,Hl).bind(this),{signal:e}),ch(this,Ol).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(null==(e=ch(this,Ol))?void 0:e.div)&&ch(this,Pl)&&(ch(this,Pl).abort(),hh(this,Pl,null),ch(this,Ol).div.classList.remove("highlighting"))}enableClick(){if(ch(this,Sl))return;hh(this,Sl,new AbortController);const e=ch(this,Bl).combinedSignal(ch(this,Sl));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;null==(e=ch(this,Sl))||e.abort(),hh(this,Sl,null)}attach(e){ch(this,Ul).set(e.id,e);const{annotationElementId:t}=e;t&&ch(this,Bl).isDeletedAnnotationElement(t)&&ch(this,Bl).removeDeletedAnnotationElement(e)}detach(e){var t;ch(this,Ul).delete(e.id),null==(t=ch(this,El))||t.removePointerInTextLayer(e.contentDiv),!ch(this,Il)&&e.annotationElementId&&ch(this,Bl).addDeletedAnnotationElement(e)}remove(e){this.detach(e),ch(this,Bl).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(ch(this,Bl).addDeletedAnnotationElement(e.annotationElementId),_p.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null==(t=e.parent)||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),ch(this,Bl).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!ch(this,Rl)),ch(this,Bl).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!ch(this,Cl)&&(e._focusEventsAllowed=!1,hh(this,Cl,setTimeout(()=>{hh(this,Cl,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:ch(this,Bl)._signal}),n.focus())},0))),e._structTreeParentId=null==(t=ch(this,El))?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return ch(this,Bl).getId()}combinedSignal(e){return ch(this,Bl).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return null==(e=ch(this,zl,Vl))?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await ch(this,Bl).updateMode(e.mode);const{offsetX:n,offsetY:i}=dh(this,zl,$l).call(this),r=this.getNextId(),a=dh(this,zl,Gl).call(this,{parent:this,id:r,x:n,y:i,uiManager:ch(this,Bl),isCentered:!0,...t});a&&this.add(a)}async deserialize(t){var n;return await(null==(n=ch(e,jl).get(t.annotationType??t.annotationEditorType))?void 0:n.deserialize(t,this,ch(this,Bl)))||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),r=dh(this,zl,Gl).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:ch(this,Bl),isCentered:t,...n});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(dh(this,zl,$l).call(this),!0,e)}setSelected(e){ch(this,Bl).setSelected(e)}toggleSelected(e){ch(this,Bl).toggleSelected(e)}unselect(e){ch(this,Bl).unselect(e)}pointerup(e){var t;const{isMac:n}=Uf.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(!ch(this,Fl))return;if(hh(this,Fl,!1),(null==(t=ch(this,zl,Vl))?void 0:t.isDrawer)&&ch(this,zl,Vl).supportMultipleDrawings)return;if(!ch(this,Al))return void hh(this,Al,!0);const i=ch(this,Bl).getMode();i!==of.STAMP&&i!==of.SIGNATURE?this.createAndAddNewEditor(e,!1):ch(this,Bl).unselectAll()}pointerdown(e){var t;if(ch(this,Bl).getMode()===of.HIGHLIGHT&&this.enableTextSelection(),ch(this,Fl))return void hh(this,Fl,!1);const{isMac:n}=Uf.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(hh(this,Fl,!0),null==(t=ch(this,zl,Vl))?void 0:t.isDrawer)return void this.startDrawingSession(e);const i=ch(this,Bl).getActive();hh(this,Al,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),ch(this,Nl))return void ch(this,zl,Vl).startDrawing(this,ch(this,Bl),!1,e);ch(this,Bl).setCurrentDrawingSession(this),hh(this,Nl,new AbortController);const t=ch(this,Bl).combinedSignal(ch(this,Nl));this.div.addEventListener("blur",({relatedTarget:e})=>{e&&!this.div.contains(e)&&(hh(this,Ml,null),this.commitOrRemove())},{signal:t}),ch(this,zl,Vl).startDrawing(this,ch(this,Bl),!1,e)}pause(e){if(e){const{activeElement:e}=document;return void(this.div.contains(e)&&hh(this,Ml,e))}ch(this,Ml)&&setTimeout(()=>{var e;null==(e=ch(this,Ml))||e.focus(),hh(this,Ml,null)},0)}endDrawingSession(e=!1){return ch(this,Nl)?(ch(this,Bl).setCurrentDrawingSession(null),ch(this,Nl).abort(),hh(this,Nl,null),hh(this,Ml,null),ch(this,zl,Vl).endDrawing(e)):null}findNewParent(e,t,n){const i=ch(this,Bl).findParent(t,n);return null!==i&&i!==this&&(i.changeParent(e),!0)}commitOrRemove(){return!!ch(this,Nl)&&(this.endDrawingSession(),!0)}onScaleChanging(){ch(this,Nl)&&ch(this,zl,Vl).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),(null==(e=ch(this,Bl).getActive())?void 0:e.parent)===this&&(ch(this,Bl).commitOrRemove(),ch(this,Bl).setActiveEditor(null)),ch(this,Cl)&&(clearTimeout(ch(this,Cl)),hh(this,Cl,null));for(const n of ch(this,Ul).values())null==(t=ch(this,El))||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,ch(this,Ul).clear(),ch(this,Bl).removeLayer(this)}render({viewport:e}){this.viewport=e,tp(this.div,e);for(const t of ch(this,Bl).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){ch(this,Bl).commitOrRemove(),dh(this,zl,ql).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,tp(this.div,{rotation:n}),t!==n)for(const i of ch(this,Ul).values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return ch(this,Bl).viewParameters.realScale}};El=new WeakMap,Al=new WeakMap,kl=new WeakMap,Sl=new WeakMap,Cl=new WeakMap,Ul=new WeakMap,Fl=new WeakMap,Il=new WeakMap,Rl=new WeakMap,Nl=new WeakMap,Ml=new WeakMap,Ol=new WeakMap,Pl=new WeakMap,Ll=new WeakMap,Wl=new WeakMap,Bl=new WeakMap,jl=new WeakMap,zl=new WeakSet,Hl=function(e){ch(this,Bl).unselectAll();const{target:t}=e;if(t===ch(this,Ol).div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&ch(this,Ol).div.contains(t)){const{isMac:t}=Uf.platform;if(0!==e.button||e.ctrlKey&&t)return;ch(this,Bl).showAllEditors("highlight",!0,!0),ch(this,Ol).div.classList.add("free"),this.toggleDrawing(),mb.startHighlighting(this,"ltr"===ch(this,Bl).direction,{target:ch(this,Ol).div,x:e.x,y:e.y}),ch(this,Ol).div.addEventListener("pointerup",()=>{ch(this,Ol).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:ch(this,Bl)._signal}),e.preventDefault()}},Vl=function(){return ch(Ib,jl).get(ch(this,Bl).getMode())},Gl=function(e){const t=ch(this,zl,Vl);return t?new t.prototype.constructor(e):null},$l=function(){const{x:e,y:t,width:n,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),s=(r+Math.min(window.innerWidth,e+n))/2-e,o=(a+Math.min(window.innerHeight,t+i))/2-t,[c,l]=this.viewport.rotation%180==0?[s,o]:[o,s];return{offsetX:c,offsetY:l}},ql=function(){for(const e of ch(this,Ul).values())e.isEmpty()&&e.remove()},sh(Ib,"_initialized",!1),lh(Ib,jl,new Map([rb,Db,Fb,mb,Ub].map(e=>[e._editorType,e])));let Rb=Ib;const Nb=class e{constructor({pageIndex:e}){lh(this,eh),lh(this,Xl,null),lh(this,Kl,new Map),lh(this,Yl,new Map),this.pageIndex=e}setParent(e){if(ch(this,Xl)){if(ch(this,Xl)!==e){if(ch(this,Kl).size>0)for(const t of ch(this,Kl).values())t.remove(),e.append(t);hh(this,Xl,e)}}else hh(this,Xl,e)}static get _svgFactory(){return wf(this,"_svgFactory",new Am)}draw(t,n=!1,i=!1){const r=uh(e,Zl)._++,a=dh(this,eh,th).call(this),s=e._svgFactory.createElement("defs");a.append(s);const o=e._svgFactory.createElement("path");s.append(o);const c=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),n&&ch(this,Yl).set(r,o);const l=i?dh(this,eh,nh).call(this,s,c):null,h=e._svgFactory.createElement("use");return a.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(a,t),ch(this,Kl).set(r,a),{id:r,clipPathId:`url(#${l})`}}drawOutline(t,n){const i=uh(e,Zl)._++,r=dh(this,eh,th).call(this),a=e._svgFactory.createElement("defs");r.append(a);const s=e._svgFactory.createElement("path");a.append(s);const o=`path_p${this.pageIndex}_${i}`;let c;if(s.setAttribute("id",o),s.setAttribute("vector-effect","non-scaling-stroke"),n){const t=e._svgFactory.createElement("mask");a.append(t),c=`mask_p${this.pageIndex}_${i}`,t.setAttribute("id",c),t.setAttribute("maskUnits","objectBoundingBox");const n=e._svgFactory.createElement("rect");t.append(n),n.setAttribute("width","1"),n.setAttribute("height","1"),n.setAttribute("fill","white");const r=e._svgFactory.createElement("use");t.append(r),r.setAttribute("href",`#${o}`),r.setAttribute("stroke","none"),r.setAttribute("fill","black"),r.setAttribute("fill-rule","nonzero"),r.classList.add("mask")}const l=e._svgFactory.createElement("use");r.append(l),l.setAttribute("href",`#${o}`),c&&l.setAttribute("mask",`url(#${c})`);const h=l.cloneNode();return r.append(h),l.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(r,t),ch(this,Kl).set(i,r),i}finalizeDraw(e,t){ch(this,Yl).delete(e),this.updateProperties(e,t)}updateProperties(t,n){var i;if(!n)return;const{root:r,bbox:a,rootClass:s,path:o}=n,c="number"==typeof t?ch(this,Kl).get(t):t;if(c){if(r&&dh(this,eh,ih).call(this,c,r),a&&dh(i=e,Jl,Ql).call(i,c,a),s){const{classList:e}=c;for(const[t,n]of Object.entries(s))e.toggle(t,n)}if(o){const e=c.firstChild.firstChild;dh(this,eh,ih).call(this,e,o)}}}updateParent(e,t){if(t===this)return;const n=ch(this,Kl).get(e);n&&(ch(t,Xl).append(n),ch(this,Kl).delete(e),ch(t,Kl).set(e,n))}remove(e){ch(this,Yl).delete(e),null!==ch(this,Xl)&&(ch(this,Kl).get(e).remove(),ch(this,Kl).delete(e))}destroy(){hh(this,Xl,null);for(const e of ch(this,Kl).values())e.remove();ch(this,Kl).clear(),ch(this,Yl).clear()}};Xl=new WeakMap,Kl=new WeakMap,Yl=new WeakMap,Zl=new WeakMap,Jl=new WeakSet,Ql=function(e,[t,n,i,r]){const{style:a}=e;a.top=100*n+"%",a.left=100*t+"%",a.width=100*i+"%",a.height=100*r+"%"},eh=new WeakSet,th=function(){const e=Nb._svgFactory.create(1,1,!0);return ch(this,Xl).append(e),e.setAttribute("aria-hidden",!0),e},nh=function(e,t){const n=Nb._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const r=Nb._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},ih=function(e,t){for(const[n,i]of Object.entries(t))null===i?e.removeAttribute(n):e.setAttribute(n,i)},lh(Nb,Jl),lh(Nb,Zl,0);let Mb=Nb;globalThis._pdfjsTestingUtils={HighlightOutliner:lb},globalThis.pdfjsLib={AbortException:kf,AnnotationEditorLayer:Rb,AnnotationEditorParamsType:cf,AnnotationEditorType:of,AnnotationEditorUIManager:mp,AnnotationLayer:class e{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:s}){lh(this,Ma),lh(this,Fa,null),lh(this,Ia,null),lh(this,Ra,new Map),lh(this,Na,null),this.div=e,hh(this,Fa,t),hh(this,Ia,n),hh(this,Na,s||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return ch(this,Ra).size>0}async render(e){var t;const{annotations:n}=e,i=this.div;tp(i,this.viewport);const r=new Map,a={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new Am,annotationStorage:e.annotationStorage||new Cp,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const s of n){if(s.noHTML)continue;const e=s.annotationType===hf.POPUP;if(e){const e=r.get(s.id);if(!e)continue;a.elements=e}else if(s.rect[2]===s.rect[0]||s.rect[3]===s.rect[1])continue;a.data=s;const n=Cm.create(a);if(!n.isRenderable)continue;if(!e&&s.popupRef){const e=r.get(s.popupRef);e?e.push(n):r.set(s.popupRef,[n])}const i=n.render();s.hidden&&(i.style.visibility="hidden"),await dh(this,Ma,Oa).call(this,i,s.id,a.elements),n._isEditable&&(ch(this,Ra).set(n.data.id,n),null==(t=this._annotationEditorUIManager)||t.renderAnnotationElement(n))}dh(this,Ma,Pa).call(this)}async addLinkAnnotations(t,n){const i={data:null,layer:this.div,linkService:n,svgFactory:new Am,parent:this};for(const r of t){r.borderStyle||(r.borderStyle=e._defaultBorderStyle),i.data=r;const t=Cm.create(i);if(!t.isRenderable)continue;const n=t.render();await dh(this,Ma,Oa).call(this,n,r.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,tp(t,{rotation:e.rotation}),dh(this,Ma,Pa).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(ch(this,Ra).values())}getEditableAnnotation(e){return ch(this,Ra).get(e)}static get _defaultBorderStyle(){return wf(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:1,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},AnnotationMode:af,AnnotationType:hf,build:"cbeef3233",ColorPicker:pb,createValidAbsoluteUrl:vf,DOMSVGFactory:Am,DrawLayer:Mb,FeatureTest:Uf,fetchData:zf,getDocument:hm,getFilenameFromUrl:function(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(e,t="document.pdf"){if("string"!=typeof e)return t;if(Gf(e))return t;const n=(e=>{try{return new URL(e)}catch{try{return new URL(decodeURIComponent(e))}catch{try{return new URL(e,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(e),"https://foo.bar")}catch{return null}}}}})(e);if(!n)return t;const i=e=>{try{let t=decodeURIComponent(e);return t.includes("/")?(t=t.split("/").at(-1),t.test(/^\.pdf$/i)?t:e):t}catch{return e}},r=/\.pdf$/i,a=n.pathname.split("/").at(-1);if(r.test(a))return i(a);if(n.searchParams.size>0){const e=Array.from(n.searchParams.values()).reverse();for(const n of e)if(r.test(n))return i(n);const t=Array.from(n.searchParams.keys()).reverse();for(const n of t)if(r.test(n))return i(n)}if(n.hash){const e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return i(e[0])}return t},getUuid:Mf,getXfaPageViewport:function(e,{scale:t=1,rotation:n=0}){const{width:i,height:r}=e.attributes.style,a=[0,0,parseInt(i),parseInt(r)];return new Hf({viewBox:a,userUnit:1,scale:t,rotation:n})},GlobalWorkerOptions:Ig,ImageKind:lf,InvalidPDFException:Df,isDataScheme:Gf,isPdfFile:$f,isValidExplicitDest:Mp,MathClamp:Pf,noContextMenu:Kf,normalizeUnicode:function(e){return Rf||(Rf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Nf=new Map([["ﬅ","ſt"]])),e.replaceAll(Rf,(e,t,n)=>t?t.normalize("NFKC"):Nf.get(n))},OPS:uf,OutputScale:np,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:fm,PDFDateString:Zf,PDFWorker:bm,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:jf,RenderingCancelledException:Vf,ResponseException:Ef,setLayerDimensions:tp,shadow:wf,SignatureExtractor:Ab,stopEvent:Yf,SupportedImageMimeTypes:ip,TextLayer:cm,TouchManager:wp,updateUrlHash:yf,Util:If,VerbosityLevel:df,version:"5.3.93",XfaLayer:km};var Ob={},Pb="1.13.7",Lb="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},Wb=Array.prototype,Bb=Object.prototype,jb="undefined"!=typeof Symbol?Symbol.prototype:null,zb=Wb.push,Hb=Wb.slice,Vb=Bb.toString,Gb=Bb.hasOwnProperty,$b="undefined"!=typeof ArrayBuffer,qb="undefined"!=typeof DataView,Xb=Array.isArray,Kb=Object.keys,Yb=Object.create,Zb=$b&&ArrayBuffer.isView,Jb=isNaN,Qb=isFinite,ev=!{toString:null}.propertyIsEnumerable("toString"),tv=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],nv=Math.pow(2,53)-1;function iv(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+t];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,arguments[0],i);case 2:return e.call(this,arguments[0],arguments[1],i)}var a=Array(t+1);for(r=0;r<t;r++)a[r]=arguments[r];return a[t]=i,e.apply(this,a)}}function rv(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function av(e){return null===e}function sv(e){return void 0===e}function ov(e){return!0===e||!1===e||"[object Boolean]"===Vb.call(e)}function cv(e){return!(!e||1!==e.nodeType)}function lv(e){var t="[object "+e+"]";return function(e){return Vb.call(e)===t}}const hv=lv("String"),dv=lv("Number"),uv=lv("Date"),fv=lv("RegExp"),pv=lv("Error"),gv=lv("Symbol"),mv=lv("ArrayBuffer");var bv=lv("Function"),vv=Lb.document&&Lb.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof vv&&(bv=function(e){return"function"==typeof e||!1});const yv=lv("Object");var wv=qb&&(!/\[native code\]/.test(String(DataView))||yv(new DataView(new ArrayBuffer(8)))),xv="undefined"!=typeof Map&&yv(new Map),_v=lv("DataView");const Tv=wv?function(e){return null!=e&&bv(e.getInt8)&&mv(e.buffer)}:_v,Dv=Xb||lv("Array");function Ev(e,t){return null!=e&&Gb.call(e,t)}var Av=lv("Arguments");function kv(e){return!gv(e)&&Qb(e)&&!isNaN(parseFloat(e))}function Sv(e){return dv(e)&&Jb(e)}function Cv(e){return function(){return e}}function Uv(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=nv}}function Fv(e){return function(t){return null==t?void 0:t[e]}}!function(){Av(arguments)||(Av=function(e){return Ev(e,"callee")})}();const Iv=Fv("byteLength"),Rv=Uv(Iv);var Nv=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;const Mv=$b?function(e){return Zb?Zb(e)&&!Tv(e):Rv(e)&&Nv.test(Vb.call(e))}:Cv(!1),Ov=Fv("length");function Pv(e,t){t=function(e){for(var t={},n=e.length,i=0;i<n;++i)t[e[i]]=!0;return{contains:function(e){return!0===t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var n=tv.length,i=e.constructor,r=bv(i)&&i.prototype||Bb,a="constructor";for(Ev(e,a)&&!t.contains(a)&&t.push(a);n--;)(a=tv[n])in e&&e[a]!==r[a]&&!t.contains(a)&&t.push(a)}function Lv(e){if(!rv(e))return[];if(Kb)return Kb(e);var t=[];for(var n in e)Ev(e,n)&&t.push(n);return ev&&Pv(e,t),t}function Wv(e){if(null==e)return!0;var t=Ov(e);return"number"==typeof t&&(Dv(e)||hv(e)||Av(e))?0===t:0===Ov(Lv(e))}function Bv(e,t){var n=Lv(t),i=n.length;if(null==e)return!i;for(var r=Object(e),a=0;a<i;a++){var s=n[a];if(t[s]!==r[s]||!(s in r))return!1}return!0}function jv(e){return e instanceof jv?e:this instanceof jv?void(this._wrapped=e):new jv(e)}function zv(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Iv(e))}jv.VERSION=Pb,jv.prototype.value=function(){return this._wrapped},jv.prototype.valueOf=jv.prototype.toJSON=jv.prototype.value,jv.prototype.toString=function(){return String(this._wrapped)};var Hv="[object DataView]";function Vv(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var r=typeof e;return("function"===r||"object"===r||"object"==typeof t)&&Gv(e,t,n,i)}function Gv(e,t,n,i){e instanceof jv&&(e=e._wrapped),t instanceof jv&&(t=t._wrapped);var r=Vb.call(e);if(r!==Vb.call(t))return!1;if(wv&&"[object Object]"==r&&Tv(e)){if(!Tv(t))return!1;r=Hv}switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0===+e?1/+e==1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return jb.valueOf.call(e)===jb.valueOf.call(t);case"[object ArrayBuffer]":case Hv:return Gv(zv(e),zv(t),n,i)}var a="[object Array]"===r;if(!a&&Mv(e)){if(Iv(e)!==Iv(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,o=t.constructor;if(s!==o&&!(bv(s)&&s instanceof s&&bv(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}i=i||[];for(var c=(n=n||[]).length;c--;)if(n[c]===e)return i[c]===t;if(n.push(e),i.push(t),a){if((c=e.length)!==t.length)return!1;for(;c--;)if(!Vv(e[c],t[c],n,i))return!1}else{var l,h=Lv(e);if(c=h.length,Lv(t).length!==c)return!1;for(;c--;)if(!Ev(t,l=h[c])||!Vv(e[l],t[l],n,i))return!1}return n.pop(),i.pop(),!0}function $v(e,t){return Vv(e,t)}function qv(e){if(!rv(e))return[];var t=[];for(var n in e)t.push(n);return ev&&Pv(e,t),t}function Xv(e){var t=Ov(e);return function(n){if(null==n)return!1;var i=qv(n);if(Ov(i))return!1;for(var r=0;r<t;r++)if(!bv(n[e[r]]))return!1;return e!==Qv||!bv(n[Kv])}}var Kv="forEach",Yv=["clear","delete"],Zv=["get","has","set"],Jv=Yv.concat(Kv,Zv),Qv=Yv.concat(Zv),ey=["add"].concat(Yv,Kv,"has");const ty=xv?Xv(Jv):lv("Map"),ny=xv?Xv(Qv):lv("WeakMap"),iy=xv?Xv(ey):lv("Set"),ry=lv("WeakSet");function ay(e){for(var t=Lv(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=e[t[r]];return i}function sy(e){for(var t=Lv(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=[t[r],e[t[r]]];return i}function oy(e){for(var t={},n=Lv(e),i=0,r=n.length;i<r;i++)t[e[n[i]]]=n[i];return t}function cy(e){var t=[];for(var n in e)bv(e[n])&&t.push(n);return t.sort()}function ly(e,t){return function(n){var i=arguments.length;if(t&&(n=Object(n)),i<2||null==n)return n;for(var r=1;r<i;r++)for(var a=arguments[r],s=e(a),o=s.length,c=0;c<o;c++){var l=s[c];t&&void 0!==n[l]||(n[l]=a[l])}return n}}const hy=ly(qv),dy=ly(Lv),uy=ly(qv,!0);function fy(e){if(!rv(e))return{};if(Yb)return Yb(e);var t=function(){};t.prototype=e;var n=new t;return t.prototype=null,n}function py(e,t){var n=fy(e);return t&&dy(n,t),n}function gy(e){return rv(e)?Dv(e)?e.slice():hy({},e):e}function my(e,t){return t(e),e}function by(e){return Dv(e)?e:[e]}function vy(e){return jv.toPath(e)}function yy(e,t){for(var n=t.length,i=0;i<n;i++){if(null==e)return;e=e[t[i]]}return n?e:void 0}function wy(e,t,n){var i=yy(e,vy(t));return sv(i)?n:i}function xy(e,t){for(var n=(t=vy(t)).length,i=0;i<n;i++){var r=t[i];if(!Ev(e,r))return!1;e=e[r]}return!!n}function _y(e){return e}function Ty(e){return e=dy({},e),function(t){return Bv(t,e)}}function Dy(e){return e=vy(e),function(t){return yy(t,e)}}function Ey(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,a){return e.call(t,n,i,r,a)}}return function(){return e.apply(t,arguments)}}function Ay(e,t,n){return null==e?_y:bv(e)?Ey(e,t,n):rv(e)&&!Dv(e)?Ty(e):Dy(e)}function ky(e,t){return Ay(e,t,1/0)}function Sy(e,t,n){return jv.iteratee!==ky?jv.iteratee(e,t):Ay(e,t,n)}function Cy(e,t,n){t=Sy(t,n);for(var i=Lv(e),r=i.length,a={},s=0;s<r;s++){var o=i[s];a[o]=t(e[o],o,e)}return a}function Uy(){}function Fy(e){return null==e?Uy:function(t){return wy(e,t)}}function Iy(e,t,n){var i=Array(Math.max(0,e));t=Ey(t,n,1);for(var r=0;r<e;r++)i[r]=t(r);return i}function Ry(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}jv.toPath=by,jv.iteratee=ky;const Ny=Date.now||function(){return(new Date).getTime()};function My(e){var t=function(t){return e[t]},n="(?:"+Lv(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}}const Oy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Py=My(Oy),Ly=My(oy(Oy)),Wy=jv.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var By=/(.)^/,jy={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},zy=/\\|'|\r|\n|\u2028|\u2029/g;function Hy(e){return"\\"+jy[e]}var Vy=/^\s*(\w|\$)+\s*$/;function Gy(e,t,n){!t&&n&&(t=n),t=uy({},t,jv.templateSettings);var i=RegExp([(t.escape||By).source,(t.interpolate||By).source,(t.evaluate||By).source].join("|")+"|$","g"),r=0,a="__p+='";e.replace(i,function(t,n,i,s,o){return a+=e.slice(r,o).replace(zy,Hy),r=o+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(a+="';\n"+s+"\n__p+='"),t}),a+="';\n";var s,o=t.variable;if(o){if(!Vy.test(o))throw new Error("variable is not a bare identifier: "+o)}else a="with(obj||{}){\n"+a+"}\n",o="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{s=new Function(o,"_",a)}catch(l){throw l.source=a,l}var c=function(e){return s.call(this,e,jv)};return c.source="function("+o+"){\n"+a+"}",c}function $y(e,t,n){var i=(t=vy(t)).length;if(!i)return bv(n)?n.call(e):n;for(var r=0;r<i;r++){var a=null==e?void 0:e[t[r]];void 0===a&&(a=n,r=i),e=bv(a)?a.call(e):a}return e}var qy=0;function Xy(e){var t=++qy+"";return e?e+t:t}function Ky(e){var t=jv(e);return t._chain=!0,t}function Yy(e,t,n,i,r){if(!(i instanceof t))return e.apply(n,r);var a=fy(e.prototype),s=e.apply(a,r);return rv(s)?s:a}var Zy=iv(function(e,t){var n=Zy.placeholder,i=function(){for(var r=0,a=t.length,s=Array(a),o=0;o<a;o++)s[o]=t[o]===n?arguments[r++]:t[o];for(;r<arguments.length;)s.push(arguments[r++]);return Yy(e,i,this,this,s)};return i});Zy.placeholder=jv;const Jy=iv(function(e,t,n){if(!bv(e))throw new TypeError("Bind must be called on a function");var i=iv(function(r){return Yy(e,i,t,this,n.concat(r))});return i}),Qy=Uv(Ov);function ew(e,t,n,i){if(i=i||[],t||0===t){if(t<=0)return i.concat(e)}else t=1/0;for(var r=i.length,a=0,s=Ov(e);a<s;a++){var o=e[a];if(Qy(o)&&(Dv(o)||Av(o)))if(t>1)ew(o,t-1,n,i),r=i.length;else for(var c=0,l=o.length;c<l;)i[r++]=o[c++];else n||(i[r++]=o)}return i}const tw=iv(function(e,t){var n=(t=ew(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=t[n];e[i]=Jy(e[i],e)}return e});function nw(e,t){var n=function(i){var r=n.cache,a=""+(t?t.apply(this,arguments):i);return Ev(r,a)||(r[a]=e.apply(this,arguments)),r[a]};return n.cache={},n}const iw=iv(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),rw=Zy(iw,jv,1);function aw(e,t,n){var i,r,a,s,o=0;n||(n={});var c=function(){o=!1===n.leading?0:Ny(),i=null,s=e.apply(r,a),i||(r=a=null)},l=function(){var l=Ny();o||!1!==n.leading||(o=l);var h=t-(l-o);return r=this,a=arguments,h<=0||h>t?(i&&(clearTimeout(i),i=null),o=l,s=e.apply(r,a),i||(r=a=null)):i||!1===n.trailing||(i=setTimeout(c,h)),s};return l.cancel=function(){clearTimeout(i),o=0,i=r=a=null},l}function sw(e,t,n){var i,r,a,s,o,c=function(){var l=Ny()-r;t>l?i=setTimeout(c,t-l):(i=null,n||(s=e.apply(o,a)),i||(a=o=null))},l=iv(function(l){return o=this,a=l,r=Ny(),i||(i=setTimeout(c,t),n&&(s=e.apply(o,a))),s});return l.cancel=function(){clearTimeout(i),i=a=o=null},l}function ow(e,t){return Zy(t,e)}function cw(e){return function(){return!e.apply(this,arguments)}}function lw(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}}function hw(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function dw(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const uw=Zy(dw,2);function fw(e,t,n){t=Sy(t,n);for(var i,r=Lv(e),a=0,s=r.length;a<s;a++)if(t(e[i=r[a]],i,e))return i}function pw(e){return function(t,n,i){n=Sy(n,i);for(var r=Ov(t),a=e>0?0:r-1;a>=0&&a<r;a+=e)if(n(t[a],a,t))return a;return-1}}const gw=pw(1),mw=pw(-1);function bw(e,t,n,i){for(var r=(n=Sy(n,i,1))(t),a=0,s=Ov(e);a<s;){var o=Math.floor((a+s)/2);n(e[o])<r?a=o+1:s=o}return a}function vw(e,t,n){return function(i,r,a){var s=0,o=Ov(i);if("number"==typeof a)e>0?s=a>=0?a:Math.max(a+o,s):o=a>=0?Math.min(a+1,o):a+o+1;else if(n&&a&&o)return i[a=n(i,r)]===r?a:-1;if(r!=r)return(a=t(Hb.call(i,s,o),Sv))>=0?a+s:-1;for(a=e>0?s:o-1;a>=0&&a<o;a+=e)if(i[a]===r)return a;return-1}}const yw=vw(1,gw,bw),ww=vw(-1,mw);function xw(e,t,n){var i=(Qy(e)?gw:fw)(e,t,n);if(void 0!==i&&-1!==i)return e[i]}function _w(e,t){return xw(e,Ty(t))}function Tw(e,t,n){var i,r;if(t=Ey(t,n),Qy(e))for(i=0,r=e.length;i<r;i++)t(e[i],i,e);else{var a=Lv(e);for(i=0,r=a.length;i<r;i++)t(e[a[i]],a[i],e)}return e}function Dw(e,t,n){t=Sy(t,n);for(var i=!Qy(e)&&Lv(e),r=(i||e).length,a=Array(r),s=0;s<r;s++){var o=i?i[s]:s;a[s]=t(e[o],o,e)}return a}function Ew(e){return function(t,n,i,r){var a=arguments.length>=3;return function(t,n,i,r){var a=!Qy(t)&&Lv(t),s=(a||t).length,o=e>0?0:s-1;for(r||(i=t[a?a[o]:o],o+=e);o>=0&&o<s;o+=e){var c=a?a[o]:o;i=n(i,t[c],c,t)}return i}(t,Ey(n,r,4),i,a)}}const Aw=Ew(1),kw=Ew(-1);function Sw(e,t,n){var i=[];return t=Sy(t,n),Tw(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i}function Cw(e,t,n){return Sw(e,cw(Sy(t)),n)}function Uw(e,t,n){t=Sy(t,n);for(var i=!Qy(e)&&Lv(e),r=(i||e).length,a=0;a<r;a++){var s=i?i[a]:a;if(!t(e[s],s,e))return!1}return!0}function Fw(e,t,n){t=Sy(t,n);for(var i=!Qy(e)&&Lv(e),r=(i||e).length,a=0;a<r;a++){var s=i?i[a]:a;if(t(e[s],s,e))return!0}return!1}function Iw(e,t,n,i){return Qy(e)||(e=ay(e)),("number"!=typeof n||i)&&(n=0),yw(e,t,n)>=0}const Rw=iv(function(e,t,n){var i,r;return bv(t)?r=t:(t=vy(t),i=t.slice(0,-1),t=t[t.length-1]),Dw(e,function(e){var a=r;if(!a){if(i&&i.length&&(e=yy(e,i)),null==e)return;a=e[t]}return null==a?a:a.apply(e,n)})});function Nw(e,t){return Dw(e,Dy(t))}function Mw(e,t){return Sw(e,Ty(t))}function Ow(e,t,n){var i,r,a=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var o=0,c=(e=Qy(e)?e:ay(e)).length;o<c;o++)null!=(i=e[o])&&i>a&&(a=i);else t=Sy(t,n),Tw(e,function(e,n,i){((r=t(e,n,i))>s||r===-1/0&&a===-1/0)&&(a=e,s=r)});return a}function Pw(e,t,n){var i,r,a=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var o=0,c=(e=Qy(e)?e:ay(e)).length;o<c;o++)null!=(i=e[o])&&i<a&&(a=i);else t=Sy(t,n),Tw(e,function(e,n,i){((r=t(e,n,i))<s||r===1/0&&a===1/0)&&(a=e,s=r)});return a}var Lw=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ww(e){return e?Dv(e)?Hb.call(e):hv(e)?e.match(Lw):Qy(e)?Dw(e,_y):ay(e):[]}function Bw(e,t,n){if(null==t||n)return Qy(e)||(e=ay(e)),e[Ry(e.length-1)];var i=Ww(e),r=Ov(i);t=Math.max(Math.min(t,r),0);for(var a=r-1,s=0;s<t;s++){var o=Ry(s,a),c=i[s];i[s]=i[o],i[o]=c}return i.slice(0,t)}function jw(e){return Bw(e,1/0)}function zw(e,t,n){var i=0;return t=Sy(t,n),Nw(Dw(e,function(e,n,r){return{value:e,index:i++,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index-t.index}),"value")}function Hw(e,t){return function(n,i,r){var a=t?[[],[]]:{};return i=Sy(i,r),Tw(n,function(t,r){var s=i(t,r,n);e(a,t,s)}),a}}const Vw=Hw(function(e,t,n){Ev(e,n)?e[n].push(t):e[n]=[t]}),Gw=Hw(function(e,t,n){e[n]=t}),$w=Hw(function(e,t,n){Ev(e,n)?e[n]++:e[n]=1}),qw=Hw(function(e,t,n){e[n?0:1].push(t)},!0);function Xw(e){return null==e?0:Qy(e)?e.length:Lv(e).length}function Kw(e,t,n){return t in n}const Yw=iv(function(e,t){var n={},i=t[0];if(null==e)return n;bv(i)?(t.length>1&&(i=Ey(i,t[1])),t=qv(e)):(i=Kw,t=ew(t,!1,!1),e=Object(e));for(var r=0,a=t.length;r<a;r++){var s=t[r],o=e[s];i(o,s,e)&&(n[s]=o)}return n}),Zw=iv(function(e,t){var n,i=t[0];return bv(i)?(i=cw(i),t.length>1&&(n=t[1])):(t=Dw(ew(t,!1,!1),String),i=function(e,n){return!Iw(t,n)}),Yw(e,i,n)});function Jw(e,t,n){return Hb.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function Qw(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:Jw(e,e.length-t)}function ex(e,t,n){return Hb.call(e,null==t||n?1:t)}function tx(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:ex(e,Math.max(0,e.length-t))}function nx(e){return Sw(e,Boolean)}function ix(e,t){return ew(e,t,!1)}const rx=iv(function(e,t){return t=ew(t,!0,!0),Sw(e,function(e){return!Iw(t,e)})}),ax=iv(function(e,t){return rx(e,t)});function sx(e,t,n,i){ov(t)||(i=n,n=t,t=!1),null!=n&&(n=Sy(n,i));for(var r=[],a=[],s=0,o=Ov(e);s<o;s++){var c=e[s],l=n?n(c,s,e):c;t&&!n?(s&&a===l||r.push(c),a=l):n?Iw(a,l)||(a.push(l),r.push(c)):Iw(r,c)||r.push(c)}return r}const ox=iv(function(e){return sx(ew(e,!0,!0))});function cx(e){for(var t=[],n=arguments.length,i=0,r=Ov(e);i<r;i++){var a=e[i];if(!Iw(t,a)){var s;for(s=1;s<n&&Iw(arguments[s],a);s++);s===n&&t.push(a)}}return t}function lx(e){for(var t=e&&Ow(e,Ov).length||0,n=Array(t),i=0;i<t;i++)n[i]=Nw(e,i);return n}const hx=iv(lx);function dx(e,t){for(var n={},i=0,r=Ov(e);i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n}function ux(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),a=0;a<i;a++,e+=n)r[a]=e;return r}function fx(e,t){if(null==t||t<1)return[];for(var n=[],i=0,r=e.length;i<r;)n.push(Hb.call(e,i,i+=t));return n}function px(e,t){return e._chain?jv(t).chain():t}function gx(e){return Tw(cy(e),function(t){var n=jv[t]=e[t];jv.prototype[t]=function(){var e=[this._wrapped];return zb.apply(e,arguments),px(this,n.apply(jv,e))}}),jv}Tw(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Wb[e];jv.prototype[e]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0]),px(this,n)}}),Tw(["concat","join","slice"],function(e){var t=Wb[e];jv.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),px(this,e)}});var mx=gx(Object.freeze(Object.defineProperty({__proto__:null,VERSION:Pb,after:hw,all:Uw,allKeys:qv,any:Fw,assign:dy,before:dw,bind:Jy,bindAll:tw,chain:Ky,chunk:fx,clone:gy,collect:Dw,compact:nx,compose:lw,constant:Cv,contains:Iw,countBy:$w,create:py,debounce:sw,default:jv,defaults:uy,defer:rw,delay:iw,detect:xw,difference:rx,drop:ex,each:Tw,escape:Py,every:Uw,extend:hy,extendOwn:dy,filter:Sw,find:xw,findIndex:gw,findKey:fw,findLastIndex:mw,findWhere:_w,first:Qw,flatten:ix,foldl:Aw,foldr:kw,forEach:Tw,functions:cy,get:wy,groupBy:Vw,has:xy,head:Qw,identity:_y,include:Iw,includes:Iw,indexBy:Gw,indexOf:yw,initial:Jw,inject:Aw,intersection:cx,invert:oy,invoke:Rw,isArguments:Av,isArray:Dv,isArrayBuffer:mv,isBoolean:ov,isDataView:Tv,isDate:uv,isElement:cv,isEmpty:Wv,isEqual:$v,isError:pv,isFinite:kv,isFunction:bv,isMap:ty,isMatch:Bv,isNaN:Sv,isNull:av,isNumber:dv,isObject:rv,isRegExp:fv,isSet:iy,isString:hv,isSymbol:gv,isTypedArray:Mv,isUndefined:sv,isWeakMap:ny,isWeakSet:ry,iteratee:ky,keys:Lv,last:tx,lastIndexOf:ww,map:Dw,mapObject:Cy,matcher:Ty,matches:Ty,max:Ow,memoize:nw,methods:cy,min:Pw,mixin:gx,negate:cw,noop:Uy,now:Ny,object:dx,omit:Zw,once:uw,pairs:sy,partial:Zy,partition:qw,pick:Yw,pluck:Nw,property:Dy,propertyOf:Fy,random:Ry,range:ux,reduce:Aw,reduceRight:kw,reject:Cw,rest:ex,restArguments:iv,result:$y,sample:Bw,select:Sw,shuffle:jw,size:Xw,some:Fw,sortBy:zw,sortedIndex:bw,tail:ex,take:Qw,tap:my,template:Gy,templateSettings:Wy,throttle:aw,times:Iy,toArray:Ww,toPath:by,transpose:lx,unescape:Ly,union:ox,uniq:sx,unique:sx,uniqueId:Xy,unzip:lx,values:ay,where:Mw,without:ax,wrap:ow,zip:hx},Symbol.toStringTag,{value:"Module"})));mx._=mx;const bx=Ah(Object.freeze(Object.defineProperty({__proto__:null,VERSION:Pb,after:hw,all:Uw,allKeys:qv,any:Fw,assign:dy,before:dw,bind:Jy,bindAll:tw,chain:Ky,chunk:fx,clone:gy,collect:Dw,compact:nx,compose:lw,constant:Cv,contains:Iw,countBy:$w,create:py,debounce:sw,default:mx,defaults:uy,defer:rw,delay:iw,detect:xw,difference:rx,drop:ex,each:Tw,escape:Py,every:Uw,extend:hy,extendOwn:dy,filter:Sw,find:xw,findIndex:gw,findKey:fw,findLastIndex:mw,findWhere:_w,first:Qw,flatten:ix,foldl:Aw,foldr:kw,forEach:Tw,functions:cy,get:wy,groupBy:Vw,has:xy,head:Qw,identity:_y,include:Iw,includes:Iw,indexBy:Gw,indexOf:yw,initial:Jw,inject:Aw,intersection:cx,invert:oy,invoke:Rw,isArguments:Av,isArray:Dv,isArrayBuffer:mv,isBoolean:ov,isDataView:Tv,isDate:uv,isElement:cv,isEmpty:Wv,isEqual:$v,isError:pv,isFinite:kv,isFunction:bv,isMap:ty,isMatch:Bv,isNaN:Sv,isNull:av,isNumber:dv,isObject:rv,isRegExp:fv,isSet:iy,isString:hv,isSymbol:gv,isTypedArray:Mv,isUndefined:sv,isWeakMap:ny,isWeakSet:ry,iteratee:ky,keys:Lv,last:tx,lastIndexOf:ww,map:Dw,mapObject:Cy,matcher:Ty,matches:Ty,max:Ow,memoize:nw,methods:cy,min:Pw,mixin:gx,negate:cw,noop:Uy,now:Ny,object:dx,omit:Zw,once:uw,pairs:sy,partial:Zy,partition:qw,pick:Yw,pluck:Nw,property:Dy,propertyOf:Fy,random:Ry,range:ux,reduce:Aw,reduceRight:kw,reject:Cw,rest:ex,restArguments:iv,result:$y,sample:Bw,select:Sw,shuffle:jw,size:Xw,some:Fw,sortBy:zw,sortedIndex:bw,tail:ex,take:Qw,tap:my,template:Gy,templateSettings:Wy,throttle:aw,times:Iy,toArray:Ww,toPath:by,transpose:lx,unescape:Ly,union:ox,uniq:sx,unique:sx,uniqueId:Xy,unzip:lx,values:ay,where:Mw,without:ax,wrap:ow,zip:hx},Symbol.toStringTag,{value:"Module"})));var vx,yx,wx,xx={},_x={},Tx={exports:{}},Dx={exports:{}};function Ex(){if(vx)return Dx.exports;vx=1;var e=function(){return void 0===this}();if(e)Dx.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var t={}.hasOwnProperty,n={}.toString,i={}.constructor.prototype,r=function(e){var n=[];for(var i in e)t.call(e,i)&&n.push(i);return n};Dx.exports={isArray:function(e){try{return"[object Array]"===n.call(e)}catch(t){return!1}},keys:r,names:r,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(t){return i}},isES5:e,propertyIsWritable:function(){return!0}}}return Dx.exports}function Ax(){if(wx)return yx;wx=1;var e,t={},n=Ex(),i="undefined"==typeof navigator,r={e:{}},a="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==kh?kh:void 0!==yx?yx:null;function s(){try{var t=e;return e=null,t.apply(this,arguments)}catch(n){return r.e=n,r}}function o(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function c(e,t,i){if(o(e))return e;var r={value:i,configurable:!0,enumerable:!1,writable:!0};return n.defineProperty(e,t,r),e}var l=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(n.isES5){var i=Object.getOwnPropertyNames;return function(e){for(var r=[],a=Object.create(null);null!=e&&!t(e);){var s;try{s=i(e)}catch(h){return r}for(var o=0;o<s.length;++o){var c=s[o];if(!a[c]){a[c]=!0;var l=Object.getOwnPropertyDescriptor(e,c);null!=l&&null==l.get&&null==l.set&&r.push(c)}}e=n.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var i=[];e:for(var a in n)if(r.call(n,a))i.push(a);else{for(var s=0;s<e.length;++s)if(r.call(e[s],a))continue e;i.push(a)}return i}}(),h=/this\s*\.\s*\S+\s*=/,d=/^[a-z$_][a-z$_0-9]*$/i;function u(e){try{return e+""}catch(t){return"[no string representation]"}}function f(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function p(e){return f(e)&&n.propertyIsWritable(e,"stack")}var g="stack"in new Error?function(e){return p(e)?e:new Error(u(e))}:function(e){if(p(e))return e;try{throw new Error(u(e))}catch(t){return t}};function m(e){return{}.toString.call(e)}var b=function(e){return n.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var v="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],i=e[Symbol.iterator]();!(t=i.next()).done;)n.push(t.value);return n};b=function(e){return n.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?v(e):null}}var y,w="undefined"!=typeof process&&"[object process]"===m(process).toLowerCase(),x="undefined"!=typeof process&&!0,_={isClass:function(e){try{if("function"==typeof e){var t=n.names(e.prototype),i=n.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),a=h.test(e+"")&&n.names(e).length>0;if(i||r||a)return!0}return!1}catch(s){return!1}},isIdentifier:function(e){return d.test(e)},inheritedDataKeys:l,getDataPropertyOrDefault:function(e,t,i){if(!n.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:i:void 0},thrower:function(e){throw e},isArray:n.isArray,asArray:b,notEnumerableProp:c,isPrimitive:o,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:f,canEvaluate:i,errorObj:r,tryCatch:function(t){return e=t,s},inherits:function(e,t){var n={}.hasOwnProperty;function i(){for(var i in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}return i.prototype=t.prototype,e.prototype=new i,e.prototype},withAppended:function(e,t){var n,i=e.length,r=new Array(i+1);for(n=0;n<i;++n)r[n]=e[n];return r[n]=t,r},maybeWrapAsError:function(e){return o(e)?new Error(u(e)):e},toFastProperties:function(e){return e},filledRange:function(e,t,n){for(var i=new Array(e),r=0;r<e;++r)i[r]=t+r+n;return i},toString:u,canAttachTrace:p,ensureErrorObject:g,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{c(e,"isOperational",!0)}catch(t){}},classString:m,copyDescriptors:function(e,t,i){for(var r=n.names(e),a=0;a<r.length;++a){var s=r[a];if(i(s))try{n.defineProperty(t,s,n.getDescriptor(e,s))}catch(o){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:w,hasEnvVariables:x,env:function(e){return x?t[e]:void 0},global:a,getNativePromise:function(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(t){}},domainBind:function(e,t){return e.bind(t)}};_.isRecentNode=_.isNode&&(0===(y=process.versions.node.split(".").map(Number))[0]&&y[1]>10||y[0]>0),_.isNode&&_.toFastProperties(process);try{throw new Error}catch(T){_.lastLineError=T}return yx=_}var kx,Sx,Cx,Ux,Fx,Ix,Rx,Nx,Mx,Ox,Px,Lx,Wx,Bx,jx,zx,Hx,Vx,Gx,$x,qx,Xx,Kx,Yx,Zx,Jx,Qx,e_,t_,n_,i_,r_,a_,s_,o_,c_,l_,h_,d_,u_,f_,p_,g_,m_,b_,v_,y_,w_,x_,__,T_,D_,E_,A_,k_,S_,C_,U_,F_,I_,R_,N_,M_,O_,P_,L_={exports:{}};function W_(){if(Fx)return L_.exports;var e;Fx=1;try{throw new Error}catch(c){e=c}var t=function(){if(Sx)return kx;Sx=1;var e,t,n,i,r,a=Ax(),s=a.getNativePromise();if(a.isNode&&"undefined"==typeof MutationObserver){var o=kh.setImmediate,c=process.nextTick;e=a.isRecentNode?function(e){o.call(kh,e)}:function(e){c.call(process,e)}}else if("function"==typeof s&&"function"==typeof s.resolve){var l=s.resolve();e=function(e){l.then(e)}}else e="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(t=document.createElement("div"),n={attributes:!0},i=!1,r=document.createElement("div"),new MutationObserver(function(){t.classList.toggle("foo"),i=!1}).observe(r,n),function(e){var a=new MutationObserver(function(){a.disconnect(),e()});a.observe(t,n),i||(i=!0,r.classList.toggle("foo"))});return kx=e}(),n=function(){if(Ux)return Cx;function e(e){this._capacity=e,this._length=0,this._front=0}return Ux=1,e.prototype._willBeOverCapacity=function(e){return this._capacity<e},e.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},e.prototype.push=function(e,t,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var r=this._front+i-3;this._checkCapacity(i);var a=this._capacity-1;this[r+0&a]=e,this[r+1&a]=t,this[r+2&a]=n,this._length=i},e.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},e.prototype.length=function(){return this._length},e.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},e.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,n,i,r){for(var a=0;a<r;++a)n[a+i]=e[a+0],e[a+0]=void 0}(this,0,this,t,this._front+this._length&t-1)},Cx=e}(),i=Ax();function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new n(16),this._normalQueue=new n(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=t}function a(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function s(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function o(e){this._normalQueue._pushOne(e),this._queueTick()}return r.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){i.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},r.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(c){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},i.hasDevTools?(r.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?a.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},r.prototype.invoke=function(e,t,n){this._trampolineEnabled?s.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},r.prototype.settlePromises=function(e){this._trampolineEnabled?o.call(this,e):this._schedule(function(){e._settlePromises()})}):(r.prototype.invokeLater=a,r.prototype.invoke=s,r.prototype.settlePromises=o),r.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),i=e.shift();t.call(n,i)}else t._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},L_.exports=r,L_.exports.firstLineError=e,L_.exports}function B_(){if(Rx)return Ix;Rx=1;var e,t,n=Ex(),i=n.freeze,r=Ax(),a=r.inherits,s=r.notEnumerableProp;function o(e,t){function n(i){if(!(this instanceof n))return new n(i);s(this,"message","string"==typeof i?i:t),s(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return a(n,Error),n}var c=o("Warning","warning"),l=o("CancellationError","cancellation error"),h=o("TimeoutError","timeout error"),d=o("AggregateError","aggregate error");try{e=TypeError,t=RangeError}catch(b){e=o("TypeError","type error"),t=o("RangeError","range error")}for(var u="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),f=0;f<u.length;++f)"function"==typeof Array.prototype[u[f]]&&(d.prototype[u[f]]=Array.prototype[u[f]]);n.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var p=0;function g(e){if(!(this instanceof g))return new g(e);s(this,"name","OperationalError"),s(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(s(this,"message",e.message),s(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var e=Array(4*p+1).join(" "),t="\n"+e+"AggregateError of:\n";p++,e=Array(4*p+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",r=i.split("\n"),a=0;a<r.length;++a)r[a]=e+r[a];t+=(i=r.join("\n"))+"\n"}return p--,t},a(g,Error);var m=Error.__BluebirdErrorTypes__;return m||(m=i({CancellationError:l,TimeoutError:h,OperationalError:g,RejectionError:g,AggregateError:d}),n.defineProperty(Error,"__BluebirdErrorTypes__",{value:m,writable:!1,enumerable:!1,configurable:!1})),Ix={Error:Error,TypeError:e,RangeError:t,CancellationError:m.CancellationError,OperationalError:m.OperationalError,TimeoutError:m.TimeoutError,AggregateError:m.AggregateError,Warning:c}}function j_(){if(qx)return $x;qx=1;var e=Ax(),t=e.maybeWrapAsError,n=B_().OperationalError,i=Ex(),r=/^(?:name|message|stack|cause)$/;return $x=function(a,s){return function(o,c){if(null!==a){if(o){var l=function(t){var a;if(function(e){return e instanceof Error&&i.getPrototypeOf(e)===Error.prototype}(t)){(a=new n(t)).name=t.name,a.message=t.message,a.stack=t.stack;for(var s=i.keys(t),o=0;o<s.length;++o){var c=s[o];r.test(c)||(a[c]=t[c])}return a}return e.markAsOriginatingFromRejection(t),t}(t(o));a._attachExtraTrace(l),a._reject(l)}else if(s){for(var h=arguments.length,d=new Array(Math.max(h-1,0)),u=1;u<h;++u)d[u-1]=arguments[u];a._fulfill(d)}else a._fulfill(c);a=null}}},$x}function z_(){return d_||(d_=1,h_=function(e,t,n,i,r,a){var s=Ax(),o=B_().TypeError,c=Ax().inherits,l=s.errorObj,h=s.tryCatch,d={};function u(e){setTimeout(function(){throw e},0)}function f(e,t,n){this._data=e,this._promise=t,this._context=n}function p(e,t,n){this.constructor$(e,t,n)}function g(e){return f.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function m(e){this.length=e,this.promise=null,this[e-1]=null}f.prototype.data=function(){return this._data},f.prototype.promise=function(){return this._promise},f.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},f.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=t!==d?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},f.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(p,f),p.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},m.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var i=this[n];i instanceof e&&i.cancel()}},e.using=function(){var i=arguments.length;if(i<2)return t("you must pass at least 2 arguments to Promise.using");var o,c=arguments[i-1];if("function"!=typeof c)return t("expecting a function but got "+s.classString(c));var d=!0;2===i&&Array.isArray(arguments[0])?(i=(o=arguments[0]).length,d=!1):(o=arguments,i--);for(var p=new m(i),b=0;b<i;++b){var v=o[b];if(f.isDisposer(v)){var y=v;(v=v.promise())._setDisposable(y)}else{var w=n(v);w instanceof e&&(v=w._then(g,null,null,{resources:p,index:b},void 0))}p[b]=v}var x=new Array(p.length);for(b=0;b<x.length;++b)x[b]=e.resolve(p[b]).reflect();var _=e.all(x).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void _.cancel();e[t]=n.value()}T._pushContext(),c=h(c);var i=d?c.apply(void 0,e):c(e),r=T._popContext();return a.checkForgottenReturns(i,r,"Promise.using",T),i}),T=_.lastly(function(){var t=new e.PromiseInspection(_);return function(t,i){var a=0,s=t.length,o=new e(r);return function r(){if(a>=s)return o._fulfill();var c=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(t[a++]);if(c instanceof e&&c._isDisposable()){try{c=n(c._getDisposer().tryDispose(i),t.promise)}catch(l){return u(l)}if(c instanceof e)return c._then(r,u,null,null,null)}r()}(),o}(p,t)});return p.promise=T,T._setOnCancel(p),T},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new p(e,this,i());throw new o}}),h_}function H_(){return y_||(y_=1,v_=function(e,t){var n={},i=Ax(),r=j_(),a=i.withAppended,s=i.maybeWrapAsError,o=i.canEvaluate,c=B_().TypeError,l={__isPromisified__:!0},h=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),d=function(e){return i.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function u(e){return!h.test(e)}function f(e){try{return!0===e.__isPromisified__}catch(t){return!1}}function p(e,t,n){var r=i.getDataPropertyOrDefault(e,t+n,l);return!!r&&f(r)}var g=o?function(o,c,l,h,d,u){var f=Math.max(0,function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0}(h)-1),p=function(e){for(var t=[e],n=Math.max(0,e-1-3),i=e-1;i>=n;--i)t.push(i);for(i=e+1;i<=3;++i)t.push(i);return t}(f),g="string"==typeof o||c===n;function m(e){var t,n=(t=e,i.filledRange(t,"_arg","")).join(", "),r=e>0?", ":"";return(g?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===c?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",n).replace(", ",r)}var b,v="string"==typeof o?"this != null ? this['"+o+"'] : fn":"fn",y="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+u+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",function(){for(var e="",t=0;t<p.length;++t)e+="case "+p[t]+":"+m(p[t]);return e+"                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",g?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",v);return y=y.replace("Parameters",(b=f,i.filledRange(Math.max(b,3),"_arg",""))),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",y)(e,h,c,a,s,r,i.tryCatch,i.errorObj,i.notEnumerableProp,t)}:function(o,c,l,h,d,u){var f=function(){return this}(),p=o;function g(){var i=c;c===n&&(i=this);var l=new e(t);l._captureStackTrace();var h="string"==typeof p&&this!==f?this[p]:o,d=r(l,u);try{h.apply(i,a(arguments,d))}catch(g){l._rejectCallback(s(g),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof p&&(o=h),i.notEnumerableProp(g,"__isPromisified__",!0),g};function m(e,t,r,a,s){for(var o=new RegExp(t.replace(/([$])/,"\\$")+"$"),l=function(e,t,n,r){for(var a=i.inheritedDataKeys(e),s=[],o=0;o<a.length;++o){var l=a[o],h=e[l],u=r===d||d(l);"function"!=typeof h||f(h)||p(e,l,t)||!r(l,h,e,u)||s.push(l,h)}return function(e,t,n){for(var i=0;i<e.length;i+=2){var r=e[i];if(n.test(r))for(var a=r.replace(n,""),s=0;s<e.length;s+=2)if(e[s]===a)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(s,t,n),s}(e,t,o,r),h=0,u=l.length;h<u;h+=2){var m=l[h],b=l[h+1],v=m+t;if(a===g)e[v]=g(m,n,m,b,t,s);else{var y=a(b,function(){return g(m,n,m,b,t,s)});i.notEnumerableProp(y,"__isPromisified__",!0),e[v]=y}}return i.toFastProperties(e),e}e.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+i.classString(e));if(f(e))return e;var r,a,s,o=(r=e,a=void 0===(t=Object(t)).context?n:t.context,s=!!t.multiArgs,g(r,a,void 0,r,null,s));return i.copyDescriptors(e,o,u),o},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(t=Object(t)).multiArgs,r=t.suffix;"string"!=typeof r&&(r="Async");var a=t.filter;"function"!=typeof a&&(a=d);var s=t.promisifier;if("function"!=typeof s&&(s=g),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var o=i.inheritedDataKeys(e),l=0;l<o.length;++l){var h=e[o[l]];"constructor"!==o[l]&&i.isClass(h)&&(m(h.prototype,r,a,s,n),m(h,r,a,s,n))}return m(e,r,a,s,n)}}),v_}function V_(){return O_||(O_=1,(e=Tx).exports=function(){var t=function(){return new u("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},n=function(){return new k.PromiseInspection(this._target())},i=function(e){return k.reject(new u(e))};function r(){}var a,s={},o=Ax();a=o.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},o.notEnumerableProp(k,"_getDomain",a);var c=Ex(),l=W_(),h=new l;c.defineProperty(k,"_async",{value:h});var d=B_(),u=k.TypeError=d.TypeError;k.RangeError=d.RangeError;var f=k.CancellationError=d.CancellationError;k.TimeoutError=d.TimeoutError,k.OperationalError=d.OperationalError,k.RejectionError=d.OperationalError,k.AggregateError=d.AggregateError;var p=function(){},g={},m={},b=(Mx?Nx:(Mx=1,Nx=function(e,t){var n=Ax(),i=n.errorObj,r=n.isObject,a={}.hasOwnProperty;return function(s,o){if(r(s)){if(s instanceof e)return s;var c=function(e){try{return function(e){return e.then}(e)}catch(t){return i.e=t,i}}(s);if(c===i){o&&o._pushContext();var l=e.reject(c.e);return o&&o._popContext(),l}if("function"==typeof c)return function(e){try{return a.call(e,"_promise0")}catch(t){return!1}}(s)?(l=new e(t),s._then(l._fulfill,l._reject,void 0,l,null),l):function(r,a,s){var o=new e(t),c=o;s&&s._pushContext(),o._captureStackTrace(),s&&s._popContext();var l=!0,h=n.tryCatch(a).call(r,function(e){o&&(o._resolveCallback(e),o=null)},function(e){o&&(o._rejectCallback(e,l,!0),o=null)});return l=!1,o&&h===i&&(o._rejectCallback(h.e,!0,!0),o=null),c}(s,c,o)}return s}}))(k,p),v=(Px?Ox:(Px=1,Ox=function(e,t,n,i,r){var a=Ax();function s(n){var i=this._promise=new e(t);n instanceof e&&i._propagateFrom(n,3),i._setOnCancel(this),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.isArray,a.inherits(s,r),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function t(r,s){var o=n(this._values,this._promise);if(o instanceof e){var c=(o=o._target())._bitField;if(this._values=o,!(50397184&c))return this._promise._setAsyncGuaranteed(),o._then(t,this._reject,void 0,this,s);if(!(33554432&c))return 16777216&c?this._reject(o._reason()):this._cancel();o=o._value()}if(null!==(o=a.asArray(o)))0!==o.length?this._iterate(o):-5===s?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{}}}(s));else{var l=i("expecting an array or an iterable object but got "+a.classString(o)).reason();this._promise._rejectCallback(l,!1)}},s.prototype._iterate=function(t){var i=this.getActualLength(t.length);this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values;for(var r=this._promise,a=!1,s=null,o=0;o<i;++o){var c=n(t[o],r);s=c instanceof e?(c=c._target())._bitField:null,a?null!==s&&c.suppressUnhandledRejections():null!==s?50397184&s?a=33554432&s?this._promiseFulfilled(c._value(),o):16777216&s?this._promiseRejected(c._reason(),o):this._promiseCancelled(o):(c._proxy(this,o),this._values[o]=c):a=this._promiseFulfilled(c,o)}a||r._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}))(k,p,b,i,r),y=(Wx?Lx:(Wx=1,Lx=function(e){var t=!1,n=[];function i(){this._trace=new i.CapturedTrace(r())}function r(){var e=n.length-1;if(e>=0)return n[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},i.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},i.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},i.CapturedTrace=null,i.create=function(){if(t)return new i},i.deactivateLongStackTraces=function(){},i.activateLongStackTraces=function(){var n=e.prototype._pushContext,a=e.prototype._popContext,s=e._peekContext,o=e.prototype._peekContext,c=e.prototype._promiseCreated;i.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=a,e._peekContext=s,e.prototype._peekContext=o,e.prototype._promiseCreated=c,t=!1},t=!0,e.prototype._pushContext=i.prototype._pushContext,e.prototype._popContext=i.prototype._popContext,e._peekContext=e.prototype._peekContext=r,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},i}))(k),w=y.create,x=(jx||(jx=1,Bx=function(e,t){var n,i,r,a=e._getDomain,s=e._async,o=B_().Warning,c=Ax(),l=c.canAttachTrace,h=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,d=/\((?:timers\.js):\d+:\d+\)/,u=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,f=null,p=null,g=!1,m=!(0==c.env("BLUEBIRD_DEBUG")||!c.env("BLUEBIRD_DEBUG")&&"development"!==c.env("NODE_ENV")),b=!(0==c.env("BLUEBIRD_WARNINGS")||!m&&!c.env("BLUEBIRD_WARNINGS")),v=!(0==c.env("BLUEBIRD_LONG_STACK_TRACES")||!m&&!c.env("BLUEBIRD_LONG_STACK_TRACES")),y=0!=c.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(b||!!c.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){524288&this._bitField||(this._setRejectionIsUnhandled(),s.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){j("rejectionHandled",n,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return!!(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),j("unhandledRejection",i,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,n){return P(e,t,n||this)},e.onPossiblyUnhandledRejection=function(e){var t=a();i="function"==typeof e?null===t?e:c.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=a();n="function"==typeof e?null===t?e:c.domainBind(t,e):void 0};var w=function(){};e.longStackTraces=function(){if(s.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!K.longStackTraces&&H()){var n=e.prototype._captureStackTrace,i=e.prototype._attachExtraTrace;K.longStackTraces=!0,w=function(){if(s.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=n,e.prototype._attachExtraTrace=i,t.deactivateLongStackTraces(),s.enableTrampoline(),K.longStackTraces=!1},e.prototype._captureStackTrace=M,e.prototype._attachExtraTrace=O,t.activateLongStackTraces(),s.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return K.longStackTraces&&H()};var x=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return c.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!c.global.dispatchEvent(n)}}return"function"==typeof Event?(e=new Event("CustomEvent"),c.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!c.global.dispatchEvent(n)}):((e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),c.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!c.global.dispatchEvent(n)})}catch(t){}return function(){return!1}}(),_=c.isNode?function(){return process.emit.apply(process,arguments)}:c.global?function(e){var t="on"+e.toLowerCase(),n=c.global[t];return!!n&&(n.apply(c.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function T(e,t){return{promise:t}}var D={promiseCreated:T,promiseFulfilled:T,promiseRejected:T,promiseResolved:T,promiseCancelled:T,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:T},E=function(e){var t=!1;try{t=_.apply(null,arguments)}catch(i){s.throwLater(i),t=!0}var n=!1;try{n=x(e,D[e].apply(null,arguments))}catch(i){s.throwLater(i),n=!0}return n||t};function A(){return!1}function k(e,t,n){var i=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+c.toString(e));i._attachCancellationCallback(e)})}catch(r){return r}}function S(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?c.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function C(){return this._onCancelField}function U(e){this._onCancelField=e}function F(){this._cancellationParent=void 0,this._onCancelField=void 0}function I(e,t){if(1&t){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}2&t&&e._isBound()&&this._setBoundTo(e._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&w()),"warnings"in t){var n=t.warnings;K.warnings=!!n,y=K.warnings,c.isObject(n)&&"wForgottenReturn"in n&&(y=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!K.cancellation){if(s.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=F,e.prototype._propagateFrom=I,e.prototype._onCancel=C,e.prototype._setOnCancel=U,e.prototype._attachCancellationCallback=S,e.prototype._execute=k,R=I,K.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!K.monitoring?(K.monitoring=!0,e.prototype._fireEvent=E):!t.monitoring&&K.monitoring&&(K.monitoring=!1,e.prototype._fireEvent=A)),e},e.prototype._fireEvent=A,e.prototype._execute=function(e,t,n){try{e(t,n)}catch(i){return i}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var R=function(e,t){2&t&&e._isBound()&&this._setBoundTo(e._boundTo)};function N(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function M(){this._trace=new q(this._peekContext())}function O(e,t){if(l(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=W(e);c.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),c.notEnumerableProp(e,"__stackCleaned__",!0)}}}function P(t,n,i){if(K.warnings){var r,a=new o(t);if(n)i._attachExtraTrace(a);else if(K.longStackTraces&&(r=e._peekContext()))r.attachExtraTrace(a);else{var s=W(a);a.stack=s.message+"\n"+s.stack.join("\n")}E("warning",a)||B(a,"",!0)}}function L(e){for(var t=[],n=0;n<e.length;++n){var i=e[n],r="    (No stack trace)"===i||f.test(i),a=r&&V(i);r&&!a&&(g&&" "!==i.charAt(0)&&(i="    "+i),t.push(i))}return t}function W(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var i=t[n];if("    (No stack trace)"===i||f.test(i))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:L(t)}}function B(e,t,n){if("undefined"!=typeof console){var i;if(c.isObject(e)){var a=e.stack;i=t+p(a,e)}else i=t+String(e);"function"==typeof r?r(i,n):"function"==typeof console.log||console.log}}function j(e,t,n,i){var r=!1;try{"function"==typeof t&&(r=!0,"rejectionHandled"===e?t(i):t(n,i))}catch(a){s.throwLater(a)}"unhandledRejection"===e?E(e,n,i)||r||B(n,"Unhandled rejection "):E(e,i)}function z(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():c.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(n){}0===t.length&&(t="(empty array)")}return"(<"+function(e){return e.length<41?e:e.substr(0,38)+"..."}(t)+">, no stack trace)"}function H(){return"function"==typeof X}var V=function(){return!1},G=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function $(e){var t=e.match(G);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function q(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);X(this,q),t>32&&this.uncycle()}c.inherits(q,Error),t.CapturedTrace=q,q.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},i=0,r=this;void 0!==r;++i)t.push(r),r=r._parent;for(i=(e=this._length=i)-1;i>=0;--i){var a=t[i].stack;void 0===n[a]&&(n[a]=i)}for(i=0;i<e;++i){var s=n[t[i].stack];if(void 0!==s&&s!==i){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[i]._parent=void 0,t[i]._length=1;var o=i>0?t[i-1]:this;s<e-1?(o._parent=t[s+1],o._parent.uncycle(),o._length=o._parent._length+1):(o._parent=void 0,o._length=1);for(var c=o._length+1,l=i-2;l>=0;--l)t[l]._length=c,c++;return}}}},q.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=W(e),n=t.message,i=[t.stack],r=this;void 0!==r;)i.push(L(r.stack.split("\n"))),r=r._parent;!function(e){for(var t=e[0],n=1;n<e.length;++n){for(var i=e[n],r=t.length-1,a=t[r],s=-1,o=i.length-1;o>=0;--o)if(i[o]===a){s=o;break}for(o=s;o>=0;--o){var c=i[o];if(t[r]!==c)break;t.pop(),r--}t=i}}(i),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(i),c.notEnumerableProp(e,"stack",function(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}(n,i)),c.notEnumerableProp(e,"__stackCleaned__",!0)}};var X=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():z(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,f=e,p=t;var n=Error.captureStackTrace;return V=function(e){return h.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var i,r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return f=/@/,p=t,g=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(a){i="stack"in a}return!("stack"in r)&&i&&"number"==typeof Error.stackTraceLimit?(f=e,p=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(a){e.stack=a.stack}Error.stackTraceLimit-=6}):(p=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?z(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(r=function(e){},c.isNode&&process.stderr.isTTY?r=function(e,t){}:c.isNode||"string"!=typeof(new Error).stack||(r=function(e,t){}));var K={warnings:b,longStackTraces:!1,cancellation:!1,monitoring:!1};return v&&e.longStackTraces(),{longStackTraces:function(){return K.longStackTraces},warnings:function(){return K.warnings},cancellation:function(){return K.cancellation},monitoring:function(){return K.monitoring},propagateFromFunction:function(){return R},boundValueFunction:function(){return N},checkForgottenReturns:function(e,t,n,i,r){if(void 0===e&&null!==t&&y){if(void 0!==r&&r._returnedNonUndefined())return;if(!(65535&i._bitField))return;n&&(n+=" ");var a="",s="";if(t._trace){for(var o=t._trace.stack.split("\n"),c=L(o),l=c.length-1;l>=0;--l){var h=c[l];if(!d.test(h)){var f=h.match(u);f&&(a="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(c.length>0){var p=c[0];for(l=0;l<o.length;++l)if(o[l]===p){l>0&&(s="\n"+o[l-1]);break}}}var g="a promise was created in a "+n+"handler "+a+"but was not returned from it, see http://goo.gl/rRqMUw"+s;i._warn(g,!0,t)}},setBounds:function(e,t){if(H()){for(var n,i,r=e.stack.split("\n"),a=t.stack.split("\n"),s=-1,o=-1,c=0;c<r.length;++c)if(l=$(r[c])){n=l.fileName,s=l.line;break}for(c=0;c<a.length;++c){var l;if(l=$(a[c])){i=l.fileName,o=l.line;break}}s<0||o<0||!n||!i||n!==i||s>=o||(V=function(e){if(h.test(e))return!0;var t=$(e);return!!(t&&t.fileName===n&&s<=t.line&&t.line<=o)})}},warn:P,deprecated:function(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),P(n)},CapturedTrace:q,fireDomEvent:x,fireGlobalEvent:_}}),Bx)(k,y);x.CapturedTrace;var _=(Hx||(Hx=1,zx=function(e,t){var n=Ax(),i=e.CancellationError,r=n.errorObj;function a(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function s(e){this.finallyHandler=e}function o(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function c(){return h.call(this,this.promise._target()._settledValue())}function l(e){if(!o(this,e))return r.e=e,r}function h(n){var a=this.promise,h=this.handler;if(!this.called){this.called=!0;var d=this.isFinallyHandler()?h.call(a._boundValue()):h.call(a._boundValue(),n);if(void 0!==d){a._setReturnedNonUndefined();var u=t(d,a);if(u instanceof e){if(null!=this.cancelPromise){if(u._isCancelled()){var f=new i("late cancellation observer");return a._attachExtraTrace(f),r.e=f,r}u.isPending()&&u._attachCancellationCallback(new s(this))}return u._then(c,l,void 0,this,void 0)}}}return a.isRejected()?(o(this),r.e=n,r):(o(this),n)}return a.prototype.isFinallyHandler=function(){return 0===this.type},s.prototype._resultCancelled=function(){o(this.finallyHandler)},e.prototype._passThrough=function(e,t,n,i){return"function"!=typeof e?this.then():this._then(n,i,void 0,new a(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,h,h)},e.prototype.tap=function(e){return this._passThrough(e,1,h)},a}),zx)(k,b),T=(Gx?Vx:(Gx=1,Vx=function(e){var t=Ax(),n=Ex().keys,i=t.tryCatch,r=t.errorObj;return function(a,s,o){return function(c){var l=o._boundValue();e:for(var h=0;h<a.length;++h){var d=a[h];if(d===Error||null!=d&&d.prototype instanceof Error){if(c instanceof d)return i(s).call(l,c)}else if("function"==typeof d){var u=i(d).call(l,c);if(u===r)return u;if(u)return i(s).call(l,c)}else if(t.isObject(c)){for(var f=n(d),p=0;p<f.length;++p){var g=f[p];if(d[g]!=c[g])continue e}return i(s).call(l,c)}}return e}}}))(m),D=j_(),E=o.errorObj,A=o.tryCatch;function k(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==p&&(function(e,t){if("function"!=typeof t)throw new u("expecting a function but got "+o.classString(t));if(e.constructor!==k)throw new u("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}(this,e),this._resolveFromExecutor(e)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function S(e){this.promise._resolveCallback(e)}function C(e){this.promise._rejectCallback(e,!1)}function U(e){var t=new k(p);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return k.prototype.toString=function(){return"[object Promise]"},k.prototype.caught=k.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),a=0;for(n=0;n<t-1;++n){var s=arguments[n];if(!o.isObject(s))return i("expecting an object but got A catch statement predicate "+o.classString(s));r[a++]=s}return r.length=a,e=arguments[n],this.then(void 0,T(r,e,this))}return this.then(void 0,e)},k.prototype.reflect=function(){return this._then(n,n,void 0,this,void 0)},k.prototype.then=function(e,t){if(x.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+o.classString(e);arguments.length>1&&(n+=", "+o.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},k.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},k.prototype.spread=function(e){return"function"!=typeof e?i("expecting a function but got "+o.classString(e)):this.all()._then(e,void 0,void 0,g,void 0)},k.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},k.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new v(this).promise()},k.prototype.error=function(e){return this.caught(o.originatesFromRejection,e)},k.getNewLibraryCopy=e.exports,k.is=function(e){return e instanceof k},k.fromNode=k.fromCallback=function(e){var t=new k(p);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=A(e)(D(t,n));return i===E&&t._rejectCallback(i.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},k.all=function(e){return new v(e).promise()},k.cast=function(e){var t=b(e);return t instanceof k||((t=new k(p))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},k.resolve=k.fulfilled=k.cast,k.reject=k.rejected=function(e){var t=new k(p);return t._captureStackTrace(),t._rejectCallback(e,!0),t},k.setScheduler=function(e){if("function"!=typeof e)throw new u("expecting a function but got "+o.classString(e));return h.setScheduler(e)},k.prototype._then=function(e,t,n,i,r){var s=void 0!==r,c=s?r:new k(p),l=this._target(),d=l._bitField;s||(c._propagateFrom(this,3),c._captureStackTrace(),void 0===i&&2097152&this._bitField&&(i=50397184&d?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,c));var u=a();if(50397184&d){var g,m,b=l._settlePromiseCtx;33554432&d?(m=l._rejectionHandler0,g=e):16777216&d?(m=l._fulfillmentHandler0,g=t,l._unsetRejectionIsUnhandled()):(b=l._settlePromiseLateCancellationObserver,m=new f("late cancellation observer"),l._attachExtraTrace(m),g=t),h.invoke(b,l,{handler:null===u?g:"function"==typeof g&&o.domainBind(u,g),promise:c,receiver:i,value:m})}else l._addCallbacks(e,t,c,i,u);return c},k.prototype._length=function(){return 65535&this._bitField},k.prototype._isFateSealed=function(){return!!(117506048&this._bitField)},k.prototype._isFollowing=function(){return!(67108864&~this._bitField)},k.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},k.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},k.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},k.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},k.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},k.prototype._isFinal=function(){return(4194304&this._bitField)>0},k.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},k.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},k.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},k.prototype._setAsyncGuaranteed=function(){h.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},k.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==s)return void 0===t&&this._isBound()?this._boundValue():t},k.prototype._promiseAt=function(e){return this[4*e-4+2]},k.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},k.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},k.prototype._boundValue=function(){},k.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,i=e._promise0,r=e._receiverAt(0);void 0===r&&(r=s),this._addCallbacks(t,n,i,r,null)},k.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),r=e._promiseAt(t),a=e._receiverAt(t);void 0===a&&(a=s),this._addCallbacks(n,i,r,a,null)},k.prototype._addCallbacks=function(e,t,n,i,r){var a=this._length();if(a>=65531&&(a=0,this._setLength(0)),0===a)this._promise0=n,this._receiver0=i,"function"==typeof e&&(this._fulfillmentHandler0=null===r?e:o.domainBind(r,e)),"function"==typeof t&&(this._rejectionHandler0=null===r?t:o.domainBind(r,t));else{var s=4*a-4;this[s+2]=n,this[s+3]=i,"function"==typeof e&&(this[s+0]=null===r?e:o.domainBind(r,e)),"function"==typeof t&&(this[s+1]=null===r?t:o.domainBind(r,t))}return this._setLength(a+1),a},k.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},k.prototype._resolveCallback=function(e,n){if(!(117506048&this._bitField)){if(e===this)return this._rejectCallback(t(),!1);var i=b(e,this);if(!(i instanceof k))return this._fulfill(e);n&&this._propagateFrom(i,2);var r=i._target();if(r!==this){var a=r._bitField;if(50397184&a)if(33554432&a)this._fulfill(r._value());else if(16777216&a)this._reject(r._reason());else{var s=new f("late cancellation observer");r._attachExtraTrace(s),this._reject(s)}else{var o=this._length();o>0&&r._migrateCallback0(this);for(var c=1;c<o;++c)r._migrateCallbackAt(this,c);this._setFollowing(),this._setLength(0),this._setFollowee(r)}}else this._reject(t())}},k.prototype._rejectCallback=function(e,t,n){var i=o.ensureErrorObject(e),r=i===e;if(!r&&!n&&x.warnings()){var a="a promise was rejected with a non-error: "+o.classString(e);this._warn(a,!0)}this._attachExtraTrace(i,!!t&&r),this._reject(e)},k.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==i&&t._rejectCallback(i,!0)},k.prototype._settlePromiseFromHandler=function(e,t,n,i){var r=i._bitField;if(!(65536&r)){var a;i._pushContext(),t===g?n&&"number"==typeof n.length?a=A(e).apply(this._boundValue(),n):(a=E).e=new u("cannot .spread() a non-array: "+o.classString(n)):a=A(e).call(t,n);var s=i._popContext();65536&(r=i._bitField)||(a===m?i._reject(n):a===E?i._rejectCallback(a.e,!1):(x.checkForgottenReturns(a,s,"",i,this),i._resolveCallback(a)))}},k.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},k.prototype._followee=function(){return this._rejectionHandler0},k.prototype._setFollowee=function(e){this._rejectionHandler0=e},k.prototype._settlePromise=function(e,t,i,a){var s=e instanceof k,o=this._bitField,c=!!(134217728&o);65536&o?(s&&e._invokeInternalOnCancel(),i instanceof _&&i.isFinallyHandler()?(i.cancelPromise=e,A(t).call(i,a)===E&&e._reject(E.e)):t===n?e._fulfill(n.call(i)):i instanceof r?i._promiseCancelled(e):s||e instanceof v?e._cancel():i.cancel()):"function"==typeof t?s?(c&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,i,a,e)):t.call(i,a,e):i instanceof r?i._isResolved()||(33554432&o?i._promiseFulfilled(a,e):i._promiseRejected(a,e)):s&&(c&&e._setAsyncGuaranteed(),33554432&o?e._fulfill(a):e._reject(a))},k.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,i=e.receiver,r=e.value;"function"==typeof t?n instanceof k?this._settlePromiseFromHandler(t,i,r,n):t.call(i,r,n):n instanceof k&&n._reject(r)},k.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},k.prototype._settlePromise0=function(e,t,n){var i=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,e,r,t)},k.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},k.prototype._fulfill=function(e){var n=this._bitField;if(!((117506048&n)>>>16)){if(e===this){var i=t();return this._attachExtraTrace(i),this._reject(i)}this._setFulfilled(),this._rejectionHandler0=e,(65535&n)>0&&(134217728&n?this._settlePromises():h.settlePromises(this))}},k.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return h.fatalError(e,o.isNode);(65535&t)>0?h.settlePromises(this):this._ensurePossibleRejectionHandled()}},k.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var i=this._fulfillmentHandlerAt(n),r=this._promiseAt(n),a=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,a,t)}},k.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var i=this._rejectionHandlerAt(n),r=this._promiseAt(n),a=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,a,t)}},k.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(16842752&e){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,e),this._fulfillPromises(t,i)}this._setLength(0)}this._clearCancellationData()},k.prototype._settledValue=function(){var e=this._bitField;return 33554432&e?this._rejectionHandler0:16777216&e?this._fulfillmentHandler0:void 0},k.defer=k.pending=function(){return x.deprecated("Promise.defer","new Promise"),{promise:new k(p),resolve:S,reject:C}},o.notEnumerableProp(k,"_makeSelfResolutionError",t),(Kx||(Kx=1,Xx=function(e,t,n,i,r){var a=Ax(),s=a.tryCatch;e.method=function(n){if("function"!=typeof n)throw new e.TypeError("expecting a function but got "+a.classString(n));return function(){var i=new e(t);i._captureStackTrace(),i._pushContext();var a=s(n).apply(this,arguments),o=i._popContext();return r.checkForgottenReturns(a,o,"Promise.method",i),i._resolveFromSyncValue(a),i}},e.attempt=e.try=function(n){if("function"!=typeof n)return i("expecting a function but got "+a.classString(n));var o,c=new e(t);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],h=arguments[2];o=a.isArray(l)?s(n).apply(h,l):s(n).call(h,l)}else o=s(n)();var d=c._popContext();return r.checkForgottenReturns(o,d,"Promise.try",c),c._resolveFromSyncValue(o),c},e.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}),Xx)(k,p,b,i,x),(Zx?Yx:(Zx=1,Yx=function(e,t,n,i){var r=!1,a=function(e,t){this._reject(t)},s=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(a,a,null,this,e)},o=function(e,t){50397184&this._bitField||this._resolveCallback(t.target)},c=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(a){r||(r=!0,e.prototype._propagateFrom=i.propagateFromFunction(),e.prototype._boundValue=i.boundValueFunction());var l=n(a),h=new e(t);h._propagateFrom(this,1);var d=this._target();if(h._setBoundTo(l),l instanceof e){var u={promiseRejectionQueued:!1,promise:h,target:d,bindingPromise:l};d._then(t,s,void 0,h,u),l._then(o,c,void 0,h,u),h._setOnCancel(l)}else h._resolveCallback(d);return h},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return!(2097152&~this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}))(k,p,b,x),(Qx?Jx:(Qx=1,Jx=function(e,t,n,i){var r=Ax(),a=r.tryCatch,s=r.errorObj,o=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),o.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(r.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var i=a(e).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),o.throwLater(i.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),o.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}))(k,v,i,x),(t_||(t_=1,e_=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var i=arguments[1];return i instanceof e&&i.suppressUnhandledRejections(),this.caught(n,function(){return i})}}),e_)(k),(i_?n_:(i_=1,n_=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.isFulfilled=function(){return!!(33554432&this._bitField)},a=t.prototype.isRejected=function(){return!!(16777216&this._bitField)},s=t.prototype.isPending=function(){return!(50397184&this._bitField)},o=t.prototype.isResolved=function(){return!!(50331648&this._bitField)};t.prototype.isCancelled=function(){return!!(8454144&this._bitField)},e.prototype.__isCancelled=function(){return!(65536&~this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return!!(8454144&this._target()._bitField)},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return a.call(this._target())},e.prototype.isFulfilled=function(){return r.call(this._target())},e.prototype.isResolved=function(){return o.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),i.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}))(k),(a_||(a_=1,r_=function(e,t,n,i,r,a){var s,o=Ax(),c=o.canEvaluate,l=o.tryCatch,h=o.errorObj;if(c){for(var d=function(e){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,e))},u=function(e){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,e))},f=function(t){for(var n=new Array(t),i=0;i<n.length;++i)n[i]="this.p"+(i+1);var a=n.join(" = ")+" = null;",s="var promise;\n"+n.map(function(e){return"                                                         \n\t                promise = "+e+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),o=n.join(", "),c="Holder$"+t,d="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return d=d.replace(/\[TheName\]/g,c).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,o).replace(/\[TheProperties\]/g,a).replace(/\[CancellationCode\]/g,s),new Function("tryCatch","errorObj","Promise","async",d)(l,h,e,r)},p=[],g=[],m=[],b=0;b<8;++b)p.push(f(b+1)),g.push(d(b+1)),m.push(u(b+1));s=function(e){this._reject(e)}}e.join=function(){var r,l=arguments.length-1;if(l>0&&"function"==typeof arguments[l]&&(r=arguments[l],l<=8&&c)){(_=new e(i))._captureStackTrace();for(var h=new(0,p[l-1])(r),d=g,u=0;u<l;++u){var f=n(arguments[u],_);if(f instanceof e){var b=(f=f._target())._bitField;50397184&b?33554432&b?d[u].call(_,f._value(),h):16777216&b?_._reject(f._reason()):_._cancel():(f._then(d[u],s,void 0,_,h),m[u](f,h),h.asyncNeeded=!1)}else d[u].call(_,f,h)}if(!_._isFateSealed()){if(h.asyncNeeded){var v=a();null!==v&&(h.fn=o.domainBind(v,h.fn))}_._setAsyncGuaranteed(),_._setOnCancel(h)}return _}for(var y=arguments.length,w=new Array(y),x=0;x<y;++x)w[x]=arguments[x];r&&w.pop();var _=new t(w).promise();return void 0!==r?_.spread(r):_}}),r_)(k,v,b,p,h,a),k.Promise=k,k.version="3.4.7",(o_?s_:(o_=1,s_=function(e,t,n,i,r,a){var s=e._getDomain,o=Ax(),c=o.tryCatch,l=o.errorObj,h=e._async;function d(e,t,n,i){this.constructor$(e),this._promise._captureStackTrace();var a=s();this._callback=null===a?t:o.domainBind(a,t),this._preservedValues=i===r?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],h.invoke(this._asyncInit,this,void 0)}function u(t,i,r,a){if("function"!=typeof i)return n("expecting a function but got "+o.classString(i));var s=0;if(void 0!==r){if("object"!=typeof r||null===r)return e.reject(new TypeError("options argument must be an object but it is "+o.classString(r)));if("number"!=typeof r.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+o.classString(r.concurrency)));s=r.concurrency}return new d(t,i,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,a).promise()}o.inherits(d,t),d.prototype._asyncInit=function(){this._init$(void 0,-2)},d.prototype._init=function(){},d.prototype._promiseFulfilled=function(t,n){var r=this._values,s=this.length(),o=this._preservedValues,h=this._limit;if(n<0){if(r[n=-1*n-1]=t,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(h>=1&&this._inFlight>=h)return r[n]=t,this._queue.push(n),!1;null!==o&&(o[n]=t);var d=this._promise,u=this._callback,f=d._boundValue();d._pushContext();var p=c(u).call(f,t,n,s),g=d._popContext();if(a.checkForgottenReturns(p,g,null!==o?"Promise.filter":"Promise.map",d),p===l)return this._reject(p.e),!0;var m=i(p,this._promise);if(m instanceof e){var b=(m=m._target())._bitField;if(!(50397184&b))return h>=1&&this._inFlight++,r[n]=m,m._proxy(this,-1*(n+1)),!1;if(!(33554432&b))return 16777216&b?(this._reject(m._reason()),!0):(this._cancel(),!0);p=m._value()}r[n]=p}return++this._totalResolved>=s&&(null!==o?this._filter(r,o):this._resolve(r),!0)},d.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var i=e.pop();this._promiseFulfilled(n[i],i)}},d.prototype._filter=function(e,t){for(var n=t.length,i=new Array(n),r=0,a=0;a<n;++a)e[a]&&(i[r++]=t[a]);i.length=r,this._resolve(i)},d.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return u(this,e,t,null)},e.map=function(e,t,n,i){return u(e,t,n,i)}}))(k,v,i,b,p,x),function(){if(l_)return c_;l_=1;var e=Object.create;if(e){var t=e(null),n=e(null);t[" size"]=n[" size"]=0}return c_=function(e){var i,r,a=Ax(),s=a.canEvaluate,o=a.isIdentifier,c=function(e){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,e))(d)},l=function(e){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",e))},h=function(e,t,n){var i=n[e];if("function"!=typeof i){if(!o(e))return null;if(i=t(e),n[e]=i,n[" size"]++,n[" size"]>512){for(var r=Object.keys(n),a=0;a<256;++a)delete n[r[a]];n[" size"]=r.length-256}}return i};function d(t,n){var i;if(null!=t&&(i=t[n]),"function"!=typeof i){var r="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(r)}return i}function u(e){return d(e,this.pop()).apply(e,this)}function f(e){return e[this]}function p(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}i=function(e){return h(e,c,t)},r=function(e){return h(e,l,n)},e.prototype.call=function(e){for(var t=arguments.length,n=new Array(Math.max(t-1,0)),r=1;r<t;++r)n[r-1]=arguments[r];if(s){var a=i(e);if(null!==a)return this._then(a,void 0,void 0,n,void 0)}return n.push(e),this._then(u,void 0,void 0,n,void 0)},e.prototype.get=function(e){var t;if("number"==typeof e)t=p;else if(s){var n=r(e);t=null!==n?n:f}else t=f;return this._then(t,void 0,void 0,e,void 0)}},c_}()(k),z_()(k,i,b,w,p,x),(f_?u_:(f_=1,u_=function(e,t,n){var i=Ax(),r=e.TimeoutError;function a(e){this.handle=e}a.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(e){return o(+this).thenReturn(e)},o=e.delay=function(i,r){var o,c;return void 0!==r?(o=e.resolve(r)._then(s,null,null,i,void 0),n.cancellation()&&r instanceof e&&o._setOnCancel(r)):(o=new e(t),c=setTimeout(function(){o._fulfill()},+i),n.cancellation()&&o._setOnCancel(new a(c)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};function c(e){return clearTimeout(this.handle),e}function l(e){throw clearTimeout(this.handle),e}e.prototype.delay=function(e){return o(e,this)},e.prototype.timeout=function(e,t){var s,o;e=+e;var h=new a(setTimeout(function(){s.isPending()&&function(e,t,n){var a;a="string"!=typeof t?t instanceof Error?t:new r("operation timed out"):new r(t),i.markAsOriginatingFromRejection(a),e._attachExtraTrace(a),e._reject(a),null!=n&&n.cancel()}(s,t,o)},e));return n.cancellation()?(o=this.then(),(s=o._then(c,l,void 0,h,void 0))._setOnCancel(h)):s=this._then(c,l,void 0,h,void 0),s}}))(k,p,x),(g_||(g_=1,p_=function(e,t,n,i,r,a){var s=B_().TypeError,o=Ax(),c=o.errorObj,l=o.tryCatch,h=[];function d(t,i,r,s){if(a.cancellation()){var o=new e(n),c=this._finallyPromise=new e(n);this._promise=o.lastly(function(){return c}),o._captureStackTrace(),o._setOnCancel(this)}else(this._promise=new e(n))._captureStackTrace();this._stack=s,this._generatorFunction=t,this._receiver=i,this._generator=void 0,this._yieldHandlers="function"==typeof r?[r].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}o.inherits(d,r),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var a=i(r,this._promise);if(a instanceof e||(a=function(t,n,r){for(var a=0;a<n.length;++a){r._pushContext();var s=l(n[a])(t);if(r._popContext(),s===c){r._pushContext();var o=e.reject(c.e);return r._popContext(),o}var h=i(s,r);if(h instanceof e)return h}return null}(a,this._yieldHandlers,this._promise),null!==a)){var o=(a=a._target())._bitField;50397184&o?33554432&o?e._async.invoke(this._promiseFulfilled,this,a._value()):16777216&o?e._async.invoke(this._promiseRejected,this,a._reason()):this._promiseCancelled():(this._yieldedPromise=a,a._proxy(this,null))}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(e,t){if("function"!=typeof e)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,i=d,r=(new Error).stack;return function(){var t=e.apply(this,arguments),a=new i(void 0,void 0,n,r),s=a.promise();return a._generator=t,a._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new s("expecting a function but got "+o.classString(e));h.push(e)},e.spawn=function(n){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof n)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new d(n,this),r=i.promise();return i._run(e.spawn),r}}),p_)(k,i,p,b,r,x),(b_?m_:(b_=1,m_=function(e){var t=Ax(),n=e._async,i=t.tryCatch,r=t.errorObj;function a(e,a){if(!t.isArray(e))return s.call(this,e,a);var o=i(a).apply(this._boundValue(),[null].concat(e));o===r&&n.throwLater(o.e)}function s(e,t){var a=this._boundValue(),s=void 0===e?i(t).call(a,null):i(t).call(a,null,e);s===r&&n.throwLater(s.e)}function o(e,t){if(!e){var a=new Error(e+"");a.cause=e,e=a}var s=i(t).call(this._boundValue(),e);s===r&&n.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(e,t){if("function"==typeof e){var n=s;void 0!==t&&Object(t).spread&&(n=a),this._then(n,o,void 0,this,e)}return this}}))(k),H_()(k,p),(x_?w_:(x_=1,w_=function(e,t,n,i){var r,a=Ax(),s=a.isObject,o=Ex();"function"==typeof Map&&(r=Map);var c=function(){var e=0,t=0;function n(n,i){this[e]=n,this[e+t]=i,e++}return function(i){t=i.size,e=0;var r=new Array(2*i.size);return i.forEach(n,r),r}}();function l(e){var t,n=!1;if(void 0!==r&&e instanceof r)t=c(e),n=!0;else{var i=o.keys(e),a=i.length;t=new Array(2*a);for(var s=0;s<a;++s){var l=i[s];t[s]=e[l],t[s+a]=l}}this.constructor$(t),this._isMap=n,this._init$(void 0,-3)}function h(t){var r,a=n(t);return s(a)?(r=a instanceof e?a._then(e.props,void 0,void 0,void 0,void 0):new l(a).promise(),a instanceof e&&r._propagateFrom(a,2),r):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}a.inherits(l,t),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(e){for(var t=new r,n=e.length/2|0,i=0;i<n;++i){var a=e[n+i],s=e[i];t.set(a,s)}return t}(this._values);else{n={};for(var i=this.length(),a=0,s=this.length();a<s;++a)n[this._values[a+i]]=this._values[a]}return this._resolve(n),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return h(this)},e.props=function(e){return h(e)}}))(k,v,b,i),(T_?__:(T_=1,__=function(e,t,n,i){var r=Ax();function a(s,o){var c,l=n(s);if(l instanceof e)return(c=l).then(function(e){return a(e,c)});if(null===(s=r.asArray(s)))return i("expecting an array or an iterable object but got "+r.classString(s));var h=new e(t);void 0!==o&&h._propagateFrom(o,3);for(var d=h._fulfill,u=h._reject,f=0,p=s.length;f<p;++f){var g=s[f];(void 0!==g||f in s)&&e.cast(g)._then(d,u,void 0,h,null)}return h}e.race=function(e){return a(e,void 0)},e.prototype.race=function(){return a(this,void 0)}}))(k,p,b,i),(E_?D_:(E_=1,D_=function(e,t,n,i,r,a){var s=e._getDomain,o=Ax(),c=o.tryCatch;function l(t,n,i,a){this.constructor$(t);var c=s();this._fn=null===c?n:o.domainBind(c,n),void 0!==i&&(i=e.resolve(i))._attachCancellationCallback(this),this._initialValue=i,this._currentCancellable=null,this._eachValues=a===r?Array(this._length):0===a?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function h(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function d(e,t,i,r){return"function"!=typeof t?n("expecting a function but got "+o.classString(t)):new l(e,t,i,r).promise()}function u(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(f,void 0,void 0,this,void 0)):f.call(this,n)}function f(t){var n,i=this.array,r=i._promise,s=c(i._fn);r._pushContext(),(n=void 0!==i._eachValues?s.call(r._boundValue(),t,this.index,this.length):s.call(r._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(i._currentCancellable=n);var o=r._popContext();return a.checkForgottenReturns(n,o,void 0!==i._eachValues?"Promise.each":"Promise.reduce",r),n}o.inherits(l,t),l.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==r&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},l.prototype._iterate=function(t){var n,i;this._values=t;var r=t.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=e.resolve(t[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<r;++i){var a={accum:null,value:t[i],index:i,length:r,array:this};n=n._then(u,void 0,void 0,a,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(h,h,void 0,n,this)},e.prototype.reduce=function(e,t){return d(this,e,t,null)},e.reduce=function(e,t,n,i){return d(e,t,n,i)}}))(k,v,i,b,p,x),(k_?A_:(k_=1,A_=function(e,t,n){var i=e.PromiseInspection;function r(e){this.constructor$(e)}Ax().inherits(r,t),r.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(e,t){var n=new i;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},r.prototype._promiseRejected=function(e,t){var n=new i;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},e.settle=function(e){return n.deprecated(".settle()",".reflect()"),new r(e).promise()},e.prototype.settle=function(){return e.settle(this)}}))(k,v,x),(C_?S_:(C_=1,S_=function(e,t,n){var i=Ax(),r=B_().RangeError,a=B_().AggregateError,s=i.isArray,o={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var i=new c(e),r=i.promise();return i.setHowMany(t),i.init(),r}i.inherits(c,t),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=s(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(o),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new a,t=this.length();t<this._values.length;++t)this._values[t]!==o&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new r(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return l(e,t)},e.prototype.some=function(e){return l(this,e)},e._SomePromiseArray=c}))(k,v,i),(F_?U_:(F_=1,U_=function(e,t){var n=e.map;e.prototype.filter=function(e,i){return n(this,e,i,t)},e.filter=function(e,i,r){return n(e,i,r,t)}}))(k,p),(R_?I_:(R_=1,I_=function(e,t){var n=e.reduce,i=e.all;function r(){return i(this)}e.prototype.each=function(e){return n(this,e,t,0)._then(r,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,i){return n(e,i,t,0)._then(r,void 0,void 0,e,void 0)},e.mapSeries=function(e,i){return n(e,i,t,t)}}))(k,p),(M_?N_:(M_=1,N_=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),i=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),i}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}))(k),o.toFastProperties(k),o.toFastProperties(k.prototype),U({a:1}),U({b:2}),U({c:3}),U(1),U(function(){}),U(void 0),U(!1),U(new k(p)),x.setBounds(l.firstLineError,o.lastLineError),k}),Tx.exports;var e}function G_(){if(P_)return _x;P_=1;var e=bx,t=V_()();return _x.defer=function(){var e,n,i=new t.Promise(function(t,i){e=t,n=i});return{resolve:e,reject:n,promise:i}},_x.when=t.resolve,_x.resolve=t.resolve,_x.all=t.all,_x.props=t.props,_x.reject=t.reject,_x.promisify=t.promisify,_x.mapSeries=t.mapSeries,_x.attempt=t.attempt,_x.nfcall=function(e){var n=Array.prototype.slice.call(arguments,1);return t.promisify(e).apply(null,n)},t.prototype.fail=t.prototype.caught,t.prototype.also=function(n){return this.then(function(i){var r=e.extend({},i,n(i));return t.props(r)})},_x}var $_,q_={};function X_(){if($_)return q_;$_=1;var e=bx,t=q_.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"},n={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function i(t){this._notes=e.indexBy(t,function(e){return r(e.noteType,e.noteId)})}function r(e,t){return e+"-"+t}function a(e){return{type:t.break,breakType:e}}return i.prototype.resolve=function(e){return this.findNoteByKey(r(e.noteType,e.noteId))},i.prototype.findNoteByKey=function(e){return this._notes[e]||null},q_.document=q_.Document=function(e,n){return{type:t.document,children:e,notes:(n=n||{}).notes||new i({}),comments:n.comments||[]}},q_.paragraph=q_.Paragraph=function(e,n){var i=(n=n||{}).indent||{};return{type:t.paragraph,children:e,styleId:n.styleId||null,styleName:n.styleName||null,numbering:n.numbering||null,alignment:n.alignment||null,indent:{start:i.start||null,end:i.end||null,firstLine:i.firstLine||null,hanging:i.hanging||null}}},q_.run=q_.Run=function(e,i){return{type:t.run,children:e,styleId:(i=i||{}).styleId||null,styleName:i.styleName||null,isBold:!!i.isBold,isUnderline:!!i.isUnderline,isItalic:!!i.isItalic,isStrikethrough:!!i.isStrikethrough,isAllCaps:!!i.isAllCaps,isSmallCaps:!!i.isSmallCaps,verticalAlignment:i.verticalAlignment||n.baseline,font:i.font||null,fontSize:i.fontSize||null,highlight:i.highlight||null}},q_.text=q_.Text=function(e){return{type:t.text,value:e}},q_.tab=q_.Tab=function(){return{type:t.tab}},q_.checkbox=q_.Checkbox=function(e){return{type:t.checkbox,checked:e.checked}},q_.Hyperlink=function(e,n){return{type:t.hyperlink,children:e,href:n.href,anchor:n.anchor,targetFrame:n.targetFrame}},q_.noteReference=q_.NoteReference=function(e){return{type:t.noteReference,noteType:e.noteType,noteId:e.noteId}},q_.Notes=i,q_.Note=function(e){return{type:t.note,noteType:e.noteType,noteId:e.noteId,body:e.body}},q_.commentReference=function(e){return{type:t.commentReference,commentId:e.commentId}},q_.comment=function(e){return{type:t.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}},q_.Image=function(e){return{type:t.image,read:function(t){return t?e.readImage(t):e.readImage().then(function(e){return Buffer.from(e)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(e){return Buffer.from(e)})},altText:e.altText,contentType:e.contentType}},q_.Table=function(e,n){return{type:t.table,children:e,styleId:(n=n||{}).styleId||null,styleName:n.styleName||null}},q_.TableRow=function(e,n){return{type:t.tableRow,children:e,isHeader:(n=n||{}).isHeader||!1}},q_.TableCell=function(e,n){return{type:t.tableCell,children:e,colSpan:null==(n=n||{}).colSpan?1:n.colSpan,rowSpan:null==n.rowSpan?1:n.rowSpan}},q_.lineBreak=a("line"),q_.pageBreak=a("page"),q_.columnBreak=a("column"),q_.BookmarkStart=function(e){return{type:t.bookmarkStart,name:e.name}},q_.verticalAlignment=n,q_}var K_,Y_={};function Z_(){if(K_)return Y_;K_=1;var e=bx;function t(e,t){this.value=e,this.messages=t||[]}function n(t){var n=[];return e.flatten(e.pluck(t,"messages"),!0).forEach(function(t){(function(t,n){return void 0!==e.find(t,i.bind(null,n))})(n,t)||n.push(t)}),n}function i(e,t){return e.type===t.type&&e.message===t.message}return Y_.Result=t,Y_.success=function(e){return new t(e,[])},Y_.warning=function(e){return{type:"warning",message:e}},Y_.error=function(e){return{type:"error",message:e.message,error:e}},t.prototype.map=function(e){return new t(e(this.value),this.messages)},t.prototype.flatMap=function(e){var i=e(this.value);return new t(i.value,n([this,i]))},t.prototype.flatMapThen=function(e){var i=this;return e(this.value).then(function(e){return new t(e.value,n([i,e]))})},t.combine=function(i){return new t(e.flatten(e.pluck(i,"value")),n(i))},Y_}var J_,Q_,eT,tT={},nT={},iT={exports:{}};function rT(){return Q_||(Q_=1,iT.exports=function e(t,n,i){function r(s,o){if(!n[s]){if(!t[s]){var c="function"==typeof Sh&&Sh;if(!o&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){return r(t[s][1][e]||e)},h,h.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof Sh&&Sh,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("./utils"),r=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,s,o,c,l,h=[],d=0,u=e.length,f=u,p="string"!==i.getTypeOf(e);d<e.length;)f=u-d,r=p?(t=e[d++],n=d<u?e[d++]:0,d<u?e[d++]:0):(t=e.charCodeAt(d++),n=d<u?e.charCodeAt(d++):0,d<u?e.charCodeAt(d++):0),s=t>>2,o=(3&t)<<4|n>>4,c=1<f?(15&n)<<2|r>>6:64,l=2<f?63&r:64,h.push(a.charAt(s)+a.charAt(o)+a.charAt(c)+a.charAt(l));return h.join("")},n.decode=function(e){var t,n,i,s,o,c,l=0,h=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var u,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=r.uint8array?new Uint8Array(0|f):new Array(0|f);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(s=a.indexOf(e.charAt(l++)))>>4,n=(15&s)<<4|(o=a.indexOf(e.charAt(l++)))>>2,i=(3&o)<<6|(c=a.indexOf(e.charAt(l++))),u[h++]=t,64!==o&&(u[h++]=n),64!==c&&(u[h++]=i);return u}},{"./support":30,"./utils":32}],2:[function(e,t,n){var i=e("./external"),r=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),s=e("./stream/DataLengthProbe");function o(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}o.prototype={getContentWorker:function(){var e=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new s("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var i=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n){var i=r,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}(0|t,e,e.length):function(e,t,n){var i=r,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^i[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:37}],7:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),a=e("./utils"),s=e("./stream/GenericWorker"),o=i?"uint8array":"array";function c(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(c,s),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(o,e.data),!1)},c.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new c("Deflate",e)},n.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function i(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i}function r(e,t,n,r,s,h){var d,u,f=e.file,p=e.compression,g=h!==o.utf8encode,m=a.transformTo("string",h(f.name)),b=a.transformTo("string",o.utf8encode(f.name)),v=f.comment,y=a.transformTo("string",h(v)),w=a.transformTo("string",o.utf8encode(v)),x=b.length!==f.name.length,_=w.length!==v.length,T="",D="",E="",A=f.dir,k=f.date,S={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(S.crc32=e.crc32,S.compressedSize=e.compressedSize,S.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),g||!x&&!_||(C|=2048);var U,F,I=0,R=0;A&&(I|=16),"UNIX"===s?(R=798,I|=(F=U=f.unixPermissions,U||(F=A?16893:33204),(65535&F)<<16)):(R=20,I|=function(e){return 63&(e||0)}(f.dosPermissions)),d=k.getUTCHours(),d<<=6,d|=k.getUTCMinutes(),d<<=5,d|=k.getUTCSeconds()/2,u=k.getUTCFullYear()-1980,u<<=4,u|=k.getUTCMonth()+1,u<<=5,u|=k.getUTCDate(),x&&(D=i(1,1)+i(c(m),4)+b,T+="up"+i(D.length,2)+D),_&&(E=i(1,1)+i(c(y),4)+w,T+="uc"+i(E.length,2)+E);var N="";return N+="\n\0",N+=i(C,2),N+=p.magic,N+=i(d,2),N+=i(u,2),N+=i(S.crc32,4),N+=i(S.compressedSize,4),N+=i(S.uncompressedSize,4),N+=i(m.length,2),N+=i(T.length,2),{fileRecord:l.LOCAL_FILE_HEADER+N+m+T,dirRecord:l.CENTRAL_FILE_HEADER+i(R,2)+N+i(y.length,2)+"\0\0\0\0"+i(I,4)+i(r,4)+m+T+y}}var a=e("../utils"),s=e("../stream/GenericWorker"),o=e("../utf8"),c=e("../crc32"),l=e("../signature");function h(e,t,n,i){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(h,s),h.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=r(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t,n=this.streamFiles&&!e.file.dir,a=r(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(a.dirRecord),n)this.push({data:(t=e,l.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:a.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n,r,s,o,c,h,d=this.bytesWritten-e,u=(n=this.dirRecords.length,r=d,s=e,o=this.zipComment,c=this.encodeFileName,h=a.transformTo("string",c(o)),l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(n,2)+i(n,2)+i(r,4)+i(s,4)+i(h.length,2)+h);this.push({data:u,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},h.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(i){}return!0},h.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var i=e("../compressions"),r=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new r(t.streamFiles,n,t.platform,t.encodeFileName),s=0;try{e.forEach(function(e,n){s++;var r=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),o=n.options.compressionOptions||t.compressionOptions||{},c=n.dir,l=n.date;n._compressWorker(r,o).withStreamInfo("file",{name:e,dir:c,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)}),a.entriesCount=s}catch(o){a.error(o)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var i=e("./utils"),r=e("./external"),a=e("./utf8"),s=e("./zipEntries"),o=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function l(e){return new r.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new o);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new s(t);return n.load(e),n}).then(function(e){var n=[r.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var a=0;a<i.length;a++)n.push(l(i[a]));return r.Promise.all(n)}).then(function(e){for(var r=e.shift(),a=r.files,s=0;s<a.length;s++){var o=a[s],c=o.fileNameStr,l=i.resolve(o.fileNameStr);n.file(l,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(n.file(l).unsafeOriginalName=c)}return r.zipComment.length&&(n.comment=r.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var i=e("../utils"),r=e("../stream/GenericWorker");function a(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(a,r),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var i=e("readable-stream").Readable;function r(e,t,n){i.call(this,t),this._helper=e;var r=this;e.on("data",function(e,t){r.push(e)||r._helper.pause(),n&&n(t)}).on("error",function(e){r.emit("error",e)}).on("end",function(){r.push(null)})}e("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function i(e,t,n){var i,r=a.getTypeOf(t),o=a.extend(n||{},c);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=g(e)),o.createFolders&&(i=p(e))&&m.call(this,i,!0);var d="string"===r&&!1===o.binary&&!1===o.base64;n&&void 0!==n.binary||(o.binary=!d),(t instanceof l&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",r="string");var b;b=t instanceof l||t instanceof s?t:u.isNode&&u.isStream(t)?new f(e,t):a.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var v=new h(e,b,o);this.files[e]=v}var r=e("./utf8"),a=e("./utils"),s=e("./stream/GenericWorker"),o=e("./stream/StreamHelper"),c=e("./defaults"),l=e("./compressedObject"),h=e("./zipObject"),d=e("./generate"),u=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:c.createFolders,e=g(e),this.files[e]||i.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function b(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i)},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,i.call(this,e,t,n),this;if(b(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(b(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=m.call(this,t),i=this.clone();return i.root=n.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var i=n.comment||this.comment||"";t=d.generateWorker(this,n,i)}catch(c){(t=new s("error")).error(c)}return new o(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var i=e("./DataReader");function r(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===i&&this.data[a+3]===r)return a-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&i===a[2]&&r===a[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var i=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,n){var i=e("./Uint8ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var i=e("./DataReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var i=e("./ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var i=e("../utils"),r=e("../support"),a=e("./ArrayReader"),s=e("./StringReader"),o=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new o(e):r.uint8array?new c(i.transformTo("uint8array",e)):new a(i.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){var i=e("./GenericWorker"),r=e("../utils");function a(e){i.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(a,i),a.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var i=e("./GenericWorker"),r=e("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,i),a.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var i=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(a,r),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var i=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,n){var i=e("../utils"),r=e("./ConvertWorker"),a=e("./GenericWorker"),s=e("../base64"),o=e("../support"),c=e("../external"),l=null;if(o.nodestream)try{l=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}function h(e,t,n){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=n,i.checkSupport(s),this._worker=e.pipe(new r(s)),e.lock()}catch(o){this._worker=new a("error"),this._worker.error(o)}}h.prototype={accumulate:function(e){return function(e,t){return new c.Promise(function(n,r){var a=[],o=e._internalType,c=e._outputType,l=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],r(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),n);case"base64":return s.encode(t);default:return i.transformTo(e,t)}}(c,function(e,t){var n,i=0,r=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(a),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,a),l);n(e)}catch(t){r(t)}a=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,n)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(a){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(s){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(a){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var i=e("./utils"),r=e("./support"),a=e("./nodejsUtils"),s=e("./stream/GenericWorker"),o=new Array(256),c=0;c<256;c++)o[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function l(){s.call(this,"utf-8 decode"),this.leftOver=null}function h(){s.call(this,"utf-8 encode")}o[254]=o[254]=1,n.utf8encode=function(e){return r.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,i,a,s,o=e.length,c=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(c):new Array(c),a=s=0;s<c;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){return r.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,a,s=e.length,c=new Array(2*s);for(t=n=0;t<s;)if((r=e[t++])<128)c[n++]=r;else if(4<(a=o[r]))c[n++]=65533,t+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&t<s;)r=r<<6|63&e[t++],a--;1<a?c[n++]=65533:r<65536?c[n++]=r:(r-=65536,c[n++]=55296|r>>10&1023,c[n++]=56320|1023&r)}return c.length!==n&&(c.subarray?c=c.subarray(0,n):c.length=n),i.applyFromCharCode(c)}(e=i.transformTo(r.uint8array?"uint8array":"array",e))},i.inherits(l,s),l.prototype.processChunk=function(e){var t=i.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}(t),c=t;s!==t.length&&(r.uint8array?(c=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(c=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:n.utf8decode(c),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=l,i.inherits(h,s),h.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var i=e("./support"),r=e("./base64"),a=e("./nodejsUtils"),s=e("./external");function o(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(t)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var l={stringifyByChunk:function(e,t,n){var i=[],r=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;r<a;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,a)))):i.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,a)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=l.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=l.applyCanBeUsed.nodebuffer),r)for(;1<t;)try{return l.stringifyByChunk(e,i,t)}catch(a){t=Math.floor(t/2)}return l.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=h;var u={};u.string={string:o,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,a.allocBuffer(e.length))}},u.array={string:h,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},u.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return a.newBufferFrom(e)}},u.nodebuffer={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:o},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return u[i][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],i=0;i<t.length;i++){var r=t[i];"."===r||""===r&&0!==i&&i!==t.length-1||(".."===r?n.pop():n.push(r))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&a.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,o,l){return s.Promise.resolve(t).then(function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var h,d=n.getTypeOf(t);return d?("arraybuffer"===d?t=n.transformTo("uint8array",t):"string"===d&&(l?t=r.decode(t):a&&!0!==o&&(t=c(h=t,i.uint8array?new Uint8Array(h.length):new Array(h.length)))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var i=e("./reader/readerFor"),r=e("./utils"),a=e("./signature"),s=e("./zipEntry"),o=e("./support");function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(0<i)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var i=e("./reader/readerFor"),r=e("./utils"),a=e("./compressedObject"),s=e("./crc32"),o=e("./utf8"),c=e("./compressions"),l=e("./support");function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i};e.setIndex(r)},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var a=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function i(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var r=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),s=e("./utf8"),o=e("./compressedObject"),c=e("./stream/GenericWorker");i.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var i="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!i&&(t=t.pipe(new s.Utf8EncodeWorker)),!a&&i&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(o){(t=new c("error")).error(o)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)i.prototype[l[d]]=h;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n,i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var a=0,s=new r(h),o=e.document.createTextNode("");s.observe(o,{characterData:!0}),n=function(){o.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){h(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(h,0)};else{var c=new e.MessageChannel;c.port1.onmessage=h,n=function(){c.port2.postMessage(0)}}var l=[];function h(){var e,t;i=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}i=!1}t.exports=function(e){1!==l.push(e)||i||n()}}).call(this,void 0!==kh?kh:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var i=e("immediate");function r(){}var a={},s=["REJECTED"],o=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function h(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){i(function(){var i;try{i=t(n)}catch(r){return a.reject(e,r)}i===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,i)})}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function i(t){n||(n=!0,a.reject(e,t))}function r(t){n||(n=!0,a.resolve(e,t))}var s=p(function(){t(r,i)});"error"===s.status&&i(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(i){n.status="error",n.value=i}return n}(t.exports=l).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(r);return this.state!==c?d(n,this.state===o?e:t,this.outcome):this.queue.push(new h(n,e,t)),n},h.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){a.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(u,t);if("error"===n.status)return a.reject(e,n.value);var i=n.value;if(i)f(e,i);else{e.state=o,e.outcome=t;for(var r=-1,s=e.queue.length;++r<s;)e.queue[r].callFulfilled(t)}return e},a.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(r),e)},l.reject=function(e){var t=new this(r);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),o=0,c=-1,l=new this(r);++c<n;)h(e[c],c);return l;function h(e,r){t.resolve(e).then(function(e){s[r]=e,++o!==n||i||(i=!0,a.resolve(l,s))},function(e){i||(i=!0,a.reject(l,e))})}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var i,s=-1,o=new this(r);++s<t;)i=e[s],this.resolve(i).then(function(e){n||(n=!0,a.resolve(o,e))},function(e){n||(n=!0,a.reject(o,e))});return o}},{immediate:36}],38:[function(e,t,n){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var i=e("./zlib/deflate"),r=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/messages"),o=e("./zlib/zstream"),c=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(s[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=i.deflateSetDictionary(this.strm,h)))throw new Error(s[n]);this._dict_set=!0}}function h(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}l.prototype.push=function(e,t){var n,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(l),o.next_out=0,o.avail_out=l),1!==(n=i.deflate(o,s))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==n);return 4===s?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),!(o.avail_out=0))},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=l,n.deflate=h,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var i=e("./zlib/inflate"),r=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/constants"),o=e("./zlib/messages"),c=e("./zlib/zstream"),l=e("./zlib/gzheader"),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);this.header=new l,i.inflateGetHeader(this.strm,this.header)}function u(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}d.prototype.push=function(e,t){var n,o,c,l,d,u,f=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(p),f.next_out=0,f.avail_out=p),(n=i.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&g&&(u="string"==typeof g?a.string2buf(g):"[object ArrayBuffer]"===h.call(g)?new Uint8Array(g):g,n=i.inflateSetDictionary(this.strm,u)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(f.output,f.next_out),l=f.next_out-c,d=a.buf2string(f.output,c),f.next_out=l,f.avail_out=p-l,l&&r.arraySet(f.output,f.output,c,l,0),this.onData(d)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=u,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.ungzip=u},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,s;for(t=i=0,n=e.length;t<n;t++)i+=e[t].length;for(s=new Uint8Array(i),t=r=0,n=e.length;t<n;t++)a=e[t],s.set(a,r),r+=a.length;return s}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},{}],42:[function(e,t,n){var i=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(l){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){a=!1}for(var s=new i.Buf8(256),o=0;o<256;o++)s[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,n.string2buf=function(e){var t,n,r,a,s,o=e.length,c=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(c),a=s=0;s<c;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t},n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,r,a,o=t||e.length,l=new Array(2*o);for(n=i=0;n<o;)if((r=e[n++])<128)l[i++]=r;else if(4<(a=s[r]))l[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&n<o;)r=r<<6|63&e[n++],a--;1<a?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return c(l,i)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,i){for(var r=65535&e,a=e>>>16&65535,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;a=a+(r=r+t[i++]|0)|0,--s;);r%=65521,a%=65521}return r|a<<16}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var a=i,s=r+n;e^=-1;for(var o=r;o<s;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,n){var i,r=e("../utils/common"),a=e("./trees"),s=e("./adler32"),o=e("./crc32"),c=e("./messages"),l=-2,h=258,d=262,u=113;function f(e,t){return e.msg=c[t],t}function p(e){return(e<<1)-(4<e?9:0)}function g(e){for(var t=e.length;0<=--t;)e[t]=0}function m(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function b(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,m(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function y(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t){var n,i,r=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,l=e.window,u=e.w_mask,f=e.prev,p=e.strstart+h,g=l[a+s-1],m=l[a+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(n=t)+s]===m&&l[n+s-1]===g&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<p);if(i=h-(p-a),a=p-h,s<i){if(e.match_start=t,o<=(s=i))break;g=l[a+s-1],m=l[a+s]}}}while((t=f[t&u])>c&&0!=--r);return s<=e.lookahead?s:e.lookahead}function x(e){var t,n,i,a,c,l,h,u,f,p,g=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-d)){for(r.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,t=n=e.hash_size;i=e.head[--t],e.head[t]=g<=i?i-g:0,--n;);for(t=n=g;i=e.prev[--t],e.prev[t]=g<=i?i-g:0,--n;);a+=g}if(0===e.strm.avail_in)break;if(l=e.strm,h=e.window,u=e.strstart+e.lookahead,p=void 0,(f=a)<(p=l.avail_in)&&(p=f),n=0===p?0:(l.avail_in-=p,r.arraySet(h,l.input,l.next_in,p,u),1===l.state.wrap?l.adler=s(l.adler,h,p,u):2===l.state.wrap&&(l.adler=o(l.adler,h,p,u)),l.next_in+=p,l.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function _(e,t){for(var n,i;;){if(e.lookahead<d){if(x(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-d&&(e.match_length=w(e,n)),e.match_length>=3)if(i=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function T(e,t){for(var n,i,r;;){if(e.lookahead<d){if(x(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d&&(e.match_length=w(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-3,i=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=a._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function D(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:u,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):f(e,l)}function k(e){var t,n=A(e);return 0===n&&((t=e.state).window_size=2*t.w_size,g(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function S(e,t,n,i,a,s){if(!e)return l;var o=1;if(-1===t&&(t=6),i<0?(o=0,i=-i):15<i&&(o=2,i-=16),a<1||9<a||8!==n||i<8||15<i||t<0||9<t||s<0||4<s)return f(e,l);8===i&&(i=9);var c=new E;return(e.state=c).strm=e,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new r.Buf8(2*c.w_size),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=n,k(e)}i=[new D(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,b(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)}),new D(4,4,8,4,_),new D(4,5,16,8,_),new D(4,6,32,32,_),new D(4,4,16,16,T),new D(8,16,32,32,T),new D(8,16,128,128,T),new D(8,32,128,256,T),new D(32,128,258,1024,T),new D(32,258,258,4096,T)],n.deflateInit=function(e,t){return S(e,t,8,15,8,0)},n.deflateInit2=S,n.deflateReset=k,n.deflateResetKeep=A,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?l:(e.state.gzhead=t,0):l},n.deflate=function(e,t){var n,r,s,c;if(!e||!e.state||5<t||t<0)return e?f(e,l):l;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&4!==t)return f(e,0===e.avail_out?-5:l);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,v(r,31),v(r,139),v(r,8),r.gzhead?(v(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),v(r,255&r.gzhead.time),v(r,r.gzhead.time>>8&255),v(r,r.gzhead.time>>16&255),v(r,r.gzhead.time>>24&255),v(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),v(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(v(r,255&r.gzhead.extra.length),v(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=o(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(v(r,0),v(r,0),v(r,0),v(r,0),v(r,0),v(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),v(r,3),r.status=u);else{var d=8+(r.w_bits-8<<4)<<8;d|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(d|=32),d+=31-d%31,r.status=u,y(r,d),0!==r.strstart&&(y(r,e.adler>>>16),y(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),m(e),s=r.pending,r.pending!==r.pending_buf_size));)v(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),m(e),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,v(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),m(e),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,v(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&m(e),r.pending+2<=r.pending_buf_size&&(v(r,255&e.adler),v(r,e.adler>>8&255),e.adler=0,r.status=u)):r.status=u),0!==r.pending){if(m(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(n)&&4!==t)return f(e,-5);if(666===r.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&666!==r.status){var w=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,i,r,s,o=e.window;;){if(e.lookahead<=h){if(x(e),e.lookahead<=h&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){s=e.strstart+h;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);e.match_length=h-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):i[r.level].func(r,t);if(3!==w&&4!==w||(r.status=666),1===w||3===w)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===w&&(1===t?a._tr_align(r):5!==t&&(a._tr_stored_block(r,0,0,!1),3===t&&(g(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),m(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(v(r,255&e.adler),v(r,e.adler>>8&255),v(r,e.adler>>16&255),v(r,e.adler>>24&255),v(r,255&e.total_in),v(r,e.total_in>>8&255),v(r,e.total_in>>16&255),v(r,e.total_in>>24&255)):(y(r,e.adler>>>16),y(r,65535&e.adler)),m(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==u&&666!==t?f(e,l):(e.state=null,t===u?f(e,-3):0):l},n.deflateSetDictionary=function(e,t){var n,i,a,o,c,h,d,u,f=t.length;if(!e||!e.state)return l;if(2===(o=(n=e.state).wrap)||1===o&&42!==n.status||n.lookahead)return l;for(1===o&&(e.adler=s(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(g(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new r.Buf8(n.w_size),r.arraySet(u,t,f-n.w_size,n.w_size,0),t=u,f=n.w_size),c=e.avail_in,h=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,x(n);n.lookahead>=3;){for(i=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--a;);n.strstart=i,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=h,e.input=d,e.avail_in=c,n.wrap=o,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,i,r,a,s,o,c,l,h,d,u,f,p,g,m,b,v,y,w,x,_,T,D,E,A;n=e.state,i=e.next_in,E=e.input,r=i+(e.avail_in-5),a=e.next_out,A=e.output,s=a-(t-e.avail_out),o=a+(e.avail_out-257),c=n.dmax,l=n.wsize,h=n.whave,d=n.wnext,u=n.window,f=n.hold,p=n.bits,g=n.lencode,m=n.distcode,b=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(f+=E[i++]<<p,p+=8,f+=E[i++]<<p,p+=8),y=g[f&b];t:for(;;){if(f>>>=w=y>>>24,p-=w,0==(w=y>>>16&255))A[a++]=65535&y;else{if(!(16&w)){if(!(64&w)){y=g[(65535&y)+(f&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&y,(w&=15)&&(p<w&&(f+=E[i++]<<p,p+=8),x+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=E[i++]<<p,p+=8,f+=E[i++]<<p,p+=8),y=m[f&v];n:for(;;){if(f>>>=w=y>>>24,p-=w,!(16&(w=y>>>16&255))){if(!(64&w)){y=m[(65535&y)+(f&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(_=65535&y,p<(w&=15)&&(f+=E[i++]<<p,(p+=8)<w&&(f+=E[i++]<<p,p+=8)),c<(_+=f&(1<<w)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=w,p-=w,(w=a-s)<_){if(h<(w=_-w)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(D=u,(T=0)===d){if(T+=l-w,w<x){for(x-=w;A[a++]=u[T++],--w;);T=a-_,D=A}}else if(d<w){if(T+=l+d-w,(w-=d)<x){for(x-=w;A[a++]=u[T++],--w;);if(T=0,d<x){for(x-=w=d;A[a++]=u[T++],--w;);T=a-_,D=A}}}else if(T+=d-w,w<x){for(x-=w;A[a++]=u[T++],--w;);T=a-_,D=A}for(;2<x;)A[a++]=D[T++],A[a++]=D[T++],A[a++]=D[T++],x-=3;x&&(A[a++]=D[T++],1<x&&(A[a++]=D[T++]))}else{for(T=a-_;A[a++]=A[T++],A[a++]=A[T++],A[a++]=A[T++],2<(x-=3););x&&(A[a++]=A[T++],1<x&&(A[a++]=A[T++]))}break}}break}}while(i<r&&a<o);i-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){var i=e("../utils/common"),r=e("./adler32"),a=e("./crc32"),s=e("./inffast"),o=e("./inftrees"),c=-2;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):c}function u(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):c}function f(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?c:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,u(e))):c}function p(e,t){var n,i;return e?(i=new h,(e.state=i).window=null,0!==(n=f(e,t))&&(e.state=null),n):c}var g,m,b=!0;function v(e){if(b){var t;for(g=new i.Buf32(512),m=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,m,0,e.work,{bits:5}),b=!1}e.lencode=g,e.lenbits=9,e.distcode=m,e.distbits=5}function y(e,t,n,r){var a,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),r>=s.wsize?(i.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(r<(a=s.wsize-s.wnext)&&(a=r),i.arraySet(s.window,t,n-r,a,s.wnext),(r-=a)?(i.arraySet(s.window,t,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}n.inflateReset=u,n.inflateReset2=f,n.inflateResetKeep=d,n.inflateInit=function(e){return p(e,15)},n.inflateInit2=p,n.inflate=function(e,t){var n,h,d,u,f,p,g,m,b,w,x,_,T,D,E,A,k,S,C,U,F,I,R,N,M=0,O=new i.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,d=e.output,g=e.avail_out,u=e.next_in,h=e.input,p=e.avail_in,m=n.hold,b=n.bits,w=p,x=g,I=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(2&n.wrap&&35615===m){O[n.check=0]=255&m,O[1]=m>>>8&255,n.check=a(n.check,O,2,0),b=m=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",n.mode=30;break}if(b-=4,F=8+(15&(m>>>=4)),0===n.wbits)n.wbits=F;else if(F>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<F,e.adler=n.check=1,n.mode=512&m?10:12,b=m=0;break;case 2:for(;b<16;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(n.flags=m,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=m>>8&1),512&n.flags&&(O[0]=255&m,O[1]=m>>>8&255,n.check=a(n.check,O,2,0)),b=m=0,n.mode=3;case 3:for(;b<32;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.head&&(n.head.time=m),512&n.flags&&(O[0]=255&m,O[1]=m>>>8&255,O[2]=m>>>16&255,O[3]=m>>>24&255,n.check=a(n.check,O,4,0)),b=m=0,n.mode=4;case 4:for(;b<16;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.head&&(n.head.xflags=255&m,n.head.os=m>>8),512&n.flags&&(O[0]=255&m,O[1]=m>>>8&255,n.check=a(n.check,O,2,0)),b=m=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.length=m,n.head&&(n.head.extra_len=m),512&n.flags&&(O[0]=255&m,O[1]=m>>>8&255,n.check=a(n.check,O,2,0)),b=m=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p<(_=n.length)&&(_=p),_&&(n.head&&(F=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,h,u,_,F)),512&n.flags&&(n.check=a(n.check,h,_,u)),p-=_,u+=_,n.length-=_),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;for(_=0;F=h[u+_++],n.head&&F&&n.length<65536&&(n.head.name+=String.fromCharCode(F)),F&&_<p;);if(512&n.flags&&(n.check=a(n.check,h,_,u)),p-=_,u+=_,F)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;for(_=0;F=h[u+_++],n.head&&F&&n.length<65536&&(n.head.comment+=String.fromCharCode(F)),F&&_<p;);if(512&n.flags&&(n.check=a(n.check,h,_,u)),p-=_,u+=_,F)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(m!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}b=m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}e.adler=n.check=l(m),b=m=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=g,e.next_in=u,e.avail_in=p,n.hold=m,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){m>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}switch(n.last=1&m,b-=1,3&(m>>>=1)){case 0:n.mode=14;break;case 1:if(v(n),n.mode=20,6!==t)break;m>>>=2,b-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}m>>>=2,b-=2;break;case 14:for(m>>>=7&b,b-=7&b;b<32;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&m,b=m=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(_=n.length){if(p<_&&(_=p),g<_&&(_=g),0===_)break e;i.arraySet(d,h,u,_,f),p-=_,u+=_,g-=_,f+=_,n.length-=_;break}n.mode=12;break;case 17:for(;b<14;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(n.nlen=257+(31&m),m>>>=5,b-=5,n.ndist=1+(31&m),m>>>=5,b-=5,n.ncode=4+(15&m),m>>>=4,b-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.lens[P[n.have++]]=7&m,m>>>=3,b-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},I=o(0,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,I){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(M=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,k=65535&M,!((E=M>>>24)<=b);){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(k<16)m>>>=E,b-=E,n.lens[n.have++]=k;else{if(16===k){for(N=E+2;b<N;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(m>>>=E,b-=E,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}F=n.lens[n.have-1],_=3+(3&m),m>>>=2,b-=2}else if(17===k){for(N=E+3;b<N;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}b-=E,F=0,_=3+(7&(m>>>=E)),m>>>=3,b-=3}else{for(N=E+7;b<N;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}b-=E,F=0,_=11+(127&(m>>>=E)),m>>>=7,b-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;_--;)n.lens[n.have++]=F}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,R={bits:n.lenbits},I=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,I){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},I=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,I){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=p&&258<=g){e.next_out=f,e.avail_out=g,e.next_in=u,e.avail_in=p,n.hold=m,n.bits=b,s(e,x),f=e.next_out,d=e.output,g=e.avail_out,u=e.next_in,h=e.input,p=e.avail_in,m=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;A=(M=n.lencode[m&(1<<n.lenbits)-1])>>>16&255,k=65535&M,!((E=M>>>24)<=b);){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(A&&!(240&A)){for(S=E,C=A,U=k;A=(M=n.lencode[U+((m&(1<<S+C)-1)>>S)])>>>16&255,k=65535&M,!(S+(E=M>>>24)<=b);){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}m>>>=S,b-=S,n.back+=S}if(m>>>=E,b-=E,n.back+=E,n.length=k,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=12;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(N=n.extra;b<N;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.length+=m&(1<<n.extra)-1,m>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(M=n.distcode[m&(1<<n.distbits)-1])>>>16&255,k=65535&M,!((E=M>>>24)<=b);){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(!(240&A)){for(S=E,C=A,U=k;A=(M=n.distcode[U+((m&(1<<S+C)-1)>>S)])>>>16&255,k=65535&M,!(S+(E=M>>>24)<=b);){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}m>>>=S,b-=S,n.back+=S}if(m>>>=E,b-=E,n.back+=E,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=k,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(N=n.extra;b<N;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}n.offset+=m&(1<<n.extra)-1,m>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===g)break e;if(_=x-g,n.offset>_){if((_=n.offset-_)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}T=_>n.wnext?(_-=n.wnext,n.wsize-_):n.wnext-_,_>n.length&&(_=n.length),D=n.window}else D=d,T=f-n.offset,_=n.length;for(g<_&&(_=g),g-=_,n.length-=_;d[f++]=D[T++],--_;);0===n.length&&(n.mode=21);break;case 26:if(0===g)break e;d[f++]=n.length,g--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===p)break e;p--,m|=h[u++]<<b,b+=8}if(x-=g,e.total_out+=x,n.total+=x,x&&(e.adler=n.check=n.flags?a(n.check,d,x,f-x):r(n.check,d,x,f-x)),x=g,(n.flags?m:l(m))!==n.check){e.msg="incorrect data check",n.mode=30;break}b=m=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===p)break e;p--,m+=h[u++]<<b,b+=8}if(m!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}b=m=0}n.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;default:return c}return e.next_out=f,e.avail_out=g,e.next_in=u,e.avail_in=p,n.hold=m,n.bits=b,(n.wsize||x!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&y(e,e.output,e.next_out,x-e.avail_out)?(n.mode=31,-4):(w-=e.avail_in,x-=e.avail_out,e.total_in+=w,e.total_out+=x,n.total+=x,n.wrap&&x&&(e.adler=n.check=n.flags?a(n.check,d,x,e.next_out-x):r(n.check,d,x,e.next_out-x)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==w&&0===x||4===t)&&0===I&&(I=-5),I)},n.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,0):c},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?c:11===n.mode&&r(1,t,i,0)!==n.check?-3:y(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):c},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var i=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,l,h,d,u){var f,p,g,m,b,v,y,w,x,_=u.bits,T=0,D=0,E=0,A=0,k=0,S=0,C=0,U=0,F=0,I=0,R=null,N=0,M=new i.Buf16(16),O=new i.Buf16(16),P=null,L=0;for(T=0;T<=15;T++)M[T]=0;for(D=0;D<c;D++)M[t[n+D]]++;for(k=_,A=15;1<=A&&0===M[A];A--);if(A<k&&(k=A),0===A)return l[h++]=20971520,l[h++]=20971520,u.bits=1,0;for(E=1;E<A&&0===M[E];E++);for(k<E&&(k=E),T=U=1;T<=15;T++)if(U<<=1,(U-=M[T])<0)return-1;if(0<U&&(0===e||1!==A))return-1;for(O[1]=0,T=1;T<15;T++)O[T+1]=O[T]+M[T];for(D=0;D<c;D++)0!==t[n+D]&&(d[O[t[n+D]]++]=D);if(v=0===e?(R=P=d,19):1===e?(R=r,N-=257,P=a,L-=257,256):(R=s,P=o,-1),T=E,b=h,C=D=I=0,g=-1,m=(F=1<<(S=k))-1,1===e&&852<F||2===e&&592<F)return 1;for(;;){for(y=T-C,x=d[D]<v?(w=0,d[D]):d[D]>v?(w=P[L+d[D]],R[N+d[D]]):(w=96,0),f=1<<T-C,E=p=1<<S;l[b+(I>>C)+(p-=f)]=y<<24|w<<16|x,0!==p;);for(f=1<<T-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,D++,0==--M[T]){if(T===A)break;T=t[n+d[D]]}if(k<T&&(I&m)!==g){for(0===C&&(C=k),b+=E,U=1<<(S=T-C);S+C<A&&!((U-=M[S+C])<=0);)S++,U<<=1;if(F+=1<<S,1===e&&852<F||2===e&&592<F)return 1;l[g=I&m]=k<<24|S<<16|b-h}}return 0!==I&&(l[b+I]=T-C<<24|64<<16),u.bits=k,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var i=e("../utils/common");function r(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,s=286,o=30,c=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);r(f);var p=new Array(60);r(p);var g=new Array(512);r(g);var m=new Array(256);r(m);var b=new Array(29);r(b);var v,y,w,x=new Array(o);function _(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function T(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function D(e){return e<256?g[e]:g[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function k(e,t,n){A(e,n[2*t],n[2*t+1])}function S(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function C(e,t,n){var i,r,a=new Array(16),s=0;for(i=1;i<=c;i++)a[i]=s=s+n[i-1]<<1;for(r=0;r<=t;r++){var o=e[2*r+1];0!==o&&(e[2*r]=S(a[o]++,o))}}function U(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function F(e){8<e.bi_valid?E(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function I(e,t,n,i){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]}function R(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&I(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!I(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function N(e,t,n){var i,r,s,o,c=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],r=e.pending_buf[e.l_buf+c],c++,0===i?k(e,r,t):(k(e,(s=m[r])+a+1,t),0!==(o=l[s])&&A(e,r-=b[s],o),k(e,s=D(--i),n),0!==(o=h[s])&&A(e,i-=x[s],o)),c<e.last_lit;);k(e,256,t)}function M(e,t){var n,i,r,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=h=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=s[2*r+1]);for(t.max_code=h,n=e.heap_len>>1;1<=n;n--)R(e,a,n);for(r=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*r]=a[2*n]+a[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=r,e.heap[1]=r++,R(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,a,s,o,l=t.dyn_tree,h=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(a=0;a<=c;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)g<(a=l[2*l[2*(i=e.heap[n])+1]+1]+1)&&(a=g,m++),l[2*i+1]=a,h<i||(e.bl_count[a]++,s=0,p<=i&&(s=f[i-p]),o=l[2*i],e.opt_len+=o*(a+s),u&&(e.static_len+=o*(d[2*i+1]+s)));if(0!==m){do{for(a=g-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[g]--,m-=2}while(0<m);for(a=g;0!==a;a--)for(i=e.bl_count[a];0!==i;)h<(r=e.heap[--n])||(l[2*r+1]!==a&&(e.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),i--)}}(e,t),C(a,h,e.bl_count)}function O(e,t,n){var i,r,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++o<c&&r===s||(o<l?e.bl_tree[2*r]+=o:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=r,l=(o=0)===s?(c=138,3):r===s?(c=6,3):(c=7,4))}function P(e,t,n){var i,r,a=-1,s=t[1],o=0,c=7,l=4;for(0===s&&(c=138,l=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++o<c&&r===s)){if(o<l)for(;k(e,r,e.bl_tree),0!=--o;);else 0!==r?(r!==a&&(k(e,r,e.bl_tree),o--),k(e,16,e.bl_tree),A(e,o-3,2)):o<=10?(k(e,17,e.bl_tree),A(e,o-3,3)):(k(e,18,e.bl_tree),A(e,o-11,7));a=r,l=(o=0)===s?(c=138,3):r===s?(c=6,3):(c=7,4)}}r(x);var L=!1;function W(e,t,n,r){var a,s,o;A(e,0+(r?1:0),3),s=t,o=n,F(a=e),E(a,o),E(a,~o),i.arraySet(a.pending_buf,a.window,s,o,a.pending),a.pending+=o}n._tr_init=function(e){L||(function(){var e,t,n,i,r,a=new Array(16);for(i=n=0;i<28;i++)for(b[i]=n,e=0;e<1<<l[i];e++)m[n++]=i;for(m[n-1]=i,i=r=0;i<16;i++)for(x[i]=r,e=0;e<1<<h[i];e++)g[r++]=i;for(r>>=7;i<o;i++)for(x[i]=r<<7,e=0;e<1<<h[i]-7;e++)g[256+r++]=i;for(t=0;t<=c;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(C(f,287,a),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=S(e,5);v=new _(f,l,257,s,c),y=new _(p,h,0,o,c),w=new _(new Array(0),d,0,19,7)}(),L=!0),e.l_desc=new T(e.dyn_ltree,v),e.d_desc=new T(e.dyn_dtree,y),e.bl_desc=new T(e.bl_tree,w),e.bi_buf=0,e.bi_valid=0,U(e)},n._tr_stored_block=W,n._tr_flush_block=function(e,t,n,i){var r,s,o=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),o=function(e){var t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*u[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==t?W(e,t,n,i):4===e.strategy||s===r?(A(e,2+(i?1:0),3),N(e,f,p)):(A(e,4+(i?1:0),3),function(e,t,n,i){var r;for(A(e,t-257,5),A(e,n-1,5),A(e,i-4,4),r=0;r<i;r++)A(e,e.bl_tree[2*u[r]+1],3);P(e,e.dyn_ltree,t-1),P(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),N(e,e.dyn_ltree,e.dyn_dtree)),U(e),i&&F(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(m[n]+a+1)]++,e.dyn_dtree[2*D(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){var t;A(e,2,3),k(e,256,f),16===(t=e).bi_valid?(E(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e){if(!e.setImmediate){var t,n,i,r,a=1,s={},o=!1,c=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(r="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",u,!1):e.attachEvent("onmessage",u),function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(d,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),i=0;i<n.length;i++)n[i]=arguments[i+1];var r={callback:e,args:n};return s[a]=r,t(a),a++},l.clearImmediate=h}function h(e){delete s[e]}function d(e){if(o)setTimeout(d,0,e);else{var t=s[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(undefined,n)}}(t)}finally{h(e),o=!1}}}}function u(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&d(+t.data.slice(r.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==kh?kh:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)),iT.exports}function aT(){if(eT)return tT;eT=1;var e=function(){if(J_)return nT;J_=1,nT.byteLength=function(e){var t=a(e),n=t[0],i=t[1];return 3*(n+i)/4-i},nT.toByteArray=function(e){var i,r,s=a(e),o=s[0],c=s[1],l=new n(function(e,t,n){return 3*(t+n)/4-n}(0,o,c)),h=0,d=c>0?o-4:o;for(r=0;r<d;r+=4)i=t[e.charCodeAt(r)]<<18|t[e.charCodeAt(r+1)]<<12|t[e.charCodeAt(r+2)]<<6|t[e.charCodeAt(r+3)],l[h++]=i>>16&255,l[h++]=i>>8&255,l[h++]=255&i;return 2===c&&(i=t[e.charCodeAt(r)]<<2|t[e.charCodeAt(r+1)]>>4,l[h++]=255&i),1===c&&(i=t[e.charCodeAt(r)]<<10|t[e.charCodeAt(r+1)]<<4|t[e.charCodeAt(r+2)]>>2,l[h++]=i>>8&255,l[h++]=255&i),l},nT.fromByteArray=function(t){for(var n,i=t.length,r=i%3,a=[],s=16383,c=0,l=i-r;c<l;c+=s)a.push(o(t,c,c+s>l?l:c+s));return 1===r?(n=t[i-1],a.push(e[n>>2]+e[n<<4&63]+"==")):2===r&&(n=(t[i-2]<<8)+t[i-1],a.push(e[n>>10]+e[n>>4&63]+e[n<<2&63]+"=")),a.join("")};for(var e=[],t=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)e[r]=i[r],t[i.charCodeAt(r)]=r;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function s(t){return e[t>>18&63]+e[t>>12&63]+e[t>>6&63]+e[63&t]}function o(e,t,n){for(var i,r=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),r.push(s(i));return r.join("")}return t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63,nT}(),t=rT();return tT.openArrayBuffer=function(n){return t.loadAsync(n).then(function(t){return{exists:function(e){return null!==t.file(e)},read:function(n,i){return t.file(n).async("uint8array").then(function(t){return"base64"===i?e.fromByteArray(t):i?new TextDecoder(i).decode(t):t})},write:function(e,n){t.file(e,n)},toArrayBuffer:function(){return t.generateAsync({type:"arraybuffer"})}}})},tT.splitPath=function(e){var t=e.lastIndexOf("/");return-1===t?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}},tT.joinPath=function(){var e=Array.prototype.filter.call(arguments,function(e){return e}),t=[];return e.forEach(function(e){/^\//.test(e)?t=[e]:t.push(e)}),t.join("/")},tT}var sT,oT={},cT={},lT={};function hT(){if(sT)return lT;sT=1;var e=bx;lT.Element=n,lT.element=function(e,t,i){return new n(e,t,i)},lT.text=function(e){return{type:"text",value:e}};var t=lT.emptyElement={first:function(){return null},firstOrEmpty:function(){return t},attributes:{},children:[]};function n(e,t,n){this.type="element",this.name=e,this.attributes=t||{},this.children=n||[]}n.prototype.first=function(t){return e.find(this.children,function(e){return e.name===t})},n.prototype.firstOrEmpty=function(e){return this.first(e)||t},n.prototype.getElementsByTagName=function(t){return r(e.filter(this.children,function(e){return e.name===t}))},n.prototype.text=function(){if(0===this.children.length)return"";if(1!==this.children.length||"text"!==this.children[0].type)throw new Error("Not implemented");return this.children[0].value};var i={getElementsByTagName:function(t){return r(e.flatten(this.map(function(e){return e.getElementsByTagName(t)},!0)))}};function r(t){return e.extend(t,i)}return lT}var dT,uT,fT={},pT={},gT={},mT={},bT={};function vT(){if(dT)return bT;function e(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.freeze?t.freeze(e):e}dT=1;var t=e({HTML:"text/html",isHTML:function(e){return e===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),n=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===n.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return bT.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},bT.find=function(e,t,n){if(void 0===n&&(n=Array.prototype),e&&"function"==typeof n.find)return n.find.call(e,t);for(var i=0;i<e.length;i++)if(Object.prototype.hasOwnProperty.call(e,i)){var r=e[i];if(t.call(void 0,r,i,e))return r}},bT.freeze=e,bT.MIME_TYPE=t,bT.NAMESPACE=n,bT}function yT(){if(uT)return mT;uT=1;var e=vT(),t=e.find,n=e.NAMESPACE;function i(e){return""!==e}function r(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function a(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(i):[]}(e);return Object.keys(t.reduce(r,{}))}function s(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function o(e,t){var n=e.prototype;if(!(n instanceof t)){let i=function(){};i.prototype=t.prototype,i=new i,s(n,i),e.prototype=n=i}n.constructor!=e&&(n.constructor=e)}var c={},l=c.ELEMENT_NODE=1,h=c.ATTRIBUTE_NODE=2,d=c.TEXT_NODE=3,u=c.CDATA_SECTION_NODE=4,f=c.ENTITY_REFERENCE_NODE=5,p=c.ENTITY_NODE=6,g=c.PROCESSING_INSTRUCTION_NODE=7,m=c.COMMENT_NODE=8,b=c.DOCUMENT_NODE=9,v=c.DOCUMENT_TYPE_NODE=10,y=c.DOCUMENT_FRAGMENT_NODE=11,w=c.NOTATION_NODE=12,x={},_={};x.INDEX_SIZE_ERR=(_[1]="Index size error",1),x.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2);var T=x.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3);x.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4),x.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5),x.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6),x.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7);var D=x.NOT_FOUND_ERR=(_[8]="Not found",8);x.NOT_SUPPORTED_ERR=(_[9]="Not supported",9);var E=x.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10);function A(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,_[e]),this.message=_[e],Error.captureStackTrace&&Error.captureStackTrace(this,A);return n.code=e,t&&(this.message=this.message+": "+t),n}function k(){}function S(e,t){this._node=e,this._refresh=t,C(this)}function C(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var n=e._refresh(e._node);if(ge(e,"length",n.length),!e.$$length||n.length<e.$$length)for(var i=n.length;i in e;i++)Object.prototype.hasOwnProperty.call(e,i)&&delete e[i];s(n,e),e._inc=t}}function U(){}function F(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function I(e,t,i,r){if(r?t[F(t,r)]=i:t[t.length++]=i,e){i.ownerElement=e;var a=e.ownerDocument;a&&(r&&W(a,e,r),function(e,t,i){e&&e._inc++,i.namespaceURI===n.XMLNS&&(t._nsMap[i.prefix?i.localName:""]=i.value)}(a,e,i))}}function R(e,t,n){var i=F(t,n);if(!(i>=0))throw new A(D,new Error(e.tagName+"@"+n));for(var r=t.length-1;i<r;)t[i]=t[++i];if(t.length=r,e){var a=e.ownerDocument;a&&(W(a,e,n),n.ownerElement=null)}}function N(){}function M(){}function O(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function P(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(P(e,t))return!0}while(e=e.nextSibling)}function L(){this.ownerDocument=this}function W(e,t,i,r){e&&e._inc++,i.namespaceURI===n.XMLNS&&delete t._nsMap[i.prefix?i.localName:""]}function B(e,t,n){if(e&&e._inc){e._inc++;var i=t.childNodes;if(n)i[i.length++]=n;else{for(var r=t.firstChild,a=0;r;)i[a++]=r,r=r.nextSibling;i.length=a,delete i[i.length]}}}function j(e,t){var n=t.previousSibling,i=t.nextSibling;return n?n.nextSibling=i:e.firstChild=i,i?i.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,B(e.ownerDocument,e),t}function z(e){return e&&e.nodeType===M.DOCUMENT_TYPE_NODE}function H(e){return e&&e.nodeType===M.ELEMENT_NODE}function V(e){return e&&e.nodeType===M.TEXT_NODE}function G(e,n){var i=e.childNodes||[];if(t(i,H)||z(n))return!1;var r=t(i,z);return!(n&&r&&i.indexOf(r)>i.indexOf(n))}function $(e,n){var i=e.childNodes||[];if(t(i,function(e){return H(e)&&e!==n}))return!1;var r=t(i,z);return!(n&&r&&i.indexOf(r)>i.indexOf(n))}function q(e,n,i){var r=e.childNodes||[],a=n.childNodes||[];if(n.nodeType===M.DOCUMENT_FRAGMENT_NODE){var s=a.filter(H);if(s.length>1||t(a,V))throw new A(T,"More than one element or text in fragment");if(1===s.length&&!G(e,i))throw new A(T,"Element in fragment can not be inserted before doctype")}if(H(n)&&!G(e,i))throw new A(T,"Only one element can be added and only after doctype");if(z(n)){if(t(r,z))throw new A(T,"Only one doctype is allowed");var o=t(r,H);if(i&&r.indexOf(o)<r.indexOf(i))throw new A(T,"Doctype can only be inserted before an element");if(!i&&o)throw new A(T,"Doctype can not be appended since element is present")}}function X(e,n,i){var r=e.childNodes||[],a=n.childNodes||[];if(n.nodeType===M.DOCUMENT_FRAGMENT_NODE){var s=a.filter(H);if(s.length>1||t(a,V))throw new A(T,"More than one element or text in fragment");if(1===s.length&&!$(e,i))throw new A(T,"Element in fragment can not be inserted before doctype")}if(H(n)&&!$(e,i))throw new A(T,"Only one element can be added and only after doctype");if(z(n)){if(t(r,function(e){return z(e)&&e!==i}))throw new A(T,"Only one doctype is allowed");var o=t(r,H);if(i&&r.indexOf(o)<r.indexOf(i))throw new A(T,"Doctype can only be inserted before an element")}}function K(e,t,n,i){(function(e,t,n){if(!function(e){return e&&(e.nodeType===M.DOCUMENT_NODE||e.nodeType===M.DOCUMENT_FRAGMENT_NODE||e.nodeType===M.ELEMENT_NODE)}(e))throw new A(T,"Unexpected parent node type "+e.nodeType);if(n&&n.parentNode!==e)throw new A(D,"child not in parent");if(!function(e){return e&&(H(e)||V(e)||z(e)||e.nodeType===M.DOCUMENT_FRAGMENT_NODE||e.nodeType===M.COMMENT_NODE||e.nodeType===M.PROCESSING_INSTRUCTION_NODE)}(t)||z(t)&&e.nodeType!==M.DOCUMENT_NODE)throw new A(T,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,n),e.nodeType===M.DOCUMENT_NODE&&(i||q)(e,t,n);var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===y){var a=t.firstChild;if(null==a)return t;var s=t.lastChild}else a=s=t;var o=n?n.previousSibling:e.lastChild;a.previousSibling=o,s.nextSibling=n,o?o.nextSibling=a:e.firstChild=a,null==n?e.lastChild=s:n.previousSibling=s;do{a.parentNode=e}while(a!==s&&(a=a.nextSibling));return B(e.ownerDocument||e,e),t.nodeType==y&&(t.firstChild=t.lastChild=null),t}function Y(){this._nsMap={}}function Z(){}function J(){}function Q(){}function ee(){}function te(){}function ne(){}function ie(){}function re(){}function ae(){}function se(){}function oe(){}function ce(){}function le(e,t){var n=[],i=9==this.nodeType&&this.documentElement||this,r=i.prefix,a=i.namespaceURI;if(a&&null==r&&null==(r=i.lookupPrefix(a)))var s=[{namespace:a,prefix:null}];return ue(this,n,e,t,s),n.join("")}function he(e,t,i){var r=e.prefix||"",a=e.namespaceURI;if(!a)return!1;if("xml"===r&&a===n.XML||a===n.XMLNS)return!1;for(var s=i.length;s--;){var o=i[s];if(o.prefix===r)return o.namespace!==a}return!0}function de(e,t,n){e.push(" ",t,'="',n.replace(/[<>&"\t\n\r]/g,O),'"')}function ue(e,t,i,r,a){if(a||(a=[]),r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case l:var s=e.attributes,o=s.length,c=e.firstChild,p=e.tagName,w=p;if(!(i=n.isHTML(e.namespaceURI)||i)&&!e.prefix&&e.namespaceURI){for(var x,_=0;_<s.length;_++)if("xmlns"===s.item(_).name){x=s.item(_).value;break}if(!x)for(var T=a.length-1;T>=0;T--)if(""===(D=a[T]).prefix&&D.namespace===e.namespaceURI){x=D.namespace;break}if(x!==e.namespaceURI)for(T=a.length-1;T>=0;T--){var D;if((D=a[T]).namespace===e.namespaceURI){D.prefix&&(w=D.prefix+":"+p);break}}}t.push("<",w);for(var E=0;E<o;E++)"xmlns"==(A=s.item(E)).prefix?a.push({prefix:A.localName,namespace:A.value}):"xmlns"==A.nodeName&&a.push({prefix:"",namespace:A.value});for(E=0;E<o;E++){var A,k,S;he(A=s.item(E),0,a)&&(de(t,(k=A.prefix||"")?"xmlns:"+k:"xmlns",S=A.namespaceURI),a.push({prefix:k,namespace:S})),ue(A,t,i,r,a)}if(p===w&&he(e,0,a)&&(de(t,(k=e.prefix||"")?"xmlns:"+k:"xmlns",S=e.namespaceURI),a.push({prefix:k,namespace:S})),c||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(p)){if(t.push(">"),i&&/^script$/i.test(p))for(;c;)c.data?t.push(c.data):ue(c,t,i,r,a.slice()),c=c.nextSibling;else for(;c;)ue(c,t,i,r,a.slice()),c=c.nextSibling;t.push("</",w,">")}else t.push("/>");return;case b:case y:for(c=e.firstChild;c;)ue(c,t,i,r,a.slice()),c=c.nextSibling;return;case h:return de(t,e.name,e.value);case d:return t.push(e.data.replace(/[<&>]/g,O));case u:return t.push("<![CDATA[",e.data,"]]>");case m:return t.push("\x3c!--",e.data,"--\x3e");case v:var C=e.publicId,U=e.systemId;if(t.push("<!DOCTYPE ",e.name),C)t.push(" PUBLIC ",C),U&&"."!=U&&t.push(" ",U),t.push(">");else if(U&&"."!=U)t.push(" SYSTEM ",U,">");else{var F=e.internalSubset;F&&t.push(" [",F,"]"),t.push(">")}return;case g:return t.push("<?",e.target," ",e.data,"?>");case f:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function fe(e,t,n){var i;switch(t.nodeType){case l:(i=t.cloneNode(!1)).ownerDocument=e;case y:break;case h:n=!0}if(i||(i=t.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,n)for(var r=t.firstChild;r;)i.appendChild(fe(e,r,n)),r=r.nextSibling;return i}function pe(e,t,n){var i=new t.constructor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=t[r];"object"!=typeof a&&a!=i[r]&&(i[r]=a)}switch(t.childNodes&&(i.childNodes=new k),i.ownerDocument=e,i.nodeType){case l:var s=t.attributes,o=i.attributes=new U,c=s.length;o._ownerElement=i;for(var d=0;d<c;d++)i.setAttributeNode(pe(e,s.item(d),!0));break;case h:n=!0}if(n)for(var u=t.firstChild;u;)i.appendChild(pe(e,u,n)),u=u.nextSibling;return i}function ge(e,t,n){e[t]=n}x.INVALID_STATE_ERR=(_[11]="Invalid state",11),x.SYNTAX_ERR=(_[12]="Syntax error",12),x.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13),x.NAMESPACE_ERR=(_[14]="Invalid namespace",14),x.INVALID_ACCESS_ERR=(_[15]="Invalid access",15),A.prototype=Error.prototype,s(x,A),k.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var n=[],i=0;i<this.length;i++)ue(this[i],n,e,t);return n.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},S.prototype.item=function(e){return C(this),this[e]||null},o(S,k),U.prototype={length:0,item:k.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new A(E);var n=this.getNamedItem(e.nodeName);return I(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new A(E);return t=this.getNamedItemNS(e.namespaceURI,e.localName),I(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return R(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return R(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var i=this[n];if(i.localName==t&&i.namespaceURI==e)return i}return null}},N.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var i=new L;if(i.implementation=this,i.childNodes=new k,i.doctype=n||null,n&&i.appendChild(n),t){var r=i.createElementNS(e,t);i.appendChild(r)}return i},createDocumentType:function(e,t,n){var i=new ne;return i.name=e,i.nodeName=e,i.publicId=t||"",i.systemId=n||"",i}},M.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return K(this,e,t)},replaceChild:function(e,t){K(this,e,t,X),t&&this.removeChild(t)},removeChild:function(e){return j(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return pe(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==d&&e.nodeType==d?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&n[i]===e)return i;t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},s(c,M),s(c,M.prototype),L.prototype={nodeName:"#document",nodeType:b,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==y){for(var n=e.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,t),n=i}return e}return K(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===l&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),j(this,e)},replaceChild:function(e,t){K(this,e,t,X),e.ownerDocument=this,t&&this.removeChild(t),H(e)&&(this.documentElement=e)},importNode:function(e,t){return fe(this,e,t)},getElementById:function(e){var t=null;return P(this.documentElement,function(n){if(n.nodeType==l&&n.getAttribute("id")==e)return t=n,!0}),t},getElementsByClassName:function(e){var t=a(e);return new S(this,function(n){var i=[];return t.length>0&&P(n.documentElement,function(r){if(r!==n&&r.nodeType===l){var s=r.getAttribute("class");if(s){var o=e===s;if(!o){var c=a(s);o=t.every((h=c,function(e){return h&&-1!==h.indexOf(e)}))}o&&i.push(r)}}var h}),i})},createElement:function(e){var t=new Y;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new k,(t.attributes=new U)._ownerElement=t,t},createDocumentFragment:function(){var e=new se;return e.ownerDocument=this,e.childNodes=new k,e},createTextNode:function(e){var t=new Q;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new ee;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new te;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new oe;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new Z;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ae;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new Y,i=t.split(":"),r=n.attributes=new U;return n.childNodes=new k,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new Z,i=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,n}},o(L,M),Y.prototype={nodeType:l,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===y?this.insertBefore(e,null):function(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,B(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new S(this,function(t){var n=[];return P(t,function(i){i===t||i.nodeType!=l||"*"!==e&&i.tagName!=e||n.push(i)}),n})},getElementsByTagNameNS:function(e,t){return new S(this,function(n){var i=[];return P(n,function(r){r===n||r.nodeType!==l||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||i.push(r)}),i})}},L.prototype.getElementsByTagName=Y.prototype.getElementsByTagName,L.prototype.getElementsByTagNameNS=Y.prototype.getElementsByTagNameNS,o(Y,M),Z.prototype.nodeType=h,o(Z,M),J.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[T])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},o(J,M),Q.prototype={nodeName:"#text",nodeType:d,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},o(Q,J),ee.prototype={nodeName:"#comment",nodeType:m},o(ee,J),te.prototype={nodeName:"#cdata-section",nodeType:u},o(te,J),ne.prototype.nodeType=v,o(ne,M),ie.prototype.nodeType=w,o(ie,M),re.prototype.nodeType=p,o(re,M),ae.prototype.nodeType=f,o(ae,M),se.prototype.nodeName="#document-fragment",se.prototype.nodeType=y,o(se,M),oe.prototype.nodeType=g,o(oe,M),ce.prototype.serializeToString=function(e,t,n){return le.call(e,t,n)},M.prototype.toString=le;try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case l:case y:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}};Object.defineProperty(S.prototype,"length",{get:function(){return C(this),this.$$length}}),Object.defineProperty(M.prototype,"textContent",{get:function(){return e(this)},set:function(e){switch(this.nodeType){case l:case y:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ge=function(e,t,n){e["$$"+t]=n}}}catch(me){}return mT.DocumentType=ne,mT.DOMException=A,mT.DOMImplementation=N,mT.Element=Y,mT.Node=M,mT.NodeList=k,mT.XMLSerializer=ce,mT}var wT,xT,_T,TT,DT,ET,AT={},kT={},ST={};function CT(){if(xT)return ST;xT=1;var e=vT().NAMESPACE,t=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+t.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+t.source+n.source+"*(?::"+t.source+n.source+"*)?$");function r(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,r)}function a(){}function s(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function o(t,n,i,r,a,s){function o(e,t,n){i.attributeNames.hasOwnProperty(e)&&s.fatalError("Attribute "+e+" redefined"),i.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,a),n)}for(var c,l=++n,h=0;;){var d=t.charAt(l);switch(d){case"=":if(1===h)c=t.slice(n,l),h=3;else{if(2!==h)throw new Error("attribute equal must after attrName");h=3}break;case"'":case'"':if(3===h||1===h){if(1===h&&(s.warning('attribute value must after "="'),c=t.slice(n,l)),n=l+1,!((l=t.indexOf(d,n))>0))throw new Error("attribute value no end '"+d+"' match");o(c,u=t.slice(n,l),n-1),h=5}else{if(4!=h)throw new Error('attribute value must after "="');o(c,u=t.slice(n,l),n),s.warning('attribute "'+c+'" missed start quot('+d+")!!"),n=l+1,h=5}break;case"/":switch(h){case 0:i.setTagName(t.slice(n,l));case 5:case 6:case 7:h=7,i.closed=!0;case 4:case 1:break;case 2:i.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),0==h&&i.setTagName(t.slice(n,l)),l;case">":switch(h){case 0:i.setTagName(t.slice(n,l));case 5:case 6:case 7:break;case 4:case 1:"/"===(u=t.slice(n,l)).slice(-1)&&(i.closed=!0,u=u.slice(0,-1));case 2:2===h&&(u=c),4==h?(s.warning('attribute "'+u+'" missed quot(")!'),o(c,u,n)):(e.isHTML(r[""])&&u.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),o(u,u,n));break;case 3:throw new Error("attribute value missed!!")}return l;case"":d=" ";default:if(d<=" ")switch(h){case 0:i.setTagName(t.slice(n,l)),h=6;break;case 1:c=t.slice(n,l),h=2;break;case 4:var u=t.slice(n,l);s.warning('attribute "'+u+'" missed quot(")!!'),o(c,u,n);case 5:h=6}else switch(h){case 2:i.tagName,e.isHTML(r[""])&&c.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!'),o(c,c,n),n=l,h=1;break;case 5:s.warning('attribute space is required"'+c+'"!!');case 6:h=1,n=l;break;case 3:h=4,n=l;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function c(t,n,i){for(var r=t.tagName,a=null,s=t.length;s--;){var o=t[s],c=o.qName,l=o.value;if((p=c.indexOf(":"))>0)var h=o.prefix=c.slice(0,p),u=c.slice(p+1),f="xmlns"===h&&u;else u=c,h=null,f="xmlns"===c&&"";o.localName=u,!1!==f&&(null==a&&(a={},d(i,i={})),i[f]=a[f]=l,o.uri=e.XMLNS,n.startPrefixMapping(f,l))}for(s=t.length;s--;)(h=(o=t[s]).prefix)&&("xml"===h&&(o.uri=e.XML),"xmlns"!==h&&(o.uri=i[h||""]));var p;(p=r.indexOf(":"))>0?(h=t.prefix=r.slice(0,p),u=t.localName=r.slice(p+1)):(h=null,u=t.localName=r);var g=t.uri=i[h||""];if(n.startElement(g,u,r,t),!t.closed)return t.currentNSMap=i,t.localNSMap=a,!0;if(n.endElement(g,u,r),a)for(h in a)Object.prototype.hasOwnProperty.call(a,h)&&n.endPrefixMapping(h)}function l(e,t,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),s=e.substring(t+1,a);if(/[&<]/.test(s))return/^script$/i.test(n)?(r.characters(s,0,s.length),a):(s=s.replace(/&#?\w+;/g,i),r.characters(s,0,s.length),a)}return t+1}function h(e,t,n,i){var r=i[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),i[n]=r),r<t}function d(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function u(e,t,n,i){if("-"===e.charAt(t+2))return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(i.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var a=function(e,t){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=t,r.exec(e);n=r.exec(e);)if(i.push(n),n[1])return i}(e,t),s=a.length;if(s>1&&/!doctype/i.test(a[0][0])){var o=a[1][0],c=!1,l=!1;s>3&&(/^public$/i.test(a[2][0])?(c=a[3][0],l=s>4&&a[4][0]):/^system$/i.test(a[2][0])&&(l=a[3][0]));var h=a[s-1];return n.startDTD(o,c,l),n.endDTD(),h.index+h[0].length}return-1}function f(e,t,n){var i=e.indexOf("?>",t);if(i){var r=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,n.processingInstruction(r[1],r[2]),i+2):-1}return-1}function p(){this.attributeNames={}}return r.prototype=new Error,r.prototype.name=r.name,a.prototype={parse:function(t,n,i){var a=this.domBuilder;a.startDocument(),d(n,n={}),function(t,n,i,a,d){function g(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(i,t)?i[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(d.error("entity not found:"+e),e)}function m(e){if(e>D){var n=t.substring(D,e).replace(/&#?\w+;/g,g);x&&b(D),a.characters(n,0,e-D),D=e}}function b(e,n){for(;e>=y&&(n=w.exec(t));)v=n.index,y=v+n[0].length,x.lineNumber++;x.columnNumber=e-v+1}for(var v=0,y=0,w=/.*(?:\r\n?|\n)|.*$/g,x=a.locator,_=[{currentNSMap:n}],T={},D=0;;){try{var E=t.indexOf("<",D);if(E<0){if(!t.substr(D).match(/^\s*$/)){var A=a.doc,k=A.createTextNode(t.substr(D));A.appendChild(k),a.currentElement=k}return}switch(E>D&&m(E),t.charAt(E+1)){case"/":var S=t.indexOf(">",E+3),C=t.substring(E+2,S).replace(/[ \t\n\r]+$/g,""),U=_.pop();S<0?(C=t.substring(E+2).replace(/[\s<].*/,""),d.error("end tag name: "+C+" is not complete:"+U.tagName),S=E+1+C.length):C.match(/\s</)&&(C=C.replace(/[\s<].*/,""),d.error("end tag name: "+C+" maybe not complete"),S=E+1+C.length);var F=U.localNSMap,I=U.tagName==C;if(I||U.tagName&&U.tagName.toLowerCase()==C.toLowerCase()){if(a.endElement(U.uri,U.localName,C),F)for(var R in F)Object.prototype.hasOwnProperty.call(F,R)&&a.endPrefixMapping(R);I||d.fatalError("end tag name: "+C+" is not match the current start tagName:"+U.tagName)}else _.push(U);S++;break;case"?":x&&b(E),S=f(t,E,a);break;case"!":x&&b(E),S=u(t,E,a,d);break;default:x&&b(E);var N=new p,M=_[_.length-1].currentNSMap,O=(S=o(t,E,N,M,g,d),N.length);if(!N.closed&&h(t,S,N.tagName,T)&&(N.closed=!0,i.nbsp||d.warning("unclosed xml attribute")),x&&O){for(var P=s(x,{}),L=0;L<O;L++){var W=N[L];b(W.offset),W.locator=s(x,{})}a.locator=P,c(N,a,M)&&_.push(N),a.locator=x}else c(N,a,M)&&_.push(N);e.isHTML(N.uri)&&!N.closed?S=l(t,S,N.tagName,g,a):S++}}catch(B){if(B instanceof r)throw B;d.error("element parse error: "+B),S=-1}S>D?D=S:m(Math.max(E,D)+1)}}(t,n,i,a,this.errorHandler),a.endDocument()}},p.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},ST.XMLReader=a,ST.ParseError=r,ST}function UT(){if(DT)return pT;DT=1;var e=function(){if(TT)return gT;TT=1;var e=yT();return gT.DOMImplementation=e.DOMImplementation,gT.XMLSerializer=e.XMLSerializer,gT.DOMParser=function(){if(_T)return AT;_T=1;var e,t,n=vT(),i=yT(),r=(wT||(wT=1,e=kT,t=vT().freeze,e.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=t({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),e.entityMap=e.HTML_ENTITIES),kT),a=CT(),s=i.DOMImplementation,o=n.NAMESPACE,c=a.ParseError,l=a.XMLReader;function h(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function d(e){this.options=e||{locator:{}}}function u(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function p(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function g(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}return d.prototype.parseFromString=function(e,t){var n=this.options,i=new l,a=n.domBuilder||new u,s=n.errorHandler,c=n.locator,d=n.xmlns||{},f=/\/x?html?$/.test(t),p=f?r.HTML_ENTITIES:r.XML_ENTITIES;c&&a.setDocumentLocator(c),i.errorHandler=function(e,t,n){if(!e){if(t instanceof u)return t;e=t}var i={},r=e instanceof Function;function a(t){var a=e[t];!a&&r&&(a=2==e.length?function(n){e(t,n)}:e),i[t]=a&&function(e){a("[xmldom "+t+"]\t"+e+function(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}(n))}||function(){}}return n=n||{},a("warning"),a("error"),a("fatalError"),i}(s,a,c),i.domBuilder=n.domBuilder||a,f&&(d[""]=o.HTML),d.xml=d.xml||o.XML;var g=n.normalizeLineEndings||h;return e&&"string"==typeof e?i.parse(g(e),d,p):i.errorHandler.error("invalid doc source"),a.doc},u.prototype={startDocument:function(){this.doc=(new s).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,i){var r=this.doc,a=r.createElementNS(e,n||t),s=i.length;g(this,a),this.currentElement=a,this.locator&&f(this.locator,a);for(var o=0;o<s;o++){e=i.getURI(o);var c=i.getValue(o),l=(n=i.getQName(o),r.createAttributeNS(e,n));this.locator&&f(i.getLocator(o),l),l.value=l.nodeValue=c,a.setAttributeNode(l)}},endElement:function(e,t,n){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,n),g(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=p.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&f(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=p.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&f(this.locator,i),g(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(e,t,n);this.locator&&f(this.locator,r),g(this,r),this.doc.doctype=r}},warning:function(e){},error:function(e){},fatalError:function(e){throw new c(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){u.prototype[e]=function(){return null}}),AT.__DOMHandler=u,AT.normalizeLineEndings=h,AT.DOMParser=d,AT}().DOMParser,gT}(),t=yT();return pT.parseFromString=function(t){var n=null,i=new e.DOMParser({errorHandler:function(e,t){n={level:e,message:t}}}).parseFromString(t);if(null===n)return i;throw new Error(n.level+": "+n.message)},pT.Node=t.Node,pT}var FT,IT={},RT={},NT={};function MT(){return FT||(FT=1,function(){var e,t,n,i,r,a,s,o=[].slice,c={}.hasOwnProperty;e=function(){var e,t,n,i,a,s;if(s=arguments[0],a=2<=arguments.length?o.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(e=0,n=a.length;e<n;e++)if(null!=(i=a[e]))for(t in i)c.call(i,t)&&(s[t]=i[t]);return s},r=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},a=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},n=function(e){return r(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},i=function(e){var t;if(n(e))return!e.length;for(t in e)if(c.call(e,t))return!1;return!0},s=function(e){var t,n;return a(e)&&(n=Object.getPrototypeOf(e))&&(t=n.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},t=function(e){return r(e.valueOf)?e.valueOf():e},NT.assign=e,NT.isFunction=r,NT.isObject=a,NT.isArray=n,NT.isEmpty=i,NT.isPlainObject=s,NT.getValue=t}.call(NT)),NT}var OT,PT={exports:{}},LT={exports:{}},WT={exports:{}},BT={exports:{}},jT=BT.exports;function zT(){return OT||(OT=1,function(){BT.exports=function(){function e(e,t,n){if(this.options=e.options,this.stringify=e.stringify,this.parent=e,null==t)throw new Error("Missing attribute name. "+this.debugInfo(t));if(null==n)throw new Error("Missing attribute value. "+this.debugInfo(t));this.name=this.stringify.attName(t),this.value=this.stringify.attValue(n)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.set(e).attribute(this)},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e}()}.call(jT)),BT.exports}var HT,VT=WT.exports;function GT(){return HT||(HT=1,function(){var e,t,n,i,r,a,s={}.hasOwnProperty;a=MT(),r=a.isObject,i=a.isFunction,n=a.getValue,t=zD(),e=zT(),WT.exports=function(t){function a(e,t,n){if(a.__super__.constructor.call(this,e),null==t)throw new Error("Missing element name. "+this.debugInfo());this.name=this.stringify.eleName(t),this.attributes={},null!=n&&this.attribute(n),e.isDocument&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this)}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(a,t),a.prototype.clone=function(){var e,t,n,i;for(t in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attributes={},i=this.attributes)s.call(i,t)&&(e=i[t],n.attributes[t]=e.clone());return n.children=[],this.children.forEach(function(e){var t;return(t=e.clone()).parent=n,n.children.push(t)}),n},a.prototype.attribute=function(t,a){var o,c;if(null!=t&&(t=n(t)),r(t))for(o in t)s.call(t,o)&&(c=t[o],this.attribute(o,c));else i(a)&&(a=a.apply()),this.options.skipNullAttributes&&null==a||(this.attributes[t]=new e(this,t,a));return this},a.prototype.removeAttribute=function(e){var t,i,r;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=n(e),Array.isArray(e))for(i=0,r=e.length;i<r;i++)t=e[i],delete this.attributes[t];else delete this.attributes[e];return this},a.prototype.toString=function(e){return this.options.writer.set(e).element(this)},a.prototype.att=function(e,t){return this.attribute(e,t)},a.prototype.a=function(e,t){return this.attribute(e,t)},a}(t)}.call(VT)),WT.exports}var $T,qT={exports:{}},XT=qT.exports;function KT(){return $T||($T=1,function(){var e,t={}.hasOwnProperty;e=zD(),qT.exports=function(e){function n(e,t){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing CDATA text. "+this.debugInfo());this.text=this.stringify.cdata(t)}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).cdata(this)},n}(e)}.call(XT)),qT.exports}var YT,ZT={exports:{}},JT=ZT.exports;function QT(){return YT||(YT=1,function(){var e,t={}.hasOwnProperty;e=zD(),ZT.exports=function(e){function n(e,t){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing comment text. "+this.debugInfo());this.text=this.stringify.comment(t)}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).comment(this)},n}(e)}.call(JT)),ZT.exports}var eD,tD={exports:{}},nD=tD.exports;function iD(){return eD||(eD=1,function(){var e,t,n={}.hasOwnProperty;t=MT().isObject,e=zD(),tD.exports=function(e){function i(e,n,r,a){var s;i.__super__.constructor.call(this,e),t(n)&&(n=(s=n).version,r=s.encoding,a=s.standalone),n||(n="1.0"),this.version=this.stringify.xmlVersion(n),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=a&&(this.standalone=this.stringify.xmlStandalone(a))}return function(e,t){for(var i in t)n.call(t,i)&&(e[i]=t[i]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(i,e),i.prototype.toString=function(e){return this.options.writer.set(e).declaration(this)},i}(e)}.call(nD)),tD.exports}var rD,aD={exports:{}},sD={exports:{}},oD=sD.exports;function cD(){return rD||(rD=1,function(){var e,t={}.hasOwnProperty;e=zD(),sD.exports=function(e){function n(e,t,i,r,a,s){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==i)throw new Error("Missing DTD attribute name. "+this.debugInfo(t));if(!r)throw new Error("Missing DTD attribute type. "+this.debugInfo(t));if(!a)throw new Error("Missing DTD attribute default. "+this.debugInfo(t));if(0!==a.indexOf("#")&&(a="#"+a),!a.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(t));if(s&&!a.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(t));this.elementName=this.stringify.eleName(t),this.attributeName=this.stringify.attName(i),this.attributeType=this.stringify.dtdAttType(r),this.defaultValue=this.stringify.dtdAttDefault(s),this.defaultValueType=a}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.set(e).dtdAttList(this)},n}(e)}.call(oD)),sD.exports}var lD,hD={exports:{}},dD=hD.exports;function uD(){return lD||(lD=1,function(){var e,t,n={}.hasOwnProperty;t=MT().isObject,e=zD(),hD.exports=function(e){function i(e,n,r,a){if(i.__super__.constructor.call(this,e),null==r)throw new Error("Missing DTD entity name. "+this.debugInfo(r));if(null==a)throw new Error("Missing DTD entity value. "+this.debugInfo(r));if(this.pe=!!n,this.name=this.stringify.eleName(r),t(a)){if(!a.pubID&&!a.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(r));if(a.pubID&&!a.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(r));if(null!=a.pubID&&(this.pubID=this.stringify.dtdPubID(a.pubID)),null!=a.sysID&&(this.sysID=this.stringify.dtdSysID(a.sysID)),null!=a.nData&&(this.nData=this.stringify.dtdNData(a.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(r))}else this.value=this.stringify.dtdEntityValue(a)}return function(e,t){for(var i in t)n.call(t,i)&&(e[i]=t[i]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(i,e),i.prototype.toString=function(e){return this.options.writer.set(e).dtdEntity(this)},i}(e)}.call(dD)),hD.exports}var fD,pD={exports:{}},gD=pD.exports;function mD(){return fD||(fD=1,function(){var e,t={}.hasOwnProperty;e=zD(),pD.exports=function(e){function n(e,t,i){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing DTD element name. "+this.debugInfo());i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.eleName(t),this.value=this.stringify.dtdElementValue(i)}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.set(e).dtdElement(this)},n}(e)}.call(gD)),pD.exports}var bD,vD={exports:{}},yD=vD.exports;function wD(){return bD||(bD=1,function(){var e,t={}.hasOwnProperty;e=zD(),vD.exports=function(e){function n(e,t,i){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing DTD notation name. "+this.debugInfo(t));if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(t));this.name=this.stringify.eleName(t),null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.set(e).dtdNotation(this)},n}(e)}.call(yD)),vD.exports}var xD,_D=aD.exports;function TD(){return xD||(xD=1,function(){var e,t,n,i,r,a,s={}.hasOwnProperty;a=MT().isObject,r=zD(),e=cD(),n=uD(),t=mD(),i=wD(),aD.exports=function(r){function o(e,t,n){var i,r;o.__super__.constructor.call(this,e),this.name="!DOCTYPE",this.documentObject=e,a(t)&&(t=(i=t).pubID,n=i.sysID),null==n&&(n=(r=[t,n])[0],t=r[1]),null!=t&&(this.pubID=this.stringify.dtdPubID(t)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(o,r),o.prototype.element=function(e,n){var i;return i=new t(this,e,n),this.children.push(i),this},o.prototype.attList=function(t,n,i,r,a){var s;return s=new e(this,t,n,i,r,a),this.children.push(s),this},o.prototype.entity=function(e,t){var i;return i=new n(this,!1,e,t),this.children.push(i),this},o.prototype.pEntity=function(e,t){var i;return i=new n(this,!0,e,t),this.children.push(i),this},o.prototype.notation=function(e,t){var n;return n=new i(this,e,t),this.children.push(n),this},o.prototype.toString=function(e){return this.options.writer.set(e).docType(this)},o.prototype.ele=function(e,t){return this.element(e,t)},o.prototype.att=function(e,t,n,i,r){return this.attList(e,t,n,i,r)},o.prototype.ent=function(e,t){return this.entity(e,t)},o.prototype.pent=function(e,t){return this.pEntity(e,t)},o.prototype.not=function(e,t){return this.notation(e,t)},o.prototype.up=function(){return this.root()||this.documentObject},o}(r)}.call(_D)),aD.exports}var DD,ED={exports:{}},AD=ED.exports;function kD(){return DD||(DD=1,function(){var e,t={}.hasOwnProperty;e=zD(),ED.exports=function(e){function n(e,t){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing raw text. "+this.debugInfo());this.value=this.stringify.raw(t)}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).raw(this)},n}(e)}.call(AD)),ED.exports}var SD,CD={exports:{}},UD=CD.exports;function FD(){return SD||(SD=1,function(){var e,t={}.hasOwnProperty;e=zD(),CD.exports=function(e){function n(e,t){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing element text. "+this.debugInfo());this.value=this.stringify.eleText(t)}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).text(this)},n}(e)}.call(UD)),CD.exports}var ID,RD={exports:{}},ND=RD.exports;function MD(){return ID||(ID=1,function(){var e,t={}.hasOwnProperty;e=zD(),RD.exports=function(e){function n(e,t,i){if(n.__super__.constructor.call(this,e),null==t)throw new Error("Missing instruction target. "+this.debugInfo());this.target=this.stringify.insTarget(t),i&&(this.value=this.stringify.insValue(i))}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).processingInstruction(this)},n}(e)}.call(ND)),RD.exports}var OD,PD={exports:{}},LD=PD.exports;function WD(){return OD||(OD=1,function(){var e,t={}.hasOwnProperty;e=zD(),PD.exports=function(e){function n(e){n.__super__.constructor.call(this,e),this.isDummy=!0}return function(e,n){for(var i in n)t.call(n,i)&&(e[i]=n[i]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return""},n}(e)}.call(LD)),PD.exports}var BD,jD=LT.exports;function zD(){return BD||(BD=1,function(){var e,t,n,i,r,a,s,o,c,l,h,d,u,f,p={}.hasOwnProperty;f=MT(),u=f.isObject,d=f.isFunction,h=f.isEmpty,l=f.getValue,a=null,e=null,t=null,n=null,i=null,o=null,c=null,s=null,r=null,LT.exports=function(){function f(l){this.parent=l,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],a||(a=GT(),e=KT(),t=QT(),n=iD(),i=TD(),o=kD(),c=FD(),s=MD(),r=WD())}return f.prototype.element=function(e,t,n){var i,r,a,s,o,c,f,g,m,b,v;if(c=null,null===t&&null==n&&(t=(m=[{},null])[0],n=m[1]),null==t&&(t={}),t=l(t),u(t)||(n=(b=[t,n])[0],t=b[1]),null!=e&&(e=l(e)),Array.isArray(e))for(a=0,f=e.length;a<f;a++)r=e[a],c=this.element(r);else if(d(e))c=this.element(e.apply());else if(u(e)){for(o in e)if(p.call(e,o))if(v=e[o],d(v)&&(v=v.apply()),u(v)&&h(v)&&(v=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===o.indexOf(this.stringify.convertAttKey))c=this.attribute(o.substr(this.stringify.convertAttKey.length),v);else if(!this.options.separateArrayItems&&Array.isArray(v))for(s=0,g=v.length;s<g;s++)r=v[s],(i={})[o]=r,c=this.element(i);else u(v)?(c=this.element(o)).element(v):c=this.element(o,v)}else c=this.options.skipNullNodes&&null===n?this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),n):this.node(e,t,n);if(null==c)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return c},f.prototype.insertBefore=function(e,t,n){var i,r,a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i},f.prototype.insertAfter=function(e,t,n){var i,r,a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r+1),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i},f.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},f.prototype.node=function(e,t,n){var i,r;return null!=e&&(e=l(e)),t||(t={}),t=l(t),u(t)||(n=(r=[t,n])[0],t=r[1]),i=new a(this,e,t),null!=n&&i.text(n),this.children.push(i),i},f.prototype.text=function(e){var t;return t=new c(this,e),this.children.push(t),this},f.prototype.cdata=function(t){var n;return n=new e(this,t),this.children.push(n),this},f.prototype.comment=function(e){var n;return n=new t(this,e),this.children.push(n),this},f.prototype.commentBefore=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},f.prototype.commentAfter=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},f.prototype.raw=function(e){var t;return t=new o(this,e),this.children.push(t),this},f.prototype.dummy=function(){var e;return e=new r(this),this.children.push(e),e},f.prototype.instruction=function(e,t){var n,i,r,a,o;if(null!=e&&(e=l(e)),null!=t&&(t=l(t)),Array.isArray(e))for(a=0,o=e.length;a<o;a++)n=e[a],this.instruction(n);else if(u(e))for(n in e)p.call(e,n)&&(i=e[n],this.instruction(n,i));else d(t)&&(t=t.apply()),r=new s(this,e,t),this.children.push(r);return this},f.prototype.instructionBefore=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},f.prototype.instructionAfter=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},f.prototype.declaration=function(e,t,i){var r,a;return r=this.document(),a=new n(r,e,t,i),r.children[0]instanceof n?r.children[0]=a:r.children.unshift(a),r.root()||r},f.prototype.doctype=function(e,t){var n,r,a,s,o,c,l,h,d;for(n=this.document(),r=new i(n,e,t),a=s=0,c=(h=n.children).length;s<c;a=++s)if(h[a]instanceof i)return n.children[a]=r,r;for(a=o=0,l=(d=n.children).length;o<l;a=++o)if(d[a].isRoot)return n.children.splice(a,0,r),r;return n.children.push(r),r},f.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},f.prototype.root=function(){var e;for(e=this;e;){if(e.isDocument)return e.rootObject;if(e.isRoot)return e;e=e.parent}},f.prototype.document=function(){var e;for(e=this;e;){if(e.isDocument)return e;e=e.parent}},f.prototype.end=function(e){return this.document().end(e)},f.prototype.prev=function(){var e;for(e=this.parent.children.indexOf(this);e>0&&this.parent.children[e-1].isDummy;)e-=1;if(e<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},f.prototype.next=function(){var e;for(e=this.parent.children.indexOf(this);e<this.parent.children.length-1&&this.parent.children[e+1].isDummy;)e+=1;if(-1===e||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},f.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},f.prototype.debugInfo=function(e){var t,n;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},f.prototype.ele=function(e,t,n){return this.element(e,t,n)},f.prototype.nod=function(e,t,n){return this.node(e,t,n)},f.prototype.txt=function(e){return this.text(e)},f.prototype.dat=function(e){return this.cdata(e)},f.prototype.com=function(e){return this.comment(e)},f.prototype.ins=function(e,t){return this.instruction(e,t)},f.prototype.doc=function(){return this.document()},f.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},f.prototype.dtd=function(e,t){return this.doctype(e,t)},f.prototype.e=function(e,t,n){return this.element(e,t,n)},f.prototype.n=function(e,t,n){return this.node(e,t,n)},f.prototype.t=function(e){return this.text(e)},f.prototype.d=function(e){return this.cdata(e)},f.prototype.c=function(e){return this.comment(e)},f.prototype.r=function(e){return this.raw(e)},f.prototype.i=function(e,t){return this.instruction(e,t)},f.prototype.u=function(){return this.up()},f.prototype.importXMLBuilder=function(e){return this.importDocument(e)},f}()}.call(jD)),LT.exports}var HD,VD={exports:{}},GD=VD.exports;function $D(){return HD||(HD=1,function(){var e={}.hasOwnProperty;VD.exports=function(){function t(t){var n,i,r,a,s;for(r in this.assertLegalChar=(n=this.assertLegalChar,i=this,function(){return n.apply(i,arguments)}),t||(t={}),this.noDoubleEncoding=t.noDoubleEncoding,a=t.stringify||{})e.call(a,r)&&(s=a[r],this[r]=s)}return t.prototype.eleName=function(e){return e=""+e||"",this.assertLegalChar(e)},t.prototype.eleText=function(e){return e=""+e||"",this.assertLegalChar(this.elEscape(e))},t.prototype.cdata=function(e){return e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e)},t.prototype.comment=function(e){if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},t.prototype.raw=function(e){return""+e||""},t.prototype.attName=function(e){return""+e||""},t.prototype.attValue=function(e){return e=""+e||"",this.attEscape(e)},t.prototype.insTarget=function(e){return""+e||""},t.prototype.insValue=function(e){if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return e},t.prototype.xmlVersion=function(e){if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},t.prototype.xmlEncoding=function(e){if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return e},t.prototype.xmlStandalone=function(e){return e?"yes":"no"},t.prototype.dtdPubID=function(e){return""+e||""},t.prototype.dtdSysID=function(e){return""+e||""},t.prototype.dtdElementValue=function(e){return""+e||""},t.prototype.dtdAttType=function(e){return""+e||""},t.prototype.dtdAttDefault=function(e){return null!=e?""+e||"":e},t.prototype.dtdEntityValue=function(e){return""+e||""},t.prototype.dtdNData=function(e){return""+e||""},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(e){var t;if(t=e.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/))throw new Error("Invalid character in string: "+e+" at index "+t.index);return e},t.prototype.elEscape=function(e){var t;return t=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},t.prototype.attEscape=function(e){var t;return t=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},t}()}.call(GD)),VD.exports}var qD,XD={exports:{}},KD={exports:{}},YD=KD.exports;function ZD(){return qD||(qD=1,function(){var e={}.hasOwnProperty;KD.exports=function(){function t(t){var n,i,r,a,s,o,c,l,h;for(n in t||(t={}),this.pretty=t.pretty||!1,this.allowEmpty=null!=(i=t.allowEmpty)&&i,this.pretty?(this.indent=null!=(r=t.indent)?r:"  ",this.newline=null!=(a=t.newline)?a:"\n",this.offset=null!=(s=t.offset)?s:0,this.dontprettytextnodes=null!=(o=t.dontprettytextnodes)?o:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=null!=(c=t.spacebeforeslash)?c:"",!0===this.spacebeforeslash&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,l=t.writer||{})e.call(l,n)&&(h=l[n],this[n]=h)}return t.prototype.set=function(t){var n,i,r;for(n in t||(t={}),"pretty"in t&&(this.pretty=t.pretty),"allowEmpty"in t&&(this.allowEmpty=t.allowEmpty),this.pretty?(this.indent="indent"in t?t.indent:"  ",this.newline="newline"in t?t.newline:"\n",this.offset="offset"in t?t.offset:0,this.dontprettytextnodes="dontprettytextnodes"in t?t.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in t?t.spacebeforeslash:"",!0===this.spacebeforeslash&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,i=t.writer||{})e.call(i,n)&&(r=i[n],this[n]=r);return this},t.prototype.space=function(e){var t;return this.pretty&&(t=(e||0)+this.offset+1)>0?new Array(t).join(this.indent):""},t}()}.call(YD)),KD.exports}var JD,QD=XD.exports;function eE(){return JD||(JD=1,function(){var e,t,n,i,r,a,s,o,c,l,h,d,u,f,p={}.hasOwnProperty;s=iD(),o=TD(),e=KT(),t=QT(),l=GT(),d=kD(),u=FD(),h=MD(),c=WD(),n=cD(),i=mD(),r=uD(),a=wD(),f=ZD(),XD.exports=function(f){function g(e){g.__super__.constructor.call(this,e)}return function(e,t){for(var n in t)p.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(g,f),g.prototype.document=function(e){var n,i,r,a,l;for(this.textispresent=!1,a="",i=0,r=(l=e.children).length;i<r;i++)(n=l[i])instanceof c||(a+=function(){switch(!1){case!(n instanceof s):return this.declaration(n);case!(n instanceof o):return this.docType(n);case!(n instanceof t):return this.comment(n);case!(n instanceof h):return this.processingInstruction(n);default:return this.element(n,0)}}.call(this));return this.pretty&&a.slice(-this.newline.length)===this.newline&&(a=a.slice(0,-this.newline.length)),a},g.prototype.attribute=function(e){return" "+e.name+'="'+e.value+'"'},g.prototype.cdata=function(e,t){return this.space(t)+"<![CDATA["+e.text+"]]>"+this.newline},g.prototype.comment=function(e,t){return this.space(t)+"\x3c!-- "+e.text+" --\x3e"+this.newline},g.prototype.declaration=function(e,t){var n;return n=this.space(t),n+='<?xml version="'+e.version+'"',null!=e.encoding&&(n+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(n+=' standalone="'+e.standalone+'"'),(n+=this.spacebeforeslash+"?>")+this.newline},g.prototype.docType=function(s,o){var c,l,d,u,f;if(o||(o=0),u=this.space(o),u+="<!DOCTYPE "+s.root().name,s.pubID&&s.sysID?u+=' PUBLIC "'+s.pubID+'" "'+s.sysID+'"':s.sysID&&(u+=' SYSTEM "'+s.sysID+'"'),s.children.length>0){for(u+=" [",u+=this.newline,l=0,d=(f=s.children).length;l<d;l++)c=f[l],u+=function(){switch(!1){case!(c instanceof n):return this.dtdAttList(c,o+1);case!(c instanceof i):return this.dtdElement(c,o+1);case!(c instanceof r):return this.dtdEntity(c,o+1);case!(c instanceof a):return this.dtdNotation(c,o+1);case!(c instanceof e):return this.cdata(c,o+1);case!(c instanceof t):return this.comment(c,o+1);case!(c instanceof h):return this.processingInstruction(c,o+1);default:throw new Error("Unknown DTD node type: "+c.constructor.name)}}.call(this);u+="]"}return(u+=this.spacebeforeslash+">")+this.newline},g.prototype.element=function(n,i){var r,a,s,o,f,g,m,b,v,y,w,x,_;for(m in i||(i=0),_=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),b="",b+=(x=this.space(i))+"<"+n.name,v=n.attributes)p.call(v,m)&&(r=v[m],b+=this.attribute(r));if(0===n.children.length||n.children.every(function(e){return""===e.value}))this.allowEmpty?b+="></"+n.name+">"+this.newline:b+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&1===n.children.length&&null!=n.children[0].value)b+=">",b+=n.children[0].value,b+="</"+n.name+">"+this.newline;else{if(this.dontprettytextnodes)for(s=0,f=(y=n.children).length;s<f;s++)if(null!=(a=y[s]).value){this.textispresent++,_=!0;break}for(this.textispresent&&(this.newline="",this.pretty=!1,x=this.space(i)),b+=">"+this.newline,o=0,g=(w=n.children).length;o<g;o++)a=w[o],b+=function(){switch(!1){case!(a instanceof e):return this.cdata(a,i+1);case!(a instanceof t):return this.comment(a,i+1);case!(a instanceof l):return this.element(a,i+1);case!(a instanceof d):return this.raw(a,i+1);case!(a instanceof u):return this.text(a,i+1);case!(a instanceof h):return this.processingInstruction(a,i+1);case!(a instanceof c):return"";default:throw new Error("Unknown XML node type: "+a.constructor.name)}}.call(this);_&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),b+=x+"</"+n.name+">"+this.newline}return b},g.prototype.processingInstruction=function(e,t){var n;return n=this.space(t)+"<?"+e.target,e.value&&(n+=" "+e.value),n+(this.spacebeforeslash+"?>")+this.newline},g.prototype.raw=function(e,t){return this.space(t)+e.value+this.newline},g.prototype.text=function(e,t){return this.space(t)+e.value+this.newline},g.prototype.dtdAttList=function(e,t){var n;return n=this.space(t)+"<!ATTLIST "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(n+=" "+e.defaultValueType),e.defaultValue&&(n+=' "'+e.defaultValue+'"'),n+(this.spacebeforeslash+">")+this.newline},g.prototype.dtdElement=function(e,t){return this.space(t)+"<!ELEMENT "+e.name+" "+e.value+this.spacebeforeslash+">"+this.newline},g.prototype.dtdEntity=function(e,t){var n;return n=this.space(t)+"<!ENTITY",e.pe&&(n+=" %"),n+=" "+e.name,e.value?n+=' "'+e.value+'"':(e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.nData&&(n+=" NDATA "+e.nData)),n+(this.spacebeforeslash+">")+this.newline},g.prototype.dtdNotation=function(e,t){var n;return n=this.space(t)+"<!NOTATION "+e.name,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?n+=' PUBLIC "'+e.pubID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),n+(this.spacebeforeslash+">")+this.newline},g.prototype.openNode=function(e,t){var n,i,r,a;if(t||(t=0),e instanceof l){for(i in r=this.space(t)+"<"+e.name,a=e.attributes)p.call(a,i)&&(n=a[i],r+=this.attribute(n));return r+(e.children?">":"/>")+this.newline}return r=this.space(t)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?r+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(r+=' SYSTEM "'+e.sysID+'"'),r+(e.children?" [":">")+this.newline},g.prototype.closeNode=function(e,t){switch(t||(t=0),!1){case!(e instanceof l):return this.space(t)+"</"+e.name+">"+this.newline;case!(e instanceof o):return this.space(t)+"]>"+this.newline}},g}(f)}.call(QD)),XD.exports}var tE,nE=PT.exports;var iE,rE,aE,sE,oE,cE,lE={exports:{}},hE=lE.exports,dE={exports:{}},uE=dE.exports;function fE(){return aE||(aE=1,function(){var e,t,n,i,r,a,s;s=MT(),r=s.assign,a=s.isFunction,tE||(tE=1,function(){var e,t,n,i,r={}.hasOwnProperty;i=MT().isPlainObject,e=zD(),n=$D(),t=eE(),PT.exports=function(e){function a(e){a.__super__.constructor.call(this,null),this.name="?xml",e||(e={}),e.writer||(e.writer=new t),this.options=e,this.stringify=new n(e),this.isDocument=!0}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(a,e),a.prototype.end=function(e){var t;return e?i(e)&&(t=e,e=this.options.writer.set(t)):e=this.options.writer,e.document(this)},a.prototype.toString=function(e){return this.options.writer.set(e).document(this)},a}(e)}.call(nE)),e=PT.exports,iE||(iE=1,function(){var e,t,n,i,r,a,s,o,c,l,h,d,u,f,p,g,m,b,v,y,w={}.hasOwnProperty;y=MT(),b=y.isObject,m=y.isFunction,v=y.isPlainObject,g=y.getValue,l=GT(),t=KT(),n=QT(),d=kD(),p=FD(),h=MD(),o=iD(),c=TD(),i=cD(),a=uD(),r=mD(),s=wD(),e=zT(),f=$D(),u=eE(),lE.exports=function(){function y(e,t,n){var i;this.name="?xml",e||(e={}),e.writer?v(e.writer)&&(i=e.writer,e.writer=new u(i)):e.writer=new u(e),this.options=e,this.writer=e.writer,this.stringify=new f(e),this.onDataCallback=t||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return y.prototype.node=function(e,t,n){var i,r;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=g(e),null===t&&null==n&&(t=(i=[{},null])[0],n=i[1]),null==t&&(t={}),t=g(t),b(t)||(n=(r=[t,n])[0],t=r[1]),this.currentNode=new l(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},y.prototype.element=function(e,t,n){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(e,t,n)},y.prototype.attribute=function(t,n){var i,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=g(t)),b(t))for(i in t)w.call(t,i)&&(r=t[i],this.attribute(i,r));else m(n)&&(n=n.apply()),this.options.skipNullAttributes&&null==n||(this.currentNode.attributes[t]=new e(this,t,n));return this},y.prototype.text=function(e){var t;return this.openCurrent(),t=new p(this,e),this.onData(this.writer.text(t,this.currentLevel+1),this.currentLevel+1),this},y.prototype.cdata=function(e){var n;return this.openCurrent(),n=new t(this,e),this.onData(this.writer.cdata(n,this.currentLevel+1),this.currentLevel+1),this},y.prototype.comment=function(e){var t;return this.openCurrent(),t=new n(this,e),this.onData(this.writer.comment(t,this.currentLevel+1),this.currentLevel+1),this},y.prototype.raw=function(e){var t;return this.openCurrent(),t=new d(this,e),this.onData(this.writer.raw(t,this.currentLevel+1),this.currentLevel+1),this},y.prototype.instruction=function(e,t){var n,i,r,a,s;if(this.openCurrent(),null!=e&&(e=g(e)),null!=t&&(t=g(t)),Array.isArray(e))for(n=0,a=e.length;n<a;n++)i=e[n],this.instruction(i);else if(b(e))for(i in e)w.call(e,i)&&(r=e[i],this.instruction(i,r));else m(t)&&(t=t.apply()),s=new h(this,e,t),this.onData(this.writer.processingInstruction(s,this.currentLevel+1),this.currentLevel+1);return this},y.prototype.declaration=function(e,t,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new o(this,e,t,n),this.onData(this.writer.declaration(i,this.currentLevel+1),this.currentLevel+1),this},y.prototype.doctype=function(e,t,n){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new c(this,t,n),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},y.prototype.dtdElement=function(e,t){var n;return this.openCurrent(),n=new r(this,e,t),this.onData(this.writer.dtdElement(n,this.currentLevel+1),this.currentLevel+1),this},y.prototype.attList=function(e,t,n,r,a){var s;return this.openCurrent(),s=new i(this,e,t,n,r,a),this.onData(this.writer.dtdAttList(s,this.currentLevel+1),this.currentLevel+1),this},y.prototype.entity=function(e,t){var n;return this.openCurrent(),n=new a(this,!1,e,t),this.onData(this.writer.dtdEntity(n,this.currentLevel+1),this.currentLevel+1),this},y.prototype.pEntity=function(e,t){var n;return this.openCurrent(),n=new a(this,!0,e,t),this.onData(this.writer.dtdEntity(n,this.currentLevel+1),this.currentLevel+1),this},y.prototype.notation=function(e,t){var n;return this.openCurrent(),n=new s(this,e,t),this.onData(this.writer.dtdNotation(n,this.currentLevel+1),this.currentLevel+1),this},y.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},y.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},y.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},y.prototype.openNode=function(e){if(!e.isOpen)return!this.root&&0===this.currentLevel&&e instanceof l&&(this.root=e),this.onData(this.writer.openNode(e,this.currentLevel),this.currentLevel),e.isOpen=!0},y.prototype.closeNode=function(e){if(!e.isClosed)return this.onData(this.writer.closeNode(e,this.currentLevel),this.currentLevel),e.isClosed=!0},y.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},y.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},y.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},y.prototype.ele=function(){return this.element.apply(this,arguments)},y.prototype.nod=function(e,t,n){return this.node(e,t,n)},y.prototype.txt=function(e){return this.text(e)},y.prototype.dat=function(e){return this.cdata(e)},y.prototype.com=function(e){return this.comment(e)},y.prototype.ins=function(e,t){return this.instruction(e,t)},y.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},y.prototype.dtd=function(e,t,n){return this.doctype(e,t,n)},y.prototype.e=function(e,t,n){return this.element(e,t,n)},y.prototype.n=function(e,t,n){return this.node(e,t,n)},y.prototype.t=function(e){return this.text(e)},y.prototype.d=function(e){return this.cdata(e)},y.prototype.c=function(e){return this.comment(e)},y.prototype.r=function(e){return this.raw(e)},y.prototype.i=function(e,t){return this.instruction(e,t)},y.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},y.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},y.prototype.ent=function(e,t){return this.entity(e,t)},y.prototype.pent=function(e,t){return this.pEntity(e,t)},y.prototype.not=function(e,t){return this.notation(e,t)},y}()}.call(hE)),t=lE.exports,i=eE(),rE||(rE=1,function(){var e,t,n,i,r,a,s,o,c,l,h,d,u,f,p={}.hasOwnProperty;s=iD(),o=TD(),e=KT(),t=QT(),l=GT(),d=kD(),u=FD(),h=MD(),c=WD(),n=cD(),i=mD(),r=uD(),a=wD(),f=ZD(),dE.exports=function(f){function g(e,t){g.__super__.constructor.call(this,t),this.stream=e}return function(e,t){for(var n in t)p.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(g,f),g.prototype.document=function(e){var n,i,r,a,l,d,u,f;for(i=0,a=(d=e.children).length;i<a;i++)(n=d[i]).isLastRootNode=!1;for(e.children[e.children.length-1].isLastRootNode=!0,f=[],r=0,l=(u=e.children).length;r<l;r++)if(!((n=u[r])instanceof c))switch(!1){case!(n instanceof s):f.push(this.declaration(n));break;case!(n instanceof o):f.push(this.docType(n));break;case!(n instanceof t):f.push(this.comment(n));break;case!(n instanceof h):f.push(this.processingInstruction(n));break;default:f.push(this.element(n))}return f},g.prototype.attribute=function(e){return this.stream.write(" "+e.name+'="'+e.value+'"')},g.prototype.cdata=function(e,t){return this.stream.write(this.space(t)+"<![CDATA["+e.text+"]]>"+this.endline(e))},g.prototype.comment=function(e,t){return this.stream.write(this.space(t)+"\x3c!-- "+e.text+" --\x3e"+this.endline(e))},g.prototype.declaration=function(e,t){return this.stream.write(this.space(t)),this.stream.write('<?xml version="'+e.version+'"'),null!=e.encoding&&this.stream.write(' encoding="'+e.encoding+'"'),null!=e.standalone&&this.stream.write(' standalone="'+e.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(e))},g.prototype.docType=function(s,o){var c,l,d,u;if(o||(o=0),this.stream.write(this.space(o)),this.stream.write("<!DOCTYPE "+s.root().name),s.pubID&&s.sysID?this.stream.write(' PUBLIC "'+s.pubID+'" "'+s.sysID+'"'):s.sysID&&this.stream.write(' SYSTEM "'+s.sysID+'"'),s.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(s)),l=0,d=(u=s.children).length;l<d;l++)switch(c=u[l],!1){case!(c instanceof n):this.dtdAttList(c,o+1);break;case!(c instanceof i):this.dtdElement(c,o+1);break;case!(c instanceof r):this.dtdEntity(c,o+1);break;case!(c instanceof a):this.dtdNotation(c,o+1);break;case!(c instanceof e):this.cdata(c,o+1);break;case!(c instanceof t):this.comment(c,o+1);break;case!(c instanceof h):this.processingInstruction(c,o+1);break;default:throw new Error("Unknown DTD node type: "+c.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(s))},g.prototype.element=function(n,i){var r,a,s,o,f,g,m,b;for(f in i||(i=0),b=this.space(i),this.stream.write(b+"<"+n.name),g=n.attributes)p.call(g,f)&&(r=g[f],this.attribute(r));if(0===n.children.length||n.children.every(function(e){return""===e.value}))this.allowEmpty?this.stream.write("></"+n.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&1===n.children.length&&null!=n.children[0].value)this.stream.write(">"),this.stream.write(n.children[0].value),this.stream.write("</"+n.name+">");else{for(this.stream.write(">"+this.newline),s=0,o=(m=n.children).length;s<o;s++)switch(a=m[s],!1){case!(a instanceof e):this.cdata(a,i+1);break;case!(a instanceof t):this.comment(a,i+1);break;case!(a instanceof l):this.element(a,i+1);break;case!(a instanceof d):this.raw(a,i+1);break;case!(a instanceof u):this.text(a,i+1);break;case!(a instanceof h):this.processingInstruction(a,i+1);break;case!(a instanceof c):break;default:throw new Error("Unknown XML node type: "+a.constructor.name)}this.stream.write(b+"</"+n.name+">")}return this.stream.write(this.endline(n))},g.prototype.processingInstruction=function(e,t){return this.stream.write(this.space(t)+"<?"+e.target),e.value&&this.stream.write(" "+e.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(e))},g.prototype.raw=function(e,t){return this.stream.write(this.space(t)+e.value+this.endline(e))},g.prototype.text=function(e,t){return this.stream.write(this.space(t)+e.value+this.endline(e))},g.prototype.dtdAttList=function(e,t){return this.stream.write(this.space(t)+"<!ATTLIST "+e.elementName+" "+e.attributeName+" "+e.attributeType),"#DEFAULT"!==e.defaultValueType&&this.stream.write(" "+e.defaultValueType),e.defaultValue&&this.stream.write(' "'+e.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(e))},g.prototype.dtdElement=function(e,t){return this.stream.write(this.space(t)+"<!ELEMENT "+e.name+" "+e.value),this.stream.write(this.spacebeforeslash+">"+this.endline(e))},g.prototype.dtdEntity=function(e,t){return this.stream.write(this.space(t)+"<!ENTITY"),e.pe&&this.stream.write(" %"),this.stream.write(" "+e.name),e.value?this.stream.write(' "'+e.value+'"'):(e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.nData&&this.stream.write(" NDATA "+e.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(e))},g.prototype.dtdNotation=function(e,t){return this.stream.write(this.space(t)+"<!NOTATION "+e.name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.pubID?this.stream.write(' PUBLIC "'+e.pubID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(e))},g.prototype.endline=function(e){return e.isLastRootNode?"":this.newline},g}(f)}.call(uE)),n=dE.exports,RT.create=function(t,n,i,a){var s,o;if(null==t)throw new Error("Root element needs a name.");return a=r({},n,i,a),o=(s=new e(a)).element(t),a.headless||(s.declaration(a),null==a.pubID&&null==a.sysID||s.doctype(a)),o},RT.begin=function(n,i,r){var s;return a(n)&&(i=(s=[n,i])[0],r=s[1],n={}),i?new t(n,i,r):new e(n)},RT.stringWriter=function(e){return new i(e)},RT.streamWriter=function(e,t){return new n(e,t)}}.call(RT)),RT}function pE(){if(oE)return cT;oE=1;var e=hT();return cT.Element=e.Element,cT.element=e.element,cT.emptyElement=e.emptyElement,cT.text=e.text,cT.readString=function(){if(ET)return fT;ET=1;var e=G_(),t=bx,n=UT(),i=hT(),r=i.Element;fT.readString=function(s,o){o=o||{};try{var c=n.parseFromString(s,"text/xml")}catch(h){return e.reject(h)}if("parsererror"===c.documentElement.tagName)return e.resolve(new Error(c.documentElement.textContent));function l(e){if(e.namespaceURI){var t=o[e.namespaceURI];return(t?t+":":"{"+e.namespaceURI+"}")+e.localName}return e.localName}return e.resolve(function e(n){switch(n.nodeType){case a.ELEMENT_NODE:return function(n){var i=l(n),a=[];t.forEach(n.childNodes,function(t){var n=e(t);n&&a.push(n)});var s={};return t.forEach(n.attributes,function(e){s[l(e)]=e.value}),new r(i,s,a)}(n);case a.TEXT_NODE:return i.text(n.nodeValue)}}(c.documentElement))};var a=n.Node;return fT}().readString,cT.writeString=function(){if(sE)return IT;sE=1;var e=bx,t=fE();function n(e,t){e.text(t.value)}return IT.writeString=function(i,r){var a,s,o=e.invert(r),c={element:function(e,t){var n=e.element(h(t.name),t.attributes);t.children.forEach(function(e){l(n,e)})},text:n};function l(e,t){return c[t.type](e,t)}function h(e){var t=/^\{(.*)\}(.*)$/.exec(e);if(t){var n=o[t[1]];return n+(""===n?"":":")+t[2]}return e}return a=i,s=t.create(h(a.name),{version:"1.0",encoding:"UTF-8",standalone:!0}),e.forEach(r,function(e,t){var n="xmlns"+(""===t?"":":"+t);s.attribute(n,e)}),a.children.forEach(function(e){l(s,e)}),s.end()},IT}().writeString,cT}var gE,mE,bE={},vE={},yE={};var wE,xE,_E={};function TE(){if(xE)return bE;xE=1,bE.createBodyReader=function(e){return{readXmlElement:function(t){return new o(e).readXmlElement(t)},readXmlElements:function(t){return new o(e).readXmlElements(t)}}},bE._readNumberingProperties=c;var e=function(){if(mE)return vE;mE=1;var e=vE&&vE.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vE,"__esModule",{value:!0}),vE.hex=vE.dec=vE.codePoint=void 0;for(var t=e((gE||(gE=1,Object.defineProperty(yE,"__esModule",{value:!0}),yE.default=[{"Typeface name":"Symbol","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Symbol","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"33","Unicode hex":"21"},{"Typeface name":"Symbol","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"8704","Unicode hex":"2200"},{"Typeface name":"Symbol","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"35","Unicode hex":"23"},{"Typeface name":"Symbol","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"8707","Unicode hex":"2203"},{"Typeface name":"Symbol","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"37","Unicode hex":"25"},{"Typeface name":"Symbol","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"38","Unicode hex":"26"},{"Typeface name":"Symbol","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"8717","Unicode hex":"220D"},{"Typeface name":"Symbol","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"40","Unicode hex":"28"},{"Typeface name":"Symbol","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"41","Unicode hex":"29"},{"Typeface name":"Symbol","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"42","Unicode hex":"2A"},{"Typeface name":"Symbol","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"43","Unicode hex":"2B"},{"Typeface name":"Symbol","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"44","Unicode hex":"2C"},{"Typeface name":"Symbol","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"8722","Unicode hex":"2212"},{"Typeface name":"Symbol","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"46","Unicode hex":"2E"},{"Typeface name":"Symbol","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"47","Unicode hex":"2F"},{"Typeface name":"Symbol","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"48","Unicode hex":"30"},{"Typeface name":"Symbol","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"49","Unicode hex":"31"},{"Typeface name":"Symbol","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"50","Unicode hex":"32"},{"Typeface name":"Symbol","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"51","Unicode hex":"33"},{"Typeface name":"Symbol","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"52","Unicode hex":"34"},{"Typeface name":"Symbol","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"53","Unicode hex":"35"},{"Typeface name":"Symbol","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"54","Unicode hex":"36"},{"Typeface name":"Symbol","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"55","Unicode hex":"37"},{"Typeface name":"Symbol","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"56","Unicode hex":"38"},{"Typeface name":"Symbol","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"57","Unicode hex":"39"},{"Typeface name":"Symbol","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"58","Unicode hex":"3A"},{"Typeface name":"Symbol","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"59","Unicode hex":"3B"},{"Typeface name":"Symbol","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"60","Unicode hex":"3C"},{"Typeface name":"Symbol","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"61","Unicode hex":"3D"},{"Typeface name":"Symbol","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"62","Unicode hex":"3E"},{"Typeface name":"Symbol","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"63","Unicode hex":"3F"},{"Typeface name":"Symbol","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"8773","Unicode hex":"2245"},{"Typeface name":"Symbol","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"913","Unicode hex":"391"},{"Typeface name":"Symbol","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"914","Unicode hex":"392"},{"Typeface name":"Symbol","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"935","Unicode hex":"3A7"},{"Typeface name":"Symbol","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"916","Unicode hex":"394"},{"Typeface name":"Symbol","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"917","Unicode hex":"395"},{"Typeface name":"Symbol","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"934","Unicode hex":"3A6"},{"Typeface name":"Symbol","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"915","Unicode hex":"393"},{"Typeface name":"Symbol","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"919","Unicode hex":"397"},{"Typeface name":"Symbol","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"921","Unicode hex":"399"},{"Typeface name":"Symbol","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"977","Unicode hex":"3D1"},{"Typeface name":"Symbol","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"922","Unicode hex":"39A"},{"Typeface name":"Symbol","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"923","Unicode hex":"39B"},{"Typeface name":"Symbol","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"924","Unicode hex":"39C"},{"Typeface name":"Symbol","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"925","Unicode hex":"39D"},{"Typeface name":"Symbol","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"927","Unicode hex":"39F"},{"Typeface name":"Symbol","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"928","Unicode hex":"3A0"},{"Typeface name":"Symbol","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"920","Unicode hex":"398"},{"Typeface name":"Symbol","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"929","Unicode hex":"3A1"},{"Typeface name":"Symbol","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"931","Unicode hex":"3A3"},{"Typeface name":"Symbol","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"932","Unicode hex":"3A4"},{"Typeface name":"Symbol","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"933","Unicode hex":"3A5"},{"Typeface name":"Symbol","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"962","Unicode hex":"3C2"},{"Typeface name":"Symbol","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"937","Unicode hex":"3A9"},{"Typeface name":"Symbol","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"926","Unicode hex":"39E"},{"Typeface name":"Symbol","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"936","Unicode hex":"3A8"},{"Typeface name":"Symbol","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"918","Unicode hex":"396"},{"Typeface name":"Symbol","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"91","Unicode hex":"5B"},{"Typeface name":"Symbol","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"8756","Unicode hex":"2234"},{"Typeface name":"Symbol","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"93","Unicode hex":"5D"},{"Typeface name":"Symbol","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"8869","Unicode hex":"22A5"},{"Typeface name":"Symbol","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"95","Unicode hex":"5F"},{"Typeface name":"Symbol","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"8254","Unicode hex":"203E"},{"Typeface name":"Symbol","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"945","Unicode hex":"3B1"},{"Typeface name":"Symbol","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"946","Unicode hex":"3B2"},{"Typeface name":"Symbol","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"967","Unicode hex":"3C7"},{"Typeface name":"Symbol","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"948","Unicode hex":"3B4"},{"Typeface name":"Symbol","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"949","Unicode hex":"3B5"},{"Typeface name":"Symbol","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"966","Unicode hex":"3C6"},{"Typeface name":"Symbol","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"947","Unicode hex":"3B3"},{"Typeface name":"Symbol","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"951","Unicode hex":"3B7"},{"Typeface name":"Symbol","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"953","Unicode hex":"3B9"},{"Typeface name":"Symbol","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"981","Unicode hex":"3D5"},{"Typeface name":"Symbol","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"954","Unicode hex":"3BA"},{"Typeface name":"Symbol","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"955","Unicode hex":"3BB"},{"Typeface name":"Symbol","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"956","Unicode hex":"3BC"},{"Typeface name":"Symbol","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"957","Unicode hex":"3BD"},{"Typeface name":"Symbol","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"959","Unicode hex":"3BF"},{"Typeface name":"Symbol","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"960","Unicode hex":"3C0"},{"Typeface name":"Symbol","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"952","Unicode hex":"3B8"},{"Typeface name":"Symbol","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"961","Unicode hex":"3C1"},{"Typeface name":"Symbol","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"963","Unicode hex":"3C3"},{"Typeface name":"Symbol","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"964","Unicode hex":"3C4"},{"Typeface name":"Symbol","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"965","Unicode hex":"3C5"},{"Typeface name":"Symbol","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"982","Unicode hex":"3D6"},{"Typeface name":"Symbol","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"969","Unicode hex":"3C9"},{"Typeface name":"Symbol","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"958","Unicode hex":"3BE"},{"Typeface name":"Symbol","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"968","Unicode hex":"3C8"},{"Typeface name":"Symbol","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"950","Unicode hex":"3B6"},{"Typeface name":"Symbol","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"123","Unicode hex":"7B"},{"Typeface name":"Symbol","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"124","Unicode hex":"7C"},{"Typeface name":"Symbol","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"125","Unicode hex":"7D"},{"Typeface name":"Symbol","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"126","Unicode hex":"7E"},{"Typeface name":"Symbol","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"8364","Unicode hex":"20AC"},{"Typeface name":"Symbol","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"978","Unicode hex":"3D2"},{"Typeface name":"Symbol","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"8242","Unicode hex":"2032"},{"Typeface name":"Symbol","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"8804","Unicode hex":"2264"},{"Typeface name":"Symbol","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"8260","Unicode hex":"2044"},{"Typeface name":"Symbol","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"8734","Unicode hex":"221E"},{"Typeface name":"Symbol","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"402","Unicode hex":"192"},{"Typeface name":"Symbol","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9827","Unicode hex":"2663"},{"Typeface name":"Symbol","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9830","Unicode hex":"2666"},{"Typeface name":"Symbol","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"9829","Unicode hex":"2665"},{"Typeface name":"Symbol","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"9824","Unicode hex":"2660"},{"Typeface name":"Symbol","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"8596","Unicode hex":"2194"},{"Typeface name":"Symbol","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"8592","Unicode hex":"2190"},{"Typeface name":"Symbol","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"8593","Unicode hex":"2191"},{"Typeface name":"Symbol","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"8594","Unicode hex":"2192"},{"Typeface name":"Symbol","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"8595","Unicode hex":"2193"},{"Typeface name":"Symbol","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"176","Unicode hex":"B0"},{"Typeface name":"Symbol","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"177","Unicode hex":"B1"},{"Typeface name":"Symbol","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"8243","Unicode hex":"2033"},{"Typeface name":"Symbol","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"8805","Unicode hex":"2265"},{"Typeface name":"Symbol","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"215","Unicode hex":"D7"},{"Typeface name":"Symbol","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"8733","Unicode hex":"221D"},{"Typeface name":"Symbol","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"8706","Unicode hex":"2202"},{"Typeface name":"Symbol","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Symbol","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"247","Unicode hex":"F7"},{"Typeface name":"Symbol","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"8800","Unicode hex":"2260"},{"Typeface name":"Symbol","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"8801","Unicode hex":"2261"},{"Typeface name":"Symbol","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"8776","Unicode hex":"2248"},{"Typeface name":"Symbol","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"8230","Unicode hex":"2026"},{"Typeface name":"Symbol","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Symbol","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"9135","Unicode hex":"23AF"},{"Typeface name":"Symbol","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"8629","Unicode hex":"21B5"},{"Typeface name":"Symbol","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"8501","Unicode hex":"2135"},{"Typeface name":"Symbol","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"8465","Unicode hex":"2111"},{"Typeface name":"Symbol","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"8476","Unicode hex":"211C"},{"Typeface name":"Symbol","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"8472","Unicode hex":"2118"},{"Typeface name":"Symbol","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"8855","Unicode hex":"2297"},{"Typeface name":"Symbol","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"8853","Unicode hex":"2295"},{"Typeface name":"Symbol","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"8709","Unicode hex":"2205"},{"Typeface name":"Symbol","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"8745","Unicode hex":"2229"},{"Typeface name":"Symbol","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"8746","Unicode hex":"222A"},{"Typeface name":"Symbol","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"8835","Unicode hex":"2283"},{"Typeface name":"Symbol","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"8839","Unicode hex":"2287"},{"Typeface name":"Symbol","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"8836","Unicode hex":"2284"},{"Typeface name":"Symbol","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"8834","Unicode hex":"2282"},{"Typeface name":"Symbol","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"8838","Unicode hex":"2286"},{"Typeface name":"Symbol","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"8712","Unicode hex":"2208"},{"Typeface name":"Symbol","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"8713","Unicode hex":"2209"},{"Typeface name":"Symbol","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"8736","Unicode hex":"2220"},{"Typeface name":"Symbol","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"8711","Unicode hex":"2207"},{"Typeface name":"Symbol","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"8719","Unicode hex":"220F"},{"Typeface name":"Symbol","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8730","Unicode hex":"221A"},{"Typeface name":"Symbol","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Symbol","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"172","Unicode hex":"AC"},{"Typeface name":"Symbol","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"8743","Unicode hex":"2227"},{"Typeface name":"Symbol","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"8744","Unicode hex":"2228"},{"Typeface name":"Symbol","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"8660","Unicode hex":"21D4"},{"Typeface name":"Symbol","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"8656","Unicode hex":"21D0"},{"Typeface name":"Symbol","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"8657","Unicode hex":"21D1"},{"Typeface name":"Symbol","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"8658","Unicode hex":"21D2"},{"Typeface name":"Symbol","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"8659","Unicode hex":"21D3"},{"Typeface name":"Symbol","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Symbol","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"12296","Unicode hex":"3008"},{"Typeface name":"Symbol","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"8721","Unicode hex":"2211"},{"Typeface name":"Symbol","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"9115","Unicode hex":"239B"},{"Typeface name":"Symbol","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"9116","Unicode hex":"239C"},{"Typeface name":"Symbol","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9117","Unicode hex":"239D"},{"Typeface name":"Symbol","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9121","Unicode hex":"23A1"},{"Typeface name":"Symbol","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"9122","Unicode hex":"23A2"},{"Typeface name":"Symbol","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"9123","Unicode hex":"23A3"},{"Typeface name":"Symbol","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"9127","Unicode hex":"23A7"},{"Typeface name":"Symbol","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"9128","Unicode hex":"23A8"},{"Typeface name":"Symbol","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"9129","Unicode hex":"23A9"},{"Typeface name":"Symbol","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"9130","Unicode hex":"23AA"},{"Typeface name":"Symbol","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"63743","Unicode hex":"F8FF"},{"Typeface name":"Symbol","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"12297","Unicode hex":"3009"},{"Typeface name":"Symbol","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8747","Unicode hex":"222B"},{"Typeface name":"Symbol","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"8992","Unicode hex":"2320"},{"Typeface name":"Symbol","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"9134","Unicode hex":"23AE"},{"Typeface name":"Symbol","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"8993","Unicode hex":"2321"},{"Typeface name":"Symbol","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"9118","Unicode hex":"239E"},{"Typeface name":"Symbol","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"9119","Unicode hex":"239F"},{"Typeface name":"Symbol","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"9120","Unicode hex":"23A0"},{"Typeface name":"Symbol","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"9124","Unicode hex":"23A4"},{"Typeface name":"Symbol","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"9125","Unicode hex":"23A5"},{"Typeface name":"Symbol","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"9126","Unicode hex":"23A6"},{"Typeface name":"Symbol","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"9131","Unicode hex":"23AB"},{"Typeface name":"Symbol","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"9132","Unicode hex":"23AC"},{"Typeface name":"Symbol","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"9133","Unicode hex":"23AD"},{"Typeface name":"Webdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Webdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128375","Unicode hex":"1F577"},{"Typeface name":"Webdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128376","Unicode hex":"1F578"},{"Typeface name":"Webdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128370","Unicode hex":"1F572"},{"Typeface name":"Webdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128374","Unicode hex":"1F576"},{"Typeface name":"Webdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"127942","Unicode hex":"1F3C6"},{"Typeface name":"Webdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"127894","Unicode hex":"1F396"},{"Typeface name":"Webdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128391","Unicode hex":"1F587"},{"Typeface name":"Webdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128488","Unicode hex":"1F5E8"},{"Typeface name":"Webdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128489","Unicode hex":"1F5E9"},{"Typeface name":"Webdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128496","Unicode hex":"1F5F0"},{"Typeface name":"Webdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128497","Unicode hex":"1F5F1"},{"Typeface name":"Webdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"127798","Unicode hex":"1F336"},{"Typeface name":"Webdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"127895","Unicode hex":"1F397"},{"Typeface name":"Webdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128638","Unicode hex":"1F67E"},{"Typeface name":"Webdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128636","Unicode hex":"1F67C"},{"Typeface name":"Webdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128469","Unicode hex":"1F5D5"},{"Typeface name":"Webdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128470","Unicode hex":"1F5D6"},{"Typeface name":"Webdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128471","Unicode hex":"1F5D7"},{"Typeface name":"Webdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"9204","Unicode hex":"23F4"},{"Typeface name":"Webdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"9205","Unicode hex":"23F5"},{"Typeface name":"Webdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"9206","Unicode hex":"23F6"},{"Typeface name":"Webdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"9207","Unicode hex":"23F7"},{"Typeface name":"Webdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"9194","Unicode hex":"23EA"},{"Typeface name":"Webdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"9193","Unicode hex":"23E9"},{"Typeface name":"Webdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"9198","Unicode hex":"23EE"},{"Typeface name":"Webdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"9197","Unicode hex":"23ED"},{"Typeface name":"Webdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"9208","Unicode hex":"23F8"},{"Typeface name":"Webdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"9209","Unicode hex":"23F9"},{"Typeface name":"Webdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"9210","Unicode hex":"23FA"},{"Typeface name":"Webdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128474","Unicode hex":"1F5DA"},{"Typeface name":"Webdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128499","Unicode hex":"1F5F3"},{"Typeface name":"Webdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128736","Unicode hex":"1F6E0"},{"Typeface name":"Webdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"127959","Unicode hex":"1F3D7"},{"Typeface name":"Webdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"127960","Unicode hex":"1F3D8"},{"Typeface name":"Webdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"127961","Unicode hex":"1F3D9"},{"Typeface name":"Webdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"127962","Unicode hex":"1F3DA"},{"Typeface name":"Webdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"127964","Unicode hex":"1F3DC"},{"Typeface name":"Webdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"127981","Unicode hex":"1F3ED"},{"Typeface name":"Webdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"127963","Unicode hex":"1F3DB"},{"Typeface name":"Webdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"127968","Unicode hex":"1F3E0"},{"Typeface name":"Webdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"127958","Unicode hex":"1F3D6"},{"Typeface name":"Webdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"127965","Unicode hex":"1F3DD"},{"Typeface name":"Webdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128739","Unicode hex":"1F6E3"},{"Typeface name":"Webdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128269","Unicode hex":"1F50D"},{"Typeface name":"Webdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"127956","Unicode hex":"1F3D4"},{"Typeface name":"Webdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128065","Unicode hex":"1F441"},{"Typeface name":"Webdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128066","Unicode hex":"1F442"},{"Typeface name":"Webdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127966","Unicode hex":"1F3DE"},{"Typeface name":"Webdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"127957","Unicode hex":"1F3D5"},{"Typeface name":"Webdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"128740","Unicode hex":"1F6E4"},{"Typeface name":"Webdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127967","Unicode hex":"1F3DF"},{"Typeface name":"Webdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"128755","Unicode hex":"1F6F3"},{"Typeface name":"Webdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128364","Unicode hex":"1F56C"},{"Typeface name":"Webdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"128363","Unicode hex":"1F56B"},{"Typeface name":"Webdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128360","Unicode hex":"1F568"},{"Typeface name":"Webdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"128264","Unicode hex":"1F508"},{"Typeface name":"Webdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"127892","Unicode hex":"1F394"},{"Typeface name":"Webdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"127893","Unicode hex":"1F395"},{"Typeface name":"Webdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128492","Unicode hex":"1F5EC"},{"Typeface name":"Webdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128637","Unicode hex":"1F67D"},{"Typeface name":"Webdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"128493","Unicode hex":"1F5ED"},{"Typeface name":"Webdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128490","Unicode hex":"1F5EA"},{"Typeface name":"Webdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128491","Unicode hex":"1F5EB"},{"Typeface name":"Webdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"11156","Unicode hex":"2B94"},{"Typeface name":"Webdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"10004","Unicode hex":"2714"},{"Typeface name":"Webdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128690","Unicode hex":"1F6B2"},{"Typeface name":"Webdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"11036","Unicode hex":"2B1C"},{"Typeface name":"Webdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128737","Unicode hex":"1F6E1"},{"Typeface name":"Webdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128230","Unicode hex":"1F4E6"},{"Typeface name":"Webdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128753","Unicode hex":"1F6F1"},{"Typeface name":"Webdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"11035","Unicode hex":"2B1B"},{"Typeface name":"Webdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128657","Unicode hex":"1F691"},{"Typeface name":"Webdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"128712","Unicode hex":"1F6C8"},{"Typeface name":"Webdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128745","Unicode hex":"1F6E9"},{"Typeface name":"Webdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128752","Unicode hex":"1F6F0"},{"Typeface name":"Webdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"128968","Unicode hex":"1F7C8"},{"Typeface name":"Webdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128372","Unicode hex":"1F574"},{"Typeface name":"Webdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"11044","Unicode hex":"2B24"},{"Typeface name":"Webdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128741","Unicode hex":"1F6E5"},{"Typeface name":"Webdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128660","Unicode hex":"1F694"},{"Typeface name":"Webdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"128472","Unicode hex":"1F5D8"},{"Typeface name":"Webdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"128473","Unicode hex":"1F5D9"},{"Typeface name":"Webdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"10067","Unicode hex":"2753"},{"Typeface name":"Webdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"128754","Unicode hex":"1F6F2"},{"Typeface name":"Webdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"128647","Unicode hex":"1F687"},{"Typeface name":"Webdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"128653","Unicode hex":"1F68D"},{"Typeface name":"Webdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9971","Unicode hex":"26F3"},{"Typeface name":"Webdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Webdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"8854","Unicode hex":"2296"},{"Typeface name":"Webdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"128685","Unicode hex":"1F6AD"},{"Typeface name":"Webdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"128494","Unicode hex":"1F5EE"},{"Typeface name":"Webdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Webdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128495","Unicode hex":"1F5EF"},{"Typeface name":"Webdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128498","Unicode hex":"1F5F2"},{"Typeface name":"Webdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128697","Unicode hex":"1F6B9"},{"Typeface name":"Webdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"128698","Unicode hex":"1F6BA"},{"Typeface name":"Webdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"128713","Unicode hex":"1F6C9"},{"Typeface name":"Webdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"128714","Unicode hex":"1F6CA"},{"Typeface name":"Webdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"128700","Unicode hex":"1F6BC"},{"Typeface name":"Webdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"128125","Unicode hex":"1F47D"},{"Typeface name":"Webdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"127947","Unicode hex":"1F3CB"},{"Typeface name":"Webdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"9975","Unicode hex":"26F7"},{"Typeface name":"Webdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"127938","Unicode hex":"1F3C2"},{"Typeface name":"Webdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"127948","Unicode hex":"1F3CC"},{"Typeface name":"Webdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"127946","Unicode hex":"1F3CA"},{"Typeface name":"Webdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127940","Unicode hex":"1F3C4"},{"Typeface name":"Webdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"127949","Unicode hex":"1F3CD"},{"Typeface name":"Webdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"127950","Unicode hex":"1F3CE"},{"Typeface name":"Webdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128664","Unicode hex":"1F698"},{"Typeface name":"Webdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128480","Unicode hex":"1F5E0"},{"Typeface name":"Webdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128738","Unicode hex":"1F6E2"},{"Typeface name":"Webdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128176","Unicode hex":"1F4B0"},{"Typeface name":"Webdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"127991","Unicode hex":"1F3F7"},{"Typeface name":"Webdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128179","Unicode hex":"1F4B3"},{"Typeface name":"Webdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128106","Unicode hex":"1F46A"},{"Typeface name":"Webdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"128481","Unicode hex":"1F5E1"},{"Typeface name":"Webdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128482","Unicode hex":"1F5E2"},{"Typeface name":"Webdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128483","Unicode hex":"1F5E3"},{"Typeface name":"Webdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Webdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128388","Unicode hex":"1F584"},{"Typeface name":"Webdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128389","Unicode hex":"1F585"},{"Typeface name":"Webdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Webdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128390","Unicode hex":"1F586"},{"Typeface name":"Webdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128441","Unicode hex":"1F5B9"},{"Typeface name":"Webdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"128442","Unicode hex":"1F5BA"},{"Typeface name":"Webdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128443","Unicode hex":"1F5BB"},{"Typeface name":"Webdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128373","Unicode hex":"1F575"},{"Typeface name":"Webdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"128368","Unicode hex":"1F570"},{"Typeface name":"Webdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128445","Unicode hex":"1F5BD"},{"Typeface name":"Webdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128446","Unicode hex":"1F5BE"},{"Typeface name":"Webdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Webdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128466","Unicode hex":"1F5D2"},{"Typeface name":"Webdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128467","Unicode hex":"1F5D3"},{"Typeface name":"Webdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Webdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128218","Unicode hex":"1F4DA"},{"Typeface name":"Webdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128478","Unicode hex":"1F5DE"},{"Typeface name":"Webdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128479","Unicode hex":"1F5DF"},{"Typeface name":"Webdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128451","Unicode hex":"1F5C3"},{"Typeface name":"Webdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128450","Unicode hex":"1F5C2"},{"Typeface name":"Webdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128444","Unicode hex":"1F5BC"},{"Typeface name":"Webdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"127917","Unicode hex":"1F3AD"},{"Typeface name":"Webdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"127900","Unicode hex":"1F39C"},{"Typeface name":"Webdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"127896","Unicode hex":"1F398"},{"Typeface name":"Webdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"127897","Unicode hex":"1F399"},{"Typeface name":"Webdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"127911","Unicode hex":"1F3A7"},{"Typeface name":"Webdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128191","Unicode hex":"1F4BF"},{"Typeface name":"Webdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"127902","Unicode hex":"1F39E"},{"Typeface name":"Webdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128247","Unicode hex":"1F4F7"},{"Typeface name":"Webdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"127903","Unicode hex":"1F39F"},{"Typeface name":"Webdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"127916","Unicode hex":"1F3AC"},{"Typeface name":"Webdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128253","Unicode hex":"1F4FD"},{"Typeface name":"Webdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128249","Unicode hex":"1F4F9"},{"Typeface name":"Webdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128254","Unicode hex":"1F4FE"},{"Typeface name":"Webdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128251","Unicode hex":"1F4FB"},{"Typeface name":"Webdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"127898","Unicode hex":"1F39A"},{"Typeface name":"Webdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"127899","Unicode hex":"1F39B"},{"Typeface name":"Webdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128250","Unicode hex":"1F4FA"},{"Typeface name":"Webdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128187","Unicode hex":"1F4BB"},{"Typeface name":"Webdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128421","Unicode hex":"1F5A5"},{"Typeface name":"Webdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128422","Unicode hex":"1F5A6"},{"Typeface name":"Webdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128423","Unicode hex":"1F5A7"},{"Typeface name":"Webdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"128377","Unicode hex":"1F579"},{"Typeface name":"Webdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"127918","Unicode hex":"1F3AE"},{"Typeface name":"Webdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"128379","Unicode hex":"1F57B"},{"Typeface name":"Webdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128380","Unicode hex":"1F57C"},{"Typeface name":"Webdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128223","Unicode hex":"1F4DF"},{"Typeface name":"Webdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128385","Unicode hex":"1F581"},{"Typeface name":"Webdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128384","Unicode hex":"1F580"},{"Typeface name":"Webdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128424","Unicode hex":"1F5A8"},{"Typeface name":"Webdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128425","Unicode hex":"1F5A9"},{"Typeface name":"Webdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128447","Unicode hex":"1F5BF"},{"Typeface name":"Webdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128426","Unicode hex":"1F5AA"},{"Typeface name":"Webdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128476","Unicode hex":"1F5DC"},{"Typeface name":"Webdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128274","Unicode hex":"1F512"},{"Typeface name":"Webdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128275","Unicode hex":"1F513"},{"Typeface name":"Webdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128477","Unicode hex":"1F5DD"},{"Typeface name":"Webdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128229","Unicode hex":"1F4E5"},{"Typeface name":"Webdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128228","Unicode hex":"1F4E4"},{"Typeface name":"Webdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128371","Unicode hex":"1F573"},{"Typeface name":"Webdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"127779","Unicode hex":"1F323"},{"Typeface name":"Webdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"127780","Unicode hex":"1F324"},{"Typeface name":"Webdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"127781","Unicode hex":"1F325"},{"Typeface name":"Webdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"127782","Unicode hex":"1F326"},{"Typeface name":"Webdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"9729","Unicode hex":"2601"},{"Typeface name":"Webdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"127784","Unicode hex":"1F328"},{"Typeface name":"Webdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"127783","Unicode hex":"1F327"},{"Typeface name":"Webdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"127785","Unicode hex":"1F329"},{"Typeface name":"Webdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"127786","Unicode hex":"1F32A"},{"Typeface name":"Webdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"127788","Unicode hex":"1F32C"},{"Typeface name":"Webdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"127787","Unicode hex":"1F32B"},{"Typeface name":"Webdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"127772","Unicode hex":"1F31C"},{"Typeface name":"Webdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"127777","Unicode hex":"1F321"},{"Typeface name":"Webdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128715","Unicode hex":"1F6CB"},{"Typeface name":"Webdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128719","Unicode hex":"1F6CF"},{"Typeface name":"Webdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"127869","Unicode hex":"1F37D"},{"Typeface name":"Webdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"127864","Unicode hex":"1F378"},{"Typeface name":"Webdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128718","Unicode hex":"1F6CE"},{"Typeface name":"Webdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128717","Unicode hex":"1F6CD"},{"Typeface name":"Webdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9413","Unicode hex":"24C5"},{"Typeface name":"Webdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9855","Unicode hex":"267F"},{"Typeface name":"Webdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128710","Unicode hex":"1F6C6"},{"Typeface name":"Webdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"128392","Unicode hex":"1F588"},{"Typeface name":"Webdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"127891","Unicode hex":"1F393"},{"Typeface name":"Webdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128484","Unicode hex":"1F5E4"},{"Typeface name":"Webdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128485","Unicode hex":"1F5E5"},{"Typeface name":"Webdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128486","Unicode hex":"1F5E6"},{"Typeface name":"Webdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"128487","Unicode hex":"1F5E7"},{"Typeface name":"Webdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128746","Unicode hex":"1F6EA"},{"Typeface name":"Webdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128063","Unicode hex":"1F43F"},{"Typeface name":"Webdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"128038","Unicode hex":"1F426"},{"Typeface name":"Webdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128031","Unicode hex":"1F41F"},{"Typeface name":"Webdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128021","Unicode hex":"1F415"},{"Typeface name":"Webdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"128008","Unicode hex":"1F408"},{"Typeface name":"Webdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"128620","Unicode hex":"1F66C"},{"Typeface name":"Webdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"128622","Unicode hex":"1F66E"},{"Typeface name":"Webdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"128621","Unicode hex":"1F66D"},{"Typeface name":"Webdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"128623","Unicode hex":"1F66F"},{"Typeface name":"Webdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128506","Unicode hex":"1F5FA"},{"Typeface name":"Webdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"127757","Unicode hex":"1F30D"},{"Typeface name":"Webdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"127759","Unicode hex":"1F30F"},{"Typeface name":"Webdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"127758","Unicode hex":"1F30E"},{"Typeface name":"Webdings","Dingbat dec":"255","Dingbat hex":"FF","Unicode dec":"128330","Unicode hex":"1F54A"},{"Typeface name":"Wingdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128393","Unicode hex":"1F589"},{"Typeface name":"Wingdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"9986","Unicode hex":"2702"},{"Typeface name":"Wingdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"9985","Unicode hex":"2701"},{"Typeface name":"Wingdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128083","Unicode hex":"1F453"},{"Typeface name":"Wingdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"128365","Unicode hex":"1F56D"},{"Typeface name":"Wingdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Wingdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128367","Unicode hex":"1F56F"},{"Typeface name":"Wingdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128383","Unicode hex":"1F57F"},{"Typeface name":"Wingdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"9990","Unicode hex":"2706"},{"Typeface name":"Wingdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128386","Unicode hex":"1F582"},{"Typeface name":"Wingdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Wingdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128234","Unicode hex":"1F4EA"},{"Typeface name":"Wingdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128235","Unicode hex":"1F4EB"},{"Typeface name":"Wingdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128236","Unicode hex":"1F4EC"},{"Typeface name":"Wingdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128237","Unicode hex":"1F4ED"},{"Typeface name":"Wingdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128448","Unicode hex":"1F5C0"},{"Typeface name":"Wingdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128449","Unicode hex":"1F5C1"},{"Typeface name":"Wingdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128462","Unicode hex":"1F5CE"},{"Typeface name":"Wingdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128463","Unicode hex":"1F5CF"},{"Typeface name":"Wingdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128464","Unicode hex":"1F5D0"},{"Typeface name":"Wingdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128452","Unicode hex":"1F5C4"},{"Typeface name":"Wingdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"8987","Unicode hex":"231B"},{"Typeface name":"Wingdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128430","Unicode hex":"1F5AE"},{"Typeface name":"Wingdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128432","Unicode hex":"1F5B0"},{"Typeface name":"Wingdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128434","Unicode hex":"1F5B2"},{"Typeface name":"Wingdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128435","Unicode hex":"1F5B3"},{"Typeface name":"Wingdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128436","Unicode hex":"1F5B4"},{"Typeface name":"Wingdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128427","Unicode hex":"1F5AB"},{"Typeface name":"Wingdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128428","Unicode hex":"1F5AC"},{"Typeface name":"Wingdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"9991","Unicode hex":"2707"},{"Typeface name":"Wingdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"9997","Unicode hex":"270D"},{"Typeface name":"Wingdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128398","Unicode hex":"1F58E"},{"Typeface name":"Wingdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"9996","Unicode hex":"270C"},{"Typeface name":"Wingdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128399","Unicode hex":"1F58F"},{"Typeface name":"Wingdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128077","Unicode hex":"1F44D"},{"Typeface name":"Wingdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128078","Unicode hex":"1F44E"},{"Typeface name":"Wingdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"9756","Unicode hex":"261C"},{"Typeface name":"Wingdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"9758","Unicode hex":"261E"},{"Typeface name":"Wingdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"9757","Unicode hex":"261D"},{"Typeface name":"Wingdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"9759","Unicode hex":"261F"},{"Typeface name":"Wingdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128400","Unicode hex":"1F590"},{"Typeface name":"Wingdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"9786","Unicode hex":"263A"},{"Typeface name":"Wingdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128528","Unicode hex":"1F610"},{"Typeface name":"Wingdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"9785","Unicode hex":"2639"},{"Typeface name":"Wingdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128163","Unicode hex":"1F4A3"},{"Typeface name":"Wingdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128369","Unicode hex":"1F571"},{"Typeface name":"Wingdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"127987","Unicode hex":"1F3F3"},{"Typeface name":"Wingdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127985","Unicode hex":"1F3F1"},{"Typeface name":"Wingdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"9992","Unicode hex":"2708"},{"Typeface name":"Wingdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9788","Unicode hex":"263C"},{"Typeface name":"Wingdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127778","Unicode hex":"1F322"},{"Typeface name":"Wingdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"10052","Unicode hex":"2744"},{"Typeface name":"Wingdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128326","Unicode hex":"1F546"},{"Typeface name":"Wingdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"10014","Unicode hex":"271E"},{"Typeface name":"Wingdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128328","Unicode hex":"1F548"},{"Typeface name":"Wingdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10016","Unicode hex":"2720"},{"Typeface name":"Wingdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"10017","Unicode hex":"2721"},{"Typeface name":"Wingdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"9770","Unicode hex":"262A"},{"Typeface name":"Wingdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"9775","Unicode hex":"262F"},{"Typeface name":"Wingdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128329","Unicode hex":"1F549"},{"Typeface name":"Wingdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"9784","Unicode hex":"2638"},{"Typeface name":"Wingdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"9800","Unicode hex":"2648"},{"Typeface name":"Wingdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"9801","Unicode hex":"2649"},{"Typeface name":"Wingdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"9802","Unicode hex":"264A"},{"Typeface name":"Wingdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"9803","Unicode hex":"264B"},{"Typeface name":"Wingdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"9804","Unicode hex":"264C"},{"Typeface name":"Wingdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"9805","Unicode hex":"264D"},{"Typeface name":"Wingdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"9806","Unicode hex":"264E"},{"Typeface name":"Wingdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"9807","Unicode hex":"264F"},{"Typeface name":"Wingdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"9808","Unicode hex":"2650"},{"Typeface name":"Wingdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"9809","Unicode hex":"2651"},{"Typeface name":"Wingdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"9810","Unicode hex":"2652"},{"Typeface name":"Wingdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9811","Unicode hex":"2653"},{"Typeface name":"Wingdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128624","Unicode hex":"1F670"},{"Typeface name":"Wingdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128629","Unicode hex":"1F675"},{"Typeface name":"Wingdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9899","Unicode hex":"26AB"},{"Typeface name":"Wingdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128318","Unicode hex":"1F53E"},{"Typeface name":"Wingdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9724","Unicode hex":"25FC"},{"Typeface name":"Wingdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128911","Unicode hex":"1F78F"},{"Typeface name":"Wingdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128912","Unicode hex":"1F790"},{"Typeface name":"Wingdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"10065","Unicode hex":"2751"},{"Typeface name":"Wingdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"10066","Unicode hex":"2752"},{"Typeface name":"Wingdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"128927","Unicode hex":"1F79F"},{"Typeface name":"Wingdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"10731","Unicode hex":"29EB"},{"Typeface name":"Wingdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9670","Unicode hex":"25C6"},{"Typeface name":"Wingdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10070","Unicode hex":"2756"},{"Typeface name":"Wingdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"8999","Unicode hex":"2327"},{"Typeface name":"Wingdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"11193","Unicode hex":"2BB9"},{"Typeface name":"Wingdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"8984","Unicode hex":"2318"},{"Typeface name":"Wingdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"127989","Unicode hex":"1F3F5"},{"Typeface name":"Wingdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"127990","Unicode hex":"1F3F6"},{"Typeface name":"Wingdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128630","Unicode hex":"1F676"},{"Typeface name":"Wingdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128631","Unicode hex":"1F677"},{"Typeface name":"Wingdings","Dingbat dec":"127","Dingbat hex":"7F","Unicode dec":"9647","Unicode hex":"25AF"},{"Typeface name":"Wingdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"127243","Unicode hex":"1F10B"},{"Typeface name":"Wingdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"10112","Unicode hex":"2780"},{"Typeface name":"Wingdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"10113","Unicode hex":"2781"},{"Typeface name":"Wingdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"10114","Unicode hex":"2782"},{"Typeface name":"Wingdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"10115","Unicode hex":"2783"},{"Typeface name":"Wingdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10116","Unicode hex":"2784"},{"Typeface name":"Wingdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"10117","Unicode hex":"2785"},{"Typeface name":"Wingdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"10118","Unicode hex":"2786"},{"Typeface name":"Wingdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"10119","Unicode hex":"2787"},{"Typeface name":"Wingdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"10120","Unicode hex":"2788"},{"Typeface name":"Wingdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"10121","Unicode hex":"2789"},{"Typeface name":"Wingdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127244","Unicode hex":"1F10C"},{"Typeface name":"Wingdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"10122","Unicode hex":"278A"},{"Typeface name":"Wingdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"10123","Unicode hex":"278B"},{"Typeface name":"Wingdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"10124","Unicode hex":"278C"},{"Typeface name":"Wingdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"10125","Unicode hex":"278D"},{"Typeface name":"Wingdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"10126","Unicode hex":"278E"},{"Typeface name":"Wingdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"10127","Unicode hex":"278F"},{"Typeface name":"Wingdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"10128","Unicode hex":"2790"},{"Typeface name":"Wingdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"10129","Unicode hex":"2791"},{"Typeface name":"Wingdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"10130","Unicode hex":"2792"},{"Typeface name":"Wingdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"10131","Unicode hex":"2793"},{"Typeface name":"Wingdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128610","Unicode hex":"1F662"},{"Typeface name":"Wingdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128608","Unicode hex":"1F660"},{"Typeface name":"Wingdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"128609","Unicode hex":"1F661"},{"Typeface name":"Wingdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128611","Unicode hex":"1F663"},{"Typeface name":"Wingdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128606","Unicode hex":"1F65E"},{"Typeface name":"Wingdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128604","Unicode hex":"1F65C"},{"Typeface name":"Wingdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128605","Unicode hex":"1F65D"},{"Typeface name":"Wingdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128607","Unicode hex":"1F65F"},{"Typeface name":"Wingdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"8729","Unicode hex":"2219"},{"Typeface name":"Wingdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Wingdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"11037","Unicode hex":"2B1D"},{"Typeface name":"Wingdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"11096","Unicode hex":"2B58"},{"Typeface name":"Wingdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128902","Unicode hex":"1F786"},{"Typeface name":"Wingdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128904","Unicode hex":"1F788"},{"Typeface name":"Wingdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128906","Unicode hex":"1F78A"},{"Typeface name":"Wingdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128907","Unicode hex":"1F78B"},{"Typeface name":"Wingdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128319","Unicode hex":"1F53F"},{"Typeface name":"Wingdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9642","Unicode hex":"25AA"},{"Typeface name":"Wingdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128910","Unicode hex":"1F78E"},{"Typeface name":"Wingdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128961","Unicode hex":"1F7C1"},{"Typeface name":"Wingdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128965","Unicode hex":"1F7C5"},{"Typeface name":"Wingdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"9733","Unicode hex":"2605"},{"Typeface name":"Wingdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128971","Unicode hex":"1F7CB"},{"Typeface name":"Wingdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128975","Unicode hex":"1F7CF"},{"Typeface name":"Wingdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"128979","Unicode hex":"1F7D3"},{"Typeface name":"Wingdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"128977","Unicode hex":"1F7D1"},{"Typeface name":"Wingdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"11216","Unicode hex":"2BD0"},{"Typeface name":"Wingdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"8982","Unicode hex":"2316"},{"Typeface name":"Wingdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"11214","Unicode hex":"2BCE"},{"Typeface name":"Wingdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"11215","Unicode hex":"2BCF"},{"Typeface name":"Wingdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"11217","Unicode hex":"2BD1"},{"Typeface name":"Wingdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"10026","Unicode hex":"272A"},{"Typeface name":"Wingdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"10032","Unicode hex":"2730"},{"Typeface name":"Wingdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"128336","Unicode hex":"1F550"},{"Typeface name":"Wingdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128337","Unicode hex":"1F551"},{"Typeface name":"Wingdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128338","Unicode hex":"1F552"},{"Typeface name":"Wingdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128339","Unicode hex":"1F553"},{"Typeface name":"Wingdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128340","Unicode hex":"1F554"},{"Typeface name":"Wingdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"128341","Unicode hex":"1F555"},{"Typeface name":"Wingdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"128342","Unicode hex":"1F556"},{"Typeface name":"Wingdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128343","Unicode hex":"1F557"},{"Typeface name":"Wingdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128344","Unicode hex":"1F558"},{"Typeface name":"Wingdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128345","Unicode hex":"1F559"},{"Typeface name":"Wingdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128346","Unicode hex":"1F55A"},{"Typeface name":"Wingdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128347","Unicode hex":"1F55B"},{"Typeface name":"Wingdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11184","Unicode hex":"2BB0"},{"Typeface name":"Wingdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11185","Unicode hex":"2BB1"},{"Typeface name":"Wingdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11186","Unicode hex":"2BB2"},{"Typeface name":"Wingdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"11187","Unicode hex":"2BB3"},{"Typeface name":"Wingdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"11188","Unicode hex":"2BB4"},{"Typeface name":"Wingdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"11189","Unicode hex":"2BB5"},{"Typeface name":"Wingdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11190","Unicode hex":"2BB6"},{"Typeface name":"Wingdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11191","Unicode hex":"2BB7"},{"Typeface name":"Wingdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128618","Unicode hex":"1F66A"},{"Typeface name":"Wingdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128619","Unicode hex":"1F66B"},{"Typeface name":"Wingdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128597","Unicode hex":"1F655"},{"Typeface name":"Wingdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128596","Unicode hex":"1F654"},{"Typeface name":"Wingdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128599","Unicode hex":"1F657"},{"Typeface name":"Wingdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128598","Unicode hex":"1F656"},{"Typeface name":"Wingdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128592","Unicode hex":"1F650"},{"Typeface name":"Wingdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128593","Unicode hex":"1F651"},{"Typeface name":"Wingdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128594","Unicode hex":"1F652"},{"Typeface name":"Wingdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128595","Unicode hex":"1F653"},{"Typeface name":"Wingdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"9003","Unicode hex":"232B"},{"Typeface name":"Wingdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8998","Unicode hex":"2326"},{"Typeface name":"Wingdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"11160","Unicode hex":"2B98"},{"Typeface name":"Wingdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"11162","Unicode hex":"2B9A"},{"Typeface name":"Wingdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"11161","Unicode hex":"2B99"},{"Typeface name":"Wingdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"11163","Unicode hex":"2B9B"},{"Typeface name":"Wingdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"11144","Unicode hex":"2B88"},{"Typeface name":"Wingdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"11146","Unicode hex":"2B8A"},{"Typeface name":"Wingdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"11145","Unicode hex":"2B89"},{"Typeface name":"Wingdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"11147","Unicode hex":"2B8B"},{"Typeface name":"Wingdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129128","Unicode hex":"1F868"},{"Typeface name":"Wingdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129130","Unicode hex":"1F86A"},{"Typeface name":"Wingdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129129","Unicode hex":"1F869"},{"Typeface name":"Wingdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129131","Unicode hex":"1F86B"},{"Typeface name":"Wingdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129132","Unicode hex":"1F86C"},{"Typeface name":"Wingdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129133","Unicode hex":"1F86D"},{"Typeface name":"Wingdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129135","Unicode hex":"1F86F"},{"Typeface name":"Wingdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129134","Unicode hex":"1F86E"},{"Typeface name":"Wingdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129144","Unicode hex":"1F878"},{"Typeface name":"Wingdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129146","Unicode hex":"1F87A"},{"Typeface name":"Wingdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129145","Unicode hex":"1F879"},{"Typeface name":"Wingdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129147","Unicode hex":"1F87B"},{"Typeface name":"Wingdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129148","Unicode hex":"1F87C"},{"Typeface name":"Wingdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129149","Unicode hex":"1F87D"},{"Typeface name":"Wingdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129151","Unicode hex":"1F87F"},{"Typeface name":"Wingdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129150","Unicode hex":"1F87E"},{"Typeface name":"Wingdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"8678","Unicode hex":"21E6"},{"Typeface name":"Wingdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"8680","Unicode hex":"21E8"},{"Typeface name":"Wingdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"8679","Unicode hex":"21E7"},{"Typeface name":"Wingdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8681","Unicode hex":"21E9"},{"Typeface name":"Wingdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"11012","Unicode hex":"2B04"},{"Typeface name":"Wingdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"8691","Unicode hex":"21F3"},{"Typeface name":"Wingdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"11009","Unicode hex":"2B01"},{"Typeface name":"Wingdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11008","Unicode hex":"2B00"},{"Typeface name":"Wingdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11011","Unicode hex":"2B03"},{"Typeface name":"Wingdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"11010","Unicode hex":"2B02"},{"Typeface name":"Wingdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"129196","Unicode hex":"1F8AC"},{"Typeface name":"Wingdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"129197","Unicode hex":"1F8AD"},{"Typeface name":"Wingdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128502","Unicode hex":"1F5F6"},{"Typeface name":"Wingdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"10003","Unicode hex":"2713"},{"Typeface name":"Wingdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"128503","Unicode hex":"1F5F7"},{"Typeface name":"Wingdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"128505","Unicode hex":"1F5F9"},{"Typeface name":"Wingdings 2","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 2","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128394","Unicode hex":"1F58A"},{"Typeface name":"Wingdings 2","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128395","Unicode hex":"1F58B"},{"Typeface name":"Wingdings 2","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128396","Unicode hex":"1F58C"},{"Typeface name":"Wingdings 2","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128397","Unicode hex":"1F58D"},{"Typeface name":"Wingdings 2","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"9988","Unicode hex":"2704"},{"Typeface name":"Wingdings 2","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"9984","Unicode hex":"2700"},{"Typeface name":"Wingdings 2","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128382","Unicode hex":"1F57E"},{"Typeface name":"Wingdings 2","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128381","Unicode hex":"1F57D"},{"Typeface name":"Wingdings 2","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128453","Unicode hex":"1F5C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128454","Unicode hex":"1F5C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128455","Unicode hex":"1F5C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128456","Unicode hex":"1F5C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128457","Unicode hex":"1F5C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128458","Unicode hex":"1F5CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128459","Unicode hex":"1F5CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128460","Unicode hex":"1F5CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128461","Unicode hex":"1F5CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128465","Unicode hex":"1F5D1"},{"Typeface name":"Wingdings 2","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128468","Unicode hex":"1F5D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128437","Unicode hex":"1F5B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"128438","Unicode hex":"1F5B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128439","Unicode hex":"1F5B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128440","Unicode hex":"1F5B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128429","Unicode hex":"1F5AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128431","Unicode hex":"1F5AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128433","Unicode hex":"1F5B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128402","Unicode hex":"1F592"},{"Typeface name":"Wingdings 2","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128403","Unicode hex":"1F593"},{"Typeface name":"Wingdings 2","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128408","Unicode hex":"1F598"},{"Typeface name":"Wingdings 2","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128409","Unicode hex":"1F599"},{"Typeface name":"Wingdings 2","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128410","Unicode hex":"1F59A"},{"Typeface name":"Wingdings 2","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"128411","Unicode hex":"1F59B"},{"Typeface name":"Wingdings 2","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128072","Unicode hex":"1F448"},{"Typeface name":"Wingdings 2","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128073","Unicode hex":"1F449"},{"Typeface name":"Wingdings 2","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128412","Unicode hex":"1F59C"},{"Typeface name":"Wingdings 2","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"128413","Unicode hex":"1F59D"},{"Typeface name":"Wingdings 2","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"128414","Unicode hex":"1F59E"},{"Typeface name":"Wingdings 2","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"128415","Unicode hex":"1F59F"},{"Typeface name":"Wingdings 2","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"128416","Unicode hex":"1F5A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128417","Unicode hex":"1F5A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"128070","Unicode hex":"1F446"},{"Typeface name":"Wingdings 2","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128071","Unicode hex":"1F447"},{"Typeface name":"Wingdings 2","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128418","Unicode hex":"1F5A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128419","Unicode hex":"1F5A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128401","Unicode hex":"1F591"},{"Typeface name":"Wingdings 2","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128500","Unicode hex":"1F5F4"},{"Typeface name":"Wingdings 2","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"128504","Unicode hex":"1F5F8"},{"Typeface name":"Wingdings 2","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"128501","Unicode hex":"1F5F5"},{"Typeface name":"Wingdings 2","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9745","Unicode hex":"2611"},{"Typeface name":"Wingdings 2","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"11197","Unicode hex":"2BBD"},{"Typeface name":"Wingdings 2","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"9746","Unicode hex":"2612"},{"Typeface name":"Wingdings 2","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"11198","Unicode hex":"2BBE"},{"Typeface name":"Wingdings 2","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"11199","Unicode hex":"2BBF"},{"Typeface name":"Wingdings 2","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128711","Unicode hex":"1F6C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"128625","Unicode hex":"1F671"},{"Typeface name":"Wingdings 2","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"128628","Unicode hex":"1F674"},{"Typeface name":"Wingdings 2","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128626","Unicode hex":"1F672"},{"Typeface name":"Wingdings 2","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128627","Unicode hex":"1F673"},{"Typeface name":"Wingdings 2","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"8253","Unicode hex":"203D"},{"Typeface name":"Wingdings 2","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128633","Unicode hex":"1F679"},{"Typeface name":"Wingdings 2","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128634","Unicode hex":"1F67A"},{"Typeface name":"Wingdings 2","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"128635","Unicode hex":"1F67B"},{"Typeface name":"Wingdings 2","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"128614","Unicode hex":"1F666"},{"Typeface name":"Wingdings 2","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128612","Unicode hex":"1F664"},{"Typeface name":"Wingdings 2","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"128613","Unicode hex":"1F665"},{"Typeface name":"Wingdings 2","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128615","Unicode hex":"1F667"},{"Typeface name":"Wingdings 2","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128602","Unicode hex":"1F65A"},{"Typeface name":"Wingdings 2","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128600","Unicode hex":"1F658"},{"Typeface name":"Wingdings 2","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"128601","Unicode hex":"1F659"},{"Typeface name":"Wingdings 2","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128603","Unicode hex":"1F65B"},{"Typeface name":"Wingdings 2","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9450","Unicode hex":"24EA"},{"Typeface name":"Wingdings 2","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"9312","Unicode hex":"2460"},{"Typeface name":"Wingdings 2","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"9313","Unicode hex":"2461"},{"Typeface name":"Wingdings 2","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9314","Unicode hex":"2462"},{"Typeface name":"Wingdings 2","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"9315","Unicode hex":"2463"},{"Typeface name":"Wingdings 2","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9316","Unicode hex":"2464"},{"Typeface name":"Wingdings 2","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"9317","Unicode hex":"2465"},{"Typeface name":"Wingdings 2","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9318","Unicode hex":"2466"},{"Typeface name":"Wingdings 2","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9319","Unicode hex":"2467"},{"Typeface name":"Wingdings 2","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9320","Unicode hex":"2468"},{"Typeface name":"Wingdings 2","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9321","Unicode hex":"2469"},{"Typeface name":"Wingdings 2","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9471","Unicode hex":"24FF"},{"Typeface name":"Wingdings 2","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"10102","Unicode hex":"2776"},{"Typeface name":"Wingdings 2","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10103","Unicode hex":"2777"},{"Typeface name":"Wingdings 2","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"10104","Unicode hex":"2778"},{"Typeface name":"Wingdings 2","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10105","Unicode hex":"2779"},{"Typeface name":"Wingdings 2","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"10106","Unicode hex":"277A"},{"Typeface name":"Wingdings 2","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"10107","Unicode hex":"277B"},{"Typeface name":"Wingdings 2","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"10108","Unicode hex":"277C"},{"Typeface name":"Wingdings 2","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"10109","Unicode hex":"277D"},{"Typeface name":"Wingdings 2","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"10110","Unicode hex":"277E"},{"Typeface name":"Wingdings 2","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"10111","Unicode hex":"277F"},{"Typeface name":"Wingdings 2","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"9737","Unicode hex":"2609"},{"Typeface name":"Wingdings 2","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"127765","Unicode hex":"1F315"},{"Typeface name":"Wingdings 2","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"9789","Unicode hex":"263D"},{"Typeface name":"Wingdings 2","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"9790","Unicode hex":"263E"},{"Typeface name":"Wingdings 2","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11839","Unicode hex":"2E3F"},{"Typeface name":"Wingdings 2","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10013","Unicode hex":"271D"},{"Typeface name":"Wingdings 2","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"128327","Unicode hex":"1F547"},{"Typeface name":"Wingdings 2","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"128348","Unicode hex":"1F55C"},{"Typeface name":"Wingdings 2","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"128349","Unicode hex":"1F55D"},{"Typeface name":"Wingdings 2","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"128350","Unicode hex":"1F55E"},{"Typeface name":"Wingdings 2","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"128351","Unicode hex":"1F55F"},{"Typeface name":"Wingdings 2","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"128352","Unicode hex":"1F560"},{"Typeface name":"Wingdings 2","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"128353","Unicode hex":"1F561"},{"Typeface name":"Wingdings 2","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"128354","Unicode hex":"1F562"},{"Typeface name":"Wingdings 2","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128355","Unicode hex":"1F563"},{"Typeface name":"Wingdings 2","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128356","Unicode hex":"1F564"},{"Typeface name":"Wingdings 2","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128357","Unicode hex":"1F565"},{"Typeface name":"Wingdings 2","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128358","Unicode hex":"1F566"},{"Typeface name":"Wingdings 2","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"128359","Unicode hex":"1F567"},{"Typeface name":"Wingdings 2","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128616","Unicode hex":"1F668"},{"Typeface name":"Wingdings 2","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128617","Unicode hex":"1F669"},{"Typeface name":"Wingdings 2","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128900","Unicode hex":"1F784"},{"Typeface name":"Wingdings 2","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"10625","Unicode hex":"2981"},{"Typeface name":"Wingdings 2","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"9679","Unicode hex":"25CF"},{"Typeface name":"Wingdings 2","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"9675","Unicode hex":"25CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128901","Unicode hex":"1F785"},{"Typeface name":"Wingdings 2","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128903","Unicode hex":"1F787"},{"Typeface name":"Wingdings 2","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128905","Unicode hex":"1F789"},{"Typeface name":"Wingdings 2","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"8857","Unicode hex":"2299"},{"Typeface name":"Wingdings 2","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"10687","Unicode hex":"29BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128908","Unicode hex":"1F78C"},{"Typeface name":"Wingdings 2","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128909","Unicode hex":"1F78D"},{"Typeface name":"Wingdings 2","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"9726","Unicode hex":"25FE"},{"Typeface name":"Wingdings 2","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"9632","Unicode hex":"25A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"9633","Unicode hex":"25A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128913","Unicode hex":"1F791"},{"Typeface name":"Wingdings 2","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128914","Unicode hex":"1F792"},{"Typeface name":"Wingdings 2","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128915","Unicode hex":"1F793"},{"Typeface name":"Wingdings 2","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128916","Unicode hex":"1F794"},{"Typeface name":"Wingdings 2","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9635","Unicode hex":"25A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128917","Unicode hex":"1F795"},{"Typeface name":"Wingdings 2","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128918","Unicode hex":"1F796"},{"Typeface name":"Wingdings 2","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128919","Unicode hex":"1F797"},{"Typeface name":"Wingdings 2","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128920","Unicode hex":"1F798"},{"Typeface name":"Wingdings 2","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings 2","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"11045","Unicode hex":"2B25"},{"Typeface name":"Wingdings 2","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"9671","Unicode hex":"25C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"128922","Unicode hex":"1F79A"},{"Typeface name":"Wingdings 2","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"9672","Unicode hex":"25C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"128923","Unicode hex":"1F79B"},{"Typeface name":"Wingdings 2","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128924","Unicode hex":"1F79C"},{"Typeface name":"Wingdings 2","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"128925","Unicode hex":"1F79D"},{"Typeface name":"Wingdings 2","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128926","Unicode hex":"1F79E"},{"Typeface name":"Wingdings 2","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"11050","Unicode hex":"2B2A"},{"Typeface name":"Wingdings 2","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"11047","Unicode hex":"2B27"},{"Typeface name":"Wingdings 2","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128928","Unicode hex":"1F7A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"9686","Unicode hex":"25D6"},{"Typeface name":"Wingdings 2","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"9687","Unicode hex":"25D7"},{"Typeface name":"Wingdings 2","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"11210","Unicode hex":"2BCA"},{"Typeface name":"Wingdings 2","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"11211","Unicode hex":"2BCB"},{"Typeface name":"Wingdings 2","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"11200","Unicode hex":"2BC0"},{"Typeface name":"Wingdings 2","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"11201","Unicode hex":"2BC1"},{"Typeface name":"Wingdings 2","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"11039","Unicode hex":"2B1F"},{"Typeface name":"Wingdings 2","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"11202","Unicode hex":"2BC2"},{"Typeface name":"Wingdings 2","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"11043","Unicode hex":"2B23"},{"Typeface name":"Wingdings 2","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11042","Unicode hex":"2B22"},{"Typeface name":"Wingdings 2","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11203","Unicode hex":"2BC3"},{"Typeface name":"Wingdings 2","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11204","Unicode hex":"2BC4"},{"Typeface name":"Wingdings 2","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128929","Unicode hex":"1F7A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128930","Unicode hex":"1F7A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128931","Unicode hex":"1F7A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128932","Unicode hex":"1F7A4"},{"Typeface name":"Wingdings 2","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128933","Unicode hex":"1F7A5"},{"Typeface name":"Wingdings 2","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128934","Unicode hex":"1F7A6"},{"Typeface name":"Wingdings 2","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128935","Unicode hex":"1F7A7"},{"Typeface name":"Wingdings 2","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128936","Unicode hex":"1F7A8"},{"Typeface name":"Wingdings 2","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128937","Unicode hex":"1F7A9"},{"Typeface name":"Wingdings 2","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128938","Unicode hex":"1F7AA"},{"Typeface name":"Wingdings 2","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128939","Unicode hex":"1F7AB"},{"Typeface name":"Wingdings 2","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128940","Unicode hex":"1F7AC"},{"Typeface name":"Wingdings 2","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128941","Unicode hex":"1F7AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128942","Unicode hex":"1F7AE"},{"Typeface name":"Wingdings 2","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128943","Unicode hex":"1F7AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"128944","Unicode hex":"1F7B0"},{"Typeface name":"Wingdings 2","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"128945","Unicode hex":"1F7B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"128946","Unicode hex":"1F7B2"},{"Typeface name":"Wingdings 2","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"128947","Unicode hex":"1F7B3"},{"Typeface name":"Wingdings 2","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"128948","Unicode hex":"1F7B4"},{"Typeface name":"Wingdings 2","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"128949","Unicode hex":"1F7B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"128950","Unicode hex":"1F7B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"128951","Unicode hex":"1F7B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"128952","Unicode hex":"1F7B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"128953","Unicode hex":"1F7B9"},{"Typeface name":"Wingdings 2","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"128954","Unicode hex":"1F7BA"},{"Typeface name":"Wingdings 2","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"128955","Unicode hex":"1F7BB"},{"Typeface name":"Wingdings 2","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"128956","Unicode hex":"1F7BC"},{"Typeface name":"Wingdings 2","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128957","Unicode hex":"1F7BD"},{"Typeface name":"Wingdings 2","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128958","Unicode hex":"1F7BE"},{"Typeface name":"Wingdings 2","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"128959","Unicode hex":"1F7BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"128960","Unicode hex":"1F7C0"},{"Typeface name":"Wingdings 2","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128962","Unicode hex":"1F7C2"},{"Typeface name":"Wingdings 2","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128964","Unicode hex":"1F7C4"},{"Typeface name":"Wingdings 2","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"128966","Unicode hex":"1F7C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"128969","Unicode hex":"1F7C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128970","Unicode hex":"1F7CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"10038","Unicode hex":"2736"},{"Typeface name":"Wingdings 2","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"128972","Unicode hex":"1F7CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128974","Unicode hex":"1F7CE"},{"Typeface name":"Wingdings 2","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128976","Unicode hex":"1F7D0"},{"Typeface name":"Wingdings 2","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128978","Unicode hex":"1F7D2"},{"Typeface name":"Wingdings 2","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"10041","Unicode hex":"2739"},{"Typeface name":"Wingdings 2","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128963","Unicode hex":"1F7C3"},{"Typeface name":"Wingdings 2","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128967","Unicode hex":"1F7C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Wingdings 2","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128973","Unicode hex":"1F7CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128980","Unicode hex":"1F7D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11212","Unicode hex":"2BCC"},{"Typeface name":"Wingdings 2","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11213","Unicode hex":"2BCD"},{"Typeface name":"Wingdings 2","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"8251","Unicode hex":"203B"},{"Typeface name":"Wingdings 2","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"8258","Unicode hex":"2042"},{"Typeface name":"Wingdings 3","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 3","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"11104","Unicode hex":"2B60"},{"Typeface name":"Wingdings 3","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"11106","Unicode hex":"2B62"},{"Typeface name":"Wingdings 3","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"11105","Unicode hex":"2B61"},{"Typeface name":"Wingdings 3","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"11107","Unicode hex":"2B63"},{"Typeface name":"Wingdings 3","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"11110","Unicode hex":"2B66"},{"Typeface name":"Wingdings 3","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"11111","Unicode hex":"2B67"},{"Typeface name":"Wingdings 3","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"11113","Unicode hex":"2B69"},{"Typeface name":"Wingdings 3","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"11112","Unicode hex":"2B68"},{"Typeface name":"Wingdings 3","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"11120","Unicode hex":"2B70"},{"Typeface name":"Wingdings 3","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"11122","Unicode hex":"2B72"},{"Typeface name":"Wingdings 3","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"11121","Unicode hex":"2B71"},{"Typeface name":"Wingdings 3","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"11123","Unicode hex":"2B73"},{"Typeface name":"Wingdings 3","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"11126","Unicode hex":"2B76"},{"Typeface name":"Wingdings 3","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"11128","Unicode hex":"2B78"},{"Typeface name":"Wingdings 3","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"11131","Unicode hex":"2B7B"},{"Typeface name":"Wingdings 3","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"11133","Unicode hex":"2B7D"},{"Typeface name":"Wingdings 3","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"11108","Unicode hex":"2B64"},{"Typeface name":"Wingdings 3","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"11109","Unicode hex":"2B65"},{"Typeface name":"Wingdings 3","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"11114","Unicode hex":"2B6A"},{"Typeface name":"Wingdings 3","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"11116","Unicode hex":"2B6C"},{"Typeface name":"Wingdings 3","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"11115","Unicode hex":"2B6B"},{"Typeface name":"Wingdings 3","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"11117","Unicode hex":"2B6D"},{"Typeface name":"Wingdings 3","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"11085","Unicode hex":"2B4D"},{"Typeface name":"Wingdings 3","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"11168","Unicode hex":"2BA0"},{"Typeface name":"Wingdings 3","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"11169","Unicode hex":"2BA1"},{"Typeface name":"Wingdings 3","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"11170","Unicode hex":"2BA2"},{"Typeface name":"Wingdings 3","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"11171","Unicode hex":"2BA3"},{"Typeface name":"Wingdings 3","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"11172","Unicode hex":"2BA4"},{"Typeface name":"Wingdings 3","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"11173","Unicode hex":"2BA5"},{"Typeface name":"Wingdings 3","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"11174","Unicode hex":"2BA6"},{"Typeface name":"Wingdings 3","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"11175","Unicode hex":"2BA7"},{"Typeface name":"Wingdings 3","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"11152","Unicode hex":"2B90"},{"Typeface name":"Wingdings 3","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"11153","Unicode hex":"2B91"},{"Typeface name":"Wingdings 3","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"11154","Unicode hex":"2B92"},{"Typeface name":"Wingdings 3","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"11155","Unicode hex":"2B93"},{"Typeface name":"Wingdings 3","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"11136","Unicode hex":"2B80"},{"Typeface name":"Wingdings 3","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"11139","Unicode hex":"2B83"},{"Typeface name":"Wingdings 3","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"11134","Unicode hex":"2B7E"},{"Typeface name":"Wingdings 3","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"11135","Unicode hex":"2B7F"},{"Typeface name":"Wingdings 3","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"11140","Unicode hex":"2B84"},{"Typeface name":"Wingdings 3","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"11142","Unicode hex":"2B86"},{"Typeface name":"Wingdings 3","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"11141","Unicode hex":"2B85"},{"Typeface name":"Wingdings 3","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"11143","Unicode hex":"2B87"},{"Typeface name":"Wingdings 3","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"11151","Unicode hex":"2B8F"},{"Typeface name":"Wingdings 3","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"11149","Unicode hex":"2B8D"},{"Typeface name":"Wingdings 3","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"11150","Unicode hex":"2B8E"},{"Typeface name":"Wingdings 3","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"11148","Unicode hex":"2B8C"},{"Typeface name":"Wingdings 3","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"11118","Unicode hex":"2B6E"},{"Typeface name":"Wingdings 3","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"11119","Unicode hex":"2B6F"},{"Typeface name":"Wingdings 3","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9099","Unicode hex":"238B"},{"Typeface name":"Wingdings 3","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"8996","Unicode hex":"2324"},{"Typeface name":"Wingdings 3","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"8963","Unicode hex":"2303"},{"Typeface name":"Wingdings 3","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"8997","Unicode hex":"2325"},{"Typeface name":"Wingdings 3","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"9251","Unicode hex":"2423"},{"Typeface name":"Wingdings 3","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"9085","Unicode hex":"237D"},{"Typeface name":"Wingdings 3","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"8682","Unicode hex":"21EA"},{"Typeface name":"Wingdings 3","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"11192","Unicode hex":"2BB8"},{"Typeface name":"Wingdings 3","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"129184","Unicode hex":"1F8A0"},{"Typeface name":"Wingdings 3","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"129185","Unicode hex":"1F8A1"},{"Typeface name":"Wingdings 3","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"129186","Unicode hex":"1F8A2"},{"Typeface name":"Wingdings 3","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"129187","Unicode hex":"1F8A3"},{"Typeface name":"Wingdings 3","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"129188","Unicode hex":"1F8A4"},{"Typeface name":"Wingdings 3","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"129189","Unicode hex":"1F8A5"},{"Typeface name":"Wingdings 3","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"129190","Unicode hex":"1F8A6"},{"Typeface name":"Wingdings 3","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"129191","Unicode hex":"1F8A7"},{"Typeface name":"Wingdings 3","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"129192","Unicode hex":"1F8A8"},{"Typeface name":"Wingdings 3","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"129193","Unicode hex":"1F8A9"},{"Typeface name":"Wingdings 3","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"129194","Unicode hex":"1F8AA"},{"Typeface name":"Wingdings 3","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"129195","Unicode hex":"1F8AB"},{"Typeface name":"Wingdings 3","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"129104","Unicode hex":"1F850"},{"Typeface name":"Wingdings 3","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"129106","Unicode hex":"1F852"},{"Typeface name":"Wingdings 3","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"129105","Unicode hex":"1F851"},{"Typeface name":"Wingdings 3","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"129107","Unicode hex":"1F853"},{"Typeface name":"Wingdings 3","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"129108","Unicode hex":"1F854"},{"Typeface name":"Wingdings 3","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"129109","Unicode hex":"1F855"},{"Typeface name":"Wingdings 3","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"129111","Unicode hex":"1F857"},{"Typeface name":"Wingdings 3","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"129110","Unicode hex":"1F856"},{"Typeface name":"Wingdings 3","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"129112","Unicode hex":"1F858"},{"Typeface name":"Wingdings 3","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"129113","Unicode hex":"1F859"},{"Typeface name":"Wingdings 3","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9650","Unicode hex":"25B2"},{"Typeface name":"Wingdings 3","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9660","Unicode hex":"25BC"},{"Typeface name":"Wingdings 3","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9651","Unicode hex":"25B3"},{"Typeface name":"Wingdings 3","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9661","Unicode hex":"25BD"},{"Typeface name":"Wingdings 3","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9664","Unicode hex":"25C0"},{"Typeface name":"Wingdings 3","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9654","Unicode hex":"25B6"},{"Typeface name":"Wingdings 3","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"9665","Unicode hex":"25C1"},{"Typeface name":"Wingdings 3","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9655","Unicode hex":"25B7"},{"Typeface name":"Wingdings 3","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"9699","Unicode hex":"25E3"},{"Typeface name":"Wingdings 3","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"9698","Unicode hex":"25E2"},{"Typeface name":"Wingdings 3","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"9700","Unicode hex":"25E4"},{"Typeface name":"Wingdings 3","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"9701","Unicode hex":"25E5"},{"Typeface name":"Wingdings 3","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"128896","Unicode hex":"1F780"},{"Typeface name":"Wingdings 3","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128898","Unicode hex":"1F782"},{"Typeface name":"Wingdings 3","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128897","Unicode hex":"1F781"},{"Typeface name":"Wingdings 3","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128899","Unicode hex":"1F783"},{"Typeface name":"Wingdings 3","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"11205","Unicode hex":"2BC5"},{"Typeface name":"Wingdings 3","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"11206","Unicode hex":"2BC6"},{"Typeface name":"Wingdings 3","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"11207","Unicode hex":"2BC7"},{"Typeface name":"Wingdings 3","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11208","Unicode hex":"2BC8"},{"Typeface name":"Wingdings 3","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"11164","Unicode hex":"2B9C"},{"Typeface name":"Wingdings 3","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"11166","Unicode hex":"2B9E"},{"Typeface name":"Wingdings 3","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"11165","Unicode hex":"2B9D"},{"Typeface name":"Wingdings 3","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"11167","Unicode hex":"2B9F"},{"Typeface name":"Wingdings 3","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"129040","Unicode hex":"1F810"},{"Typeface name":"Wingdings 3","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"129042","Unicode hex":"1F812"},{"Typeface name":"Wingdings 3","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"129041","Unicode hex":"1F811"},{"Typeface name":"Wingdings 3","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"129043","Unicode hex":"1F813"},{"Typeface name":"Wingdings 3","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"129044","Unicode hex":"1F814"},{"Typeface name":"Wingdings 3","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"129046","Unicode hex":"1F816"},{"Typeface name":"Wingdings 3","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"129045","Unicode hex":"1F815"},{"Typeface name":"Wingdings 3","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"129047","Unicode hex":"1F817"},{"Typeface name":"Wingdings 3","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"129048","Unicode hex":"1F818"},{"Typeface name":"Wingdings 3","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"129050","Unicode hex":"1F81A"},{"Typeface name":"Wingdings 3","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"129049","Unicode hex":"1F819"},{"Typeface name":"Wingdings 3","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"129051","Unicode hex":"1F81B"},{"Typeface name":"Wingdings 3","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"129052","Unicode hex":"1F81C"},{"Typeface name":"Wingdings 3","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"129054","Unicode hex":"1F81E"},{"Typeface name":"Wingdings 3","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"129053","Unicode hex":"1F81D"},{"Typeface name":"Wingdings 3","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"129055","Unicode hex":"1F81F"},{"Typeface name":"Wingdings 3","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"129024","Unicode hex":"1F800"},{"Typeface name":"Wingdings 3","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"129026","Unicode hex":"1F802"},{"Typeface name":"Wingdings 3","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"129025","Unicode hex":"1F801"},{"Typeface name":"Wingdings 3","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"129027","Unicode hex":"1F803"},{"Typeface name":"Wingdings 3","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"129028","Unicode hex":"1F804"},{"Typeface name":"Wingdings 3","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"129030","Unicode hex":"1F806"},{"Typeface name":"Wingdings 3","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"129029","Unicode hex":"1F805"},{"Typeface name":"Wingdings 3","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"129031","Unicode hex":"1F807"},{"Typeface name":"Wingdings 3","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"129032","Unicode hex":"1F808"},{"Typeface name":"Wingdings 3","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"129034","Unicode hex":"1F80A"},{"Typeface name":"Wingdings 3","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"129033","Unicode hex":"1F809"},{"Typeface name":"Wingdings 3","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"129035","Unicode hex":"1F80B"},{"Typeface name":"Wingdings 3","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"129056","Unicode hex":"1F820"},{"Typeface name":"Wingdings 3","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"129058","Unicode hex":"1F822"},{"Typeface name":"Wingdings 3","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"129060","Unicode hex":"1F824"},{"Typeface name":"Wingdings 3","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"129062","Unicode hex":"1F826"},{"Typeface name":"Wingdings 3","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"129064","Unicode hex":"1F828"},{"Typeface name":"Wingdings 3","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"129066","Unicode hex":"1F82A"},{"Typeface name":"Wingdings 3","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"129068","Unicode hex":"1F82C"},{"Typeface name":"Wingdings 3","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"129180","Unicode hex":"1F89C"},{"Typeface name":"Wingdings 3","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"129181","Unicode hex":"1F89D"},{"Typeface name":"Wingdings 3","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"129182","Unicode hex":"1F89E"},{"Typeface name":"Wingdings 3","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"129183","Unicode hex":"1F89F"},{"Typeface name":"Wingdings 3","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"129070","Unicode hex":"1F82E"},{"Typeface name":"Wingdings 3","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"129072","Unicode hex":"1F830"},{"Typeface name":"Wingdings 3","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"129074","Unicode hex":"1F832"},{"Typeface name":"Wingdings 3","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"129076","Unicode hex":"1F834"},{"Typeface name":"Wingdings 3","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"129078","Unicode hex":"1F836"},{"Typeface name":"Wingdings 3","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"129080","Unicode hex":"1F838"},{"Typeface name":"Wingdings 3","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"129082","Unicode hex":"1F83A"},{"Typeface name":"Wingdings 3","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"129081","Unicode hex":"1F839"},{"Typeface name":"Wingdings 3","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"129083","Unicode hex":"1F83B"},{"Typeface name":"Wingdings 3","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"129176","Unicode hex":"1F898"},{"Typeface name":"Wingdings 3","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"129178","Unicode hex":"1F89A"},{"Typeface name":"Wingdings 3","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"129177","Unicode hex":"1F899"},{"Typeface name":"Wingdings 3","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"129179","Unicode hex":"1F89B"},{"Typeface name":"Wingdings 3","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"129084","Unicode hex":"1F83C"},{"Typeface name":"Wingdings 3","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"129086","Unicode hex":"1F83E"},{"Typeface name":"Wingdings 3","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"129085","Unicode hex":"1F83D"},{"Typeface name":"Wingdings 3","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"129087","Unicode hex":"1F83F"},{"Typeface name":"Wingdings 3","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"129088","Unicode hex":"1F840"},{"Typeface name":"Wingdings 3","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"129090","Unicode hex":"1F842"},{"Typeface name":"Wingdings 3","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"129089","Unicode hex":"1F841"},{"Typeface name":"Wingdings 3","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"129091","Unicode hex":"1F843"},{"Typeface name":"Wingdings 3","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"129092","Unicode hex":"1F844"},{"Typeface name":"Wingdings 3","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"129094","Unicode hex":"1F846"},{"Typeface name":"Wingdings 3","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"129093","Unicode hex":"1F845"},{"Typeface name":"Wingdings 3","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"129095","Unicode hex":"1F847"},{"Typeface name":"Wingdings 3","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11176","Unicode hex":"2BA8"},{"Typeface name":"Wingdings 3","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11177","Unicode hex":"2BA9"},{"Typeface name":"Wingdings 3","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"11178","Unicode hex":"2BAA"},{"Typeface name":"Wingdings 3","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"11179","Unicode hex":"2BAB"},{"Typeface name":"Wingdings 3","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"11180","Unicode hex":"2BAC"},{"Typeface name":"Wingdings 3","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"11181","Unicode hex":"2BAD"},{"Typeface name":"Wingdings 3","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"11182","Unicode hex":"2BAE"},{"Typeface name":"Wingdings 3","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"11183","Unicode hex":"2BAF"},{"Typeface name":"Wingdings 3","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"129120","Unicode hex":"1F860"},{"Typeface name":"Wingdings 3","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"129122","Unicode hex":"1F862"},{"Typeface name":"Wingdings 3","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"129121","Unicode hex":"1F861"},{"Typeface name":"Wingdings 3","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"129123","Unicode hex":"1F863"},{"Typeface name":"Wingdings 3","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"129124","Unicode hex":"1F864"},{"Typeface name":"Wingdings 3","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"129125","Unicode hex":"1F865"},{"Typeface name":"Wingdings 3","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"129127","Unicode hex":"1F867"},{"Typeface name":"Wingdings 3","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"129126","Unicode hex":"1F866"},{"Typeface name":"Wingdings 3","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"129136","Unicode hex":"1F870"},{"Typeface name":"Wingdings 3","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"129138","Unicode hex":"1F872"},{"Typeface name":"Wingdings 3","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"129137","Unicode hex":"1F871"},{"Typeface name":"Wingdings 3","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"129139","Unicode hex":"1F873"},{"Typeface name":"Wingdings 3","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"129140","Unicode hex":"1F874"},{"Typeface name":"Wingdings 3","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"129141","Unicode hex":"1F875"},{"Typeface name":"Wingdings 3","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129143","Unicode hex":"1F877"},{"Typeface name":"Wingdings 3","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129142","Unicode hex":"1F876"},{"Typeface name":"Wingdings 3","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129152","Unicode hex":"1F880"},{"Typeface name":"Wingdings 3","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129154","Unicode hex":"1F882"},{"Typeface name":"Wingdings 3","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129153","Unicode hex":"1F881"},{"Typeface name":"Wingdings 3","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129155","Unicode hex":"1F883"},{"Typeface name":"Wingdings 3","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129156","Unicode hex":"1F884"},{"Typeface name":"Wingdings 3","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129157","Unicode hex":"1F885"},{"Typeface name":"Wingdings 3","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129159","Unicode hex":"1F887"},{"Typeface name":"Wingdings 3","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129158","Unicode hex":"1F886"},{"Typeface name":"Wingdings 3","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129168","Unicode hex":"1F890"},{"Typeface name":"Wingdings 3","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129170","Unicode hex":"1F892"},{"Typeface name":"Wingdings 3","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129169","Unicode hex":"1F891"},{"Typeface name":"Wingdings 3","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129171","Unicode hex":"1F893"},{"Typeface name":"Wingdings 3","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129172","Unicode hex":"1F894"},{"Typeface name":"Wingdings 3","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129174","Unicode hex":"1F896"},{"Typeface name":"Wingdings 3","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"129173","Unicode hex":"1F895"},{"Typeface name":"Wingdings 3","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"129175","Unicode hex":"1F897"}]),yE)),n={},i=String.fromCodePoint?String.fromCodePoint:function(e){if(e<=65535)return String.fromCharCode(e);var t=Math.floor((e-65536)/1024)+55296,n=(e-65536)%1024+56320;return String.fromCharCode(t,n)},r=0,a=t.default;r<a.length;r++){var s=a[r],o=parseInt(s["Unicode dec"],10),c={codePoint:o,string:i(o)};n[s["Typeface name"].toUpperCase()+"_"+s["Dingbat dec"]]=c}function l(e,t){return n[e.toUpperCase()+"_"+t]}return vE.codePoint=l,vE.dec=function(e,t){return l(e,parseInt(t,10))},vE.hex=function(e,t){return l(e,parseInt(t,16))},vE}(),t=bx,n=X_(),i=Z_().Result,r=Z_().warning,a=pE(),s=(wE||(wE=1,_E.uriToZipEntryName=function(e,t){return"/"===t.charAt(0)?t.substr(1):e+"/"+t},_E.replaceFragment=function(e,t){var n=e.indexOf("#");return-1!==n&&(e=e.substring(0,n)),e+"#"+t}),_E);function o(i){var o=[],b=[],v=[],y=i.relationships,w=i.contentTypes,x=i.docxFile,_=i.files,T=i.numbering,D=i.styles;function E(e){return m(e.map(A))}function A(e){if("element"===e.type){var t=N[e.name];if(t)return t(e);if(!Object.prototype.hasOwnProperty.call(h,e.name))return d([r("An unrecognised element was ignored: "+e.name)])}return u()}function k(e){return{start:e.attributes["w:start"]||e.attributes["w:left"],end:e.attributes["w:end"]||e.attributes["w:right"],firstLine:e.attributes["w:firstLine"],hanging:e.attributes["w:hanging"]}}function S(e){if(e){var t=e.attributes["w:val"];return void 0!==t&&"false"!==t&&"0"!==t&&"none"!==t}return!1}function C(e){if(e){var t=e.attributes["w:val"];return"false"!==t&&"0"!==t}return!1}function U(e,t,n,i){var a=[],s=e.first(t),o=null,c=null;if(s&&(o=s.attributes["w:val"])){var l=i(o);l?c=l.name:a.push(function(e,t){return r(e+" style with ID "+t+" was referenced but not defined in the document")}(n,o))}return p({styleId:o,name:c},a)}function F(e){return function(e,t){var n=/\s*HYPERLINK "(.*)"/.exec(e);if(n)return{type:"hyperlink",options:{href:n[1]}};var i=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(e);if(i)return{type:"hyperlink",options:{anchor:i[1]}};if(/\s*FORMCHECKBOX\s*/.exec(e)){var r=t.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),a=r.first("w:checked");return{type:"checkbox",checked:C(null==a?r.first("w:default"):a)}}return{type:"unknown"}}(b.join(""),"begin"===e.type?e.fldChar:a.emptyElement)}function I(e){return function(t){var i=t.attributes["w:id"];return f(new n.NoteReference({noteType:e,noteId:i}))}}function R(e){return E(e.children)}var N={"w:p":function(e){var t=e.firstOrEmpty("w:pPr");if(t.firstOrEmpty("w:rPr").first("w:del"))return e.children.forEach(function(e){v.push(e)}),u();var i=e.children;return v.length>0&&(i=v.concat(i),v=[]),g.map(function(e){return function(e){return U(e,"w:pStyle","Paragraph",D.findParagraphStyleById)}(e).map(function(t){return{type:"paragraphProperties",styleId:t.styleId,styleName:t.name,alignment:e.firstOrEmpty("w:jc").attributes["w:val"],numbering:c(t.styleId,e.firstOrEmpty("w:numPr"),T),indent:k(e.firstOrEmpty("w:ind"))}})}(t),E(i),function(e,t){return new n.Paragraph(t,e)}).insertExtra()},"w:r":function(e){return g.map(function(e){return function(e){return U(e,"w:rStyle","Run",D.findCharacterStyleById)}(e).map(function(t){var n,i=e.firstOrEmpty("w:sz").attributes["w:val"],r=/^[0-9]+$/.test(i)?parseInt(i,10)/2:null;return{type:"runProperties",styleId:t.styleId,styleName:t.name,verticalAlignment:e.firstOrEmpty("w:vertAlign").attributes["w:val"],font:e.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:r,isBold:C(e.first("w:b")),isUnderline:S(e.first("w:u")),isItalic:C(e.first("w:i")),isStrikethrough:C(e.first("w:strike")),isAllCaps:C(e.first("w:caps")),isSmallCaps:C(e.first("w:smallCaps")),highlight:(n=e.firstOrEmpty("w:highlight").attributes["w:val"],n&&"none"!==n?n:null)}})}(e.firstOrEmpty("w:rPr")),E(e.children),function(e,i){var r,a=(r=t.last(o.filter(function(e){return"hyperlink"===e.type})))?r.options:null;return null!==a&&(i=[new n.Hyperlink(i,a)]),new n.Run(i,e)})},"w:fldChar":function(e){var t=e.attributes["w:fldCharType"];if("begin"===t)o.push({type:"begin",fldChar:e}),b=[];else if("end"===t){var i=o.pop();if("begin"===i.type&&(i=F(i)),"checkbox"===i.type)return f(n.checkbox({checked:i.checked}))}else if("separate"===t){var r=F(o.pop());o.push(r)}return u()},"w:instrText":function(e){return b.push(e.text()),u()},"w:t":function(e){return f(new n.Text(e.text()))},"w:tab":function(e){return f(new n.Tab)},"w:noBreakHyphen":function(){return f(new n.Text("‑"))},"w:softHyphen":function(e){return f(new n.Text("­"))},"w:sym":function(t){var i=t.attributes["w:font"],a=t.attributes["w:char"],s=e.hex(i,a);return null==s&&/^F0..$/.test(a)&&(s=e.hex(i,a.substring(2))),null==s?d([r("A w:sym element with an unsupported character was ignored: char "+a+" in font "+i)]):f(new n.Text(s.string))},"w:hyperlink":function(e){var i=e.attributes["r:id"],r=e.attributes["w:anchor"];return E(e.children).map(function(a){function o(i){var r=e.attributes["w:tgtFrame"]||null;return new n.Hyperlink(a,t.extend({targetFrame:r},i))}if(i){var c=y.findTargetByRelationshipId(i);return r&&(c=s.replaceFragment(c,r)),o({href:c})}return r?o({anchor:r}):a})},"w:tbl":function(e){var t=function(e){return function(e){return U(e,"w:tblStyle","Table",D.findTableStyleById)}(e).map(function(e){return{styleId:e.styleId,styleName:e.name}})}(e.firstOrEmpty("w:tblPr"));return E(e.children).flatMap(M).flatMap(function(e){return t.map(function(t){return n.Table(e,t)})})},"w:tr":function(e){var t=!!e.firstOrEmpty("w:trPr").first("w:tblHeader");return E(e.children).map(function(e){return n.TableRow(e,{isHeader:t})})},"w:tc":function(e){return E(e.children).map(function(t){var i=e.firstOrEmpty("w:tcPr"),r=i.firstOrEmpty("w:gridSpan").attributes["w:val"],a=r?parseInt(r,10):1,s=n.TableCell(t,{colSpan:a});return s._vMerge=function(e){var t=e.first("w:vMerge");if(t){var n=t.attributes["w:val"];return"continue"===n||!n}return null}(i),s})},"w:footnoteReference":I("footnote"),"w:endnoteReference":I("endnote"),"w:commentReference":function(e){return f(n.commentReference({commentId:e.attributes["w:id"]}))},"w:br":function(e){var t=e.attributes["w:type"];return null==t||"textWrapping"===t?f(n.lineBreak):"page"===t?f(n.pageBreak):"column"===t?f(n.columnBreak):d([r("Unsupported break type: "+t)])},"w:bookmarkStart":function(e){var t=e.attributes["w:name"];return"_GoBack"===t?u():f(new n.BookmarkStart({name:t}))},"mc:AlternateContent":function(e){return R(e.firstOrEmpty("mc:Fallback"))},"w:sdt":function(e){var t,i=e.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(i){var r=i.first("wordml:checked"),a=!!r&&"false"!==(t=r.attributes["wordml:val"])&&"0"!==t;return f(n.checkbox({checked:a}))}return E(e.firstOrEmpty("w:sdtContent").children)},"w:ins":R,"w:object":R,"w:smartTag":R,"w:drawing":R,"w:pict":function(e){return R(e).toExtra()},"v:roundrect":R,"v:shape":R,"v:textbox":R,"w:txbxContent":R,"wp:inline":O,"wp:anchor":O,"v:imagedata":function(e){var t=e.attributes["r:id"];return t?W(L(t),e.attributes["o:title"]):d([r("A v:imagedata element without a relationship ID was ignored")])},"v:group":R,"v:rect":R};return{readXmlElement:A,readXmlElements:E};function M(e){if(t.any(e,function(e){return e.type!==n.types.tableRow}))return p(e,[r("unexpected non-row element in table, cell merging may be incorrect")]);if(t.any(e,function(e){return t.any(e.children,function(e){return e.type!==n.types.tableCell})}))return p(e,[r("unexpected non-cell element in table row, cell merging may be incorrect")]);var i={};return e.forEach(function(e){var t=0;e.children.forEach(function(e){e._vMerge&&i[t]?i[t].rowSpan++:(i[t]=e,e._vMerge=!1),t+=e.colSpan})}),e.forEach(function(e){e.children=e.children.filter(function(e){return!e._vMerge}),e.children.forEach(function(e){delete e._vMerge})}),f(e)}function O(e){return m(e.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip").map(P.bind(null,e)))}function P(e,t){var n,i=e.first("wp:docPr").attributes,a=null==(n=i.descr)||/^\s*$/.test(n)?i.title:i.descr,s=function(e){var t=e.attributes["r:embed"],n=e.attributes["r:link"];if(t)return L(t);if(n){var i=y.findTargetByRelationshipId(n);return{path:i,read:_.read.bind(_,i)}}return null}(t);return null===s?d([r("Could not find image file for a:blip element")]):W(s,a)}function L(e){var t=s.uriToZipEntryName("word",y.findTargetByRelationshipId(e));return{path:t,read:x.read.bind(x,t)}}function W(e,t){var i=w.findContentType(e.path);return p(n.Image({readImage:e.read,altText:t,contentType:i}),l[i]?[]:r("Image of type "+i+" is unlikely to display in web browsers"))}}function c(e,t,n){var i=t.firstOrEmpty("w:ilvl").attributes["w:val"],r=t.firstOrEmpty("w:numId").attributes["w:val"];if(void 0!==i&&void 0!==r)return n.findLevel(r,i);if(null!=e){var a=n.findLevelByParagraphStyleId(e);if(null!=a)return a}return null}var l={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},h={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function d(e){return new g(null,null,e)}function u(){return new g(null)}function f(e){return new g(e)}function p(e,t){return new g(e,null,t)}function g(e,t,n){this.value=e||[],this.extra=t||[],this._result=new i({element:this.value,extra:t},n),this.messages=this._result.messages}function m(e){var n=i.combine(t.pluck(e,"_result"));return new g(t.flatten(t.pluck(n.value,"element")),t.filter(t.flatten(t.pluck(n.value,"extra")),v),n.messages)}function b(e,n){return t.flatten([e,n])}function v(e){return e}return g.prototype.toExtra=function(){return new g(null,b(this.extra,this.value),this.messages)},g.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new g(b(this.value,e),null,this.messages):this},g.prototype.map=function(e){var t=this._result.map(function(t){return e(t.element)});return new g(t.value,this.extra,t.messages)},g.prototype.flatMap=function(e){var t=this._result.flatMap(function(t){return e(t.element)._result});return new g(t.value.element,b(this.extra,t.value.extra),t.messages)},g.map=function(e,t,n){return new g(n(e.value,t.value),b(e.extra,t.extra),e.messages.concat(t.messages))},bE}var DE,EE,AE,kE,SE={},CE={},UE={},FE={};var IE,RE={};var NE,ME,OE,PE,LE={},WE={},BE={};function jE(){if(PE)return xx;PE=1,xx.read=function(i,r){return r=r||{},e.props({contentTypes:y(i),partPaths:p(i),docxFile:i,files:r.path?f.relativeToFile(r.path):new f(null)}).also(function(e){return{styles:(t=i,n=e.partPaths.styles,m({filename:n,readElement:h.readStylesXml,defaultValue:h.defaultStyles})(t))};var t,n}).also(function(e){return{numbering:(t=i,n=e.partPaths.numbering,r=e.styles,m({filename:n,readElement:function(e){return l.readNumberingXml(e,{styles:r})},defaultValue:l.defaultNumbering})(t))};var t,n,r}).also(function(e){return{footnotes:b(e.partPaths.footnotes,e,function(e,t){return t?d.createFootnotesReader(e)(t):new n([])}),endnotes:b(e.partPaths.endnotes,e,function(e,t){return t?d.createEndnotesReader(e)(t):new n([])}),comments:b(e.partPaths.comments,e,function(e,t){return t?u.createCommentsReader(e)(t):new n([])})}}).also(function(e){return{notes:e.footnotes.flatMap(function(n){return e.endnotes.map(function(e){return new t.Notes(n.concat(e))})})}}).then(function(e){return b(e.partPaths.mainDocument,e,function(t,n){return e.notes.flatMap(function(i){return e.comments.flatMap(function(e){return new s({bodyReader:t,notes:i,comments:e}).convertXmlToDocument(n)})})})})},xx._findPartPaths=p;var e=G_(),t=X_(),n=Z_().Result,i=aT(),r=function(){if(cE)return oT;cE=1;var e=bx,t=G_(),n=pE();oT.read=r,oT.readXmlFromZipFile=function(e,n){return e.exists(n)?e.read(n,"utf-8").then(a).then(r):t.resolve(null)};var i={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function r(e){return n.readString(e,i).then(function(e){return s(e)[0]})}function a(e){return e.replace(/^\uFEFF/g,"")}function s(t){return"element"===t.type?"mc:AlternateContent"===t.name?t.firstOrEmpty("mc:Fallback").children:(t.children=e.flatten(t.children.map(s,!0)),[t]):[t]}return oT}().readXmlFromZipFile,a=TE().createBodyReader,s=function(){if(DE)return SE;DE=1,SE.DocumentXmlReader=function(n){var i=n.bodyReader;return{convertXmlToDocument:function(r){var a=r.first("w:body");if(null==a)throw new Error("Could not find the body element: are you sure this is a docx file?");var s=i.readXmlElements(a.children).map(function(t){return new e.Document(t,{notes:n.notes,comments:n.comments})});return new t(s.value,s.messages)}}};var e=X_(),t=Z_().Result;return SE}().DocumentXmlReader,o=function(){if(EE)return CE;function e(e){var t={};e.forEach(function(e){t[e.relationshipId]=e.target});var n={};return e.forEach(function(e){n[e.type]||(n[e.type]=[]),n[e.type].push(e.target)}),{findTargetByRelationshipId:function(e){return t[e]},findTargetsByType:function(e){return n[e]||[]}}}return EE=1,CE.readRelationships=function(t){var n=[];return t.children.forEach(function(e){if("relationships:Relationship"===e.name){var t={relationshipId:e.attributes.Id,target:e.attributes.Target,type:e.attributes.Type};n.push(t)}}),new e(n)},CE.defaultValue=new e([]),CE.Relationships=e,CE}(),c=function(){if(AE)return UE;AE=1,UE.readContentTypesFromXml=function(e){var n={},i={};return e.children.forEach(function(e){if("content-types:Default"===e.name&&(n[e.attributes.Extension]=e.attributes.ContentType),"content-types:Override"===e.name){var t=e.attributes.PartName;"/"===t.charAt(0)&&(t=t.substring(1)),i[t]=e.attributes.ContentType}}),t(i,n)};var e={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};function t(t,n){return{findContentType:function(i){var r=t[i];if(r)return r;var a=i.split("."),s=a[a.length-1];if(n.hasOwnProperty(s))return n[s];var o=e[s.toLowerCase()];return o?"image/"+o:null}}}return UE.defaultContentTypes=t({},{}),UE}(),l=function(){if(kE)return FE;kE=1;var e=bx;function t(t,n,i){var r=e.flatten(e.values(n).map(function(t){return e.values(t.levels)})),a=e.indexBy(r.filter(function(e){return null!=e.paragraphStyleId}),"paragraphStyleId");return{findLevel:function e(r,a){var s=t[r];if(s){var o=n[s.abstractNumId];return o?null==o.numStyleLink?n[s.abstractNumId].levels[a]:e(i.findNumberingStyleById(o.numStyleLink).numId,a):null}return null},findLevelByParagraphStyleId:function(e){return a[e]||null}}}return FE.readNumberingXml=function(e,n){if(!n||!n.styles)throw new Error("styles is missing");var i=function(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach(function(e){var n=e.attributes["w:abstractNumId"];t[n]=function(e){var t={};e.getElementsByTagName("w:lvl").forEach(function(e){var n=e.attributes["w:ilvl"],i=e.firstOrEmpty("w:numFmt").attributes["w:val"],r=e.firstOrEmpty("w:pStyle").attributes["w:val"];t[n]={isOrdered:"bullet"!==i,level:n,paragraphStyleId:r}});var n=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:n}}(e)}),t}(e);return new t(function(e){var t={};return e.getElementsByTagName("w:num").forEach(function(e){var n=e.attributes["w:numId"],i=e.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:i}}),t}(e),i,n.styles)},FE.Numbering=t,FE.defaultNumbering=new t({},{}),FE}(),h=function(){if(IE)return RE;function e(e,t,n,i){return{findParagraphStyleById:function(t){return e[t]},findCharacterStyleById:function(e){return t[e]},findTableStyleById:function(e){return n[e]},findNumberingStyleById:function(e){return i[e]}}}return IE=1,RE.readStylesXml=function(t){var n={},i={},r={},a={},s={paragraph:n,character:i,table:r};return t.getElementsByTagName("w:style").forEach(function(e){var t=function(e){var t=e.attributes["w:type"],n=e.attributes["w:styleId"],i=function(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}(e);return{type:t,styleId:n,name:i}}(e);if("numbering"===t.type)a[t.styleId]=function(e){return{numId:e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"]}}(e);else{var n=s[t.type];n&&(n[t.styleId]=t)}}),new e(n,i,r,a)},RE.Styles=e,RE.defaultStyles=new e({},{}),e.EMPTY=new e({},{},{},{}),RE}(),d=function(){if(NE)return LE;NE=1;var e=X_(),t=Z_().Result;function n(n,i){function r(e){var t=e.attributes["w:type"];return"continuationSeparator"!==t&&"separator"!==t}function a(t){var r=t.attributes["w:id"];return i.readXmlElements(t.children).map(function(t){return e.Note({noteType:n,noteId:r,body:t})})}return function(e){return t.combine(e.getElementsByTagName("w:"+n).filter(r).map(a))}}return LE.createFootnotesReader=n.bind(LE,"footnote"),LE.createEndnotesReader=n.bind(LE,"endnote"),LE}(),u=function(){if(ME)return WE;ME=1;var e=X_(),t=Z_().Result;return WE.createCommentsReader=function(n){function i(t){var i=t.attributes["w:id"];function r(e){return(t.attributes[e]||"").trim()||null}return n.readXmlElements(t.children).map(function(t){return e.comment({commentId:i,body:t,authorName:r("w:author"),authorInitials:r("w:initials")})})}return function(e){return t.combine(e.getElementsByTagName("w:comment").map(i))}},WE}(),f=function(){if(OE)return BE;OE=1;var e=G_();return BE.Files=function(){return{read:function(t){return e.reject(new Error("could not open external image: '"+t+"'\ncannot open linked files from a web browser"))}}},BE}().Files;function p(e){return w(e).then(function(t){var n=g({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(n))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return m({filename:v(n),readElement:o.readRelationships,defaultValue:o.defaultValue})(e).then(function(t){function r(r){return g({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+r,basePath:i.splitPath(n).dirname,fallbackPath:"word/"+r+".xml"})}return{mainDocument:n,comments:r("comments"),endnotes:r("endnotes"),footnotes:r("footnotes"),numbering:r("numbering"),styles:r("styles")}})})}function g(e){var t=e.docxFile,n=e.relationships,r=e.relationshipType,a=e.basePath,s=e.fallbackPath,o=n.findTargetsByType(r).map(function(e){return"/"===(t=i.joinPath(a,e)).substring(0,1)?t.substring(1):t;var t}).filter(function(e){return t.exists(e)});return 0===o.length?s:o[0]}function m(e){return function(t){return r(t,e.filename).then(function(t){return t?e.readElement(t):e.defaultValue})}}function b(e,t,n){return m({filename:v(e),readElement:o.readRelationships,defaultValue:o.defaultValue})(t.docxFile).then(function(i){var s=new a({relationships:i,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return r(t.docxFile,e).then(function(e){return n(s,e)})})}function v(e){var t=i.splitPath(e);return i.joinPath(t.dirname,"_rels",t.basename+".rels")}var y=m({filename:"[Content_Types].xml",readElement:c.readContentTypesFromXml,defaultValue:c.defaultContentTypes}),w=m({filename:"_rels/.rels",readElement:o.readRelationships,defaultValue:o.defaultValue});return xx}var zE,HE={};var VE,GE,$E,qE,XE,KE={},YE={},ZE={},JE={};function QE(){if(VE)return JE;VE=1;var e=nA();function t(e,t){return{type:"element",tag:e,children:t||[]}}JE.freshElement=function(n,i,r){return t(e.element(n,i,{fresh:!0}),r)},JE.nonFreshElement=function(n,i,r){return t(e.element(n,i,{fresh:!1}),r)},JE.elementWithTag=t,JE.text=function(e){return{type:"text",value:e}},JE.forceWrite={type:"forceWrite"};var n={br:!0,hr:!0,img:!0,input:!0};return JE.isVoidElement=function(e){return 0===e.children.length&&n[e.tag.tagName]},JE}function eA(){if($E)return GE;$E=1;var e=bx,t=QE();function n(e){var t=[];return e.map(i).forEach(function(e){s(t,e)}),t}function i(e){return r[e.type](e)}var r={element:function(e){return t.elementWithTag(e.tag,n(e.children))},text:a,forceWrite:a};function a(e){return e}function s(e,n){var i=e[e.length-1];"element"===n.type&&!n.tag.fresh&&i&&"element"===i.type&&n.tag.matchesElement(i.tag)?(n.tag.separator&&s(i.children,t.text(n.tag.separator)),n.children.forEach(function(e){s(i.children,e)})):e.push(n)}function o(t){return n=t,i=function(e){return c[e.type](e)},e.flatten(e.map(n,i),!0);var n,i}var c={element:function(e){var n=o(e.children);return 0!==n.length||t.isVoidElement(e)?[t.elementWithTag(e.tag,n)]:[]},text:function(e){return 0===e.value.length?[]:[e]},forceWrite:function(e){return[e]}};return GE=function(e){return n(o(e))}}function tA(){if(qE)return ZE;qE=1;var e=QE();function t(e,t){t.forEach(function(t){!function(e,t){n[t.type](e,t)}(e,t)})}ZE.freshElement=e.freshElement,ZE.nonFreshElement=e.nonFreshElement,ZE.elementWithTag=e.elementWithTag,ZE.text=e.text,ZE.forceWrite=e.forceWrite,ZE.simplify=eA();var n={element:function(n,i){e.isVoidElement(i)?n.selfClosing(i.tag.tagName,i.tag.attributes):(n.open(i.tag.tagName,i.tag.attributes),t(n,i.children),n.close(i.tag.tagName))},text:function(e,t){e.text(t.value)},forceWrite:function(){}};return ZE.write=t,ZE}function nA(){if(XE)return YE;XE=1;var e=bx,t=tA();function n(t){return new i(t.map(function(t){return e.isString(t)?r(t):t}))}function i(e){this._elements=e}function r(e,t,n){return new a(e,t,n=n||{})}function a(t,n,i){var r={};e.isArray(t)?(t.forEach(function(e){r[e]=!0}),t=t[0]):r[t]=!0,this.tagName=t,this.tagNames=r,this.attributes=n||{},this.fresh=i.fresh,this.separator=i.separator}return YE.topLevelElement=function(e,t){return n([r(e,t,{fresh:!0})])},YE.elements=n,YE.element=r,i.prototype.wrap=function(e){for(var t=e(),n=this._elements.length-1;n>=0;n--)t=this._elements[n].wrapNodes(t);return t},a.prototype.matchesElement=function(t){return this.tagNames[t.tagName]&&e.isEqual(this.attributes||{},t.attributes||{})},a.prototype.wrap=function(e){return this.wrapNodes(e())},a.prototype.wrapNodes=function(e){return[t.elementWithTag(this,e)]},YE.empty=n([]),YE.ignore={wrap:function(){return[]}},YE}var iA,rA={};function aA(){return iA||(iA=1,function(e){var t=bx,n=G_(),i=tA();function r(e){return function(r,a){return n.when(e(r)).then(function(e){var n={};return r.altText&&(n.alt=r.altText),t.extend(n,e),[i.freshElement("img",n)]})}}e.imgElement=r,e.inline=e.imgElement,e.dataUri=r(function(e){return e.readAsBase64String().then(function(t){return{src:"data:"+e.contentType+";base64,"+t}})})}(rA)),rA}var sA,oA={},cA={};function lA(){if(sA)return cA;sA=1;var e=bx;cA.writer=function(i){return(i=i||{}).prettyPrint?function(){var i=0,r=[],a=!0,s=!1,o=n();function c(){if(s=!1,!a&&(0===r.length||t[r[r.length-1]])&&!l()){o._append("\n");for(var e=0;e<i;e++)o._append("  ")}}function l(){return e.some(r,function(e){return"pre"===e})}return{asString:o.asString,open:function(e,n){t[e]&&c(),r.push(e),o.open(e,n),t[e]&&i++,a=!1},close:function(e){t[e]&&(i--,c()),r.pop(),o.close(e)},text:function(e){s||(c(),s=!0);var t=l()?e:e.replace("\n","\n  ");o.text(t)},selfClosing:function(e,t){c(),o.selfClosing(e,t)}}}():n()};var t={div:!0,p:!0,ul:!0,li:!0};function n(){var t=[];function n(t){return e.map(t,function(e,t){return" "+t+'="'+function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(e)+'"'}).join("")}return{asString:function(){return t.join("")},open:function(e,i){var r=n(i);t.push("<"+e+r+">")},close:function(e){t.push("</"+e+">")},text:function(e){t.push(function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(e))},selfClosing:function(e,i){var r=n(i);t.push("<"+e+r+" />")},_append:function(e){t.push(e)}}}return cA}var hA,dA,uA,fA={};function pA(){if(uA)return KE;uA=1;var e=bx,t=G_(),n=X_(),i=nA(),r=Z_(),a=aA(),s=tA(),o=function(){if(dA)return oA;dA=1;var e=lA(),t=function(){if(hA)return fA;hA=1;var e=bx;function t(e){return n(e,e)}function n(e,t){return function(){return{start:e,end:t}}}function i(e){return function(t,n){return{start:n?"\n":"",end:n?"":"\n",list:{isOrdered:e.isOrdered,indent:n?n.indent+1:0,count:0}}}}var r={p:n("","\n\n"),br:n("","  \n"),ul:i({isOrdered:!1}),ol:i({isOrdered:!0}),li:function(e,t,n){(t=t||{indent:0,isOrdered:!1,count:0}).count++,n.hasClosed=!1;var i=t.isOrdered?t.count+".":"-";return{start:a("\t",t.indent)+i+" ",end:function(){if(!n.hasClosed)return n.hasClosed=!0,"\n"}}},strong:t("__"),em:t("*"),a:function(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}},img:function(e){var t=e.src||"",n=e.alt||"";return t||n?{start:"!["+n+"]("+t+")"}:{}}};function a(e,t){return new Array(t+1).join(e)}return function(){for(var e=1;e<=6;e++)r["h"+e]=n(a("#",e)+" ","\n\n")}(),fA.writer=function(){var t=[],n=[],i=null,a={};function s(e,s){s=s||{};var c=(r[e]||function(){return{}})(s,i,a);n.push({end:c.end,list:i}),c.list&&(i=c.list);var l="before"===c.anchorPosition;l&&o(s),t.push(c.start||""),l||o(s)}function o(e){e.id&&t.push('<a id="'+e.id+'"></a>')}function c(r){var a=n.pop();i=a.list;var s=e.isFunction(a.end)?a.end():a.end;t.push(s||"")}return{asString:function(){return t.join("")},open:s,close:c,text:function(e){t.push(function(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}(e))},selfClosing:function(e,t){s(e,t),c()}}},fA}();return oA.writer=function(n){return"markdown"===(n=n||{}).outputFormat?t.writer():e.writer(n)},oA}();function c(c,p){var g=1,m=[],b=[],v=void 0===(c=e.extend({ignoreEmptyParagraphs:!0},c)).idPrefix?"":c.idPrefix,y=c.ignoreEmptyParagraphs,w=i.topLevelElement("p"),x=c.styleMap||[];function _(e,t,n){return d(e,function(e){return T(e,t,n)})}function T(e,t,n){if(!n)throw new Error("options not set");var i=O[e.type];return i?i(e,t,n):[]}function D(e,t){return E({type:e})||(t?i.element(t,{},{fresh:!1}):i.empty)}function E(e,t){var n=A(e);return n?n.to:t}function A(e){for(var t=0;t<x.length;t++)if(x[t].from.matches(e))return x[t]}function k(e){return C(e.noteType,e.noteId)}function S(e){return U(e.noteType,e.noteId)}function C(e,t){return F(e+"-"+t)}function U(e,t){return F(e+"-ref-"+t)}function F(e){return v+e}var I=i.elements([i.element("table",{},{fresh:!0})]);function R(e,t,n){var i=e.label,r=e.comment,a=_(r.body,t,n).concat([s.nonFreshElement("p",{},[s.text(" "),s.freshElement("a",{href:"#"+U("comment",r.commentId)},[s.text("↑")])])]);return[s.freshElement("dt",{id:C("comment",r.commentId)},[s.text("Comment "+i)]),s.freshElement("dd",{},a)]}var N,M,O={document:function(e,t,n){var i=_(e.children,t,n),r=_(m.map(function(t){return e.notes.resolve(t)}),t,n);return i.concat([s.freshElement("ol",{},r),s.freshElement("dl",{},d(b,function(e){return R(e,t,n)}))])},paragraph:function(e,t,n){return function(e,t){var n=A(e);return n?n.to:(e.styleId&&t.push(h("paragraph",e)),w)}(e,t).wrap(function(){var i=_(e.children,t,n);return y?i:[s.forceWrite].concat(i)})},run:function(e,t,r){var a=function(){return _(e.children,t,r)},s=[];if(null!==e.highlight){var o=E({type:"highlight",color:e.highlight});o&&s.push(o)}e.isSmallCaps&&s.push(D("smallCaps")),e.isAllCaps&&s.push(D("allCaps")),e.isStrikethrough&&s.push(D("strikethrough","s")),e.isUnderline&&s.push(D("underline")),e.verticalAlignment===n.verticalAlignment.subscript&&s.push(i.element("sub",{},{fresh:!1})),e.verticalAlignment===n.verticalAlignment.superscript&&s.push(i.element("sup",{},{fresh:!1})),e.isItalic&&s.push(D("italic","em")),e.isBold&&s.push(D("bold","strong"));var c=i.empty,l=A(e);return l?c=l.to:e.styleId&&t.push(h("run",e)),s.push(c),s.forEach(function(e){a=e.wrap.bind(e,a)}),a()},text:function(e,t,n){return[s.text(e.value)]},tab:function(e,t,n){return[s.text("\t")]},hyperlink:function(e,t,n){var i={href:e.anchor?"#"+F(e.anchor):e.href};null!=e.targetFrame&&(i.target=e.targetFrame);var r=_(e.children,t,n);return[s.nonFreshElement("a",i,r)]},checkbox:function(e){var t={type:"checkbox"};return e.checked&&(t.checked="checked"),[s.freshElement("input",t)]},bookmarkStart:function(e,t,n){return[s.freshElement("a",{id:F(e.name)},[s.forceWrite])]},noteReference:function(e,t,n){m.push(e);var i=s.freshElement("a",{href:"#"+k(e),id:S(e)},[s.text("["+g+++"]")]);return[s.freshElement("sup",{},[i])]},note:function(e,t,n){var r=_(e.body,t,n),a=s.elementWithTag(i.element("p",{},{fresh:!1}),[s.text(" "),s.freshElement("a",{href:"#"+S(e)},[s.text("↑")])]),o=r.concat([a]);return s.freshElement("li",{id:k(e)},o)},commentReference:function(e,t,n){return E(e,i.ignore).wrap(function(){var t=p[e.commentId],n=b.length+1,i="["+f(t)+n+"]";return b.push({label:i,comment:t}),[s.freshElement("a",{href:"#"+C("comment",e.commentId),id:U("comment",e.commentId)},[s.text(i)])]})},comment:R,image:(M=c.convertImage||a.dataUri,N=function(e,n){return t.attempt(function(){return M(e,n)}).caught(function(e){return n.push(r.error(e)),[]})},function(e,t,n){return[{type:"deferred",id:l++,value:function(){return N(e,t)}}]}),table:function(t,i,r){return E(t,I).wrap(function(){return function(t,i,r){var a,o=e.findIndex(t.children,function(e){return!e.type===n.types.tableRow||!e.isHeader});if(-1===o&&(o=t.children.length),0===o)a=_(t.children,i,e.extend({},r,{isTableHeader:!1}));else{var c=_(t.children.slice(0,o),i,e.extend({},r,{isTableHeader:!0})),l=_(t.children.slice(o),i,e.extend({},r,{isTableHeader:!1}));a=[s.freshElement("thead",{},c),s.freshElement("tbody",{},l)]}return[s.forceWrite].concat(a)}(t,i,r)})},tableRow:function(e,t,n){var i=_(e.children,t,n);return[s.freshElement("tr",{},[s.forceWrite].concat(i))]},tableCell:function(e,t,n){var i=n.isTableHeader?"th":"td",r=_(e.children,t,n),a={};return 1!==e.colSpan&&(a.colspan=e.colSpan.toString()),1!==e.rowSpan&&(a.rowspan=e.rowSpan.toString()),[s.freshElement(i,a,[s.forceWrite].concat(r))]},break:function(e,t,n){return function(e){var t=A(e);return t?t.to:"line"===e.breakType?i.topLevelElement("br"):i.empty}(e).wrap(function(){return[]})}};return{convertToHtml:function(n){var i=[],a=T(n,i,{}),l=[];u(a,function(e){"deferred"===e.type&&l.push(e)});var h={};return t.mapSeries(l,function(e){return e.value().then(function(t){h[e.id]=t})}).then(function(){var t=o.writer({prettyPrint:c.prettyPrint,outputFormat:c.outputFormat});return s.write(t,s.simplify(function t(n){return d(n,function(n){return"deferred"===n.type?h[n.id]:n.children?[e.extend({},n,{children:t(n.children)})]:[n]})}(a))),new r.Result(t.asString(),i)})}}}KE.DocumentConverter=function(t){return{convertToHtml:function(i){var r=e.indexBy(i.type===n.types.document?i.comments:[],"commentId");return new c(t,r).convertToHtml(i)}}};var l=1;function h(e,t){return r.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function d(t,n){return e.flatten(t.map(n),!0)}function u(e,t){e.forEach(function(e){t(e),e.children&&u(e.children,t)})}var f=KE.commentAuthorLabel=function(e){return e.authorInitials||""};return KE}var gA,mA,bA,vA={},yA={},wA={},xA={},_A={exports:{}};var TA,DA,EA,AA={},kA={};function SA(){if(EA)return DA;EA=1,DA={failure:function(t,n){if(t.length<1)throw new Error("Failure must have errors");return new e({status:"failure",remaining:n,errors:t})},error:function(t,n){if(t.length<1)throw new Error("Failure must have errors");return new e({status:"error",remaining:n,errors:t})},success:function(t,n,i){return new e({status:"success",value:t,source:i,remaining:n,errors:[]})},cut:function(t){return new e({status:"cut",remaining:t,errors:[]})}};var e=function(e){this._value=e.value,this._status=e.status,this._hasValue=void 0!==e.value,this._remaining=e.remaining,this._source=e.source,this._errors=e.errors};return e.prototype.map=function(t){return this._hasValue?new e({value:t(this._value,this._source),status:this._status,remaining:this._remaining,source:this._source,errors:this._errors}):this},e.prototype.changeRemaining=function(t){return new e({value:this._value,status:this._status,remaining:t,source:this._source,errors:this._errors})},e.prototype.isSuccess=function(){return"success"===this._status||"cut"===this._status},e.prototype.isFailure=function(){return"failure"===this._status},e.prototype.isError=function(){return"error"===this._status},e.prototype.isCut=function(){return"cut"===this._status},e.prototype.value=function(){return this._value},e.prototype.remaining=function(){return this._remaining},e.prototype.source=function(){return this._source},e.prototype.errors=function(){return this._errors},DA}var CA,UA={};function FA(){if(CA)return UA;CA=1,UA.error=function(t){return new e(t)};var e=function(e){this.expected=e.expected,this.actual=e.actual,this._location=e.location};return e.prototype.describe=function(){return(this._location?this._location.describe()+":\n":"")+"Expected "+this.expected+"\nbut got "+this.actual},e.prototype.lineNumber=function(){return this._location.lineNumber()},e.prototype.characterNumber=function(){return this._location.characterNumber()},UA}var IA,RA,NA={};function MA(){return RA||(RA=1,function(e){var t=bx,n=(TA||(TA=1,function(e){function t(e){return"function"==typeof e?e():e}e.none=Object.create({value:function(){throw new Error("Called value on none")},isNone:function(){return!0},isSome:function(){return!1},map:function(){return e.none},flatMap:function(){return e.none},filter:function(){return e.none},toArray:function(){return[]},orElse:t,valueOrElse:t}),e.some=function(e){return new n(e)};var n=function(e){this._value=e};n.prototype.value=function(){return this._value},n.prototype.isNone=function(){return!1},n.prototype.isSome=function(){return!0},n.prototype.map=function(e){return new n(e(this._value))},n.prototype.flatMap=function(e){return e(this._value)},n.prototype.filter=function(t){return t(this._value)?this:e.none},n.prototype.toArray=function(){return[this._value]},n.prototype.orElse=function(e){return this},n.prototype.valueOrElse=function(e){return this._value},e.isOption=function(t){return t===e.none||t instanceof n},e.fromNullable=function(t){return null==t?e.none:new n(t)}}(kA)),kA),i=SA(),r=FA(),a=function(){if(IA)return NA;IA=1,NA.fromArray=function(t){var n=0,i=function(){return n<t.length};return new e({hasNext:i,next:function(){if(i())return t[n++];throw new Error("No more elements")}})};var e=function(e){this._iterator=e};return e.prototype.map=function(t){var n=this._iterator;return new e({hasNext:function(){return n.hasNext()},next:function(){return t(n.next())}})},e.prototype.filter=function(t){var n,i=this._iterator,r=!1,a=!1,s=function(){if(!r)for(r=!0,a=!1;i.hasNext()&&!a;)n=i.next(),a=t(n)};return new e({hasNext:function(){return s(),a},next:function(){return s(),r=!1,n}})},e.prototype.first=function(){var e=this._iterator;return this._iterator.hasNext()?e.next():null},e.prototype.toArray=function(){for(var e=[];this._iterator.hasNext();)e.push(this._iterator.next());return e},NA}();e.token=function(e,t){var n=void 0!==t;return function(r){var a=r.head();return!a||a.name!==e||n&&a.value!==t?d(r,h({name:e,value:t})):i.success(a.value,r.tail(),a.source)}},e.tokenOfType=function(t){return e.token(t)},e.firstOf=function(e,n){return t.isArray(n)||(n=Array.prototype.slice.call(arguments,1)),function(t){return a.fromArray(n).map(function(e){return e(t)}).filter(function(e){return e.isSuccess()||e.isError()}).first()||d(t,e)}},e.then=function(e,t){return function(n){var i=e(n);return i.map,i.map(t)}},e.sequence=function(){var n=Array.prototype.slice.call(arguments,0),r=function(r){var a=t.foldl(n,function(e,t){var n=e.result,a=e.hasCut;if(!n.isSuccess())return{result:n,hasCut:a};var s=t(n.remaining());if(s.isCut())return{result:n,hasCut:!0};if(s.isSuccess()){var o;o=t.isCaptured?n.value().withValue(t,s.value()):n.value();var c=s.remaining(),l=r.to(c);return{result:i.success(o,c,l),hasCut:a}}return a?{result:i.error(s.errors(),s.remaining()),hasCut:a}:{result:s,hasCut:a}},{result:i.success(new s,r),hasCut:!1}).result,o=r.to(a.remaining());return a.map(function(t){return t.withValue(e.sequence.source,o)})};function a(e){return e.isCaptured}return r.head=function(){var i=t.find(n,a);return e.then(r,e.sequence.extract(i))},r.map=function(t){return e.then(r,function(e){return t.apply(this,e.toArray())})},r};var s=function(e,t){this._values=e||{},this._valuesArray=t||[]};s.prototype.withValue=function(e,n){if(e.captureName&&e.captureName in this._values)throw new Error('Cannot add second value for capture "'+e.captureName+'"');var i=t.clone(this._values);i[e.captureName]=n;var r=this._valuesArray.concat([n]);return new s(i,r)},s.prototype.get=function(e){if(e.captureName in this._values)return this._values[e.captureName];throw new Error('No value for capture "'+e.captureName+'"')},s.prototype.toArray=function(){return this._valuesArray},e.sequence.capture=function(e,t){var n=function(){return e.apply(this,arguments)};return n.captureName=t,n.isCaptured=!0,n},e.sequence.extract=function(e){return function(t){return t.get(e)}},e.sequence.applyValues=function(e){var t=Array.prototype.slice.call(arguments,1);return function(n){var i=t.map(function(e){return n.get(e)});return e.apply(this,i)}},e.sequence.source={captureName:"☃source☃"},e.sequence.cut=function(){return function(e){return i.cut(e)}},e.optional=function(e){return function(t){var r=e(t);return r.isSuccess()?r.map(n.some):r.isFailure()?i.success(n.none,t):r}},e.zeroOrMoreWithSeparator=function(e,t){return l(e,t,!1)},e.oneOrMoreWithSeparator=function(e,t){return l(e,t,!0)};var o=e.zeroOrMore=function(e){return function(t){for(var n,r=[];(n=e(t))&&n.isSuccess();)t=n.remaining(),r.push(n.value());return n.isError()?n:i.success(r,t)}};function c(e){return i.success(null,e)}e.oneOrMore=function(t){return e.oneOrMoreWithSeparator(t,c)};var l=function(t,n,r){return function(a){var s=t(a);if(s.isSuccess()){var c=e.sequence.capture(t,"main"),l=o(e.then(e.sequence(n,c),e.sequence.extract(c)))(s.remaining());return i.success([s.value()].concat(l.value()),l.remaining())}return r||s.isError()?s:i.success([],a)}};e.leftAssociative=function(t,n,r){var a;a=(a=r?[{func:r,rule:n}]:n).map(function(t){return e.then(t.rule,function(e){return function(n,i){return t.func(n,e,i)}})});var s=e.firstOf.apply(null,["rules"].concat(a));return function(e){var n=e,r=t(e);if(!r.isSuccess())return r;for(var a=s(r.remaining());a.isSuccess();){var o=a.remaining(),c=n.to(a.remaining()),l=a.value();r=i.success(l(r.value(),c),o,c),a=s(r.remaining())}return a.isError()?a:r}},e.leftAssociative.firstOf=function(){return Array.prototype.slice.call(arguments,0)},e.nonConsuming=function(e){return function(t){return e(t).changeRemaining(t)}};var h=function(e){return e.value?e.name+' "'+e.value+'"':e.name};function d(e,t){var n,a=e.head();return n=a?r.error({expected:t,actual:h(a),location:a.source}):r.error({expected:t,actual:"end of tokens"}),i.failure([n],e)}}(AA)),AA}var OA,PA,LA,WA={exports:{}};function BA(){if(OA)return WA.exports;OA=1,WA.exports=function(t,n){return{asString:function(){return t},range:function(i,r){return new e(t,n,i,r)}}};var e=function(e,t,n,i){this._string=e,this._description=t,this._startIndex=n,this._endIndex=i};return e.prototype.to=function(t){return new e(this._string,this._description,this._startIndex,t._endIndex)},e.prototype.describe=function(){var e=this._position();return(this._description?this._description+"\n":"")+"Line number: "+e.lineNumber+"\nCharacter number: "+e.characterNumber},e.prototype.lineNumber=function(){return this._position().lineNumber},e.prototype.characterNumber=function(){return this._position().characterNumber},e.prototype._position=function(){for(var e=this,t=0,n=function(){return e._string.indexOf("\n",t)},i=1;-1!==n()&&n()<this._startIndex;)t=n()+1,i+=1;return{lineNumber:i,characterNumber:this._startIndex-t+1}},WA.exports}function jA(){return LA?PA:(LA=1,PA=function(e,t,n){this.name=e,this.value=t,n&&(this.source=n)})}var zA,HA={};function VA(){return zA||(zA=1,function(e){var t=MA(),n=SA();function i(e){function r(){return e.map(function(e){return e.name})}function a(n){return t.firstOf("infix",e.map(function(e){return e.rule}))(n)}return{apply:function(e){for(var t,i;;){if(!(t=a(e.remaining())).isSuccess())return t.isFailure()?e:t;i=e.source().to(t.source()),e=n.success(t.value()(e.value(),i),t.remaining(),i)}},untilExclusive:function(t){return new i(e.slice(0,r().indexOf(t)))},untilInclusive:function(t){return new i(e.slice(0,r().indexOf(t)+1))}}}e.parser=function(e,n,a){var s={rule:function(){return l(o)},leftAssociative:function(e){return l(o.untilExclusive(e))},rightAssociative:function(e){return l(o.untilInclusive(e))}},o=new i(a.map(function(e){return{name:e.name,rule:r(e.ruleBuilder.bind(null,s))}})),c=t.firstOf(e,n);function l(e){return h.bind(null,e)}function h(e,t){var n=c(t);return n.isSuccess()?e.apply(n):n}return s},e.infix=function(t,n){return{name:t,ruleBuilder:n,map:function(i){return e.infix(t,function(e){var t=n(e);return function(e){return t(e).map(function(e){return function(t,n){return i(t,e,n)}})}})}}};var r=function(e){var t;return function(n){return t||(t=e()),t(n)}}}(HA)),HA}var GA,$A,qA={};function XA(){return $A||($A=1,wA.Parser=function(){if(bA)return xA;bA=1;var e=function(){if(mA)return _A.exports;mA=1;var e=_A.exports=function(e,t){this._tokens=e,this._startIndex=t||0};return e.prototype.head=function(){return this._tokens[this._startIndex]},e.prototype.tail=function(t){return new e(this._tokens,this._startIndex+1)},e.prototype.toArray=function(){return this._tokens.slice(this._startIndex)},e.prototype.end=function(){return this._tokens[this._tokens.length-1]},e.prototype.to=function(e){var t=this.head().source,n=e.head()||e.end();return t.to(n.source)},_A.exports}();return xA.Parser=function(t){return{parseTokens:function(t,n){return t(new e(n))}}},xA}().Parser,wA.rules=MA(),wA.errors=FA(),wA.results=SA(),wA.StringSource=BA(),wA.Token=jA(),wA.bottomUp=VA(),wA.RegexTokeniser=function(){if(GA)return qA;GA=1;var e=jA(),t=BA();return qA.RegexTokeniser=function(n){function i(t,i,r){for(var a=0;a<n.length;a++){var s=n[a].regex;s.lastIndex=i;var o=s.exec(t);if(o){var c=i+o[0].length;if(o.index===i&&c>i){var l=o[1];return{token:new e(n[a].name,l,r.range(i,c)),endIndex:c}}}}return c=i+1,{token:new e("unrecognisedCharacter",t.substring(i,c),r.range(i,c)),endIndex:c}}return n=n.map(function(e){return{name:e.name,regex:new RegExp(e.regex.source,"g")}}),{tokenise:function(n,r){for(var a=new t(n,r),s=0,o=[];s<n.length;){var c=i(n,s,a);s=c.endIndex,o.push(c.token)}return o.push(function(t,n){return new e("end",null,n.range(t.length,t.length))}(n,a)),o}}},qA}().RegexTokeniser,wA.rule=function(e){var t;return function(n){return t||(t=e()),t(n)}}),wA}var KA,YA,ZA,JA={},QA={};var ek,tk,nk,ik={},rk={},ak={};function sk(){if(nk)return ak;nk=1;var e=bx;function t(e,t){return n(function(n){return n.type===e?t(n):n})}function n(t){return function n(i){if(i.children){var r=e.map(i.children,n);i=e.extend(i,{children:r})}return t(i)}}function i(e){var t=[];return r(e,function(e){t.push(e)}),t}function r(e,t){e.children&&e.children.forEach(function(e){r(e,t),t(e)})}return ak.paragraph=function(e){return t("paragraph",e)},ak.run=function(e){return t("run",e)},ak._elements=n,ak.getDescendantsOfType=function(e,t){return i(e).filter(function(e){return e.type===t})},ak.getDescendants=i,ak}var ok,ck,lk={};const hk=Ch(function(){if(ck)return Ob;ck=1;var e=bx,t=jE(),n=function(){if(zE)return HE;zE=1;var e=bx,t=G_(),n=pE();HE.writeStyleMap=function(e,t){return e.write(r,t),function(e){var t="word/_rels/document.xml.rels",r="http://schemas.openxmlformats.org/package/2006/relationships",o="{"+r+"}Relationship";return e.read(t,"utf8").then(n.readString).then(function(c){s(c.children,o,"Id",{Id:"rMammothStyleMap",Type:i,Target:a});var l={"":r};return e.write(t,n.writeString(c,l))})}(e).then(function(){return function(e){var t="[Content_Types].xml",i="http://schemas.openxmlformats.org/package/2006/content-types",r="{"+i+"}Override";return e.read(t,"utf8").then(n.readString).then(function(o){s(o.children,r,"PartName",{PartName:a,ContentType:"text/prs.mammoth.style-map"});var c={"":i};return e.write(t,n.writeString(o,c))})}(e)})},HE.readStyleMap=function(e){return e.exists(r)?e.read(r,"utf8"):t.resolve(null)};var i="http://schemas.zwobble.org/mammoth/style-map",r="mammoth/style-map",a="/"+r;function s(t,i,r,a){var s=e.find(t,function(e){return e.name===i&&e.attributes[r]===a[r]});s?s.attributes=a:t.push(n.element(i,a))}return HE}(),i=pA().DocumentConverter,r=function(){if(gA)return vA;gA=1;var e=X_();return vA.convertElementToRawText=function t(n){if("text"===n.type)return n.value;if(n.type===e.types.tab)return"\t";var i="paragraph"===n.type?"\n\n":"";return(n.children||[]).map(t).join("")+i},vA}().convertElementToRawText,a=function(){if(ZA)return yA;ZA=1;var e=bx,t=XA(),n=function(){if(KA)return JA;function e(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}function t(e){e=e||{},this._color=e.color}function n(e){e=e||{},this._breakType=e.breakType}function i(e,t){return e.toUpperCase()===t.toUpperCase()}function r(e,t){return 0===t.toUpperCase().indexOf(e.toUpperCase())}return KA=1,JA.paragraph=function(t){return new e("paragraph",t)},JA.run=function(t){return new e("run",t)},JA.table=function(t){return new e("table",t)},JA.bold=new e("bold"),JA.italic=new e("italic"),JA.underline=new e("underline"),JA.strikethrough=new e("strikethrough"),JA.allCaps=new e("allCaps"),JA.smallCaps=new e("smallCaps"),JA.highlight=function(e){return new t(e)},JA.commentReference=new e("commentReference"),JA.lineBreak=new n({breakType:"line"}),JA.pageBreak=new n({breakType:"page"}),JA.columnBreak=new n({breakType:"column"}),JA.equalTo=function(e){return{operator:i,operand:e}},JA.startsWith=function(e){return{operator:r,operand:e}},e.prototype.matches=function(e){return e.type===this._elementType&&(void 0===this._styleId||e.styleId===this._styleId)&&(void 0===this._styleName||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(void 0===this._listIndex||function(e,t,n){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==n}(e,this._listIndex,this._listIsOrdered))&&(void 0===this._breakType||this._breakType===e.breakType)},t.prototype.matches=function(e){return"highlight"===e.type&&(void 0===this._color||e.color===this._color)},n.prototype.matches=function(e){return"break"===e.type&&(void 0===this._breakType||e.breakType===this._breakType)},JA}(),i=nA(),r=function(){if(YA)return QA;YA=1;var e=XA().RegexTokeniser;QA.tokenise=function(n){var i="(?:[a-zA-Z\\-_]|\\\\.)";return new e([{name:"identifier",regex:new RegExp("("+i+"(?:"+i+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(t+"'")},{name:"unterminated-string",regex:new RegExp(t)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]).tokenise(n)};var t="'((?:\\\\.|[^'])*)";return QA}().tokenise,a=Z_();function s(){var i=t.rules.sequence,r=function(e,n){return t.rules.then(t.rules.token("identifier",e),function(){return n})},a=r("p",n.paragraph),s=r("r",n.run),o=t.rules.firstOf("p or r or table",a,s),d=t.rules.sequence(t.rules.tokenOfType("dot"),t.rules.sequence.cut(),t.rules.sequence.capture(c)).map(function(e){return{styleId:e}}),u=t.rules.firstOf("style name matcher",t.rules.then(t.rules.sequence(t.rules.tokenOfType("equals"),t.rules.sequence.cut(),t.rules.sequence.capture(h)).head(),function(e){return{styleName:n.equalTo(e)}}),t.rules.then(t.rules.sequence(t.rules.tokenOfType("startsWith"),t.rules.sequence.cut(),t.rules.sequence.capture(h)).head(),function(e){return{styleName:n.startsWith(e)}})),f=t.rules.sequence(t.rules.tokenOfType("open-square-bracket"),t.rules.sequence.cut(),t.rules.token("identifier","style-name"),t.rules.sequence.capture(u),t.rules.tokenOfType("close-square-bracket")).head(),p=t.rules.firstOf("list type",r("ordered-list",{isOrdered:!0}),r("unordered-list",{isOrdered:!1})),g=i(t.rules.tokenOfType("colon"),i.capture(p),i.cut(),t.rules.tokenOfType("open-paren"),i.capture(l),t.rules.tokenOfType("close-paren")).map(function(e,t){return{list:{isOrdered:e.isOrdered,levelIndex:t-1}}});function m(n){var i=t.rules.firstOf.apply(t.rules.firstOf,["matcher suffix"].concat(n)),r=t.rules.zeroOrMore(i);return t.rules.then(r,function(t){var n={};return t.forEach(function(t){e.extend(n,t)}),n})}var b=i(i.capture(o),i.capture(m([d,f,g]))).map(function(e,t){return e(t)}),v=i(t.rules.token("identifier","table"),i.capture(m([d,f]))).map(function(e){return n.table(e)}),y=r("b",n.bold),w=r("i",n.italic),x=r("u",n.underline),_=r("strike",n.strikethrough),T=r("all-caps",n.allCaps),D=r("small-caps",n.smallCaps),E=i(t.rules.token("identifier","highlight"),t.rules.sequence.capture(t.rules.optional(t.rules.sequence(t.rules.tokenOfType("open-square-bracket"),t.rules.sequence.cut(),t.rules.token("identifier","color"),t.rules.tokenOfType("equals"),t.rules.sequence.capture(h),t.rules.tokenOfType("close-square-bracket")).head()))).map(function(e){return n.highlight({color:e.valueOrElse(void 0)})}),A=r("comment-reference",n.commentReference),k=i(t.rules.token("identifier","br"),i.cut(),t.rules.tokenOfType("open-square-bracket"),t.rules.token("identifier","type"),t.rules.tokenOfType("equals"),i.capture(h),t.rules.tokenOfType("close-square-bracket")).map(function(e){switch(e){case"line":return n.lineBreak;case"page":return n.pageBreak;case"column":return n.columnBreak}});return t.rules.firstOf("element type",b,v,y,w,x,_,T,D,E,A,k)}function o(){var e=t.rules.sequence.capture,n=t.rules.tokenOfType("whitespace"),r=t.rules.then(t.rules.optional(t.rules.sequence(t.rules.tokenOfType("colon"),t.rules.token("identifier","fresh"))),function(e){return e.map(function(){return!0}).valueOrElse(!1)}),a=t.rules.then(t.rules.optional(t.rules.sequence(t.rules.tokenOfType("colon"),t.rules.token("identifier","separator"),t.rules.tokenOfType("open-paren"),e(h),t.rules.tokenOfType("close-paren")).head()),function(e){return e.valueOrElse("")}),s=t.rules.oneOrMoreWithSeparator(c,t.rules.tokenOfType("choice")),o=t.rules.sequence(e(s),e(t.rules.zeroOrMore(g)),e(r),e(a)).map(function(e,t,n,r){var a={},s={};return t.forEach(function(e){e.append&&a[e.name]?a[e.name]+=" "+e.value:a[e.name]=e.value}),n&&(s.fresh=!0),r&&(s.separator=r),i.element(e,a,s)});return t.rules.firstOf("html path",t.rules.then(t.rules.tokenOfType("bang"),function(){return i.ignore}),t.rules.then(t.rules.zeroOrMoreWithSeparator(o,t.rules.sequence(n,t.rules.tokenOfType("gt"),n)),i.elements))}yA.readHtmlPath=function(e){return m(o(),e)},yA.readDocumentMatcher=function(e){return m(s(),e)},yA.readStyle=function(e){return m(y,e)};var c=t.rules.then(t.rules.tokenOfType("identifier"),u),l=t.rules.tokenOfType("integer"),h=t.rules.then(t.rules.tokenOfType("string"),u),d={n:"\n",r:"\r",t:"\t"};function u(e){return e.replace(/\\(.)/g,function(e,t){return d[t]||t})}var f=t.rules.sequence(t.rules.tokenOfType("open-square-bracket"),t.rules.sequence.cut(),t.rules.sequence.capture(c),t.rules.tokenOfType("equals"),t.rules.sequence.capture(h),t.rules.tokenOfType("close-square-bracket")).map(function(e,t){return{name:e,value:t,append:!1}}),p=t.rules.sequence(t.rules.tokenOfType("dot"),t.rules.sequence.cut(),t.rules.sequence.capture(c)).map(function(e){return{name:"class",value:e,append:!0}}),g=t.rules.firstOf("attribute or class",f,p);function m(e,n){var i=r(n),s=t.Parser().parseTokens(e,i);return s.isSuccess()?a.success(s.value()):new a.Result(null,[a.warning(b(n,s))])}function b(e,t){return"Did not understand this style mapping, so ignored it: "+e+"\n"+t.errors().map(v).join("\n")}function v(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var y=t.rules.sequence(t.rules.sequence.capture(s()),t.rules.tokenOfType("whitespace"),t.rules.tokenOfType("arrow"),t.rules.sequence.capture(t.rules.optional(t.rules.sequence(t.rules.tokenOfType("whitespace"),t.rules.sequence.capture(o())).head())),t.rules.tokenOfType("end")).map(function(e,t){return{from:e,to:t.valueOrElse(i.empty)}});return yA}().readStyle,s=function(){if(ek)return ik;ek=1,ik.readOptions=function(r){return r=r||{},e.extend({},n,r,{customStyleMap:i(r.styleMap),readStyleMap:function(){var e=this.customStyleMap;return this.includeEmbeddedStyleMap&&(e=e.concat(i(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(e=e.concat(t)),e}})};var e=bx,t=ik._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],n=ik._standardOptions={transformDocument:function(e){return e},includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function i(t){return t?e.isString(t)?t.split("\n").map(function(e){return e.trim()}).filter(function(e){return""!==e&&"#"!==e.charAt(0)}):t:[]}return ik}().readOptions,o=function(){if(tk)return rk;tk=1;var e=G_(),t=aT();return rk.openZip=function(n){return n.arrayBuffer?e.resolve(t.openArrayBuffer(n.arrayBuffer)):e.reject(new Error("Could not find file in options"))},rk}(),c=Z_().Result;function l(r,l){return l=s(l),o.openZip(r).tap(function(e){return n.readStyleMap(e).then(function(e){l.embeddedStyleMap=e})}).then(function(n){return t.read(n,r).then(function(e){return e.map(l.transformDocument)}).then(function(t){return function(t,n){var r,s=(r=n.readStyleMap(),c.combine((r||[]).map(a)).map(function(e){return e.filter(function(e){return!!e})})),o=e.extend({},n,{styleMap:s.value}),l=new i(o);return t.flatMapThen(function(e){return s.flatMapThen(function(t){return l.convertToHtml(e)})})}(t,l)})})}return Ob.convertToHtml=function(e,t){return l(e,t)},Ob.convertToMarkdown=function(e,t){var n=Object.create(t||{});return n.outputFormat="markdown",l(e,n)},Ob.convert=l,Ob.extractRawText=function(e){return o.openZip(e).then(t.read).then(function(e){return e.map(r)})},Ob.images=aA(),Ob.transforms=sk(),Ob.underline=function(){if(ok)return lk;ok=1;var e=nA(),t=tA();return lk.element=function(n){return function(i){return t.elementWithTag(e.element(n),[i])}},lk}(),Ob.embedStyleMap=function(e,t){return o.openZip(e).tap(function(e){return n.writeStyleMap(e,t)}).then(function(e){return e.toArrayBuffer()}).then(function(e){return{toArrayBuffer:function(){return e},toBuffer:function(){return Buffer.from(e)}}})},Ob.readEmbeddedStyleMap=function(e){return o.openZip(e).then(n.readStyleMap)},Ob.styleMapping=function(){throw new Error("Use a raw string instead of mammoth.styleMapping e.g. \"p[style-name='Title'] => h1\" instead of mammoth.styleMapping(\"p[style-name='Title'] => h1\")")},Ob}());
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var dk=1252,uk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fk={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pk=function(e){-1!=uk.indexOf(e)&&(dk=fk[0]=e)},gk=function(e){pk(e)};function mk(){gk(1200),pk(1252)}function bk(e){for(var t=[],n=0,i=e.length;n<i;++n)t[n]=e.charCodeAt(n);return t}function vk(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var yk,wk=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?vk(e.slice(2)):65279==t?e.slice(1):e},xk=function(e){return String.fromCharCode(e)},_k=function(e){return String.fromCharCode(e)},Tk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Dk(e){for(var t="",n=0,i=0,r=0,a=0,s=0,o=0,c=0,l=0;l<e.length;)a=(n=e.charCodeAt(l++))>>2,s=(3&n)<<4|(i=e.charCodeAt(l++))>>4,o=(15&i)<<2|(r=e.charCodeAt(l++))>>6,c=63&r,isNaN(i)?o=c=64:isNaN(r)&&(c=64),t+=Tk.charAt(a)+Tk.charAt(s)+Tk.charAt(o)+Tk.charAt(c);return t}function Ek(e){var t="",n=0,i=0,r=0,a=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)n=Tk.indexOf(e.charAt(c++))<<2|(a=Tk.indexOf(e.charAt(c++)))>>4,t+=String.fromCharCode(n),i=(15&a)<<4|(s=Tk.indexOf(e.charAt(c++)))>>2,64!==s&&(t+=String.fromCharCode(i)),r=(3&s)<<6|(o=Tk.indexOf(e.charAt(c++))),64!==o&&(t+=String.fromCharCode(r));return t}var Ak=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),kk=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Sk(e){return Ak?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ck(e){return Ak?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Uk=function(e){return Ak?kk(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Fk(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function Ik(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ik(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Rk=Ak?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:kk(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var i=new Uint8Array(n),r=0;for(t=0,n=0;t<e.length;n+=r,++t)if(r=e[t].length,e[t]instanceof Uint8Array)i.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";i.set(new Uint8Array(e[t]),n)}return i}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))},Nk=/\u0000/g,Mk=/[\u0001-\u0006]/g;function Ok(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Pk(e,t){var n=""+e;return n.length>=t?n:VS("0",t-n.length)+n}function Lk(e,t){var n=""+e;return n.length>=t?n:VS(" ",t-n.length)+n}function Wk(e,t){var n=""+e;return n.length>=t?n:n+VS(" ",t-n.length)}var Bk=Math.pow(2,32);function jk(e,t){return e>Bk||e<-Bk?function(e,t){var n=""+Math.round(e);return n.length>=t?n:VS("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:VS("0",t-n.length)+n}(Math.round(e),t)}function zk(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var Hk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vk=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Gk={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$k={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xk(e,t,n){for(var i=e<0?-1:1,r=e*i,a=0,s=1,o=0,c=1,l=0,h=0,d=Math.floor(r);l<t&&(o=(d=Math.floor(r))*s+a,h=d*l+c,!(r-d<5e-8));)r=1/(r-d),a=s,s=o,c=l,l=h;if(h>t&&(l>t?(h=c,o=a):(h=l,o=s)),!n)return[0,i*o,h];var u=Math.floor(i*o/h);return[u,i*o-u*h,h]}function Kk(e,t,n){if(e>2958465||e<0)return null;var i=0|e,r=Math.floor(86400*(e-i)),a=0,s=[],o={D:i,T:r,u:86400*(e-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(i+=1462),o.u>.9999&&(o.u=0,86400==++r&&(o.T=r=0,++i,++o.D)),60===i)s=n?[1317,10,29]:[1900,2,29],a=3;else if(0===i)s=n?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var c=new Date(1900,0,1);c.setDate(c.getDate()+i-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),i<60&&(a=(a+6)%7),n&&(a=function(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=a,o}var Yk=new Date(1899,11,31,0,0,0),Zk=Yk.getTime(),Jk=new Date(1900,2,1,0,0,0);function Qk(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Jk&&(n+=864e5),(n-(Zk+6e4*(e.getTimezoneOffset()-Yk.getTimezoneOffset())))/864e5}function eS(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function tS(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=eS(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=eS(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),eS(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function nS(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):tS(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return _S(14,Qk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function iS(e,t,n,i){var r,a="",s=0,o=0,c=n.y,l=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:r=c%100,l=2;break;default:r=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:r=n.m,l=t.length;break;case 3:return Vk[n.m-1][1];case 5:return Vk[n.m-1][0];default:return Vk[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:r=n.d,l=t.length;break;case 3:return Hk[n.q][0];default:return Hk[n.q][1]}break;case 104:switch(t.length){case 1:case 2:r=1+(n.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:r=n.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:r=n.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=i>=2?3===i?1e3:100:1===i?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(a=Pk(s,2+i),"ss"===t?a.substr(0,2):"."+a.substr(2,t.length-1))):Pk(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":r=24*n.D+n.H;break;case"[m]":case"[mm]":r=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":r=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:r=c,l=1}return l>0?Pk(r,l):""}function rS(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var aS=/%/g;function sS(e,t){var n,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+sS(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),-1===(n=(t/Math.pow(10,a)).toPrecision(i+1+(r+a)%r)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+a):n+="E+"+(s-a);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,r)+"."+n.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,i){return t+n+i.substr(0,(r+a)%r)+"."+i.substr(a)+"E"})}else n=t.toExponential(i);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var oS=/# (\?+)( ?)\/( ?)(\d+)/,cS=/^#*0*\.([0#]+)/,lS=/\).*[0#]/,hS=/\(###\) ###\\?-####/;function dS(e){for(var t,n="",i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function uS(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function fS(e,t){var n=e-Math.floor(e),i=Math.pow(10,t);return t<(""+Math.round(n*i)).length?0:Math.round(n*i)}function pS(e,t,n){if(40===e.charCodeAt(0)&&!t.match(lS)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?pS("n",i,n):"("+pS("n",i,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return bS(e,t.substr(0,i),n/Math.pow(10,3*(t.length-i)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var i=t.replace(aS,""),r=t.length-i.length;return bS(e,i,n*Math.pow(10,2*r))+VS("%",r)}(e,t,n);if(-1!==t.indexOf("E"))return sS(t,n);if(36===t.charCodeAt(0))return"$"+pS(e,t.substr(" "==t.charAt(1)?2:1),n);var r,a,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+jk(c,t.length);if(t.match(/^[#?]+$/))return"0"===(r=jk(n,0))&&(r=""),r.length>t.length?r:dS(t.substr(0,t.length-r.length))+r;if(a=t.match(oS))return function(e,t,n){var i=parseInt(e[4],10),r=Math.round(t*i),a=Math.floor(r/i),s=r-a*i,o=i;return n+(0===a?"":""+a)+" "+(0===s?VS(" ",e[1].length+1+e[4].length):Lk(s,e[1].length)+e[2]+"/"+e[3]+Pk(o,e[4].length))}(a,c,l);if(t.match(/^#+0+$/))return l+jk(c,t.length-t.indexOf("0"));if(a=t.match(cS))return r=uS(n,a[1].length).replace(/^([^\.]+)$/,"$1."+dS(a[1])).replace(/\.$/,"."+dS(a[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+VS("0",dS(a[1]).length-t.length)}),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return l+uS(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return l+rS(jk(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+pS(e,t,-n):rS(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,a[1].length)))+"."+Pk(fS(n,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return pS(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Ok(pS(e,t.replace(/[\\-]/g,""),n)),s=0,Ok(Ok(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<r.length?r.charAt(s++):"0"===e?"0":""}));if(t.match(hS))return"("+(r=pS(e,"##########",n)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Xk(c,Math.pow(10,s)-1,!1),r=""+l," "==(h=bS("n",a[1],o[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),r+=h+a[2]+"/"+a[3],(h=Wk(o[2],s)).length<a[4].length&&(h=dS(a[4].substr(a[4].length-h.length))+h),r+=h;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),l+((o=Xk(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Lk(o[1],s)+a[2]+"/"+a[3]+Wk(o[2],s):VS(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=jk(n,0),t.length<=r.length?r:dS(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var d=t.indexOf(".")-s,u=t.length-r.length-d;return dS(t.substr(0,d)+r+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=fS(n,a[1].length),n<0?"-"+pS(e,t,-n):rS(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Pk(0,3-e.length):"")+e})+"."+Pk(s,a[1].length);switch(t){case"###,##0.00":return pS(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=rS(jk(c,0));return"0"!==f?l+f:"";case"###,###.00":return pS(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return pS(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gS(e,t){var n,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+gS(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),!(n=(t/Math.pow(10,a)).toPrecision(i+1+(r+a)%r)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+a):n+="E+"+(s-a),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,i){return t+n+i.substr(0,(r+a)%r)+"."+i.substr(a)+"E"})}else n=t.toExponential(i);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function mS(e,t,n){if(40===e.charCodeAt(0)&&!t.match(lS)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?mS("n",i,n):"("+mS("n",i,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var i=t.length-1;44===t.charCodeAt(i-1);)--i;return bS(e,t.substr(0,i),n/Math.pow(10,3*(t.length-i)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var i=t.replace(aS,""),r=t.length-i.length;return bS(e,i,n*Math.pow(10,2*r))+VS("%",r)}(e,t,n);if(-1!==t.indexOf("E"))return gS(t,n);if(36===t.charCodeAt(0))return"$"+mS(e,t.substr(" "==t.charAt(1)?2:1),n);var r,a,s,o,c=Math.abs(n),l=n<0?"-":"";if(t.match(/^00+$/))return l+Pk(c,t.length);if(t.match(/^[#?]+$/))return r=""+n,0===n&&(r=""),r.length>t.length?r:dS(t.substr(0,t.length-r.length))+r;if(a=t.match(oS))return function(e,t,n){return n+(0===t?"":""+t)+VS(" ",e[1].length+2+e[4].length)}(a,c,l);if(t.match(/^#+0+$/))return l+Pk(c,t.length-t.indexOf("0"));if(a=t.match(cS))return r=(r=(""+n).replace(/^([^\.]+)$/,"$1."+dS(a[1])).replace(/\.$/,"."+dS(a[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+VS("0",dS(a[1]).length-t.length)}),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return l+rS(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+mS(e,t,-n):rS(""+n)+"."+VS("0",a[1].length);if(a=t.match(/^#,#*,#0/))return mS(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Ok(mS(e,t.replace(/[\\-]/g,""),n)),s=0,Ok(Ok(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<r.length?r.charAt(s++):"0"===e?"0":""}));if(t.match(hS))return"("+(r=mS(e,"##########",n)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Xk(c,Math.pow(10,s)-1,!1),r=""+l," "==(h=bS("n",a[1],o[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),r+=h+a[2]+"/"+a[3],(h=Wk(o[2],s)).length<a[4].length&&(h=dS(a[4].substr(a[4].length-h.length))+h),r+=h;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),l+((o=Xk(c,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Lk(o[1],s)+a[2]+"/"+a[3]+Wk(o[2],s):VS(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=""+n,t.length<=r.length?r:dS(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var d=t.indexOf(".")-s,u=t.length-r.length-d;return dS(t.substr(0,d)+r+t.substr(t.length-u))}if(a=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+mS(e,t,-n):rS(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Pk(0,3-e.length):"")+e})+"."+Pk(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=rS(""+c);return"0"!==f?l+f:"";default:if(t.match(/\.[0#?]*$/))return mS(e,t.slice(0,t.lastIndexOf(".")),n)+dS(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function bS(e,t,n){return(0|n)===n?mS(e,t,n):pS(e,t,n)}var vS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yS(e){for(var t=0,n="",i="";t<e.length;)switch(n=e.charAt(t)){case"G":zk(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(i=n;"]"!==e.charAt(t++)&&t<e.length;)i+=e.charAt(t);if(i.match(vS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var wS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xS(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function _S(e,t,n){null==n&&(n={});var i="";switch(typeof e){case"string":i="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(i=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Gk)[e])&&(i=n.table&&n.table[$k[e]]||Gk[$k[e]]),null==i&&(i=qk[e]||"General")}if(zk(i,0))return nS(t,n);t instanceof Date&&(t=Qk(t,n.date1904));var r=function(e,t){var n=function(e){for(var t=[],n=!1,i=0,r=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:n=!n;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=e.substr(r,i-r),r=i+1}if(t[t.length]=e.substr(r),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),i=n.length,r=n[i-1].indexOf("@");if(i<4&&r>-1&&--i,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var a=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[i,a];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(wS),o=n[1].match(wS);return xS(t,s)?[i,n[0]]:xS(t,o)?[i,n[1]]:[i,n[null!=s&&null!=o?2:1]]}return[i,a]}(i,t);if(zk(r[1]))return nS(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,i){for(var r,a,s,o=[],c="",l=0,h="",d="t",u="H";l<e.length;)switch(h=e.charAt(l)){case"G":if(!zk(e,l))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(s=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(s);o[o.length]={t:"t",v:c},++l;break;case"\\":var f=e.charAt(++l),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++l;break;case"_":o[o.length]={t:"t",v:" "},l+=2;break;case"@":o[o.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==r&&null==(r=Kk(t,n,"2"===e.charAt(l+1))))return"";o[o.length]={t:"X",v:e.substr(l,2)},d=h,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=Kk(t,n)))return"";for(c=h;++l<e.length&&e.charAt(l).toLowerCase()===h;)c+=h;"m"===h&&"h"===d.toLowerCase()&&(h="M"),"h"===h&&(h=u),o[o.length]={t:h,v:c},d=h;break;case"A":case"a":case"上":var g={t:h,v:h};if(null==r&&(r=Kk(t,n)),"A/P"===e.substr(l,3).toUpperCase()?(null!=r&&(g.v=r.H>=12?"P":"A"),g.t="T",u="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=r&&(g.v=r.H>=12?"PM":"AM"),g.t="T",l+=5,u="h"):"上午/下午"===e.substr(l,5).toUpperCase()?(null!=r&&(g.v=r.H>=12?"下午":"上午"),g.t="T",l+=5,u="h"):(g.t="t",++l),null==r&&"T"===g.t)return"";o[o.length]=g,d=h;break;case"[":for(c=h;"]"!==e.charAt(l++)&&l<e.length;)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(vS)){if(null==r&&null==(r=Kk(t,n)))return"";o[o.length]={t:"Z",v:c.toLowerCase()},d=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",yS(e)||(o[o.length]={t:"t",v:c}));break;case".":if(null!=r){for(c=h;++l<e.length&&"0"===(h=e.charAt(l));)c+=h;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=h;++l<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(l))>-1;)c+=h;o[o.length]={t:"n",v:c};break;case"?":for(c=h;e.charAt(++l)===h;)c+=h;o[o.length]={t:h,v:c},d=h;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":o[o.length]={t:1===i?"t":h,v:h},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=h;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)c+=e.charAt(l);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:h,v:h},++l;break;case"$":o[o.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"t",v:h},++l}var m,b=0,v=0;for(l=o.length-1,d="t";l>=0;--l)switch(o[l].t){case"h":case"H":o[l].t=u,d="h",b<1&&(b=1);break;case"s":(m=o[l].v.match(/\.0+$/))&&(v=Math.max(v,m[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=o[l].t;break;case"m":"s"===d&&(o[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&o[l].v.match(/[Hh]/)&&(b=1),b<2&&o[l].v.match(/[Mm]/)&&(b=2),b<3&&o[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var y,w="";for(l=0;l<o.length;++l)switch(o[l].t){case"t":case"T":case" ":case"D":break;case"X":o[l].v="",o[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[l].v=iS(o[l].t.charCodeAt(0),o[l].v,r,v),o[l].t="t";break;case"n":case"?":for(y=l+1;null!=o[y]&&("?"===(h=o[y].t)||"D"===h||(" "===h||"t"===h)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[l].t&&(" "===h||"n"===h||")"===h)||"t"===h&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[l].v+=o[y].v,o[y]={v:"",t:";"},++y;w+=o[l].v,l=y-1;break;case"G":o[l].t="t",o[l].v=nS(t,n)}var x,_,T="";if(w.length>0){40==w.charCodeAt(0)?(x=t<0&&45===w.charCodeAt(0)?-t:t,_=bS("n",w,x)):(_=bS("n",w,x=t<0&&i>1?-t:t),x<0&&o[0]&&"t"==o[0].t&&(_=_.substr(1),o[0].v="-"+o[0].v)),y=_.length-1;var D=o.length;for(l=0;l<o.length;++l)if(null!=o[l]&&"t"!=o[l].t&&o[l].v.indexOf(".")>-1){D=l;break}var E=o.length;if(D===o.length&&-1===_.indexOf("E")){for(l=o.length-1;l>=0;--l)null!=o[l]&&-1!=="n?".indexOf(o[l].t)&&(y>=o[l].v.length-1?(y-=o[l].v.length,o[l].v=_.substr(y+1,o[l].v.length)):y<0?o[l].v="":(o[l].v=_.substr(0,y+1),y=-1),o[l].t="t",E=l);y>=0&&E<o.length&&(o[E].v=_.substr(0,y+1)+o[E].v)}else if(D!==o.length&&-1===_.indexOf("E")){for(y=_.indexOf(".")-1,l=D;l>=0;--l)if(null!=o[l]&&-1!=="n?".indexOf(o[l].t)){for(a=o[l].v.indexOf(".")>-1&&l===D?o[l].v.indexOf(".")-1:o[l].v.length-1,T=o[l].v.substr(a+1);a>=0;--a)y>=0&&("0"===o[l].v.charAt(a)||"#"===o[l].v.charAt(a))&&(T=_.charAt(y--)+T);o[l].v=T,o[l].t="t",E=l}for(y>=0&&E<o.length&&(o[E].v=_.substr(0,y+1)+o[E].v),y=_.indexOf(".")+1,l=D;l<o.length;++l)if(null!=o[l]&&(-1!=="n?(".indexOf(o[l].t)||l===D)){for(a=o[l].v.indexOf(".")>-1&&l===D?o[l].v.indexOf(".")+1:0,T=o[l].v.substr(0,a);a<o[l].v.length;++a)y<_.length&&(T+=_.charAt(y++));o[l].v=T,o[l].t="t",E=l}}}for(l=0;l<o.length;++l)null!=o[l]&&"n?".indexOf(o[l].t)>-1&&(x=i>1&&t<0&&l>0&&"-"===o[l-1].v?-t:t,o[l].v=bS(o[l].t,o[l].v,x),o[l].t="t");var A="";for(l=0;l!==o.length;++l)null!=o[l]&&(A+=o[l].v);return A}(r[1],t,n,r[0])}function TS(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null!=Gk[n]){if(Gk[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Gk[t]=e,t}function DS(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',Gk=e}var ES={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},AS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,kS=function(){var e={version:"1.2.0"},t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),n=function(e){var t=0,n=0,i=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(i=0;256!=i;++i)r[i]=e[i];for(i=0;256!=i;++i)for(n=e[i],t=256+i;t<4096;t+=256)n=r[t]=n>>>8^e[255&n];var a=[];for(i=1;16!=i;++i)a[i-1]="undefined"!=typeof Int32Array?r.subarray(256*i,256*i+256):r.slice(256*i,256*i+256);return a}(t),i=n[0],r=n[1],a=n[2],s=n[3],o=n[4],c=n[5],l=n[6],h=n[7],d=n[8],u=n[9],f=n[10],p=n[11],g=n[12],m=n[13],b=n[14];return e.table=t,e.bstr=function(e,n){for(var i=-1^n,r=0,a=e.length;r<a;)i=i>>>8^t[255&(i^e.charCodeAt(r++))];return~i},e.buf=function(e,n){for(var v=-1^n,y=e.length-15,w=0;w<y;)v=b[e[w++]^255&v]^m[e[w++]^v>>8&255]^g[e[w++]^v>>16&255]^p[e[w++]^v>>>24]^f[e[w++]]^u[e[w++]]^d[e[w++]]^h[e[w++]]^l[e[w++]]^c[e[w++]]^o[e[w++]]^s[e[w++]]^a[e[w++]]^r[e[w++]]^i[e[w++]]^t[e[w++]];for(y+=15;w<y;)v=v>>>8^t[255&(v^e[w++])];return~v},e.str=function(e,n){for(var i=-1^n,r=0,a=e.length,s=0,o=0;r<a;)(s=e.charCodeAt(r++))<128?i=i>>>8^t[255&(i^s)]:s<2048?i=(i=i>>>8^t[255&(i^(192|s>>6&31))])>>>8^t[255&(i^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(r++),i=(i=(i=(i=i>>>8^t[255&(i^(240|s>>8&7))])>>>8^t[255&(i^(128|s>>2&63))])>>>8^t[255&(i^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(i^(128|63&o))]):i=(i=(i=i>>>8^t[255&(i^(224|s>>12&15))])>>>8^t[255&(i^(128|s>>6&63))])>>>8^t[255&(i^(128|63&s))];return~i},e}(),SS=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function i(e){if("/"==e.charAt(e.length-1))return i(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function r(e,t){"string"==typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var i=t.getFullYear()-1980;i=(i=i<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,i)}function a(e){mU(e,0);for(var t={},n=0;e.l<=e.length-4;){var i=e.read_shift(2),r=e.read_shift(2),a=e.l+r,s={};21589===i&&(1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),r>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime))),e.l=a,t[i]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ie(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=_(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",i=(Ak&&Buffer.isBuffer(e)?e.toString("binary"):_(e)).split("\r\n"),r=0,a="";for(r=0;r<i.length;++r)if(a=i[r],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),n||(n=a.slice(0,a.lastIndexOf("/")+1)),a.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),a.slice(0,n.length)!=n););var s=(i[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),c={FileIndex:[],FullPaths:[]};u(c);var l,h=0;for(r=0;r<i.length;++r){var d=i[r];d!==o&&d!==o+"--"||(h++&&le(c,i.slice(l,r),n),l=r)}return c}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,i,r,a,s,o,f=512,p=[],g=e.slice(0,512);mU(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return ie(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&mU(g=e.slice(0,f),28);var y=e.slice(0,f);!function(e,t){var n;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var w=g.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);g.l+=4,a=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),s=g.read_shift(4,"i"),i=g.read_shift(4,"i"),o=g.read_shift(4,"i"),r=g.read_shift(4,"i");for(var x=-1,T=0;T<109&&!((x=g.read_shift(4,"i"))<0);++T)p[T]=x;var D=function(e,t){for(var n=Math.ceil(e.length/t)-1,i=[],r=1;r<n;++r)i[r-1]=e.slice(r*t,(r+1)*t);return i[n-1]=e.slice(n*t),i}(e,f);l(o,r,D,f,p);var E=function(e,t,n,i){var r=e.length,a=[],s=[],o=[],c=[],l=i-1,h=0,d=0,u=0,f=0;for(h=0;h<r;++h)if(o=[],(u=h+t)>=r&&(u-=r),!s[u]){c=[];var p=[];for(d=u;d>=0;){p[d]=!0,s[d]=!0,o[o.length]=d,c.push(e[d]);var g=n[Math.floor(4*d/i)];if(i<4+(f=4*d&l))throw new Error("FAT boundary crossed: "+d+" 4 "+i);if(!e[g])break;if(p[d=cU(e[g],f)])break}a[u]={nodes:o,data:LC([c])}}return a}(D,a,p,f);E[a].name="!Directory",i>0&&s!==b&&(E[s].name="!MiniFAT"),E[p[0]].name="!FAT",E.fat_addrs=p,E.ssz=f;var A=[],k=[],S=[];!function(e,t,n,i,r,a,s,o){for(var l,u=0,f=i.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var v=p.slice(g,g+128);mU(v,64),m=v.read_shift(2),l=BC(v,0,m-f),i.push(l);var y={name:l,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.ct=d(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.mt=d(v,v.l-8)),y.start=v.read_shift(4,"i"),y.size=v.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=b,y.name=""),5===y.type?(u=y.start,r>0&&u!==b&&(t[u].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=h(n,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:u!==b&&y.start!==b&&t[u]&&(y.content=c(y,t[u].data,(t[o]||{}).data))),y.content&&mU(y.content,0),a[l]=y,s.push(y)}}(a,E,D,A,i,{},k,s),function(e,t,n){for(var i=0,r=0,a=0,s=0,o=0,c=n.length,l=[],h=[];i<c;++i)l[i]=h[i]=i,t[i]=n[i];for(;o<h.length;++o)r=e[i=h[o]].L,a=e[i].R,s=e[i].C,l[i]===i&&(-1!==r&&l[r]!==r&&(l[i]=l[r]),-1!==a&&l[a]!==a&&(l[i]=l[a])),-1!==s&&(l[s]=i),-1!==r&&i!=l[i]&&(l[r]=l[i],h.lastIndexOf(r)<o&&h.push(r)),-1!==a&&i!=l[i]&&(l[a]=l[i],h.lastIndexOf(a)<o&&h.push(a));for(i=1;i<c;++i)l[i]===i&&(-1!==a&&l[a]!==a?l[i]=l[a]:-1!==r&&l[r]!==r&&(l[i]=l[r]));for(i=1;i<c;++i)if(0!==e[i].type){if((o=i)!=l[o])do{o=l[o],t[i]=t[o]+"/"+t[i]}while(0!==o&&-1!==l[o]&&o!=l[o]);l[i]=-1}for(t[0]+="/",i=1;i<c;++i)2!==e[i].type&&(t[i]+="/")}(k,S,A),A.shift();var C={FileIndex:k,FullPaths:S};return t&&t.raw&&(C.raw={header:y,sectors:D}),C}function c(e,t,n){for(var i=e.start,r=e.size,a=[],s=i;n&&r>0&&s>=0;)a.push(t.slice(s*m,s*m+m)),r-=m,s=cU(n,4*s);return 0===a.length?vU(0):Rk(a).slice(0,e.size)}function l(e,t,n,i,r){var a=b;if(e===b){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(i>>>2)-1;if(!s)return;for(var c=0;c<o&&(a=cU(s,4*c))!==b;++c)r.push(a);l(cU(s,i-4),t-1,n,i,r)}}function h(e,t,n,i,r){var a=[],s=[];r||(r=[]);var o=i-1,c=0,l=0;for(c=t;c>=0;){r[c]=!0,a[a.length]=c,s.push(e[c]);var h=n[Math.floor(4*c/i)];if(i<4+(l=4*c&o))throw new Error("FAT boundary crossed: "+c+" 4 "+i);if(!e[h])break;c=cU(e[h],l)}return{nodes:a,data:LC([s])}}function d(e,t){return new Date(1e3*(oU(e,t+4)/1e7*Math.pow(2,32)+oU(e,t)/1e7-11644473600))}function u(e,t){var n=t||{},i=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=i+"/",e.FileIndex[0]={name:i,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="Sh33tJ5";if(!SS.find(e,"/"+t)){var n=vU(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}}(e)}function f(e,t){u(e);for(var r=!1,a=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:a?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(r=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){var c=new Date(1987,1,19),l=0,h=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)h[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var f=n(d[s][0]);(a=h[f])||(d.push([f,{name:i(f).replace("/",""),type:1,clsid:w,ct:c,mt:c,content:null}]),h[f]=!0)}for(d.sort(function(e,t){return function(e,t){for(var n=e.split("/"),i=t.split("/"),r=0,a=0,s=Math.min(n.length,i.length);r<s;++r){if(a=n[r].length-i[r].length)return a;if(n[r]!=i[r])return n[r]<i[r]?-1:1}return n.length-i.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var p=e.FileIndex[s],g=e.FullPaths[s];if(p.name=i(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(l=s+1;l<d.length&&n(e.FullPaths[l])!=g;++l);for(p.C=l>=d.length?-1:l,l=s+1;l<d.length&&n(e.FullPaths[l])!=n(g);++l);p.R=l>=d.length?-1:l,p.type=1}else n(e.FullPaths[s+1]||"")==n(g)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},i=n.boundary||"SheetJS",r=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(i="------="+i).slice(2)+'"',"","",""],a=e.FullPaths[0],s=a,o=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(s=e.FullPaths[c].slice(a.length),(o=e.FileIndex[c]).size&&o.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var l=o.content,h=Ak&&Buffer.isBuffer(l)?l.toString("binary"):_(l),d=0,u=Math.min(1024,h.length),f=0,p=0;p<=u;++p)(f=h.charCodeAt(p))>=32&&f<128&&++d;var g=d>=4*u/5;r.push(i),r.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),r.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),r.push("Content-Type: "+se(o,s)),r.push(""),r.push(g?ce(h):oe(h))}return r.push(i+"--\r\n"),r.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},i=[],a=[],s=vU(1),o=n.compression?8:0,c=0,l=0,h=0,d=0,u=e.FullPaths[0],f=u,p=e.FileIndex[0],g=[],m=0;for(c=1;c<e.FullPaths.length;++c)if(f=e.FullPaths[c].slice(u.length),(p=e.FileIndex[c]).size&&p.content&&"Sh33tJ5"!=f){var b=h,v=vU(f.length);for(l=0;l<f.length;++l)v.write_shift(1,127&f.charCodeAt(l));v=v.slice(0,v.l),g[d]=kS.buf(p.content,0);var y=p.content;8==o&&(y=T(y)),(s=vU(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,0),s.write_shift(2,o),p.mt?r(s,p.mt):s.write_shift(4,0),s.write_shift(-4,g[d]),s.write_shift(4,y.length),s.write_shift(4,p.content.length),s.write_shift(2,v.length),s.write_shift(2,0),h+=s.length,i.push(s),h+=v.length,i.push(v),h+=y.length,i.push(y),(s=vU(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,0),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[d]),s.write_shift(4,y.length),s.write_shift(4,p.content.length),s.write_shift(2,v.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,b),m+=s.l,a.push(s),m+=v.length,a.push(v),++d}return(s=vU(22)).write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,d),s.write_shift(2,d),s.write_shift(4,m),s.write_shift(4,h),s.write_shift(2,0),Rk([Rk(i),Rk(a),s])}(e,n);var i=function(e){for(var t=0,n=0,i=0;i<e.FileIndex.length;++i){var r=e.FileIndex[i];if(r.content){var a=r.content.length;a>0&&(a<4096?t+=a+63>>6:n+=a+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,c=(t+7>>3)+n+s+o,l=c+127>>7,h=l<=109?0:Math.ceil((l-109)/127);c+l+h+127>>7>l;)h=++l<=109?0:Math.ceil((l-109)/127);var d=[1,h,l,o,s,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),a=vU(i[7]<<9),s=0,o=0;for(s=0;s<8;++s)a.write_shift(1,y[s]);for(s=0;s<8;++s)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),s=0;s<3;++s)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,i[2]),a.write_shift(4,i[0]+i[1]+i[2]+i[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,i[3]?i[0]+i[1]+i[2]-1:b),a.write_shift(4,i[3]),a.write_shift(-4,i[1]?i[0]-1:b),a.write_shift(4,i[1]),s=0;s<109;++s)a.write_shift(-4,s<i[2]?i[1]+s:-1);if(i[1])for(o=0;o<i[1];++o){for(;s<236+127*o;++s)a.write_shift(-4,s<i[2]?i[1]+s:-1);a.write_shift(-4,o===i[1]-1?b:o+1)}var c=function(e){for(o+=e;s<o-1;++s)a.write_shift(-4,s+1);e&&(++s,a.write_shift(-4,b))};for(o=s=0,o+=i[1];s<o;++s)a.write_shift(-4,x.DIFSECT);for(o+=i[2];s<o;++s)a.write_shift(-4,x.FATSECT);c(i[3]),c(i[4]);for(var l=0,h=0,d=e.FileIndex[0];l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&((h=d.content.length)<4096||(d.start=o,c(h+511>>9)));for(c(i[6]+7>>3);511&a.l;)a.write_shift(-4,x.ENDOFCHAIN);for(o=s=0,l=0;l<e.FileIndex.length;++l)(d=e.FileIndex[l]).content&&(!(h=d.content.length)||h>=4096||(d.start=o,c(h+63>>6)));for(;511&a.l;)a.write_shift(-4,x.ENDOFCHAIN);for(s=0;s<i[4]<<2;++s){var u=e.FullPaths[s];if(u&&0!==u.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:b);var p=0===s&&n.root||d.name;if(h=2*(p.length+1),a.write_shift(64,p,"utf16le"),a.write_shift(2,h),a.write_shift(1,d.type),a.write_shift(1,d.color),a.write_shift(-4,d.L),a.write_shift(-4,d.R),a.write_shift(-4,d.C),d.clsid)a.write_shift(16,d.clsid,"hex");else for(l=0;l<4;++l)a.write_shift(4,0);a.write_shift(4,d.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,d.start),a.write_shift(4,d.size),a.write_shift(4,0)}else{for(l=0;l<17;++l)a.write_shift(4,0);for(l=0;l<3;++l)a.write_shift(4,-1);for(l=0;l<12;++l)a.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(a.l=d.start+1<<9,Ak&&Buffer.isBuffer(d.content))d.content.copy(a,a.l,0,d.size),a.l+=d.size+511&-512;else{for(l=0;l<d.size;++l)a.write_shift(1,d.content[l]);for(;511&l;++l)a.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(Ak&&Buffer.isBuffer(d.content))d.content.copy(a,a.l,0,d.size),a.l+=d.size+63&-64;else{for(l=0;l<d.size;++l)a.write_shift(1,d.content[l]);for(;63&l;++l)a.write_shift(1,0)}if(Ak)a.l=a.length;else for(;a.l<a.length;)a.write_shift(1,0);return a}t.version="1.2.1";var g,m=64,b=-2,v="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function T(e){return g?g.deflateRawSync(e):X(e)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var S="undefined"!=typeof Uint8Array,C=S?new Uint8Array(256):[],U=0;U<256;++U)C[U]=k(U);function F(e,t){var n=C[255&e];return t<=8?n>>>8-t:(n=n<<8|C[e>>8&255],t<=16?n>>>16-t:(n=n<<8|C[e>>16&255])>>>24-t)}function I(e,t){var n=7&t,i=t>>>3;return(e[i]|(n<=6?0:e[i+1]<<8))>>>n&3}function R(e,t){var n=7&t,i=t>>>3;return(e[i]|(n<=5?0:e[i+1]<<8))>>>n&7}function N(e,t){var n=7&t,i=t>>>3;return(e[i]|(n<=3?0:e[i+1]<<8))>>>n&31}function M(e,t){var n=7&t,i=t>>>3;return(e[i]|(n<=1?0:e[i+1]<<8))>>>n&127}function O(e,t,n){var i=7&t,r=t>>>3,a=(1<<n)-1,s=e[r]>>>i;return n<8-i?s&a:(s|=e[r+1]<<8-i,n<16-i?s&a:(s|=e[r+2]<<16-i,n<24-i?s&a:(s|=e[r+3]<<24-i)&a))}function P(e,t,n){var i=7&t,r=t>>>3;return i<=5?e[r]|=(7&n)<<i:(e[r]|=n<<i&255,e[r+1]=(7&n)>>8-i),t+3}function L(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function W(e,t,n){var i=t>>>3;return n<<=7&t,e[i]|=255&n,n>>>=8,e[i+1]=n,t+8}function B(e,t,n){var i=t>>>3;return n<<=7&t,e[i]|=255&n,n>>>=8,e[i+1]=255&n,e[i+2]=n>>>8,t+16}function j(e,t){var n=e.length,i=2*n>t?2*n:t+5,r=0;if(n>=t)return e;if(Ak){var a=Ck(i);if(e.copy)e.copy(a);else for(;r<e.length;++r)a[r]=e[r];return a}if(S){var s=new Uint8Array(i);if(s.set)s.set(e);else for(;r<n;++r)s[r]=e[r];return s}return e.length=i,e}function z(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function H(e,t,n){var i=1,r=0,a=0,s=0,o=0,c=e.length,l=S?new Uint16Array(32):z(32);for(a=0;a<32;++a)l[a]=0;for(a=c;a<n;++a)e[a]=0;c=e.length;var h=S?new Uint16Array(c):z(c);for(a=0;a<c;++a)l[r=e[a]]++,i<r&&(i=r),h[a]=0;for(l[0]=0,a=1;a<=i;++a)l[a+16]=o=o+l[a-1]<<1;for(a=0;a<c;++a)0!=(o=e[a])&&(h[a]=l[o+16]++);var d=0;for(a=0;a<c;++a)if(0!=(d=e[a]))for(o=F(h[a],i)>>i-d,s=(1<<i+4-d)-1;s>=0;--s)t[o|s<<d]=15&d|a<<4;return i}var V=S?new Uint16Array(512):z(512),G=S?new Uint16Array(32):z(32);if(!S){for(var $=0;$<512;++$)V[$]=0;for($=0;$<32;++$)G[$]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);H(n,V,288)}();var q=function(){for(var e=S?new Uint8Array(32768):[],t=0,n=0;t<A.length-1;++t)for(;n<A[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var i=S?new Uint8Array(259):[];for(t=0,n=0;t<E.length-1;++t)for(;n<E[t+1];++n)i[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var i=Math.min(65535,e.length-n),r=n+i==e.length;for(t.write_shift(1,+r),t.write_shift(2,i),t.write_shift(2,65535&~i);i-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var r=0,a=0,s=S?new Uint16Array(32768):[];a<t.length;){var o=Math.min(65535,t.length-a);if(o<10){for(7&(r=P(n,r,+!(a+o!=t.length)))&&(r+=8-(7&r)),n.l=r/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[a++];r=8*n.l}else{r=P(n,r,+!(a+o!=t.length)+2);for(var c=0;o-- >0;){var l=t[a],h=-1,d=0;if((h=s[c=32767&(c<<5^l)])&&((h|=-32768&a)>a&&(h-=32768),h<a))for(;t[h+d]==t[a+d]&&d<250;)++d;if(d>2){(l=i[d])<=22?r=W(n,r,C[l+1]>>1)-1:(W(n,r,3),W(n,r+=5,C[l-23]>>5),r+=3);var u=l<8?0:l-4>>2;u>0&&(B(n,r,d-E[l]),r+=u),l=e[a-h],r=W(n,r,C[l]>>3),r-=3;var f=l<4?0:l-2>>1;f>0&&(B(n,r,a-h-A[l]),r+=f);for(var p=0;p<d;++p)s[c]=32767&a,c=32767&(c<<5^t[a]),++a;o-=d-1}else l<=143?l+=48:r=L(n,r,1),r=W(n,r,C[l]),s[c]=32767&a,++a}r=W(n,r,0)-1}}return n.l=(r+7)/8|0,n.l}(t,n)}}();function X(e){var t=vU(50+Math.floor(1.1*e.length)),n=q(e,t);return t.slice(0,n)}var K=S?new Uint16Array(32768):z(32768),Y=S?new Uint16Array(32768):z(32768),Z=S?new Uint16Array(128):z(128),J=1,Q=1;function ee(e,t){var n=N(e,t)+257,i=N(e,t+=5)+1,r=function(e,t){var n=7&t,i=t>>>3;return(e[i]|(n<=4?0:e[i+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var a=0,s=S?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=S?new Uint8Array(8):z(8),h=S?new Uint8Array(8):z(8),d=s.length,u=0;u<r;++u)s[D[u]]=a=R(e,t),c<a&&(c=a),l[a]++,t+=3;var f=0;for(l[0]=0,u=1;u<=c;++u)h[u]=f=f+l[u-1]<<1;for(u=0;u<d;++u)0!=(f=s[u])&&(o[u]=h[f]++);var p=0;for(u=0;u<d;++u)if(0!=(p=s[u])){f=C[o[u]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)Z[f|g<<p]=7&p|u<<3}var m=[];for(c=1;m.length<n+i;)switch(t+=7&(f=Z[M(e,t)]),f>>>=3){case 16:for(a=3+I(e,t),t+=2,f=m[m.length-1];a-- >0;)m.push(f);break;case 17:for(a=3+R(e,t),t+=3;a-- >0;)m.push(0);break;case 18:for(a=11+M(e,t),t+=7;a-- >0;)m.push(0);break;default:m.push(f),c<f&&(c=f)}var b=m.slice(0,n),v=m.slice(n);for(u=n;u<286;++u)b[u]=0;for(u=i;u<30;++u)v[u]=0;return J=H(b,K,286),Q=H(v,Y,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Sk(t),2];for(var n=0,i=0,r=Ck(t||1<<18),a=0,s=r.length>>>0,o=0,c=0;!(1&i);)if(i=R(e,n),n+=3,i>>>1!=0)for(i>>1==1?(o=9,c=5):(n=ee(e,n),o=J,c=Q);;){!t&&s<a+32767&&(s=(r=j(r,a+32767)).length);var l=O(e,n,o),h=i>>>1==1?V[l]:K[l];if(n+=15&h,(h>>>=4)>>>8&255){if(256==h)break;var d=(h-=257)<8?0:h-4>>2;d>5&&(d=0);var u=a+E[h];d>0&&(u+=O(e,n,d),n+=d),l=O(e,n,c),n+=15&(h=i>>>1==1?G[l]:Y[l]);var f=(h>>>=4)<4?0:h-2>>1,p=A[h];for(f>0&&(p+=O(e,n,f),n+=f),!t&&s<u&&(s=(r=j(r,u+100)).length);a<u;)r[a]=r[a-p],++a}else r[a++]=h}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,g>0)for(!t&&s<a+g&&(s=(r=j(r,a+g)).length);g-- >0;)r[a++]=e[n>>>3],n+=8}return t?[r,n+7>>>3]:[r.slice(0,a),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t)}function ie(e,t){var n=e;mU(n,0);var i={FileIndex:[],FullPaths:[]};u(i,{root:t.root});for(var r=n.length-4;(80!=n[r]||75!=n[r+1]||5!=n[r+2]||6!=n[r+3])&&r>=0;)--r;n.l=r+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,r=0;r<s;++r){n.l+=20;var c=n.read_shift(4),l=n.read_shift(4),h=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),g=a(n.slice(n.l+h,n.l+h+d));n.l+=h+d+f;var m=n.l;n.l=p+4,re(n,c,l,i,g),n.l=m}return i}function re(e,t,n,i,r){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),c=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),i=new Date,r=31&n,a=15&(n>>>=5);n>>>=4,i.setMilliseconds(0),i.setFullYear(n+1980),i.setMonth(a-1),i.setDate(r);var s=31&t,o=63&(t>>>=5);return t>>>=6,i.setHours(t),i.setMinutes(o),i.setSeconds(s<<1),i}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var l=e.read_shift(4),h=e.read_shift(4),d=e.read_shift(2),u=e.read_shift(2),f="",p=0;p<d;++p)f+=String.fromCharCode(e[e.l++]);if(u){var m=a(e.slice(e.l,e.l+u));(m[21589]||{}).mt&&(c=m[21589].mt),((r||{})[21589]||{}).mt&&(c=r[21589].mt)}e.l+=u;var b=e.slice(e.l,e.l+l);switch(o){case 8:b=function(e,t){if(!g)return te(e,t);var n=new(0,g.InflateRaw),i=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,i}(e,h);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var v=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),l=e.read_shift(4),h=e.read_shift(4)),l!=t&&ne(v,"Bad compressed size: "+t+" != "+l),h!=n&&ne(v,"Bad uncompressed size: "+n+" != "+h),he(i,f,b,{unsafe:!0,mt:c})}var ae={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",i=n.match(/\.([^\.]+)$/);return i&&ae[i[1]]||t&&(i=(n=t).match(/[\.\\]([^\.\\])+$/))&&ae[i[1]]?ae[i[1]]:"application/octet-stream"}function oe(e){for(var t=Dk(e),n=[],i=0;i<t.length;i+=76)n.push(t.slice(i,i+76));return n.join("\r\n")+"\r\n"}function ce(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],i=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),r=0;r<i.length;++r){var a=i[r];if(0!=a.length)for(var s=0;s<a.length;){var o=76,c=a.slice(s,s+o);"="==c.charAt(o-1)?o--:"="==c.charAt(o-2)?o-=2:"="==c.charAt(o-3)&&(o-=3),c=a.slice(s,s+o),(s+=o)<a.length&&(c+="="),n.push(c)}else n.push("")}return n.join("\r\n")}function le(e,t,n){for(var i,r="",a="",s="",o=0;o<10;++o){var c=t[o];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":r=l[2].trim();break;case"content-type":s=l[2].trim();break;case"content-transfer-encoding":a=l[2].trim()}}switch(++o,a.toLowerCase()){case"base64":i=Uk(Ek(t.slice(o).join("")));break;case"quoted-printable":i=function(e){for(var t=[],n=0;n<e.length;++n){for(var i=e[n];n<=e.length&&"="==i.charAt(i.length-1);)i=i.slice(0,i.length-1)+e[++n];t.push(i)}for(var r=0;r<t.length;++r)t[r]=t[r].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Uk(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+a)}var h=he(e,r.slice(n.length),i,{unsafe:!0});s&&(h.ctype=s)}function he(e,t,n,r){var a=r&&r.unsafe;a||u(e);var s=!a&&SS.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:i(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),a||SS.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,r&&(r.CLSID&&(s.clsid=r.CLSID),r.mt&&(s.mt=r.mt),r.ct&&(s.ct=r.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),i=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),r=!1;47===t.charCodeAt(0)?(r=!0,t=n[0].slice(0,-1)+t):r=-1!==t.indexOf("/");var a=t.toUpperCase(),s=!0===r?n.indexOf(a):i.indexOf(a);if(-1!==s)return e.FileIndex[s];var o=!a.match(Mk);for(a=a.replace(Nk,""),o&&(a=a.replace(Mk,"!")),s=0;s<n.length;++s){if((o?n[s].replace(Mk,"!"):n[s]).replace(Nk,"")==a)return e.FileIndex[s];if((o?i[s].replace(Mk,"!"):i[s]).replace(Nk,"")==a)return e.FileIndex[s]}return null},t.read=function(t,n){var i=n&&n.type;switch(i||Ak&&Buffer.isBuffer(t)&&(i="buffer"),i||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(Uk(Ek(t)),n);case"binary":return o(Uk(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var i=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,i),i;case"binary":return"string"==typeof i?i:_(i);case"base64":return Dk("string"==typeof i?i:_(i));case"buffer":if(Ak)return Buffer.isBuffer(i)?i:kk(i);case"array":return"string"==typeof i?Uk(i):i}return i},t.writeFile=function(t,n,i){s();var r=p(t,i);e.writeFileSync(n,r)},t.utils={cfb_new:function(e){var t={};return u(t,e),t},cfb_add:he,cfb_del:function(e,t){u(e);var n=SS.find(e,t);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n)return e.FileIndex.splice(i,1),e.FullPaths.splice(i,1),!0;return!1},cfb_mov:function(e,t,n){u(e);var r=SS.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex[a].name=i(n),e.FullPaths[a]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:hU,CheckField:gU,prep_blob:mU,bconcat:Rk,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(n){}},_deflateRaw:X,_inflateRaw:te,consts:x},t}();function CS(e){for(var t=Object.keys(e),n=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(e,t[i])&&n.push(t[i]);return n}function US(e){for(var t=[],n=CS(e),i=0;i!==n.length;++i)t[e[n[i]]]=n[i];return t}var FS=new Date(1899,11,30,0,0,0);function IS(e,t){return(e.getTime()-(FS.getTime()+6e4*(e.getTimezoneOffset()-FS.getTimezoneOffset())))/864e5}var RS=new Date,NS=FS.getTime()+6e4*(RS.getTimezoneOffset()-FS.getTimezoneOffset()),MS=RS.getTimezoneOffset();function OS(e){var t=new Date;return t.setTime(24*e*60*60*1e3+NS),t.getTimezoneOffset()!==MS&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-MS)),t}function PS(e){var t=0,n=0,i=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=r.length;++a)if(r[a]){switch(n=1,a>3&&(i=!0),r[a].slice(r[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[a].slice(r[a].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!i)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(r[a],10)}return t}var LS=new Date("2017-02-19T19:06:09.000Z"),WS=isNaN(LS.getFullYear())?new Date("2/19/17"):LS,BS=2017==WS.getFullYear();function jS(e,t){var n=new Date(e);if(BS)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==WS.getFullYear()&&!isNaN(n.getFullYear())){var i=n.getFullYear();return e.indexOf(""+i)>-1||n.setFullYear(n.getFullYear()+100),n}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function zS(e,t){if(Ak&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return EC(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return EC(vk(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return EC(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return EC(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return n[e]||e})}catch(a){}for(var i=[],r=0;r!=e.length;++r)i.push(String.fromCharCode(e[r]));return i.join("")}function HS(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=HS(e[n]));return t}function VS(e,t){for(var n="";n.length<t;)n+=e;return n}function GS(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(i))?(i=i.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(i))?t:t/n):t/n}var $S=["january","february","march","april","may","june","july","august","september","october","november","december"];function qS(e){var t=new Date(e),n=new Date(NaN),i=t.getYear(),r=t.getMonth(),a=t.getDate();if(isNaN(a))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==$S.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return i<0||i>8099?n:(r>0||a>1)&&101!=i?t:e.match(/[^-0-9:,\/\\]/)?n:t}var XS=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,i){if(e||"string"==typeof n)return t.split(n);for(var r=t.split(n),a=[r[0]],s=1;s<r.length;++s)a.push(i),a.push(r[s]);return a}}();function KS(e){return e?e.content&&e.type?zS(e.content,!0):e.data?wk(e.data):e.asNodeBuffer&&Ak?wk(e.asNodeBuffer().toString("binary")):e.asBinary?wk(e.asBinary()):e._data&&e._data.getContent?wk(zS(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function YS(e){if(!e)return null;if(e.data)return bk(e.data);if(e.asNodeBuffer&&Ak)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?bk(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ZS(e,t){for(var n=e.FullPaths||CS(e.files),i=t.toLowerCase().replace(/[\/]/g,"\\"),r=i.replace(/\\/g,"/"),a=0;a<n.length;++a){var s=n[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==s||r==s)return e.files?e.files[n[a]]:e.FileIndex[a]}return null}function JS(e,t){var n=ZS(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function QS(e,t,n){if(!n)return(i=JS(e,t))&&".bin"===i.name.slice(-4)?YS(i):KS(i);var i;if(!t)return null;try{return QS(e,t)}catch(r){return null}}function eC(e,t,n){if(!n)return KS(JS(e,t));if(!t)return null;try{return eC(e,t)}catch(i){return null}}function tC(e){for(var t=e.FullPaths||CS(e.files),n=[],i=0;i<t.length;++i)"/"!=t[i].slice(-1)&&n.push(t[i].replace(/^Root Entry[\/]/,""));return n.sort()}function nC(e,t){switch(t.type){case"base64":return SS.read(e,{type:"base64"});case"binary":return SS.read(e,{type:"binary"});case"buffer":case"array":return SS.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function iC(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var i=e.split("/");0!==i.length;){var r=i.shift();".."===r?n.pop():"."!==r&&n.push(r)}return n.join("/")}var rC='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',aC=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,sC=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,oC=rC.match(sC)?sC:/<[^>]*>/g,cC=/<\w*:/,lC=/<(\/?)\w+:/;function hC(e,t,n){for(var i={},r=0,a=0;r!==e.length&&32!==(a=e.charCodeAt(r))&&10!==a&&13!==a;++r);if(t||(i[0]=e.slice(0,r)),r===e.length)return i;var s=e.match(aC),o=0,c="",l=0,h="",d="",u=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l],a=0;a!=d.length&&61!==d.charCodeAt(a);++a);for(h=d.slice(0,a).trim();32==d.charCodeAt(a+1);)++a;for(u=34==(r=d.charCodeAt(a+1))||39==r?1:0,c=d.slice(a+1+u,d.length-u),o=0;o!=h.length&&58!==h.charCodeAt(o);++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),i[h]=c,i[h.toLowerCase()]=c;else{var f=(5===o&&"xmlns"===h.slice(0,5)?"xmlns":"")+h.slice(o+1);if(i[f]&&"ext"==h.slice(o-3,o))continue;i[f]=c,i[f.toLowerCase()]=c}}return i}function dC(e){return e.replace(lC,"<$1")}var uC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fC=US(uC),pC=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(i){var r=i+"",a=r.indexOf("<![CDATA[");if(-1==a)return r.replace(e,function(e,t){return uC[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var s=r.indexOf("]]>");return n(r.slice(0,a))+r.slice(a+9,s)+n(r.slice(s+3))}}(),gC=/[&<>'"]/g,mC=/[\u0000-\u001f]/g;function bC(e){return(e+"").replace(gC,function(e){return fC[e]}).replace(/\n/g,"<br/>").replace(mC,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var vC=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function yC(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wC(e){for(var t="",n=0,i=0,r=0,a=0,s=0,o=0;n<e.length;)(i=e.charCodeAt(n++))<128?t+=String.fromCharCode(i):(r=e.charCodeAt(n++),i>191&&i<224?(s=(31&i)<<6,s|=63&r,t+=String.fromCharCode(s)):(a=e.charCodeAt(n++),i<240?t+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&a):(o=((7&i)<<18|(63&r)<<12|(63&a)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function xC(e){var t,n,i,r=Sk(2*e.length),a=1,s=0,o=0;for(n=0;n<e.length;n+=a)a=1,(i=e.charCodeAt(n))<128?t=i:i<224?(t=64*(31&i)+(63&e.charCodeAt(n+1)),a=2):i<240?(t=4096*(15&i)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),a=3):(a=4,t=262144*(7&i)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(r[s++]=255&o,r[s++]=o>>>8,o=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function _C(e){return kk(e,"binary").toString("utf8")}var TC="foo bar bazâð£",DC=Ak&&(_C(TC)==wC(TC)&&_C||xC(TC)==wC(TC)&&xC)||wC,EC=Ak?function(e){return kk(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,i=0,r=0;n<e.length;)switch(i=e.charCodeAt(n++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(63&i)));break;case i>=55296&&i<57344:i-=55296,r=e.charCodeAt(n++)-56320+(i<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)))}return t.join("")},AC=function(){var e={};return function(t,n){var i=t+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),kC=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),SC=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),CC=/<\/?(?:vt:)?variant>/g,UC=/<(?:vt:)([^>]*)>([\s\S]*)</;function FC(e,t){var n=hC(e),i=e.match(SC(n.baseType))||[],r=[];if(i.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+i.length+" != "+n.size);return r}return i.forEach(function(e){var t=e.replace(CC,"").match(UC);t&&r.push({v:DC(t[2]),t:t[1]})}),r}var IC=/(^\s|\s$|\n)/;function RC(e,t,n){return"<"+e+(null!=n?function(e){return CS(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}(n):"")+(null!=t?(t.match(IC)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function NC(e){if(Ak&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return DC(Fk(Ik(e)));throw new Error("Bad input format: expected Buffer or string")}var MC=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,OC=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],PC=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,r=e[0][n].length;i<r;i+=10240)t.push.apply(t,e[0][n].slice(i,i+10240));return t},LC=Ak?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:kk(e)})):PC(e)}:PC,WC=function(e,t,n){for(var i=[],r=t;r<n;r+=2)i.push(String.fromCharCode(aU(e,r)));return i.join("").replace(Nk,"")},BC=Ak?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Nk,""):WC(e,t,n)}:WC,jC=function(e,t,n){for(var i=[],r=t;r<t+n;++r)i.push(("0"+e[r].toString(16)).slice(-2));return i.join("")},zC=Ak?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):jC(e,t,n)}:jC,HC=function(e,t,n){for(var i=[],r=t;r<n;r++)i.push(String.fromCharCode(rU(e,r)));return i.join("")},VC=Ak?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):HC(e,t,n)}:HC,GC=function(e,t){var n=oU(e,t);return n>0?VC(e,t+4,t+4+n-1):""},$C=GC,qC=function(e,t){var n=oU(e,t);return n>0?VC(e,t+4,t+4+n-1):""},XC=qC,KC=function(e,t){var n=2*oU(e,t);return n>0?VC(e,t+4,t+4+n-1):""},YC=KC,ZC=function(e,t){var n=oU(e,t);return n>0?BC(e,t+4,t+4+n):""},JC=ZC,QC=function(e,t){var n=oU(e,t);return n>0?VC(e,t+4,t+4+n):""},eU=QC,tU=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),i=((127&e[t+7])<<4)+(e[t+6]>>>4&15),r=15&e[t+6],a=5;a>=0;--a)r=256*r+e[t+a];return 2047==i?0==r?n*(1/0):NaN:(0==i?i=-1022:(i-=1023,r+=Math.pow(2,52)),n*Math.pow(2,i-52)*r)}(e,t)},nU=tU,iU=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};Ak&&($C=function(e,t){if(!Buffer.isBuffer(e))return GC(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},XC=function(e,t){if(!Buffer.isBuffer(e))return qC(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},YC=function(e,t){if(!Buffer.isBuffer(e))return KC(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},JC=function(e,t){if(!Buffer.isBuffer(e))return ZC(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},eU=function(e,t){if(!Buffer.isBuffer(e))return QC(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},nU=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):tU(e,t)},iU=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var rU=function(e,t){return e[t]},aU=function(e,t){return 256*e[t+1]+e[t]},sU=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},oU=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cU=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function hU(e,t){var n,i,r,a,s,o,c="",l=[];switch(t){case"dbcs":if(o=this.l,Ak&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)c+=String.fromCharCode(aU(this,o)),o+=2;e*=2;break;case"utf8":c=VC(this,this.l,this.l+e);break;case"utf16le":e*=2,c=BC(this,this.l,this.l+e);break;case"wstr":return hU.call(this,e,"dbcs");case"lpstr-ansi":c=$C(this,this.l),e=4+oU(this,this.l);break;case"lpstr-cp":c=XC(this,this.l),e=4+oU(this,this.l);break;case"lpwstr":c=YC(this,this.l),e=4+2*oU(this,this.l);break;case"lpp4":e=4+oU(this,this.l),c=JC(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+oU(this,this.l),c=eU(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(r=rU(this,this.l+e++));)l.push(xk(r));c=l.join("");break;case"_wstr":for(e=0,c="";0!==(r=aU(this,this.l+e));)l.push(xk(r)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return r=rU(this,o),this.l=o+1,a=hU.call(this,e-s,r?"dbcs-cont":"sbcs-cont"),l.join("")+a;l.push(xk(aU(this,o))),o+=2}c=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(c="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return r=rU(this,o),this.l=o+1,a=hU.call(this,e-s,r?"dbcs-cont":"sbcs-cont"),l.join("")+a;l.push(xk(rU(this,o))),o+=1}c=l.join("");break;default:switch(e){case 1:return n=rU(this,this.l),this.l++,n;case 2:return n=("i"===t?sU:aU)(this,this.l),this.l+=2,n;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(i=oU(this,this.l),this.l+=4,i):(n=(e>0?cU:lU)(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return i=8==e?nU(this,this.l):nU([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:c=zC(this,this.l,e)}}return this.l+=e,c}var dU=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},uU=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},fU=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function pU(e,t,n){var i=0,r=0;if("dbcs"===n){for(r=0;r!=t.length;++r)fU(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if("sbcs"===n){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=255&t.charCodeAt(r);i=t.length}else{if("hex"===n){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===n){var a=Math.min(this.l+e,this.length);for(r=0;r<Math.min(t.length,e);++r){var s=t.charCodeAt(r);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:i=1,this[this.l]=255&t;break;case 2:i=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:i=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:i=4,dU(this,t,this.l);break;case 8:if(i=8,"f"===n){!function(e,t,n){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,a=0,s=i?-t:t;isFinite(s)?0==s?r=a=0:(r=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[n+o]=255&a;e[n+6]=(15&r)<<4|15&a,e[n+7]=r>>4|i}(this,t,this.l);break}case 16:break;case-4:i=4,uU(this,t,this.l)}}return this.l+=i,this}function gU(e,t){var n=zC(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function mU(e,t){e.l=t,e.read_shift=hU,e.chk=gU,e.write_shift=pU}function bU(e,t){e.l+=t}function vU(e){var t=Sk(e);return mU(t,0),t}function yU(e,t,n){if(e){var i,r,a;mU(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var l=aM[o]||aM[65535];for(a=127&(i=e.read_shift(1)),r=1;r<4&&128&i;++r)a+=(127&(i=e.read_shift(1)))<<7*r;c=e.l+a;var h=l.f&&l.f(e,a,n);if(e.l=c,t(h,l,o))return}}}function wU(){var e=[],t=Ak?256:2048,n=function(e){var t=vU(e);return mU(t,0),t},i=n(t),r=function(){i&&(i.length>i.l&&((i=i.slice(0,i.l)).l=i.length),i.length>0&&e.push(i),i=null)},a=function(e){return i&&e<i.length-i.l?i:(r(),i=n(Math.max(e+1,t)))};return{next:a,push:function(e){r(),null==(i=e).l&&(i.l=i.length),a(t)},end:function(){return r(),Rk(e)},_bufs:e}}function xU(e,t,n){var i=HS(e);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!n||n.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function _U(e,t,n){var i=HS(e);return i.s=xU(i.s,t.s,n),i.e=xU(i.e,t.s,n),i}function TU(e,t){if(e.cRel&&e.c<0)for(e=HS(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=HS(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=UU(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),n}function DU(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?TU(e.s,t.biff)+":"+TU(e.e,t.biff):(e.s.rRel?"":"$")+AU(e.s.r)+":"+(e.e.rRel?"":"$")+AU(e.e.r):(e.s.cRel?"":"$")+SU(e.s.c)+":"+(e.e.cRel?"":"$")+SU(e.e.c)}function EU(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function AU(e){return""+(e+1)}function kU(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,i=0;i!==t.length;++i)n=26*n+t.charCodeAt(i)-64;return n-1}function SU(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function CU(e){for(var t=0,n=0,i=0;i<e.length;++i){var r=e.charCodeAt(i);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(n=26*n+(r-64))}return{c:n-1,r:t-1}}function UU(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function FU(e){var t=e.indexOf(":");return-1==t?{s:CU(e),e:CU(e)}:{s:CU(e.slice(0,t)),e:CU(e.slice(t+1))}}function IU(e,t){return void 0===t||"number"==typeof t?IU(e.s,e.e):("string"!=typeof e&&(e=UU(e)),"string"!=typeof t&&(t=UU(t)),e==t?e:e+":"+t)}function RU(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,i=0,r=0,a=e.length;for(n=0;i<a&&!((r=e.charCodeAt(i)-64)<1||r>26);++i)n=26*n+r;for(t.s.c=--n,n=0;i<a&&!((r=e.charCodeAt(i)-48)<0||r>9);++i)n=10*n+r;if(t.s.r=--n,i===a||10!=r)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,n=0;i!=a&&!((r=e.charCodeAt(i)-64)<1||r>26);++i)n=26*n+r;for(t.e.c=--n,n=0;i!=a&&!((r=e.charCodeAt(i)-48)<0||r>9);++i)n=10*n+r;return t.e.r=--n,t}function NU(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?oF[e.v]||e.v:function(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=_S(e.z,n?IS(t):t)}catch(i){}try{return e.w=_S((e.XF||{}).numFmtId||(n?14:0),n?IS(t):t)}catch(i){return""+t}}(e,null==t?e.v:t))}function MU(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",i={};return i[n]=e,{SheetNames:[n],Sheets:i}}function OU(e,t,n){var i=n||{},r=e?Array.isArray(e):i.dense,a=e||(r?[]:{}),s=0,o=0;if(a&&null!=i.origin){if("number"==typeof i.origin)s=i.origin;else{var c="string"==typeof i.origin?CU(i.origin):i.origin;s=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=RU(a["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),-1==s&&(l.e.r=s=h.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[d].length;++u)if(void 0!==t[d][u]){var f={v:t[d][u]},p=s+d,g=o+u;if(l.s.r>p&&(l.s.r=p),l.s.c>g&&(l.s.c=g),l.e.r<p&&(l.e.r=p),l.e.c<g&&(l.e.c=g),!t[d][u]||"object"!=typeof t[d][u]||Array.isArray(t[d][u])||t[d][u]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][u][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(i.nullError)f.t="e",f.v=0;else{if(!i.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=i.dateNF||Gk[14],i.cellDates?(f.t="d",f.w=_S(f.z,IS(f.v))):(f.t="n",f.v=IS(f.v),f.w=_S(f.z,f.v))):f.t="s";else f=t[d][u];if(r)a[p]||(a[p]=[]),a[p][g]&&a[p][g].z&&(f.z=a[p][g].z),a[p][g]=f;else{var m=UU({c:g,r:p});a[m]&&a[m].z&&(f.z=a[m].z),a[m]=f}}}return l.s.c<1e7&&(a["!ref"]=IU(l)),a}function PU(e,t){return OU(null,e,t)}function LU(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function WU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function BU(e,t){var n=e.l,i=e.read_shift(1),r=LU(e),a=[],s={t:r,h:r};if(1&i){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(WU(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var jU=BU;function zU(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function HU(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var VU=LU;function GU(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var $U=LU,qU=GU;function XU(e){var t=e.slice(e.l,e.l+4),n=1&t[0],i=2&t[0];e.l+=4;var r=0===i?nU([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):cU(t,0)>>2;return n?r/100:r}function KU(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var YU=KU;function ZU(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function JU(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var QU=80,eF=[QU,81],tF={1:{n:"CodePage",t:2},2:{n:"Category",t:QU},3:{n:"PresentationFormat",t:QU},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:QU},15:{n:"Company",t:QU},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:QU},27:{n:"ContentStatus",t:QU},28:{n:"Language",t:QU},29:{n:"Version",t:QU},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},nF={1:{n:"CodePage",t:2},2:{n:"Title",t:QU},3:{n:"Subject",t:QU},4:{n:"Author",t:QU},5:{n:"Keywords",t:QU},6:{n:"Comments",t:QU},7:{n:"Template",t:QU},8:{n:"LastAuthor",t:QU},9:{n:"RevNumber",t:QU},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:QU},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},iF={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function aF(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var sF=HS(aF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),oF={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hF={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dF(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function uF(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var i={};return(e.match(oC)||[]).forEach(function(e){var r=hC(e);if("<Relationship"===r[0]){var a={};a.Type=r.Type,a.Target=r.Target,a.Id=r.Id,r.TargetMode&&(a.TargetMode=r.TargetMode);var s="External"===r.TargetMode?r.Target:iC(r.Target,t);n[s]=a,i[r.Id]=a}}),n["!id"]=i,n}var fF=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pF=function(){for(var e=new Array(fF.length),t=0;t<fF.length;++t){var n=fF[t],i="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e}();function gF(e){var t={};e=DC(e);for(var n=0;n<fF.length;++n){var i=fF[n],r=e.match(pF[n]);null!=r&&r.length>0&&(t[i[1]]=pC(r[1])),"date"===i[2]&&t[i[1]]&&(t[i[1]]=jS(t[i[1]]))}return t}var mF=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function bF(e,t,n,i){var r=[];if("string"==typeof e)r=FC(e,i);else for(var a=0;a<e.length;++a)r=r.concat(e[a].map(function(e){return{v:e}}));var s="string"==typeof t?FC(t,i).map(function(e){return e.v}):t,o=0,c=0;if(s.length>0)for(var l=0;l!==r.length;l+=2){switch(c=+r[l+1].v,r[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=c,n.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=c,n.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":n.Chartsheets=c,n.ChartNames=s.slice(o,o+c)}o+=c}}var vF,yF=/<[^>]+>[^<]*/g,wF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xF(e,t,n){vF||(vF=US(wF)),e[t=vF[t]||t]=n}function _F(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function TF(e,t,n){var i=e.l,r=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-i&3;)++e.l;return r}function DF(e,t,n){return e.read_shift(0,"lpwstr")}function EF(e,t,n){return 31===t?DF(e):TF(e,0,n)}function AF(e,t,n){return EF(e,t,!1===n?0:4)}function kF(e){var t=e.l,n=UF(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,UF(e,3)]}function SF(e,t){for(var n=e.read_shift(4),i={},r=0;r!=n;++r){var a=e.read_shift(4),s=e.read_shift(4);i[a]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(Nk,"").replace(Mk,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),i}function CF(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function UF(e,t,n){var i,r=e.read_shift(2),a=n||{};if(e.l+=2,12!==t&&r!==t&&-1===eF.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&r)))throw new Error("Expected type "+t+" saw "+r);switch(12===t?r:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return TF(e,0,4).replace(Nk,"");case 31:return DF(e);case 64:return _F(e);case 65:return CF(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return AF(e,r,!a.raw).replace(Nk,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return EF(e,t,0)}(e,r).replace(Nk,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],i=0;i<t/2;++i)n.push(kF(e));return n}(e);case 4126:case 4127:return 4127==r?function(e){for(var t=e.read_shift(4),n=[],i=0;i!=t;++i){var r=e.l;n[i]=e.read_shift(0,"lpwstr").replace(Nk,""),e.l-r&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],i=0;i!=t;++i)n[i]=e.read_shift(0,"lpstr-cp").replace(Nk,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function FF(e,t){var n=e.l,i=e.read_shift(4),r=e.read_shift(4),a=[],s=0,o=0,c=-1,l={};for(s=0;s!=r;++s){var h=e.read_shift(4),d=e.read_shift(4);a[s]=[h,d+n]}a.sort(function(e,t){return e[1]-t[1]});var u={};for(s=0;s!=r;++s){if(e.l!==a[s][1]){var f=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=a[s][1]&&(e.l=a[s][1],f=!1)}if((!t||0==s)&&e.l<=a[s][1]&&(f=!1,e.l=a[s][1]),f)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[a[s][0]];if(u[p.n]=UF(e,p.t,{raw:!0}),"version"===p.p&&(u[p.n]=String(u[p.n]>>16)+"."+("0000"+String(65535&u[p.n])).slice(-4)),"CodePage"==p.n)switch(u[p.n]){case 0:u[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gk(o=u[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[p.n])}}else if(1===a[s][0]){if(o=u.CodePage=UF(e,2),gk(o),-1!==c){var g=e.l;e.l=a[c][1],l=SF(e,o),e.l=g}}else if(0===a[s][0]){if(0===o){c=s,e.l=a[s+1][1];continue}l=SF(e,o)}else{var m,b=l[a[s][0]];switch(e[e.l]){case 65:e.l+=4,m=CF(e);break;case 30:case 31:e.l+=4,m=AF(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=NF(e,4);break;case 64:e.l+=4,m=jS(_F(e));break;default:throw new Error("unparsed value: "+e[e.l])}u[b]=m}}return e.l=n+i,u}function IF(e,t,n){var i=e.content;if(!i)return{};mU(i,0);var r,a,s,o,c=0;i.chk("feff","Byte Order: "),i.read_shift(2);var l=i.read_shift(4),h=i.read_shift(16);if(h!==SS.utils.consts.HEADER_CLSID&&h!==n)throw new Error("Bad PropertySet CLSID "+h);if(1!==(r=i.read_shift(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(a=i.read_shift(16),o=i.read_shift(4),1===r&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);2===r&&(s=i.read_shift(16),c=i.read_shift(4));var d,u=FF(i,t),f={SystemIdentifier:l};for(var p in u)f[p]=u[p];if(f.FMTID=a,1===r)return f;if(c-i.l==2&&(i.l+=2),i.l!==c)throw new Error("Length mismatch 2: "+i.l+" !== "+c);try{d=FF(i,null)}catch(g){}for(p in d)f[p]=d[p];return f.FMTID=[a,s],f}function RF(e,t){return e.read_shift(t),null}function NF(e,t){return 1===e.read_shift(t)}function MF(e){return e.read_shift(2,"u")}function OF(e,t){return function(e,t,n){for(var i=[],r=e.l+t;e.l<r;)i.push(n(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return i}(e,t,MF)}function PF(e,t,n){var i=e.read_shift(n&&n.biff>=12?2:1),r="sbcs-cont";return n&&n.biff,n&&8!=n.biff?12==n.biff&&(r="wstr"):e.read_shift(1)&&(r="dbcs-cont"),n.biff>=2&&n.biff<=5&&(r="cpstr"),i?e.read_shift(i,r):""}function LF(e){var t,n=e.read_shift(2),i=e.read_shift(1),r=4&i,a=8&i,s=1+(1&i),o=0,c={};a&&(o=e.read_shift(2)),r&&(t=e.read_shift(4));var l=2==s?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,l);return a&&(e.l+=4*o),r&&(e.l+=t),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function WF(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function BF(e,t,n){var i=e.read_shift(n&&2==n.biff?1:2);return 0===i?(e.l++,""):WF(e,i,n)}function jF(e,t,n){if(n.biff>5)return BF(e,0,n);var i=e.read_shift(1);return 0===i?(e.l++,""):e.read_shift(i,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zF(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Nk,""):""}function HF(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function VF(e,t){var n=HF(e);return n[3]=0,n}function GF(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function $F(e,t,n){var i=n.biff>8?4:2;return[e.read_shift(i),e.read_shift(i,"i"),e.read_shift(i,"i")]}function qF(e){return[e.read_shift(2),XU(e)]}function XF(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function KF(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var YF=KF;function ZF(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[n,t,i]}function JF(e){e.l+=2,e.l+=e.read_shift(2)}var QF={0:JF,4:JF,5:JF,6:JF,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:JF,9:JF,10:JF,11:JF,12:JF,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:JF,15:JF,16:JF,17:JF,18:JF,19:JF,20:JF,21:ZF};function eI(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function tI(e,t,n){var i=0;n&&2==n.biff||(i=e.read_shift(2));var r=e.read_shift(2);return n&&2==n.biff&&(i=1-(r>>15),r&=32767),[{Unsynced:1&i,DyZero:(2&i)>>1,ExAsc:(4&i)>>2,ExDsc:(8&i)>>3},r]}var nI=jF;function iI(e,t,n){var i=e.l+t,r=8!=n.biff&&n.biff?2:4,a=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(2),c=e.read_shift(2);return e.l=i,{s:{r:a,c:o},e:{r:s,c:c}}}function rI(e,t,n){var i=GF(e);2!=n.biff&&9!=t||++e.l;var r=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return i.val=r,i.t=!0===r||!1===r?"b":"e",i}var aI=function(e,t,n){return 0===t?"":jF(e,0,n)};function sI(e,t,n){var i,r=e.read_shift(2),a={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===n.sbcch&&(i=function(e,t,n){e.l+=4,t-=4;var i=e.l+t,r=PF(e,0,n),a=e.read_shift(2);if(a!==(i-=e.l))throw new Error("Malformed AddinUdf: padding = "+i+" != "+a);return e.l+=a,r}(e,t-2,n)),a.body=i||e.read_shift(t-2),"string"==typeof i&&(a.Name=i),a}var oI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cI(e,t,n){var i=e.l+t,r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),c=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),c=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var l=WF(e,s,n);32&r&&(l=oI[l.charCodeAt(0)]);var h=i-e.l;n&&2==n.biff&&--h;var d=i!=e.l&&0!==o&&h>0?function(e,t,n,i){var r,a=e.l+t,s=$R(e,i,n);return a!==e.l&&(r=GR(e,a-e.l,s,n)),[s,r]}(e,h,n,o):[];return{chKey:a,Name:l,itab:c,rgce:d}}function lI(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var i=PF(e,0,n);return 3==i.charCodeAt(0)?i.slice(1):i}(e,0,n);for(var i=[],r=e.l+t,a=e.read_shift(n.biff>8?4:2);0!==a--;)i.push($F(e,n.biff,n));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return i}function hI(e,t,n){var i=YF(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[i,JR(e,t,n)]}var dI={8:function(e,t){var n=e.l+t;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=n,{fmt:i}}};function uI(e,t,n){if(!n.cellStyles)return bU(e,t);var i=n&&n.biff>=12?4:2,r=e.read_shift(i),a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(i),c=e.read_shift(2);2==i&&(e.l+=2);var l={s:r,e:a,w:s,ixfe:o,flags:c};return(n.biff>=5||!n.biff)&&(l.level=c>>8&7),l}var fI=GF,pI=OF,gI=BF,mI=[2,3,48,49,131,139,140,245],bI=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=US({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var i=n||{};i.dateNF||(i.dateNF="yyyymmdd");var r=PU(function(t,n){var i=[],r=Sk(1);switch(n.type){case"base64":r=Uk(Ek(t));break;case"binary":r=Uk(t);break;case"buffer":case"array":r=t}mU(r,0);var a=r.read_shift(1),s=!!(136&a),o=!1,c=!1;switch(a){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var l=0,h=521;2==a&&(l=r.read_shift(2)),r.l+=3,2!=a&&(l=r.read_shift(4)),l>1048576&&(l=1e6),2!=a&&(h=r.read_shift(2));var d=r.read_shift(2),u=n.codepage||1252;2!=a&&(r.l+=16,r.read_shift(1),0!==r[r.l]&&(u=e[r[r.l]]),r.l+=1,r.l+=2),c&&(r.l+=36);for(var f=[],p={},g=Math.min(r.length,2==a?521:h-10-(o?264:0)),m=c?32:11;r.l<g&&13!=r[r.l];)switch((p={}).name=yk.utils.decode(u,r.slice(r.l,r.l+m)).replace(/[\u0000\r\n].*$/g,""),r.l+=m,p.type=String.fromCharCode(r.read_shift(1)),2==a||c||(p.offset=r.read_shift(4)),p.len=r.read_shift(1),2==a&&(p.offset=r.read_shift(2)),p.dec=r.read_shift(1),p.name.length&&f.push(p),2!=a&&(r.l+=c?13:14),p.type){case"B":(!o||8!=p.len)&&n.WTF;break;case"G":case"P":n.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==r[r.l]&&(r.l=h-1),13!==r.read_shift(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=h;var b=0,v=0;for(i[0]=[],v=0;v!=f.length;++v)i[0][v]=f[v].name;for(;l-- >0;)if(42!==r[r.l])for(++r.l,i[++b]=[],v=0,v=0;v!=f.length;++v){var y=r.slice(r.l,r.l+f[v].len);r.l+=f[v].len,mU(y,0);var w=yk.utils.decode(u,y);switch(f[v].type){case"C":w.trim().length&&(i[b][v]=w.replace(/\s+$/,""));break;case"D":8===w.length?i[b][v]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):i[b][v]=w;break;case"F":i[b][v]=parseFloat(w.trim());break;case"+":case"I":i[b][v]=c?2147483648^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":i[b][v]=!0;break;case"N":case"F":i[b][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));i[b][v]="##MEMO##"+(c?parseInt(w.trim(),10):y.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(i[b][v]=+w||0);break;case"@":i[b][v]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":i[b][v]=new Date(864e5*(y.read_shift(4)-2440588)+y.read_shift(4));break;case"Y":i[b][v]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":i[b][v]=-y.read_shift(-8,"f");break;case"B":if(o&&8==f[v].len){i[b][v]=y.read_shift(8,"f");break}case"G":case"P":y.l+=f[v].len;break;case"0":if("_NullFlags"===f[v].name)break;default:throw new Error("DBF Unsupported data type "+f[v].type)}}else r.l+=d;if(2!=a&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return n&&n.sheetRows&&(i=i.slice(0,n.sheetRows)),n.DBF=f,i}(t,i),i);return r["!cols"]=i.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete i.DBF,r}var i={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return MU(n(e,t),t)}catch(i){if(t&&t.WTF)throw i}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var r=n||{};if(+r.codepage>=0&&gk(+r.codepage),"string"==r.type)throw new Error("Cannot write DBF to JS string");var a=wU(),s=zM(e,{header:1,raw:!0,cellDates:!0}),o=s[0],c=s.slice(1),l=e["!cols"]||[],h=0,d=0,u=0,f=1;for(h=0;h<o.length;++h)if(((l[h]||{}).DBF||{}).name)o[h]=l[h].DBF.name,++u;else if(null!=o[h]){if(++u,"number"==typeof o[h]&&(o[h]=o[h].toString(10)),"string"!=typeof o[h])throw new Error("DBF Invalid column name "+o[h]+" |"+typeof o[h]+"|");if(o.indexOf(o[h])!==h)for(d=0;d<1024;++d)if(-1==o.indexOf(o[h]+"_"+d)){o[h]+="_"+d;break}}var p=RU(e["!ref"]),g=[],m=[],b=[];for(h=0;h<=p.e.c-p.s.c;++h){var v="",y="",w=0,x=[];for(d=0;d<c.length;++d)null!=c[d][h]&&x.push(c[d][h]);if(0!=x.length&&null!=o[h]){for(d=0;d<x.length;++d){switch(typeof x[d]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=x[d]instanceof Date?"D":"C"}w=Math.max(w,String(x[d]).length),v=v&&v!=y?"C":y}w>250&&(w=250),"C"==(y=((l[h]||{}).DBF||{}).type)&&l[h].DBF.len>w&&(w=l[h].DBF.len),"B"==v&&"N"==y&&(v="N",b[h]=l[h].DBF.dec,w=l[h].DBF.len),m[h]="C"==v||"N"==y?w:i[v]||0,f+=m[h],g[h]=v}else g[h]="?"}var _=a.next(32);for(_.write_shift(4,318902576),_.write_shift(4,c.length),_.write_shift(2,296+32*u),_.write_shift(2,f),h=0;h<4;++h)_.write_shift(4,0);for(_.write_shift(4,(+t[dk]||3)<<8),h=0,d=0;h<o.length;++h)if(null!=o[h]){var T=a.next(32),D=(o[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,D,"sbcs"),T.write_shift(1,"?"==g[h]?"C":g[h],"sbcs"),T.write_shift(4,d),T.write_shift(1,m[h]||i[g[h]]||0),T.write_shift(1,b[h]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),d+=m[h]||i[g[h]]||0}var E=a.next(264);for(E.write_shift(4,13),h=0;h<65;++h)E.write_shift(4,0);for(h=0;h<c.length;++h){var A=a.next(f);for(A.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(g[d]){case"L":A.write_shift(1,null==c[h][d]?63:c[h][d]?84:70);break;case"B":A.write_shift(8,c[h][d]||0,"f");break;case"N":var k="0";for("number"==typeof c[h][d]&&(k=c[h][d].toFixed(b[d]||0)),u=0;u<m[d]-k.length;++u)A.write_shift(1,32);A.write_shift(1,k,"sbcs");break;case"D":c[h][d]?(A.write_shift(4,("0000"+c[h][d].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(c[h][d].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+c[h][d].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var S=String(null!=c[h][d]?c[h][d]:"").slice(0,m[d]);for(A.write_shift(1,S,"sbcs"),u=0;u<m[d]-S.length;++u)A.write_shift(1,32)}}return a.next(1).write_shift(1,26),a.end()}}}(),vI=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+CS(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var i=e[n];return"number"==typeof i?_k(i):i},i=function(e,t,n){var i=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==i?e:_k(i)};function r(e,r){var a,s=e.split(/[\n\r]+/),o=-1,c=-1,l=0,h=0,d=[],u=[],f=null,p={},g=[],m=[],b=[],v=0;for(+r.codepage>=0&&gk(+r.codepage);l!==s.length;++l){v=0;var y,w=s[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,n),x=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),_=x[0];if(w.length>0)switch(_){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==x[1].charAt(0)&&u.push(w.slice(3).replace(/;;/g,";"));break;case"C":var T=!1,D=!1,E=!1,A=!1,k=-1,S=-1;for(h=1;h<x.length;++h)switch(x[h].charAt(0)){case"A":case"G":break;case"X":c=parseInt(x[h].slice(1))-1,D=!0;break;case"Y":for(o=parseInt(x[h].slice(1))-1,D||(c=0),a=d.length;a<=o;++a)d[a]=[];break;case"K":'"'===(y=x[h].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(GS(y))?isNaN(qS(y).getDate())||(y=jS(y)):(y=GS(y),null!==f&&yS(f)&&(y=OS(y))),T=!0;break;case"E":A=!0;var C=wR(x[h].slice(1),{r:o,c:c});d[o][c]=[d[o][c],C];break;case"S":E=!0,d[o][c]=[d[o][c],"S5S"];break;case"R":k=parseInt(x[h].slice(1))-1;break;case"C":S=parseInt(x[h].slice(1))-1;break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+w)}if(T&&(d[o][c]&&2==d[o][c].length?d[o][c][0]=y:d[o][c]=y,f=null),E){if(A)throw new Error("SYLK shared formula cannot have own formula");var U=k>-1&&d[k][S];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");d[o][c][1]=TR(U[1],{r:o-k,c:c-S})}break;case"F":var F=0;for(h=1;h<x.length;++h)switch(x[h].charAt(0)){case"X":c=parseInt(x[h].slice(1))-1,++F;break;case"Y":for(o=parseInt(x[h].slice(1))-1,a=d.length;a<=o;++a)d[a]=[];break;case"M":v=parseInt(x[h].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=u[parseInt(x[h].slice(1))];break;case"W":for(b=x[h].slice(1).split(" "),a=parseInt(b[0],10);a<=parseInt(b[1],10);++a)v=parseInt(b[2],10),m[a-1]=0===v?{hidden:!0}:{wch:v},ZI(m[a-1]);break;case"C":m[c=parseInt(x[h].slice(1))-1]||(m[c]={});break;case"R":g[o=parseInt(x[h].slice(1))-1]||(g[o]={}),v>0?(g[o].hpt=v,g[o].hpx=eR(v)):0===v&&(g[o].hidden=!0);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+w)}F<1&&(f=null);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+w)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),r&&r.sheetRows&&(d=d.slice(0,r.sheetRows)),[d,p]}function a(e,t){var n=function(e,t){switch(t.type){case"base64":return r(Ek(e),t);case"binary":return r(e,t);case"buffer":return r(Ak&&Buffer.isBuffer(e)?e.toString("binary"):Fk(e),t);case"array":return r(zS(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),i=n[0],a=n[1],s=PU(i,t);return CS(a).forEach(function(e){s[e]=a[e]}),s}function s(e,t,n,i){var r="C;Y"+(n+1)+";X"+(i+1)+";K";switch(e.t){case"n":r+=e.v||0,e.f&&!e.F&&(r+=";E"+_R(e.f,{r:n,c:i}));break;case"b":r+=e.v?"TRUE":"FALSE";break;case"e":r+=e.w||e.v;break;case"d":r+='"'+(e.w||e.v)+'"';break;case"s":r+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return r}return e["|"]=254,{to_workbook:function(e,t){return MU(a(e,t),t)},to_sheet:a,from_sheet:function(e,t){var n,i,r=["ID;PWXL;N;E"],a=[],o=RU(e["!ref"]),c=Array.isArray(e),l="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),e["!cols"]&&(i=r,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=$I(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=qI(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&i.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var i="F;";t.hidden?i+="M0;":t.hpt?i+="M"+20*t.hpt+";":t.hpx&&(i+="M"+20*QI(t.hpx)+";"),i.length>2&&e.push(i+"R"+(n+1))})}(r,e["!rows"]),r.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var h=o.s.r;h<=o.e.r;++h)for(var d=o.s.c;d<=o.e.c;++d){var u=UU({r:h,c:d});(n=c?(e[h]||[])[d]:e[u])&&(null!=n.v||n.f&&!n.F)&&a.push(s(n,0,h,d))}return r.join(l)+l+a.join(l)+l+"E"+l}}}(),yI=function(){function e(e,t){for(var n=e.split("\n"),i=-1,r=-1,a=0,s=[];a!==n.length;++a)if("BOT"!==n[a].trim()){if(!(i<0)){for(var o=n[a].trim().split(","),c=o[0],l=o[1],h=n[++a]||"";1&(h.match(/["]/g)||[]).length&&a<n.length-1;)h+="\n"+n[++a];switch(h=h.trim(),+c){case-1:if("BOT"===h){s[++i]=[],r=0;continue}if("EOD"!==h)throw new Error("Unrecognized DIF special command "+h);break;case 0:"TRUE"===h?s[i][r]=!0:"FALSE"===h?s[i][r]=!1:isNaN(GS(l))?isNaN(qS(l).getDate())?s[i][r]=l:s[i][r]=jS(l):s[i][r]=GS(l),++r;break;case 1:(h=(h=h.slice(1,h.length-1)).replace(/""/g,'"'))&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),s[i][r++]=""!==h?h:null}if("EOD"===h)break}}else s[++i]=[],r=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return PU(function(t,n){switch(n.type){case"base64":return e(Ek(t),n);case"binary":return e(t,n);case"buffer":return e(Ak&&Buffer.isBuffer(t)?t.toString("binary"):Fk(t),n);case"array":return e(zS(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return MU(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,i,r){e.push(t),e.push(n+","+i),e.push('"'+r.replace(/"/g,'""')+'"')},t=function(e,t,n,i){e.push(t+","+n),e.push(1==t?'"'+i.replace(/"/g,'""')+'"':i)};return function(n){var i,r=[],a=RU(n["!ref"]),s=Array.isArray(n);e(r,"TABLE",0,1,"sheetjs"),e(r,"VECTORS",0,a.e.r-a.s.r+1,""),e(r,"TUPLES",0,a.e.c-a.s.c+1,""),e(r,"DATA",0,0,"");for(var o=a.s.r;o<=a.e.r;++o){t(r,-1,0,"BOT");for(var c=a.s.c;c<=a.e.c;++c){var l=UU({r:o,c:c});if(i=s?(n[o]||[])[c]:n[l])switch(i.t){case"n":var h=i.w;h||null==i.v||(h=i.v),null==h?i.f&&!i.F?t(r,1,0,"="+i.f):t(r,1,0,""):t(r,0,h,"V");break;case"b":t(r,0,i.v?1:0,i.v?"TRUE":"FALSE");break;case"s":t(r,1,0,isNaN(i.v)?i.v:'="'+i.v+'"');break;case"d":i.w||(i.w=_S(i.z||Gk[14],IS(jS(i.v)))),t(r,0,i.w,"V");break;default:t(r,1,0,"")}else t(r,1,0,"")}}return t(r,-1,0,"EOD"),r.join("\r\n")}}()}}(),wI=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return PU(function(t,n){for(var i=t.split("\n"),r=-1,a=-1,s=0,o=[];s!==i.length;++s){var c=i[s].trim().split(":");if("cell"===c[0]){var l=CU(c[1]);if(o.length<=l.r)for(r=o.length;r<=l.r;++r)o[r]||(o[r]=[]);switch(r=l.r,a=l.c,c[2]){case"t":o[r][a]=e(c[3]);break;case"v":o[r][a]=+c[3];break;case"vtf":var h=c[c.length-1];case"vtc":"nl"===c[3]?o[r][a]=!!+c[4]:o[r][a]=+c[4],"vtf"==c[2]&&(o[r][a]=[o[r][a],h])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,i=[],r=[],a="",s=FU(e["!ref"]),o=Array.isArray(e),c=s.s.r;c<=s.e.r;++c)for(var l=s.s.c;l<=s.e.c;++l)if(a=UU({r:c,c:l}),(n=o?(e[c]||[])[l]:e[a])&&null!=n.v&&"z"!==n.t){switch(r=["cell",a,"t"],n.t){case"s":case"str":r.push(t(n.v));break;case"n":n.f?(r[2]="vtf",r[3]="n",r[4]=n.v,r[5]=t(n.f)):(r[2]="v",r[3]=n.v);break;case"b":r[2]="vt"+(n.f?"f":"c"),r[3]="nl",r[4]=n.v?"1":"0",r[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var h=IS(jS(n.v));r[2]="vtc",r[3]="nd",r[4]=""+h,r[5]=n.w||_S(n.z||Gk[14],h);break;case"e":continue}i.push(r.join(":"))}return i.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),i.push("valueformat:1:text-wiki"),i.join("\n")}return{to_workbook:function(e,t){return MU(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[i,r,a,r,o(e),s].join("\n")}}}(),xI=function(){function e(e,t,n,i,r){r.raw?t[n][i]=e:""===e||("TRUE"===e?t[n][i]=!0:"FALSE"===e?t[n][i]=!1:isNaN(GS(e))?isNaN(qS(e).getDate())?t[n][i]=e:t[n][i]=jS(e):t[n][i]=GS(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(e){for(var i={},r=!1,a=0,s=0;a<e.length;++a)34==(s=e.charCodeAt(a))?r=!r:!r&&s in t&&(i[s]=(i[s]||0)+1);for(a in s=[],i)Object.prototype.hasOwnProperty.call(i,a)&&s.push([i[a],a]);if(!s.length)for(a in i=n)Object.prototype.hasOwnProperty.call(i,a)&&s.push([i[a],a]);return s.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[s.pop()[1]]||44}function r(e,t){var n=t||{},r="",a=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(r=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(r=e.charAt(4),e=e.slice(6)):r=i(e.slice(0,1024)):r=n&&n.FS?n.FS:i(e.slice(0,1024));var o=0,c=0,l=0,h=0,d=0,u=r.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m,b,v=null!=n.dateNF?(b=(b="number"==typeof(m=n.dateNF)?Gk[m]:m).replace(AS,"(\\d+)"),new RegExp("^"+b+"$")):null;function y(){var t=e.slice(h,d),i={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)i.t="z";else if(n.raw)i.t="s",i.v=t;else if(0===t.trim().length)i.t="s",i.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(i.t="s",i.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(i.t="n",i.f=t.slice(1)):(i.t="s",i.v=t);else if("TRUE"==t)i.t="b",i.v=!0;else if("FALSE"==t)i.t="b",i.v=!1;else if(isNaN(l=GS(t)))if(!isNaN(qS(t).getDate())||v&&t.match(v)){i.z=n.dateNF||Gk[14];var r=0;v&&t.match(v)&&(t=function(e,t,n){var i=-1,r=-1,a=-1,s=-1,o=-1,c=-1;(t.match(AS)||[]).forEach(function(e,t){var l=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":i=l;break;case"d":a=l;break;case"h":s=l;break;case"s":c=l;break;case"m":s>=0?o=l:r=l}}),c>=0&&-1==o&&r>=0&&(o=r,r=-1);var l=(""+(i>=0?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==s&&-1==o&&-1==c?l:-1==i&&-1==r&&-1==a?h:l+"T"+h}(0,n.dateNF,t.match(v)||[]),r=1),n.cellDates?(i.t="d",i.v=jS(t,r)):(i.t="n",i.v=IS(jS(t,r))),!1!==n.cellText&&(i.w=_S(i.z,i.v instanceof Date?IS(i.v):i.v)),n.cellNF||delete i.z}else i.t="s",i.v=t;else i.t="n",!1!==n.cellText&&(i.w=t),i.v=l;if("z"==i.t||(n.dense?(a[o]||(a[o]=[]),a[o][c]=i):a[UU({c:c,r:o})]=i),h=d+1,g=e.charCodeAt(h),s.e.c<c&&(s.e.c=c),s.e.r<o&&(s.e.r=o),p==u)++c;else if(c=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===g&&(f=!f);break;case u:case 10:case 13:if(!f&&y())break e}return d-h>0&&y(),a["!ref"]=IU(s),a}function a(t,n){var i="",a="string"==n.type?[0,0,0,0]:PM(t,n);switch(n.type){case"base64":i=Ek(t);break;case"binary":case"string":i=t;break;case"buffer":65001==n.codepage?i=t.toString("utf8"):(n.codepage,i=Ak&&Buffer.isBuffer(t)?t.toString("binary"):Fk(t));break;case"array":i=zS(t);break;default:throw new Error("Unrecognized type "+n.type)}return 239==a[0]&&187==a[1]&&191==a[2]?i=DC(i.slice(3)):"string"!=n.type&&"buffer"!=n.type&&65001==n.codepage?i=DC(i):n.type,"socialcalc:version:"==i.slice(0,19)?wI.to_sheet("string"==n.type?i:DC(i),n):function(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?r(t,n):PU(function(t,n){var i=n||{},r=[];if(!t||0===t.length)return r;for(var a=t.split(/[\r\n]/),s=a.length-1;s>=0&&0===a[s].length;)--s;for(var o=10,c=0,l=0;l<=s;++l)-1==(c=a[l].indexOf(" "))?c=a[l].length:c++,o=Math.max(o,c);for(l=0;l<=s;++l){r[l]=[];var h=0;for(e(a[l].slice(0,o).trim(),r,l,h,i),h=1;h<=(a[l].length-o)/10+1;++h)e(a[l].slice(o+10*(h-1),o+10*h).trim(),r,l,h,i)}return i.sheetRows&&(r=r.slice(0,i.sheetRows)),r}(t,n),n):r(t,n)}(i,n)}return{to_workbook:function(e,t){return MU(a(e,t),t)},to_sheet:a,from_sheet:function(e){for(var t,n=[],i=RU(e["!ref"]),r=Array.isArray(e),a=i.s.r;a<=i.e.r;++a){for(var s=[],o=i.s.c;o<=i.e.c;++o){var c=UU({r:a,c:o});if((t=r?(e[a]||[])[o]:e[c])&&null!=t.v){for(var l=(t.w||(NU(t),t.w)||"").slice(0,10);l.length<10;)l+=" ";s.push(l+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}(),_I=function(){function e(e,t,n){if(e){mU(e,e.l||0);for(var i=n.Enum||b;e.l<e.length;){var r=e.read_shift(2),a=i[r]||i[65535],s=e.read_shift(2),o=e.l+s,c=a.f&&a.f(e,s,n);if(e.l=o,t(c,a,r))return}}}function t(t,n){if(!t)return t;var i=n||{},r=i.dense?[]:{},a="Sheet1",s="",o=0,c={},l=[],h=[],d={s:{r:0,c:0},e:{r:0,c:0}},u=i.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])i.Enum=b,e(t,function(e,t,n){switch(n){case 0:i.vers=e,e>=4096&&(i.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:i.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=i.dateNF||Gk[14],i.cellDates&&(e[1].t="d",e[1].v=OS(e[1].v))),i.qpro&&e[3]>o&&(r["!ref"]=IU(d),c[a]=r,l.push(a),r=i.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a=s||"Sheet"+(o+1),s="");var h=i.dense?(r[e[0].r]||[])[e[0].c]:r[UU(e[0])];if(h){h.t=e[1].t,h.v=e[1].v,null!=e[1].z&&(h.z=e[1].z),null!=e[1].f&&(h.f=e[1].f);break}i.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[UU(e[0])]=e[1]}},i);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);i.Enum=v,14==t[2]&&(i.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:a=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(r["!ref"]=IU(d),c[a]=r,l.push(a),r=i.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],a="Sheet"+(o+1)),u>0&&e[0].r>=u)break;i.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[UU(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(h[e[14e3][0]]=e[14e3][1]);break;case 1537:h[e[0]]=e[1],e[0]==o&&(a=e[1])}},i)}if(r["!ref"]=IU(d),c[s||a]=r,l.push(s||a),!h.length)return{SheetNames:l,Sheets:c};for(var f={},p=[],g=0;g<h.length;++g)c[l[g]]?(p.push(h[g]||l[g]),f[h[g]]=c[h[g]]||c[l[g]]):(p.push(h[g]),f[h[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var i=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(i[0].c=e.read_shift(1),i[3]=e.read_shift(1),i[0].r=e.read_shift(2),e.l+=2):(i[2]=e.read_shift(1),i[0].c=e.read_shift(2),i[0].r=e.read_shift(2)),i}function i(e,t,i){var r=e.l+t,a=n(e,0,i);if(a[1].t="s",20768==i.vers){e.l++;var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return i.qpro&&e.l++,a[1].v=e.read_shift(r-e.l,"cstr"),a}function r(e,t,n){var i=vU(7+n.length);i.write_shift(1,255),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(1,39);for(var r=0;r<i.length;++r){var a=n.charCodeAt(r);i.write_shift(1,a>=128?95:a)}return i.write_shift(1,0),i}function a(e,t,n){var i=vU(7);return i.write_shift(1,255),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,n,"i"),i}function s(e,t,n){var i=vU(13);return i.write_shift(1,255),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(8,n,"f"),i}function o(e,t,n){var i=32768&t;return t=(i?e:0)+((t&=-32769)>=8192?t-16384:t),(i?"":"$")+(n?SU(t):AU(t))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},l=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function h(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,i){var r=vU(6+i.length);r.write_shift(2,e),r.write_shift(1,n),r.write_shift(1,t),r.write_shift(1,39);for(var a=0;a<i.length;++a){var s=i.charCodeAt(a);r.write_shift(1,s>=128?95:s)}return r.write_shift(1,0),r}function u(e,t){var n=h(e),i=e.read_shift(4),r=e.read_shift(4),a=e.read_shift(2);if(65535==a)return 0===i&&3221225472===r?(n[1].t="e",n[1].v=15):0===i&&3489660928===r?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&a;return a=(32767&a)-16446,n[1].v=(1-2*s)*(r*Math.pow(2,a+32)+i*Math.pow(2,a)),n}function f(e,t,n,i){var r=vU(14);if(r.write_shift(2,e),r.write_shift(1,n),r.write_shift(1,t),0==i)return r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,65535),r;var a,s=0,o=0,c=0;return i<0&&(s=1,i=-i),o=0|Math.log2(i),2147483648&(c=(i/=Math.pow(2,o-31))>>>0)||(++o,c=(i/=2)>>>0),i-=c,c|=2147483648,c>>>=0,a=(i*=Math.pow(2,32))>>>0,r.write_shift(4,a),r.write_shift(4,c),o+=16383+(s?32768:0),r.write_shift(2,o),r}function p(e,t){var n=h(e),i=e.read_shift(8,"f");return n[1].v=i,n}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var n=vU(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var i=0;i<e.length;++i){var r=e.charCodeAt(i);n[n.l++]=r>127?95:r}return n[n.l++]=0,n}var b={0:{n:"BOF",f:MF},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var i={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(i.s.c=e.read_shift(1),e.l++,i.s.r=e.read_shift(2),i.e.c=e.read_shift(1),e.l++,i.e.r=e.read_shift(2),i):(i.s.c=e.read_shift(2),i.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),i.e.c=e.read_shift(2),i.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==i.s.c&&(i.s.c=i.e.c=i.s.r=i.e.r=0),i)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,i){var r=n(e,0,i);return r[1].v=e.read_shift(2,"i"),r}},14:{n:"NUMBER",f:function(e,t,i){var r=n(e,0,i);return r[1].v=e.read_shift(8,"f"),r}},15:{n:"LABEL",f:i},16:{n:"FORMULA",f:function(e,t,i){var r=e.l+t,a=n(e,0,i);if(a[1].v=e.read_shift(8,"f"),i.qpro)e.l=r;else{var s=e.read_shift(2);!function(e,t){mU(e,0);for(var n=[],i=0,r="",a="",s="",h="";e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:a=o(t[0].c,e.read_shift(2),!0),r=o(t[0].r,e.read_shift(2),!1),n.push(a+r);break;case 2:var u=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);a=o(t[0].c,e.read_shift(2),!0),r=o(t[0].r,e.read_shift(2),!1),n.push(u+f+":"+a+r);break;case 3:if(e.l<e.length)return;break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:h=n.pop(),s=n.pop(),n.push(["AND","OR"][d-20]+"("+s+","+h+")");break;default:if(d<32&&l[d])h=n.pop(),s=n.pop(),n.push(s+l[d]+h);else{if(!c[d])return;if(69==(i=c[d][1])&&(i=e[e.l++]),i>n.length)return;var g=n.slice(-i);n.length-=i,n.push(c[d][0]+"("+g.join(",")+")")}}}1==n.length&&(t[1].f=""+n[0])}(e.slice(e.l,e.l+s),a),e.l+=s}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:i},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var i="";i.length<n;)i+=String.fromCharCode(e[e.l++]);return i}},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=h(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:u},24:{n:"NUMBER18",f:function(e,t){var n=h(e);n[1].v=e.read_shift(2);var i=n[1].v>>1;if(1&n[1].v)switch(7&i){case 0:i=5e3*(i>>3);break;case 1:i=500*(i>>3);break;case 2:i=(i>>3)/20;break;case 3:i=(i>>3)/200;break;case 4:i=(i>>3)/2e3;break;case 5:i=(i>>3)/2e4;break;case 6:i=(i>>3)/16;break;case 7:i=(i>>3)/64}return n[1].v=i,n}},25:{n:"FORMULA19",f:function(e,t){var n=u(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},i=e.l+t;e.l<i;){var r=e.read_shift(2);if(14e3==r){for(n[r]=[0,""],n[r][0]=e.read_shift(2);e[e.l];)n[r][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=h(e),i=e.read_shift(4);return n[1].v=i>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var i=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[i,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&gk(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var i,o=wU(),c=RU(e["!ref"]),l=Array.isArray(e),h=[];oM(o,0,((i=vU(2)).write_shift(2,1030),i)),oM(o,6,function(e){var t=vU(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(c));for(var d=Math.min(c.e.r,8191),u=c.s.r;u<=d;++u)for(var f=AU(u),p=c.s.c;p<=c.e.c;++p){u===c.s.r&&(h[p]=SU(p));var g=h[p]+f,m=l?(e[u]||[])[p]:e[g];m&&"z"!=m.t&&("n"==m.t?(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?oM(o,13,a(u,p,m.v)):oM(o,14,s(u,p,m.v)):oM(o,15,r(u,p,NU(m).slice(0,239))))}return oM(o,1),o.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&gk(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var i=wU();oM(i,0,function(e){var t=vU(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,i=0,r=0,a=0;a<e.SheetNames.length;++a){var s=e.SheetNames[a],o=e.Sheets[s];if(o&&o["!ref"]){++r;var c=FU(o["!ref"]);n<c.e.r&&(n=c.e.r),i<c.e.c&&(i=c.e.c)}}return n>8191&&(n=8191),t.write_shift(2,n),t.write_shift(1,r),t.write_shift(1,i),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var r=0,a=0;r<e.SheetNames.length;++r)(e.Sheets[e.SheetNames[r]]||{})["!ref"]&&oM(i,27,m(e.SheetNames[r],a++));var s=0;for(r=0;r<e.SheetNames.length;++r){var o=e.Sheets[e.SheetNames[r]];if(o&&o["!ref"]){for(var c=RU(o["!ref"]),l=Array.isArray(o),h=[],u=Math.min(c.e.r,8191),p=c.s.r;p<=u;++p)for(var g=AU(p),b=c.s.c;b<=c.e.c;++b){p===c.s.r&&(h[b]=SU(b));var v=h[b]+g,y=l?(o[p]||[])[b]:o[v];y&&"z"!=y.t&&("n"==y.t?oM(i,23,f(p,b,s,y.v)):oM(i,22,d(p,b,s,NU(y).slice(0,239))))}++s}}return oM(i,1),i.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Uk(Ek(e)),n);case"binary":return t(Uk(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}(),TI=function(){var e=AC("t"),t=AC("rPr");function n(n){var i=n.match(e);if(!i)return{t:"s",v:""};var r={t:"s",v:pC(i[1])},a=n.match(t);return a&&(r.s=function(e){var t={},n=e.match(oC),i=0,r=!1;if(n)for(;i!=n.length;++i){var a=hC(n[i]);switch(a[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==a.val)break;t.cp=fk[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==a.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==a.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==a[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+a[0])}}return t}(a[1])),r}var i=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(e){return e.replace(i,"").split(r).map(n).filter(function(e){return e.v})}}(),DI=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var i=[];e.u&&i.push("text-decoration: underline;"),e.uval&&i.push("text-underline-style:"+e.uval+";"),e.sz&&i.push("font-size:"+e.sz+"pt;"),e.outline&&i.push("text-effect: outline;"),e.shadow&&i.push("text-shadow: auto;"),t.push('<span style="'+i.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var r=e.valign||"";"superscript"==r||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(t.push("<"+r+">"),n.push("</"+r+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),EI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AI=/<(?:\w+:)?r>/,kI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function SI(e,t){var n=!t||t.cellHTML,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=pC(DC(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=DC(e),n&&(i.h=bC(i.t))):e.match(AI)&&(i.r=DC(e),i.t=pC(DC((e.replace(kI,"").match(EI)||[]).join("").replace(oC,""))),n&&(i.h=DI(TI(i.r)))),i):{t:""}}var CI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UI=/<(?:\w+:)?(?:si|sstItem)>/g,FI=/<\/(?:\w+:)?(?:si|sstItem)>/;function II(e){for(var t=[],n=e.split(""),i=0;i<n.length;++i)t[i]=n[i].charCodeAt(0);return t}function RI(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function NI(e){for(var t=e.read_shift(4),n=e.l+t-4,i={},r=e.read_shift(4),a=[];r-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=a,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return i}function MI(e,t){var n=e.l+t,i={};i.Flags=63&e.read_shift(4),e.l+=4,i.AlgID=e.read_shift(4);var r=!1;switch(i.AlgID){case 26126:case 26127:case 26128:r=36==i.Flags;break;case 26625:r=4==i.Flags;break;case 0:r=16==i.Flags||4==i.Flags||36==i.Flags;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,i}function OI(e,t){var n={},i=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,i),e.l=i,n}function PI(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:MI(e,t),v:OI(e,e.length-e.l)}}function LI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function WI(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),i={};return n.replace(oC,function(e){var n=hC(e);switch(dC(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){i[e]=n[e]});break;case"<dataIntegrity":i.encryptedHmacKey=n.encryptedHmacKey,i.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"<keyEncryptor":i.uri=n.uri;break;case"<encryptedKey":i.encs.push(n);break;default:throw n[0]}}),i}var BI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(r){for(var a,s,o,c=II(r),l=function(e){for(var i=t[e.length-1],r=104,a=e.length-1;a>=0;--a)for(var s=e[a],o=0;7!=o;++o)64&s&&(i^=n[r]),s*=2,--r;return i}(c),h=c.length,d=Sk(16),u=0;16!=u;++u)d[u]=0;for(1&~h||(a=l>>8,d[h]=i(e[0],a),--h,a=255&l,s=c[c.length-1],d[h]=i(s,a));h>0;)a=l>>8,d[--h]=i(c[h],a),a=255&l,d[--h]=i(c[h],a);for(h=15,o=15-c.length;o>0;)a=l>>8,d[h]=i(e[o],a),--o,a=255&l,d[--h]=i(c[h],a),--h,--o;return d}}();function jI(e,t,n,i){var r,a,s,o={key:MF(e),verificationBytes:MF(e)};return n.password&&(o.verifier=function(e){var t,n,i=0,r=II(e),a=r.length+1;for((t=Sk(a))[0]=r.length,n=1;n!=a;++n)t[n]=r[n-1];for(n=a-1;n>=0;--n)i=((16384&i?1:0)|i<<1&32767)^t[n];return 52811^i}(n.password)),i.valid=o.verificationBytes===o.verifier,i.valid&&(i.insitu=(r=n.password,a=0,s=BI(r),function(e){var t=function(e,t,n,i,r){var a,s;for(r||(r=t),i||(i=BI("")),a=0;a!=t.length;++a)s=t[a],s=255&((s^=i[n])>>5|s<<3),r[a]=s,++n;return[r,n,i]}(0,e,a,s);return a=t[1],t[0]})),o}var zI=function(){function e(e,n){switch(n.type){case"base64":return t(Ek(e),n);case"binary":return t(e,n);case"buffer":return t(Ak&&Buffer.isBuffer(e)?e.toString("binary"):Fk(e),n);case"array":return t(zS(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},i=e.match(/\\trowd.*?\\row\b/g);if(!i.length)throw new Error("RTF missing table");var r={s:{c:0,r:0},e:{c:0,r:i.length-1}};return i.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var i,a=/\\\w+\b/g,s=0,o=-1;i=a.exec(e);){if("\\cell"===i[0]){var c=e.slice(s,a.lastIndex-i[0].length);if(" "==c[0]&&(c=c.slice(1)),++o,c.length){var l={v:c,t:"s"};Array.isArray(n)?n[t][o]=l:n[UU({r:t,c:o})]=l}}s=a.lastIndex}o>r.e.c&&(r.e.c=o)}),n["!ref"]=IU(r),n}return{to_workbook:function(t,n){return MU(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],i=RU(e["!ref"]),r=Array.isArray(e),a=i.s.r;a<=i.e.r;++a){n.push("\\trowd\\trautofit1");for(var s=i.s.c;s<=i.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=i.s.c;s<=i.e.c;++s){var o=UU({r:a,c:s});(t=r?(e[a]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(NU(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function HI(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function VI(e,t){if(0===t)return e;var n,i,r=function(e){var t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.max(t,n,i),a=Math.min(t,n,i),s=r-a;if(0===s)return[0,0,t];var o,c=0,l=r+a;switch(o=s/(l>1?2-l:l),r){case t:c=((n-i)/s+6)%6;break;case n:c=(i-t)/s+2;break;case i:c=(t-n)/s+4}return[c/6,o,l/2]}((i=(n=e).slice("#"===n[0]?1:0).slice(0,6),[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)]));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),HI(function(e){var t,n=e[0],i=e[1],r=e[2],a=2*i*(r<.5?r:1-r),s=r-a/2,o=[s,s,s],c=6*n;if(0!==i)switch(0|c){case 0:case 6:t=a*c,o[0]+=a,o[1]+=t;break;case 1:t=a*(2-c),o[0]+=t,o[1]+=a;break;case 2:t=a*(c-2),o[1]+=a,o[2]+=t;break;case 3:t=a*(4-c),o[1]+=t,o[2]+=a;break;case 4:t=a*(c-4),o[2]+=a,o[0]+=t;break;case 5:t=a*(6-c),o[2]+=t,o[0]+=a}for(var l=0;3!=l;++l)o[l]=Math.round(255*o[l]);return o}(r))}var GI=6;function $I(e){return Math.floor((e+Math.round(128/GI)/256)*GI)}function qI(e){return Math.floor((e-5)/GI*100+.5)/100}function XI(e){return Math.round((e*GI+5)/GI*256)/256}function KI(e){return XI(qI($I(e)))}function YI(e){var t=Math.abs(e-KI(e)),n=GI;if(t>.005)for(GI=1;GI<15;++GI)Math.abs(e-KI(e))<=t&&(t=Math.abs(e-KI(e)),n=GI);GI=n}function ZI(e){e.width?(e.wpx=$I(e.width),e.wch=qI(e.wpx),e.MDW=GI):e.wpx?(e.wch=qI(e.wpx),e.width=XI(e.wch),e.MDW=GI):"number"==typeof e.wch&&(e.width=XI(e.wch),e.wpx=$I(e.width),e.MDW=GI),e.customWidth&&delete e.customWidth}var JI=96;function QI(e){return 96*e/JI}function eR(e){return e*JI/96}var tR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},nR=["numFmtId","fillId","fontId","borderId","xfId"],iR=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],rR=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,r=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,s,o){var c,l={};return a?((c=(a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var i=CS(Gk),r=0;r<i.length;++r)t.NumberFmt[i[r]]=Gk[i[r]];var a=e[0].match(oC);if(a)for(r=0;r<a.length;++r){var s=hC(a[r]);switch(dC(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=pC(DC(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&null!=t.NumberFmt[c];--c);t.NumberFmt[c]=o}TS(o,c)}break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(c,l,o),(c=a.match(i))&&function(e,t,n,i){t.Fonts=[];var r={},a=!1;(e[0].match(oC)||[]).forEach(function(e){var s=hC(e);switch(dC(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(r),r={};break;case"<name":s.val&&(r.name=DC(s.val));break;case"<b":r.bold=s.val?yC(s.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=s.val?yC(s.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(s.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=s.val?yC(s.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=s.val?yC(s.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=s.val?yC(s.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=s.val?yC(s.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=s.val?yC(s.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":s.val&&(r.sz=+s.val);break;case"<vertAlign":s.val&&(r.vertAlign=s.val);break;case"<family":s.val&&(r.family=parseInt(s.val,10));break;case"<scheme":s.val&&(r.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=fk[parseInt(s.val,10)];break;case"<color":if(r.color||(r.color={}),s.auto&&(r.color.auto=yC(s.auto)),s.rgb)r.color.rgb=s.rgb.slice(-6);else if(s.indexed){r.color.index=parseInt(s.indexed,10);var o=sF[r.color.index];81==r.color.index&&(o=sF[1]),o||(o=sF[1]),r.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(r.color.theme=parseInt(s.theme,10),s.tint&&(r.color.tint=parseFloat(s.tint)),s.theme&&n.themeElements&&n.themeElements.clrScheme&&(r.color.rgb=VI(n.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}(c,l,s,o),(c=a.match(n))&&function(e,t,n,i){t.Fills=[];var r={},a=!1;(e[0].match(oC)||[]).forEach(function(e){var n=hC(e);switch(dC(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r={},t.Fills.push(r);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":n.patternType&&(r.patternType=n.patternType);break;case"<bgColor":r.bgColor||(r.bgColor={}),n.indexed&&(r.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(r.bgColor.theme=parseInt(n.theme,10)),n.tint&&(r.bgColor.tint=parseFloat(n.tint)),n.rgb&&(r.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":r.fgColor||(r.fgColor={}),n.theme&&(r.fgColor.theme=parseInt(n.theme,10)),n.tint&&(r.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(r.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+n[0]+" in fills")}})}(c,l,0,o),(c=a.match(r))&&function(e,t,n,i){t.Borders=[];var r={},a=!1;(e[0].match(oC)||[]).forEach(function(e){var n=hC(e);switch(dC(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":r={},n.diagonalUp&&(r.diagonalUp=yC(n.diagonalUp)),n.diagonalDown&&(r.diagonalDown=yC(n.diagonalDown)),t.Borders.push(r);break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i&&i.WTF&&!a)throw new Error("unrecognized "+n[0]+" in borders")}})}(c,l,0,o),(c=a.match(t))&&function(e,t,n){var i;t.CellXf=[];var r=!1;(e[0].match(oC)||[]).forEach(function(e){var a=hC(e),s=0;switch(dC(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(i=a)[0],s=0;s<nR.length;++s)i[nR[s]]&&(i[nR[s]]=parseInt(i[nR[s]],10));for(s=0;s<iR.length;++s)i[iR[s]]&&(i[iR[s]]=yC(i[iR[s]]));if(t.NumberFmt&&i.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[i.numFmtId]==t.NumberFmt[s]){i.numFmtId=s;break}t.CellXf.push(i);break;case"<alignment":case"<alignment/>":var o={};a.vertical&&(o.vertical=a.vertical),a.horizontal&&(o.horizontal=a.horizontal),null!=a.textRotation&&(o.textRotation=a.textRotation),a.indent&&(o.indent=a.indent),a.wrapText&&(o.wrapText=yC(a.wrapText)),i.alignment=o;break;case"<AlternateContent":case"<ext":r=!0;break;case"</AlternateContent>":case"</ext>":r=!1;break;default:if(n&&n.WTF&&!r)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}(c,l,o),l):l}}(),aR=bU,sR=bU,oR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function cR(e,t,n){t.themeElements.clrScheme=[];var i={};(e[0].match(oC)||[]).forEach(function(e){var r=hC(e);switch(r[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=r.val;break;case"<a:sysClr":i.rgb=r.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===r[0].charAt(1)?(t.themeElements.clrScheme[oR.indexOf(r[0])]=i,i={}):i.name=r[0].slice(3,r[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+r[0]+" in clrScheme")}})}function lR(){}function hR(){}var dR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,uR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,pR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gR(e,t){var n,i;e&&0!==e.length||((n=[rC])[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",e=n.join(""));var r={};if(!(i=e.match(pR)))throw new Error("themeElements not found in theme");return function(e,t,n){var i;t.themeElements={},[["clrScheme",dR,cR],["fontScheme",uR,lR],["fmtScheme",fR,hR]].forEach(function(r){if(!(i=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](i,t,n)})}(i[0],r,t),r.raw=e,r}function mR(e){var t=e.read_shift(2),n=e.read_shift(2)-4,i=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=function(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e){return bU(e,4)}(e);break;case 2:t.xclrValue=HF(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}(e);break;case 6:i[1]=function(e,t){return bU(e,t)}(e,n);break;case 14:case 15:i[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return i}function bR(e,t){t.forEach(function(e){e[0]})}function vR(e,t,n,i){var r,a=Array.isArray(e);t.forEach(function(t){var s=CU(t.ref);if(a?(e[s.r]||(e[s.r]=[]),r=e[s.r][s.c]):r=e[t.ref],!r){r={t:"z"},a?e[s.r][s.c]=r:e[t.ref]=r;var o=RU(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var c=IU(o);c!==e["!ref"]&&(e["!ref"]=c)}r.c||(r.c=[]);var l={a:t.author,t:t.t,r:t.r,T:n};t.h&&(l.h=t.h);for(var h=r.c.length-1;h>=0;--h){if(!n&&r.c[h].T)return;n&&!r.c[h].T&&r.c.splice(h,1)}if(n&&i)for(h=0;h<i.length;++h)if(l.a==i[h].id){l.a=i[h].name||l.a;break}r.c.push(l)})}var yR=LU,wR=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,i,r){var a=!1,s=!1;0==i.length?s=!0:"["==i.charAt(0)&&(s=!0,i=i.slice(1,-1)),0==r.length?a=!0:"["==r.charAt(0)&&(a=!0,r=r.slice(1,-1));var o=i.length>0?0|parseInt(i,10):0,c=r.length>0?0|parseInt(r,10):0;return a?c+=t.c:--c,s?o+=t.r:--o,n+(a?"":"$")+SU(c)+(s?"":"$")+AU(o)}return function(i,r){return t=r,i.replace(e,n)}}(),xR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_R=function(){return function(e,t){return e.replace(xR,function(e,n,i,r,a,s){var o=kU(r)-(i?0:t.c),c=EU(s)-(a?0:t.r);return n+"R"+(0==c?"":a?c+1:"["+c+"]")+"C"+(0==o?"":i?o+1:"["+o+"]")})}}();function TR(e,t){return e.replace(xR,function(e,n,i,r,a,s){return n+("$"==i?i+r:SU(kU(r)+t.c))+("$"==a?a+s:AU(EU(s)+t.r))})}function DR(e,t,n){var i=FU(t).s,r=CU(n);return TR(e,{r:r.r-i.r,c:r.c-i.c})}function ER(e){return e.replace(/_xlfn\./g,"")}function AR(e){e.l+=1}function kR(e,t){var n=e.read_shift(2);return[16383&n,n>>14&1,n>>15&1]}function SR(e,t,n){var i=2;if(n){if(n.biff>=2&&n.biff<=5)return CR(e);12==n.biff&&(i=4)}var r=e.read_shift(i),a=e.read_shift(i),s=kR(e),o=kR(e);return{s:{r:r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function CR(e){var t=kR(e),n=kR(e),i=e.read_shift(1),r=e.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:n[0],c:r,cRel:n[1],rRel:n[2]}}}function UR(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=kR(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var i=e.read_shift(n&&12==n.biff?4:2),r=kR(e);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function FR(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function IR(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function RR(e){return[e.read_shift(1),e.read_shift(1)]}function NR(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=NF(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=oF[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=ZU(e);break;case 2:n[1]=jF(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function MR(e,t,n){for(var i=e.read_shift(12==n.biff?4:2),r=[],a=0;a!=i;++a)r.push((12==n.biff?YU:XF)(e));return r}function OR(e,t,n){var i=0,r=0;12==n.biff?(i=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),i=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--i,0==--r&&(r=256));for(var a=0,s=[];a!=i&&(s[a]=[]);++a)for(var o=0;o!=r;++o)s[a][o]=NR(e,n.biff);return s}function PR(e,t,n){return e.l+=2,[FR(e)]}function LR(e){return e.l+=6,[]}function WR(e){return e.l+=2,[MF(e),1&e.read_shift(2)]}var BR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],jR={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:bU},3:{n:"PtgAdd",f:AR},4:{n:"PtgSub",f:AR},5:{n:"PtgMul",f:AR},6:{n:"PtgDiv",f:AR},7:{n:"PtgPower",f:AR},8:{n:"PtgConcat",f:AR},9:{n:"PtgLt",f:AR},10:{n:"PtgLe",f:AR},11:{n:"PtgEq",f:AR},12:{n:"PtgGe",f:AR},13:{n:"PtgGt",f:AR},14:{n:"PtgNe",f:AR},15:{n:"PtgIsect",f:AR},16:{n:"PtgUnion",f:AR},17:{n:"PtgRange",f:AR},18:{n:"PtgUplus",f:AR},19:{n:"PtgUminus",f:AR},20:{n:"PtgPercent",f:AR},21:{n:"PtgParen",f:AR},22:{n:"PtgMissArg",f:AR},23:{n:"PtgStr",f:function(e,t,n){return e.l++,PF(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,oF[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,ZU(e)}},32:{n:"PtgArray",f:function(e,t,n){var i=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[i]}},33:{n:"PtgFunc",f:function(e,t,n){var i=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(n&&n.biff<=3?1:2);return[cN[r],oN[r],i]}},34:{n:"PtgFuncVar",f:function(e,t,n){var i=e[e.l++],r=e.read_shift(1),a=n&&n.biff<=3?[88==i?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[r,(0===a[0]?oN:sN)[a[1]]]}},35:{n:"PtgName",f:function(e,t,n){var i=e.read_shift(1)>>>5&3,r=!n||n.biff>=8?4:2,a=e.read_shift(r);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[i,0,a]}},36:{n:"PtgRef",f:function(e,t,n){var i=(96&e[e.l])>>5;return e.l+=1,[i,UR(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,SR(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var i=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[i,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:bU},40:{n:"PtgMemNoMem",f:bU},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var i=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[i]}},43:{n:"PtgAreaErr",f:function(e,t,n){var i=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[i]}},44:{n:"PtgRefN",f:function(e,t,n){var i=(96&e[e.l])>>5;e.l+=1;var r=function(e,t,n){var i=n&&n.biff?n.biff:8;if(i>=2&&i<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),i=(32768&t)>>15,r=(16384&t)>>14;return t&=16383,1==i&&t>=8192&&(t-=16384),1==r&&n>=128&&(n-=256),{r:t,c:n,cRel:r,rRel:i}}(e);var r=e.read_shift(i>=12?4:2),a=e.read_shift(2),s=(16384&a)>>14,o=(32768&a)>>15;if(a&=16383,1==o)for(;r>524287;)r-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:r,c:a,cRel:s,rRel:o}}(e,0,n);return[i,r]}},45:{n:"PtgAreaN",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=function(e,t,n){if(n.biff<8)return CR(e);var i=e.read_shift(12==n.biff?4:2),r=e.read_shift(12==n.biff?4:2),a=kR(e),s=kR(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:r,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[i,r]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[t,n,i]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var i=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[i,r,UR(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e.read_shift(2,"i");if(n&&5===n.biff)e.l+=12;return[i,r,SR(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e.read_shift(2),a=4;if(n)switch(n.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[i,r]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var i=(96&e[e.l++])>>5,r=e.read_shift(2),a=8;if(n)switch(n.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[i,r]}},255:{}},zR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HR={1:{n:"PtgElfLel",f:WR},2:{n:"PtgElfRw",f:PR},3:{n:"PtgElfCol",f:PR},6:{n:"PtgElfRwV",f:PR},7:{n:"PtgElfColV",f:PR},10:{n:"PtgElfRadical",f:PR},11:{n:"PtgElfRadicalS",f:LR},13:{n:"PtgElfColS",f:LR},15:{n:"PtgElfColSV",f:LR},16:{n:"PtgElfRadicalLel",f:WR},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(4),r=e.read_shift(2),a=e.read_shift(2);return{ixti:t,coltype:3&n,rt:BR[n>>2&31],idx:i,c:r,C:a}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},VR={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[i]}},2:{n:"PtgAttrIf",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var i=e.read_shift(n&&2==n.biff?1:2),r=[],a=0;a<=i;++a)r.push(e.read_shift(n&&2==n.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(e,t,n){var i=255&e[e.l+1]?1:0;return e.l+=2,[i,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:IR},33:{n:"PtgAttrBaxcel",f:IR},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),RR(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),RR(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function GR(e,t,n,i){if(i.biff<8)return bU(e,t);for(var r=e.l+t,a=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=OR(e,0,i),a.push(n[s][1]);break;case"PtgMemArea":n[s][2]=MR(e,n[s][1],i),a.push(n[s][2]);break;case"PtgExp":i&&12==i.biff&&(n[s][1][1]=e.read_shift(4),a.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=r-e.l)&&a.push(bU(e,t)),a}function $R(e,t,n){for(var i,r,a=e.l+t,s=[];a!=e.l;)t=a-e.l,r=e[e.l],i=jR[r]||jR[zR[r]],24!==r&&25!==r||(i=(24===r?HR:VR)[e[e.l+1]]),i&&i.f?s.push([i.n,i.f(e,t,n)]):bU(e,t);return s}function qR(e){for(var t=[],n=0;n<e.length;++n){for(var i=e[n],r=[],a=0;a<i.length;++a){var s=i[a];s?2===s[0]?r.push('"'+s[1].replace(/"/g,'""')+'"'):r.push(s[1]):r.push("")}t.push(r.join(","))}return t.join(";")}var XR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KR(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(n.biff>8)switch(e[i[0]][0]){case 357:return r=-1==i[1]?"#REF":e.SheetNames[i[1]],i[1]==i[2]?r:r+":"+e.SheetNames[i[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[i[0]][0];default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return r=-1==i[1]?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[i[0]][0][3]?(r=-1==i[1]?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function YR(e,t,n){var i=KR(e,t,n);return"#REF"==i?i:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(i,n)}function ZR(e,t,n,i,r){var a,s,o,c,l=r&&r.biff||8,h={s:{c:0,r:0}},d=[],u=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",b=0,v=e[0].length;b<v;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=d.pop(),s=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=VS(" ",e[0][g][1][1]);break;case 1:m=VS("\r",e[0][g][1][1]);break;default:if(m="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}s+=m,g=-1}d.push(s+XR[y[0]]+a);break;case"PtgIsect":a=d.pop(),s=d.pop(),d.push(s+" "+a);break;case"PtgUnion":a=d.pop(),s=d.pop(),d.push(s+","+a);break;case"PtgRange":a=d.pop(),s=d.pop(),d.push(s+":"+a);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=xU(y[1][1],h,r),d.push(TU(o,l));break;case"PtgRefN":o=n?xU(y[1][1],n,r):y[1][1],d.push(TU(o,l));break;case"PtgRef3d":u=y[1][1],o=xU(y[1][2],h,r),p=YR(i,u,r),d.push(p+"!"+TU(o,l));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],x=y[1][1];w||(w=0);var _=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===x&&(x=_.shift()),d.push(x+"("+_.join(",")+")");break;case"PtgBool":d.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(y[1]);break;case"PtgNum":d.push(String(y[1]));break;case"PtgStr":d.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=_U(y[1][1],n?{s:n}:h,r),d.push(DU(c,r));break;case"PtgArea":c=_U(y[1][1],h,r),d.push(DU(c,r));break;case"PtgArea3d":u=y[1][1],c=y[1][2],p=YR(i,u,r),d.push(p+"!"+DU(c,r));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=y[1][2];var T=(i.names||[])[f-1]||(i[0]||[])[f],D=T?T.Name:"SH33TJSNAME"+String(f);D&&"_xlfn."==D.slice(0,6)&&!r.xlfn&&(D=D.slice(6)),d.push(D);break;case"PtgNameX":var E,A=y[1][1];if(f=y[1][2],!(r.biff<=5)){var k="";if(14849==((i[A]||[])[0]||[])[0]||(1025==((i[A]||[])[0]||[])[0]?i[A][f]&&i[A][f].itab>0&&(k=i.SheetNames[i[A][f].itab-1]+"!"):k=i.SheetNames[f-1]+"!"),i[A]&&i[A][f])k+=i[A][f].Name;else if(i[0]&&i[0][f])k+=i[0][f].Name;else{var S=(KR(i,A,r)||"").split(";;");S[f-1]?k=S[f-1]:k+="SH33TJSERRX"}d.push(k);break}A<0&&(A=-A),i[A]&&(E=i[A][f]),E||(E={Name:"SH33TJSERRY"}),d.push(E.Name);break;case"PtgParen":var C="(",U=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:C=VS(" ",e[0][g][1][1])+C;break;case 3:C=VS("\r",e[0][g][1][1])+C;break;case 4:U=VS(" ",e[0][g][1][1])+U;break;case 5:U=VS("\r",e[0][g][1][1])+U;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(C+d.pop()+U);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var F={c:n.c,r:n.r};if(i.sharedf[UU(o)]){var I=i.sharedf[UU(o)];d.push(ZR(I,0,F,i,r))}else{var R=!1;for(a=0;a!=i.arrayf.length;++a)if(s=i.arrayf[a],!(o.c<s[0].s.c||o.c>s[0].e.c||o.r<s[0].s.r||o.r>s[0].e.r)){d.push(ZR(s[1],0,F,i,r)),R=!0;break}R||d.push(y[1])}break;case"PtgArray":d.push("{"+qR(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=r.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][b][0])){var N=!0;switch((y=e[0][g])[1][0]){case 4:N=!1;case 0:m=VS(" ",y[1][1]);break;case 5:N=!1;case 1:m=VS("\r",y[1][1]);break;default:if(m="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}d.push((N?m:"")+d.pop()+(N?"":m)),g=-1}}if(d.length>1&&r.WTF)throw new Error("bad formula stack");return d[0]}function JR(e,t,n){var i,r=e.l+t,a=2==n.biff?1:2,s=e.read_shift(a);if(65535==s)return[[],bU(e,t-2)];var o=$R(e,s,n);return t!==s+a&&(i=GR(e,t-s-a,o,n)),e.l=r,[o,i]}function QR(e,t,n){var i,r=e.l+t,a=e.read_shift(2),s=$R(e,a,n);return 65535==a?[[],bU(e,t-2)]:(t!==a+2&&(i=GR(e,r-a-2,s,n)),[s,i])}function eN(e,t,n){var i=e.l+t,r=GF(e);2==n.biff&&++e.l;var a=function(e){var t;if(65535!==aU(e,e.l+6))return[ZU(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var i,r=e.l+t,a=2==n.biff?1:2,s=e.read_shift(a);if(65535==s)return[[],bU(e,t-2)];var o=$R(e,s,n);return t!==s+a&&(i=GR(e,t-s-a,o,n)),e.l=r,[o,i]}(e,i-e.l,n);return{cell:r,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function tN(e,t,n){var i=e.read_shift(4),r=$R(e,i,n),a=e.read_shift(4);return[r,a>0?GR(e,a,r,n):null]}var nN=tN,iN=tN,rN=tN,aN=tN,sN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lN(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function hN(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var dN={},uN={};function fN(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function pN(e,t,n,i,r,a){try{i.cellNF&&(e.z=Gk[t])}catch(o){if(i.WTF)throw o}if("z"!==e.t||i.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=jS(e.v)),(!i||!1!==i.cellText)&&"z"!==e.t)try{if(null==Gk[t]&&TS(ES[t]||"General",t),"e"===e.t)e.w=e.w||oF[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=tS(e.v);else if("d"===e.t){var s=IS(e.v);e.w=(0|s)===s?s.toString(10):tS(s)}else{if(void 0===e.v)return"";e.w=nS(e.v,uN)}else"d"===e.t?e.w=_S(t,IS(e.v),uN):e.w=_S(t,e.v,uN)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&null!=n)try{e.s=a.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=VI(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=VI(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&a.Fills)throw o}}}var gN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,mN=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bN=/<(?:\w:)?hyperlink [^>]*>/gm,vN=/"(\w*:\w*)"/,yN=/<(?:\w:)?col\b[^>]*[\/]?>/g,wN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xN=/<(?:\w:)?pageMargins[^>]*\/>/g,_N=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,DN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function EN(e,t,n,i){var r=hC(e);n.Sheets[i]||(n.Sheets[i]={}),r.codeName&&(n.Sheets[i].CodeName=pC(DC(r.codeName)))}var AN=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,kN=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,a=AC("v"),s=AC("f");return function(o,c,l,h,d,u){for(var f,p,g,m,b,v=0,y="",w=[],x=[],_=0,T=0,D=0,E="",A=0,k=0,S=0,C=0,U=Array.isArray(u.CellXf),F=[],I=[],R=Array.isArray(c),N=[],M={},O=!1,P=!!l.sheetStubs,L=o.split(t),W=0,B=L.length;W!=B;++W){var j=(y=L[W].trim()).length;if(0!==j){var z=0;e:for(v=0;v<j;++v)switch(y[v]){case">":if("/"!=y[v-1]){++v;break e}if(l&&l.cellStyles){if(A=null!=(p=hC(y.slice(z,v),!0)).r?parseInt(p.r,10):A+1,k=-1,l.sheetRows&&l.sheetRows<A)continue;M={},O=!1,p.ht&&(O=!0,M.hpt=parseFloat(p.ht),M.hpx=eR(M.hpt)),"1"==p.hidden&&(O=!0,M.hidden=!0),null!=p.outlineLevel&&(O=!0,M.level=+p.outlineLevel),O&&(N[A-1]=M)}break;case"<":z=v}if(z>=v)break;if(A=null!=(p=hC(y.slice(z,v),!0)).r?parseInt(p.r,10):A+1,k=-1,!(l.sheetRows&&l.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),l&&l.cellStyles&&(M={},O=!1,p.ht&&(O=!0,M.hpt=parseFloat(p.ht),M.hpx=eR(M.hpt)),"1"==p.hidden&&(O=!0,M.hidden=!0),null!=p.outlineLevel&&(O=!0,M.level=+p.outlineLevel),O&&(N[A-1]=M)),w=y.slice(v).split(e);for(var H=0;H!=w.length&&"<"==w[H].trim().charAt(0);++H);for(w=w.slice(H),v=0;v!=w.length;++v)if(0!==(y=w[v].trim()).length){if(x=y.match(n),_=v,T=0,D=0,y="<c "+("<"==y.slice(0,1)?">":"")+y,null!=x&&2===x.length){for(_=0,E=x[1],T=0;T!=E.length&&!((D=E.charCodeAt(T)-64)<1||D>26);++T)_=26*_+D;k=--_}else++k;for(T=0;T!=y.length&&62!==y.charCodeAt(T);++T);if(++T,(p=hC(y.slice(0,T),!0)).r||(p.r=UU({r:A-1,c:k})),f={t:""},null!=(x=(E=y.slice(T)).match(a))&&""!==x[1]&&(f.v=pC(x[1])),l.cellFormula){if(null!=(x=E.match(s))&&""!==x[1]){if(f.f=pC(DC(x[1])).replace(/\r\n/g,"\n"),l.xlfn||(f.f=ER(f.f)),x[0].indexOf('t="array"')>-1)f.F=(E.match(r)||[])[1],f.F.indexOf(":")>-1&&F.push([RU(f.F),f.F]);else if(x[0].indexOf('t="shared"')>-1){m=hC(x[0]);var V=pC(DC(x[1]));l.xlfn||(V=ER(V)),I[parseInt(m.si,10)]=[m,V,p.r]}}else(x=E.match(/<f[^>]*\/>/))&&I[(m=hC(x[0])).si]&&(f.f=DR(I[m.si][1],I[m.si][2],p.r));var G=CU(p.r);for(T=0;T<F.length;++T)G.r>=F[T][0].s.r&&G.r<=F[T][0].e.r&&G.c>=F[T][0].s.c&&G.c<=F[T][0].e.c&&(f.F=F[T][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!P)continue;f.t="z"}else f.t=p.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),f.t){case"n":if(""==f.v||null==f.v){if(!P)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!P)continue;f.t="z"}else g=dN[parseInt(f.v,10)],f.v=g.t,f.r=g.r,l.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?DC(f.v):"",l.cellHTML&&(f.h=bC(f.v));break;case"inlineStr":x=E.match(i),f.t="s",null!=x&&(g=SI(x[1]))?(f.v=g.t,l.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=yC(f.v);break;case"d":l.cellDates?f.v=jS(f.v,1):(f.v=IS(jS(f.v,1)),f.t="n");break;case"e":l&&!1===l.cellText||(f.w=f.v),f.v=cF[f.v]}if(S=C=0,b=null,U&&void 0!==p.s&&null!=(b=u.CellXf[p.s])&&(null!=b.numFmtId&&(S=b.numFmtId),l.cellStyles&&null!=b.fillId&&(C=b.fillId)),pN(f,S,C,l,d,u),l.cellDates&&U&&"n"==f.t&&yS(Gk[S])&&(f.t="d",f.v=OS(f.v)),p.cm&&l.xlmeta){var $=(l.xlmeta.Cell||[])[+p.cm-1];$&&"XLDAPR"==$.type&&(f.D=!0)}if(R){var q=CU(p.r);c[q.r]||(c[q.r]=[]),c[q.r][q.c]=f}else c[p.r]=f}}}}N.length>0&&(c["!rows"]=N)}}(),SN=YU;function CN(e){return[HU(e),ZU(e),"n"]}var UN=YU,FN=["left","right","top","bottom","header","footer"];var IN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],RN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NN=[],MN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ON(e,t){for(var n=0;n!=e.length;++n)for(var i=e[n],r=0;r!=t.length;++r){var a=t[r];if(null==i[a[0]])i[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof i[a[0]]&&(i[a[0]]=yC(i[a[0]]));break;case"int":"string"==typeof i[a[0]]&&(i[a[0]]=parseInt(i[a[0]],10))}}}function PN(e,t){for(var n=0;n!=t.length;++n){var i=t[n];if(null==e[i[0]])e[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof e[i[0]]&&(e[i[0]]=yC(e[i[0]]));break;case"int":"string"==typeof e[i[0]]&&(e[i[0]]=parseInt(e[i[0]],10))}}}function LN(e){PN(e.WBProps,IN),PN(e.CalcPr,MN),ON(e.WBView,RN),ON(e.Sheets,NN),uN.date1904=yC(e.WBProps.date1904)}var WN="][*?/\\".split(""),BN=/<\w+:workbook/;function jN(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function zN(e,t,n,i,r,a,s,o){return".bin"===t.slice(-4)?function(e,t,n,i,r,a,s){if(!e)return e;var o=t||{};i||(i={"!id":{}});var c,l,h,d,u,f,p,g,m,b,v=o.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=!1,x=!1,_=[];o.biff=12,o["!row"]=0;var T=0,D=!1,E=[],A={},k=o.supbooks||r.supbooks||[[]];if(k.sharedf=A,k.arrayf=E,k.SheetNames=r.SheetNames||r.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=k,r.Names))for(var S=0;S<r.Names.length;++S)k[0][S+1]=r.Names[S];var C,U=[],F=[],I=!1;if(aM[16]={n:"BrtShortReal",f:CN},yU(e,function(e,t,S){if(!x)switch(S){case 148:c=e;break;case 0:l=e,o.sheetRows&&o.sheetRows<=l.r&&(x=!0),m=AU(u=l.r),o["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=eR(e.hpt)),F[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:e[2]},e[2]){case"n":h.v=e[1];break;case"s":g=dN[e[1]],h.v=g.t,h.r=g.r;break;case"b":h.v=!!e[1];break;case"e":h.v=e[1],!1!==o.cellText&&(h.w=oF[h.v]);break;case"str":h.t="s",h.v=e[1];break;case"is":h.t="s",h.v=e[1].t}if((d=s.CellXf[e[0].iStyleRef])&&pN(h,d.numFmtId,null,o,a,s),f=-1==e[0].c?f+1:e[0].c,o.dense?(v[u]||(v[u]=[]),v[u][f]=h):v[SU(f)+m]=h,o.cellFormula){for(D=!1,T=0;T<E.length;++T){var R=E[T];l.r>=R[0].s.r&&l.r<=R[0].e.r&&f>=R[0].s.c&&f<=R[0].e.c&&(h.F=IU(R[0]),D=!0)}!D&&e.length>3&&(h.f=e[3])}if(y.s.r>l.r&&(y.s.r=l.r),y.s.c>f&&(y.s.c=f),y.e.r<l.r&&(y.e.r=l.r),y.e.c<f&&(y.e.c=f),o.cellDates&&d&&"n"==h.t&&yS(Gk[d.numFmtId])){var N=Kk(h.v);N&&(h.t="d",h.v=new Date(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u))}C&&("XLDAPR"==C.type&&(h.D=!0),C=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;h={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(v[u]||(v[u]=[]),v[u][f]=h):v[SU(f)+m]=h,y.s.r>l.r&&(y.s.r=l.r),y.s.c>f&&(y.s.c=f),y.e.r<l.r&&(y.e.r=l.r),y.e.c<f&&(y.e.c=f),C&&("XLDAPR"==C.type&&(h.D=!0),C=void 0);break;case 176:_.push(e);break;case 49:C=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var M=i["!id"][e.relId];for(M?(e.Target=M.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=M):""==e.relId&&(e.Target="#"+e.loc),u=e.rfx.s.r;u<=e.rfx.e.r;++u)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(v[u]||(v[u]=[]),v[u][f]||(v[u][f]={t:"z",v:void 0}),v[u][f].l=e):(p=UU({c:f,r:u}),v[p]||(v[p]={t:"z",v:void 0}),v[p].l=e);break;case 426:if(!o.cellFormula)break;E.push(e),(b=o.dense?v[u][f]:v[SU(f)+m]).f=ZR(e[1],0,{r:l.r,c:f},k,o),b.F=IU(e[0]);break;case 427:if(!o.cellFormula)break;A[UU(e[0].s)]=e[1],(b=o.dense?v[u][f]:v[SU(f)+m]).f=ZR(e[1],0,{r:l.r,c:f},k,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)U[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},I||(I=!0,YI(e.w/256)),ZI(U[e.e+1]);break;case 161:v["!autofilter"]={ref:IU(e)};break;case 476:v["!margins"]=e;break;case 147:r.Sheets[n]||(r.Sheets[n]={}),e.name&&(r.Sheets[n].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),e.RTL&&(r.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:w=!0;break;case 36:case 38:w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}},o),delete o.supbooks,delete o["!row"],!v["!ref"]&&(y.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(v["!ref"]=IU(c||y)),o.sheetRows&&v["!ref"]){var R=RU(v["!ref"]);o.sheetRows<=+R.e.r&&(R.e.r=o.sheetRows-1,R.e.r>y.e.r&&(R.e.r=y.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>y.e.c&&(R.e.c=y.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),v["!fullref"]=v["!ref"],v["!ref"]=IU(R))}return _.length>0&&(v["!merges"]=_),U.length>0&&(v["!cols"]=U),F.length>0&&(v["!rows"]=F),v}(e,i,n,r,a,s,o):function(e,t,n,i,r,a,s){if(!e)return e;i||(i={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",h="",d=e.match(mN);d?(l=e.slice(0,d.index),h=e.slice(d.index+d[0].length)):l=h=e;var u=l.match(_N);u?EN(u[0],0,r,n):(u=l.match(TN))&&function(e,t,n,i,r){EN(e.slice(0,e.indexOf(">")),0,i,r)}(u[0],u[1],0,r,n);var f=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=l.slice(f,f+50).match(vN);p&&function(e,t){var n=RU(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=IU(n))}(o,p[1])}var g=l.match(DN);g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]),(e.match(AN)||[]).forEach(function(e,n){var i=hC(e);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),yC(i.rightToLeft)&&(t.Views[n].RTL=!0)})}(g[1],r);var m=[];if(t.cellStyles){var b=l.match(yN);b&&function(e,t){for(var n=!1,i=0;i!=t.length;++i){var r=hC(t[i],!0);r.hidden&&(r.hidden=yC(r.hidden));var a=parseInt(r.min,10)-1,s=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!n&&r.width&&(n=!0,YI(r.width)),ZI(r);a<=s;)e[a++]=HS(r)}}(m,b)}d&&kN(d[1],o,t,c,a,s);var v=h.match(wN);v&&(o["!autofilter"]=function(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(v[0]));var y=[],w=h.match(gN);if(w)for(f=0;f!=w.length;++f)y[f]=RU(w[f].slice(w[f].indexOf('"')+1));var x=h.match(bN);x&&function(e,t,n){for(var i=Array.isArray(e),r=0;r!=t.length;++r){var a=hC(DC(t[r]),!0);if(!a.ref)return;var s=((n||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+pC(a.location))):(a.Target="#"+pC(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=RU(a.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var h=UU({c:l,r:c});i?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=a):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=a)}}}(o,x,i);var _,T,D=h.match(xN);if(D&&(o["!margins"]=(_=hC(D[0]),T={},["left","right","top","bottom","header","footer"].forEach(function(e){_[e]&&(T[e]=parseFloat(_[e]))}),T)),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=IU(c)),t.sheetRows>0&&o["!ref"]){var E=RU(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=IU(E))}return m.length>0&&(o["!cols"]=m),y.length>0&&(o["!merges"]=y),o}(e,i,n,r,a,s,o)}var HN,VN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $N(e,t){var n=e.split(/\s+/),i=[];if(i[0]=n[0],1===n.length)return i;var r,a,s,o=e.match(VN);if(o)for(s=0;s!=o.length;++s)-1===(a=(r=o[s].match(GN))[1].indexOf(":"))?i[r[1]]=r[2].slice(1,r[2].length-1):i["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(a+1)]=r[2].slice(1,r[2].length-1);return i}function qN(e){var t={};if(1===e.split(/\s+/).length)return t;var n,i,r,a=e.match(VN);if(a)for(r=0;r!=a.length;++r)-1===(i=(n=a[r].match(GN))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1)]=n[2].slice(1,n[2].length-1);return t}function XN(e,t,n,i){var r=i;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=yC(i);break;case"i2":case"int":r=parseInt(i,10);break;case"r4":case"float":r=parseFloat(i);break;case"date":case"dateTime.tz":r=jS(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[pC(t)]=r}function KN(e,t,n){if(n.cellStyles&&t.Interior){var i=t.Interior;i.Pattern&&(i.patternType=tR[i.Pattern]||i.Pattern)}e[t.ID]=t}function YN(e,t,n,i,r,a,s,o,c,l){var h="General",d=i.StyleID,u={};l=l||{};var f=[],p=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&s&&(d=s.StyleID);void 0!==a[d]&&(a[d].nf&&(h=a[d].nf),a[d].Interior&&f.push(a[d].Interior),a[d].Parent);)d=a[d].Parent;switch(n.Type){case"Boolean":i.t="b",i.v=yC(e);break;case"String":i.t="s",i.r=vC(pC(e)),i.v=e.indexOf("<")>-1?pC(t||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),i.v=(jS(e)-new Date(Date.UTC(1899,11,30)))/864e5,i.v!=i.v?i.v=pC(e):i.v<60&&(i.v=i.v-1),h&&"General"!=h||(h="yyyy-mm-dd");case"Number":void 0===i.v&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=cF[e],!1!==l.cellText&&(i.w=e);break;default:""==e&&""==t?i.t="z":(i.t="s",i.v=vC(t||e))}if(function(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||oF[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=tS(e.v):e.w=nS(e.v):e.w=(i=t||"General",r=e.v,"General"===(a=HN[i]||pC(i))?nS(r):_S(a,r))}catch(c){if(n.WTF)throw c}var i,r,a;try{var s=HN[t]||t||"General";if(n.cellNF&&(e.z=s),n.cellDates&&"n"==e.t&&yS(s)){var o=Kk(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(c){if(n.WTF)throw c}}}(i,h,l),!1!==l.cellFormula)if(i.Formula){var g=pC(i.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),i.f=wR(g,r),delete i.Formula,"RC"==i.ArrayRange?i.F=wR("RC:RC",r):i.ArrayRange&&(i.F=wR(i.ArrayRange,r),c.push([RU(i.F),i.F]))}else for(p=0;p<c.length;++p)r.r>=c[p][0].s.r&&r.r<=c[p][0].e.r&&r.c>=c[p][0].s.c&&r.c<=c[p][0].e.c&&(i.F=c[p][1]);l.cellStyles&&(f.forEach(function(e){!u.patternType&&e.patternType&&(u.patternType=e.patternType)}),i.s=u),void 0!==i.StyleID&&(i.ixfe=i.StyleID)}function ZN(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function JN(e,t){var n=t||{};DS();var i=wk(NC(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(i=DC(i));var r,a=i.slice(0,1024).toLowerCase(),s=!1;if((1023&(a=a.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&a.indexOf(","),1023&a.indexOf(";"))){var o=HS(n);return o.type="string",xI.to_workbook(i,o)}if(-1==a.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){a.indexOf("<"+e)>=0&&(s=!0)}),s)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return MU(cM(n[0],t),t);var i={SheetNames:[],Sheets:{}};return n.forEach(function(e,n){XM(i,cM(e,t),"Sheet"+(n+1))}),i}(i,n);HN={"General Number":"General","General Date":Gk[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gk[15],"Short Date":Gk[14],"Long Time":Gk[19],"Medium Time":Gk[18],"Short Time":Gk[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gk[2],Standard:Gk[4],Percent:Gk[10],Scientific:Gk[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l,h=[],d={},u=[],f=n.dense?[]:{},p="",g={},m={},b=$N('<Data ss:Type="String">'),v=0,y=0,w=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},T={},D="",E=0,A=[],k={},S={},C=0,U=[],F=[],I={},R=[],N=!1,M=[],O=[],P={},L=0,W=0,B={Sheets:[],WBProps:{date1904:!1}},j={};MC.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/gm,"");for(var z="";r=MC.exec(i);)switch(r[3]=(z=r[3]).toLowerCase()){case"data":if("data"==z){if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break}if(h[h.length-1][1])break;"/"===r[1]?YN(i.slice(v,r.index),D,b,"comment"==h[h.length-1][0]?I:g,{c:y,r:w},_,R[y],m,M,n):(D="",b=$N(r[0]),v=r.index+r[0].length);break;case"cell":if("/"===r[1])if(F.length>0&&(g.c=F),(!n.sheetRows||n.sheetRows>w)&&void 0!==g.v&&(n.dense?(f[w]||(f[w]=[]),f[w][y]=g):f[SU(y)+AU(w)]=g),g.HRef&&(g.l={Target:pC(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(L=y+(0|parseInt(g.MergeAcross,10)),W=w+(0|parseInt(g.MergeDown,10)),A.push({s:{c:y,r:w},e:{c:L,r:W}})),n.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var H=y;H<=L;++H)for(var V=w;V<=W;++V)(H>y||V>w)&&(n.dense?(f[V]||(f[V]=[]),f[V][H]={t:"z"}):f[SU(H)+AU(V)]={t:"z"});y=L+1}else++y;else g.MergeAcross?y=L+1:++y;else(g=qN(r[0])).Index&&(y=+g.Index-1),y<x.s.c&&(x.s.c=y),y>x.e.c&&(x.e.c=y),"/>"===r[0].slice(-2)&&++y,F=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(w<x.s.r&&(x.s.r=w),w>x.e.r&&(x.e.r=w),"/>"===r[0].slice(-2)&&(m=$N(r[0])).Index&&(w=+m.Index-1),y=0,++w):((m=$N(r[0])).Index&&(w=+m.Index-1),P={},("0"==m.AutoFitHeight||m.Height)&&(P.hpx=parseInt(m.Height,10),P.hpt=QI(P.hpx),O[w]=P),"1"==m.Hidden&&(P.hidden=!0,O[w]=P));break;case"worksheet":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"));u.push(p),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(f["!ref"]=IU(x),n.sheetRows&&n.sheetRows<=x.e.r&&(f["!fullref"]=f["!ref"],x.e.r=n.sheetRows-1,f["!ref"]=IU(x))),A.length&&(f["!merges"]=A),R.length>0&&(f["!cols"]=R),O.length>0&&(f["!rows"]=O),d[p]=f}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,h.push([r[3],!1]),c=$N(r[0]),p=pC(c.Name),f=n.dense?[]:{},A=[],M=[],O=[],j={name:p,Hidden:0},B.Sheets.push(j);break;case"table":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==r[0].slice(-2))break;h.push([r[3],!1]),R=[],N=!1}break;case"style":"/"===r[1]?KN(_,T,n):T=$N(r[0]);break;case"numberformat":T.nf=pC($N(r[0]).Format||"General"),HN[T.nf]&&(T.nf=HN[T.nf]);for(var G=0;392!=G&&Gk[G]!=T.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==Gk[G]){TS(T.nf,G);break}break;case"column":if("table"!==h[h.length-1][0])break;if((l=$N(r[0])).Hidden&&(l.hidden=!0,delete l.Hidden),l.Width&&(l.wpx=parseInt(l.Width,10)),!N&&l.wpx>10){N=!0,GI=6;for(var $=0;$<R.length;++$)R[$]&&ZI(R[$])}N&&ZI(l),R[l.Index-1||R.length]=l;for(var q=0;q<+l.Span;++q)R[R.length]=HS(l);break;case"namedrange":if("/"===r[1])break;B.Names||(B.Names=[]);var X=hC(r[0]),K={Name:X.Name,Ref:wR(X.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(K.Sheet=B.Sheets.length-1),B.Names.push(K);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===r[0].slice(-2))break;"/"===r[1]?D+=i.slice(E,r.index):E=r.index+r[0].length;break;case"interior":if(!n.cellStyles)break;T.Interior=$N(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===r[0].slice(-2))break;"/"===r[1]?xF(k,z,i.slice(C,r.index)):C=r.index+r[0].length;break;case"styles":case"workbook":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else h.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"));ZN(I),F.push(I)}else h.push([r[3],!1]),I={a:(c=$N(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var Y=$N(r[0]);f["!autofilter"]={ref:wR(Y.Range).replace(/\$/g,"")},h.push([r[3],!0])}break;case"datavalidation":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((c=h.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&h.push([r[3],!0]);break;default:if(0==h.length&&"document"==r[3])return bM(i,n);if(0==h.length&&"uof"==r[3])return bM(i,n);var Z=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(r[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:Z=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(i.slice(C,r.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2}else C=r.index+r[0].length;break;case"header":f["!margins"]||fN(f["!margins"]={},"xlml"),isNaN(+hC(r[0]).Margin)||(f["!margins"].header=+hC(r[0]).Margin);break;case"footer":f["!margins"]||fN(f["!margins"]={},"xlml"),isNaN(+hC(r[0]).Margin)||(f["!margins"].footer=+hC(r[0]).Margin);break;case"pagemargins":var J=hC(r[0]);f["!margins"]||fN(f["!margins"]={},"xlml"),isNaN(+J.Top)||(f["!margins"].top=+J.Top),isNaN(+J.Left)||(f["!margins"].left=+J.Left),isNaN(+J.Right)||(f["!margins"].right=+J.Right),isNaN(+J.Bottom)||(f["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Z=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Z=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1}if(Z)break;if(r[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+h.join("|");if("customdocumentproperties"===h[h.length-1][0]){if("/>"===r[0].slice(-2))break;"/"===r[1]?XN(S,z,U,i.slice(C,r.index)):(U=r,C=r.index+r[0].length);break}if(n.WTF)throw"Unrecognized tag: "+r[3]+"|"+h.join("|")}var Q={};return n.bookSheets||n.bookProps||(Q.Sheets=d),Q.SheetNames=u,Q.Workbook=B,Q.SSF=HS(Gk),Q.Props=k,Q.Custprops=S,Q}function QN(e,t){switch(IM(t=t||{}),t.type||"base64"){case"base64":return JN(Ek(e),t);case"binary":case"buffer":case"file":return JN(e,t);case"array":return JN(Fk(e),t)}}var eM=[60,1084,2066,2165,2175];function tM(e,t,n,i,r){var a=i,s=[],o=n.slice(n.l,n.l+a);if(r&&r.enc&&r.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:r.enc.insitu(o)}s.push(o),n.l+=a;for(var c=aU(n,n.l),l=sM[c],h=0;null!=l&&eM.indexOf(c)>-1;)a=aU(n,n.l+2),h=n.l+4,2066==c?h+=4:2165!=c&&2175!=c||(h+=12),o=n.slice(h,n.l+4+a),s.push(o),n.l+=4+a,l=sM[c=aU(n,n.l)];var d=Rk(s);mU(d,0);var u=0;d.lens=[];for(var f=0;f<s.length;++f)d.lens.push(u),u+=s[f].length;if(d.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+i;return t.f(d,d.length,r)}function nM(e,t,n){if("z"!==e.t&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Gk[i])}catch(a){if(t.WTF)throw a}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||oF[e.v]:0===i||"General"==i?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=tS(e.v):e.w=nS(e.v):e.w=_S(i,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&i&&"n"==e.t&&yS(Gk[i]||String(i))){var r=Kk(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function iM(e,t,n){return{v:e,ixfe:t,t:n}}function rM(e,t){var n,i,r,a;if(t||(t={}),IM(t),mk(),t.codepage&&pk(t.codepage),e.FullPaths){if(SS.find(e,"/encryption"))throw new Error("File is password-protected");n=SS.find(e,"!CompObj"),i=SS.find(e,"/Workbook")||SS.find(e,"/Book")}else{switch(t.type){case"base64":e=Uk(Ek(e));break;case"binary":e=Uk(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}mU(e,0),i={content:e}}if(n&&function(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return JU(e,1)}(n),n.length-n.l<=4)return t;var i=n.read_shift(4);0==i||i>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(i=n.read_shift(4))||(t.UnicodeClipboardFormat=function(e){return JU(e,2)}(n),0==(i=n.read_shift(4))||i>40||(n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr"))))}(n),t.bookProps&&!t.bookSheets)r={};else{var s=Ak?"buffer":"array";if(i&&i.content)r=function(e,t){var n,i,r,a,s,o,c,l,h={opts:{}},d={},u=t.dense?[]:{},f={},p={},g=null,m=[],b="",v={},y="",w={},x=[],_=[],T=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},A=function(e){return e<8?sF[e]:e<64&&T[e-8]||sF[e]},k=function(e,t,i){if(!(P>1||i.sheetRows&&e.r>=i.sheetRows)){if(i.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var i,r=t.XF.data;r&&r.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=r.patternType,(i=HI(A(r.icvFore)))&&(t.s.fgColor={rgb:i}),(i=HI(A(r.icvBack)))&&(t.s.bgColor={rgb:i}))}(0,t,i),delete t.ixfe,delete t.XF,n=e,y=UU(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),i.cellFormula&&t.f)for(var r=0;r<x.length;++r)if(!(x[r][0].s.c>e.c||x[r][0].s.r>e.r||x[r][0].e.c<e.c||x[r][0].e.r<e.r)){t.F=IU(x[r][0]),x[r][0].s.c==e.c&&x[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+ZR(x[r][1],0,e,N,S));break}i.dense?(u[e.r]||(u[e.r]=[]),u[e.r][e.c]=t):u[y]=t}},S={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(S.password=t.password);var C=[],U=[],F=[],I=[],R=!1,N=[];N.SheetNames=S.snames,N.sharedf=S.sharedf,N.arrayf=S.arrayf,N.names=[],N.XTI=[];var M,O=0,P=0,L=0,W=[],B=[];S.codepage=1200,gk(1200);for(var j=!1;e.l<e.length-1;){var z=e.l,H=e.read_shift(2);if(0===H&&10===O)break;var V=e.l===e.length?0:e.read_shift(2),G=sM[H];if(G&&G.f){if(t.bookSheets&&133===O&&133!==H)break;if(O=H,2===G.r||12==G.r){var $=e.read_shift(2);if(V-=2,!S.enc&&$!==H&&((255&$)<<8|$>>8)!==H)throw new Error("rt mismatch: "+$+"!="+H);12==G.r&&(e.l+=10,V-=10)}var q={};if(q=10===H?G.f(e,V,S):tM(H,G,e,V,S),0==P&&-1===[9,521,1033,2057].indexOf(O))continue;switch(H){case 34:h.opts.Date1904=D.WBProps.date1904=q;break;case 134:h.opts.WriteProtect=!0;break;case 47:if(S.enc||(e.l=0),S.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:S.lastuser=q;break;case 66:var X=Number(q);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}gk(S.codepage=X),j=!0;break;case 317:S.rrtabid=q;break;case 25:S.winlocked=q;break;case 439:h.opts.RefreshAll=q;break;case 12:h.opts.CalcCount=q;break;case 16:h.opts.CalcDelta=q;break;case 17:h.opts.CalcIter=q;break;case 13:h.opts.CalcMode=q;break;case 14:h.opts.CalcPrecision=q;break;case 95:h.opts.CalcSaveRecalc=q;break;case 15:S.CalcRefMode=q;break;case 2211:h.opts.FullCalc=q;break;case 129:q.fDialog&&(u["!type"]="dialog"),q.fBelow||((u["!outline"]||(u["!outline"]={})).above=!0),q.fRight||((u["!outline"]||(u["!outline"]={})).left=!0);break;case 224:_.push(q);break;case 430:N.push([q]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push(q);break;case 24:case 536:M={Name:q.Name,Ref:ZR(q.rgce,0,null,N,S)},q.itab>0&&(M.Sheet=q.itab-1),N.names.push(M),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(B[q.itab-1]={ref:IU(q.rgce[0][0][1][2])});break;case 22:S.ExternCount=q;break;case 23:0==N.length&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat(q),N.XTI=N.XTI.concat(q);break;case 2196:if(S.biff<8)break;null!=M&&(M.Comment=q[1]);break;case 18:u["!protect"]=q;break;case 19:0!==q&&S.WTF;break;case 133:f[q.pos]=q,S.snames.push(q.name);break;case 10:if(--P)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,u["!ref"]=IU(p),t.sheetRows&&t.sheetRows<=p.e.r){var K=p.e.r;p.e.r=t.sheetRows-1,u["!fullref"]=u["!ref"],u["!ref"]=IU(p),p.e.r=K}p.e.r++,p.e.c++}C.length>0&&(u["!merges"]=C),U.length>0&&(u["!objects"]=U),F.length>0&&(u["!cols"]=F),I.length>0&&(u["!rows"]=I),D.Sheets.push(E)}""===b?v=u:d[b]=u,u=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===S.biff&&(S.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),S.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(S.biff=5,j=!0,gk(S.codepage=28591)),8==S.biff&&0==q.BIFFVer&&16==q.dt&&(S.biff=2),P++)break;if(u=t.dense?[]:{},S.biff<8&&!j&&(j=!0,gk(S.codepage=t.codepage||1252)),S.biff<5||0==q.BIFFVer&&4096==q.dt){""===b&&(b="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-V,name:b};f[Y.pos]=Y,S.snames.push(b)}else b=(f[z]||{name:""}).name;32==q.dt&&(u["!type"]="chart"),64==q.dt&&(u["!type"]="macro"),C=[],U=[],S.arrayf=x=[],F=[],I=[],R=!1,E={Hidden:(f[z]||{hs:0}).hs,name:b};break;case 515:case 3:case 2:"chart"==u["!type"]&&(t.dense?(u[q.r]||[])[q.c]:u[UU({c:q.c,r:q.r})])&&++q.c,o={ixfe:q.ixfe,XF:_[q.ixfe]||{},v:q.val,t:"n"},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t);break;case 5:case 517:o={ixfe:q.ixfe,XF:_[q.ixfe],v:q.val,t:q.t},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t);break;case 638:o={ixfe:q.ixfe,XF:_[q.ixfe],v:q.rknum,t:"n"},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t);break;case 189:for(var Z=q.c;Z<=q.C;++Z){var J=q.rkrec[Z-q.c][0];o={ixfe:J,XF:_[J],v:q.rkrec[Z-q.c][1],t:"n"},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:Z,r:q.r},o,t)}break;case 6:case 518:case 1030:if("String"==q.val){g=q;break}if((o=iM(q.val,q.cell.ixfe,q.tt)).XF=_[o.ixfe],t.cellFormula){var Q=q.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],te=Q[0][0][1][1],ne=UU({r:ee,c:te});w[ne]?o.f=""+ZR(q.formula,0,q.cell,N,S):o.F=((t.dense?(u[ee]||[])[te]:u[ne])||{}).F}else o.f=""+ZR(q.formula,0,q.cell,N,S)}L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k(q.cell,o,t),g=q;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=q,(o=iM(q,g.cell.ixfe,"s")).XF=_[o.ixfe],t.cellFormula&&(o.f=""+ZR(g.formula,0,g.cell,N,S)),L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k(g.cell,o,t),g=null;break;case 33:case 545:x.push(q);var ie=UU(q[0].s);if(i=t.dense?(u[q[0].s.r]||[])[q[0].s.c]:u[ie],t.cellFormula&&i){if(!g)break;if(!ie||!i)break;i.f=""+ZR(q[1],0,q[0],N,S),i.F=IU(q[0])}break;case 1212:if(!t.cellFormula)break;if(y){if(!g)break;w[UU(g.cell)]=q[0],((i=t.dense?(u[g.cell.r]||[])[g.cell.c]:u[UU(g.cell)])||{}).f=""+ZR(q[0],0,n,N,S)}break;case 253:o=iM(m[q.isst].t,q.ixfe,"s"),m[q.isst].h&&(o.h=m[q.isst].h),o.XF=_[o.ixfe],L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t);break;case 513:t.sheetStubs&&(o={ixfe:q.ixfe,XF:_[q.ixfe],t:"z"},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t));break;case 190:if(t.sheetStubs)for(var re=q.c;re<=q.C;++re){var ae=q.ixfe[re-q.c];o={ixfe:ae,XF:_[ae],t:"z"},L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:re,r:q.r},o,t)}break;case 214:case 516:case 4:(o=iM(q.val,q.ixfe,"s")).XF=_[o.ixfe],L>0&&(o.z=W[o.ixfe>>8&63]),nM(o,t,h.opts.Date1904),k({c:q.c,r:q.r},o,t);break;case 0:case 512:1===P&&(p=q);break;case 252:m=q;break;case 1054:if(4==S.biff){W[L++]=q[1];for(var se=0;se<L+163&&Gk[se]!=q[1];++se);se>=163&&TS(q[1],L+163)}else TS(q[1],q[0]);break;case 30:W[L++]=q;for(var oe=0;oe<L+163&&Gk[oe]!=q;++oe);oe>=163&&TS(q,L+163);break;case 229:C=C.concat(q);break;case 93:U[q.cmo[0]]=S.lastobj=q;break;case 438:S.lastobj.TxO=q;break;case 127:S.lastobj.ImData=q;break;case 440:for(s=q[0].s.r;s<=q[0].e.r;++s)for(a=q[0].s.c;a<=q[0].e.c;++a)(i=t.dense?(u[s]||[])[a]:u[UU({c:a,r:s})])&&(i.l=q[1]);break;case 2048:for(s=q[0].s.r;s<=q[0].e.r;++s)for(a=q[0].s.c;a<=q[0].e.c;++a)(i=t.dense?(u[s]||[])[a]:u[UU({c:a,r:s})])&&i.l&&(i.l.Tooltip=q[1]);break;case 28:if(S.biff<=5&&S.biff>=2)break;i=t.dense?(u[q[0].r]||[])[q[0].c]:u[UU(q[0])];var ce=U[q[2]];i||(t.dense?(u[q[0].r]||(u[q[0].r]=[]),i=u[q[0].r][q[0].c]={t:"z"}):i=u[UU(q[0])]={t:"z"},p.e.r=Math.max(p.e.r,q[0].r),p.s.r=Math.min(p.s.r,q[0].r),p.e.c=Math.max(p.e.c,q[0].c),p.s.c=Math.min(p.s.c,q[0].c)),i.c||(i.c=[]),r={a:q[1],t:ce.TxO.t},i.c.push(r);break;case 2173:bR(_[q.ixfe],q.ext);break;case 125:if(!S.cellStyles)break;for(;q.e>=q.s;)F[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},R||(R=!0,YI(q.w/256)),ZI(F[q.e+1]);break;case 520:var le={};null!=q.level&&(I[q.r]=le,le.level=q.level),q.hidden&&(I[q.r]=le,le.hidden=!0),q.hpt&&(I[q.r]=le,le.hpt=q.hpt,le.hpx=eR(q.hpt));break;case 38:case 39:case 40:case 41:u["!margins"]||fN(u["!margins"]={}),u["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=q;break;case 161:u["!margins"]||fN(u["!margins"]={}),u["!margins"].header=q.header,u["!margins"].footer=q.footer;break;case 574:q.RTL&&(D.Views[0].RTL=!0);break;case 146:T=q;break;case 2198:l=q;break;case 140:c=q;break;case 442:b?E.CodeName=q||E.name:D.WBProps.CodeName=q||"ThisWorkbook"}}else e.l+=V}return h.SheetNames=CS(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(h.Sheets=d),!h.SheetNames.length&&v["!ref"]?(h.SheetNames.push("Sheet1"),h.Sheets&&(h.Sheets.Sheet1=v)):h.Preamble=v,h.Sheets&&B.forEach(function(e,t){h.Sheets[h.SheetNames[t]]["!autofilter"]=e}),h.Strings=m,h.SSF=HS(Gk),S.enc&&(h.Encryption=S.enc),l&&(h.Themes=l),h.Metadata={},void 0!==c&&(h.Metadata.Country=c),N.names.length>0&&(D.Names=N.names),h.Workbook=D,h}(i.content,t);else if((a=SS.find(e,"PerfectOffice_MAIN"))&&a.content)r=_I.to_workbook(a.content,(t.type=s,t));else{if(!(a=SS.find(e,"NativeContent_MAIN"))||!a.content)throw(a=SS.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=_I.to_workbook(a.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&SS.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=function(e){var t=SS.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,i){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var r=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");SS.utils.cfb_add(t,r,e.FileIndex[i].content)}}),SS.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var i=SS.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var r=IF(i,tF,"02d5cdd59c2e1b10939708002b2cf9ae");for(var a in r)t[a]=r[a]}catch(l){if(n.WTF)throw l}var s=SS.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=IF(s,nF,"e0859ff2f94f6810ab9108002b27b3d9");for(var c in o)null==t[c]&&(t[c]=o[c])}catch(l){if(n.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(bF(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),r.Props=r.Custprops=o,t.bookFiles&&(r.cfb=e),r}var aM={0:{f:function(e,t){var n={},i=e.l+t;n.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=i,7&a&&(n.level=7&a),16&a&&(n.hidden=!0),32&a&&(n.hpt=r/20),n}},1:{f:function(e){return[zU(e)]}},2:{f:function(e){return[zU(e),XU(e),"n"]}},3:{f:function(e){return[zU(e),e.read_shift(1),"e"]}},4:{f:function(e){return[zU(e),e.read_shift(1),"b"]}},5:{f:function(e){return[zU(e),ZU(e),"n"]}},6:{f:function(e){return[zU(e),LU(e),"str"]}},7:{f:function(e){return[zU(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var i=e.l+t,r=zU(e);r.r=n["!row"];var a=[r,LU(e),"str"];if(n.cellFormula){e.l+=2;var s=iN(e,i-e.l,n);a[3]=ZR(s,0,r,n.supbooks,n)}else e.l=i;return a}},9:{f:function(e,t,n){var i=e.l+t,r=zU(e);r.r=n["!row"];var a=[r,ZU(e),"n"];if(n.cellFormula){e.l+=2;var s=iN(e,i-e.l,n);a[3]=ZR(s,0,r,n.supbooks,n)}else e.l=i;return a}},10:{f:function(e,t,n){var i=e.l+t,r=zU(e);r.r=n["!row"];var a=[r,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=iN(e,i-e.l,n);a[3]=ZR(s,0,r,n.supbooks,n)}else e.l=i;return a}},11:{f:function(e,t,n){var i=e.l+t,r=zU(e);r.r=n["!row"];var a=[r,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=iN(e,i-e.l,n);a[3]=ZR(s,0,r,n.supbooks,n)}else e.l=i;return a}},12:{f:function(e){return[HU(e)]}},13:{f:function(e){return[HU(e),XU(e),"n"]}},14:{f:function(e){return[HU(e),e.read_shift(1),"e"]}},15:{f:function(e){return[HU(e),e.read_shift(1),"b"]}},16:{f:CN},17:{f:function(e){return[HU(e),LU(e),"str"]}},18:{f:function(e){return[HU(e),e.read_shift(4),"s"]}},19:{f:BU},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var i=e.l+t;e.l+=4,e.l+=1;var r=e.read_shift(4),a=$U(e),s=rN(e,0,n),o=GU(e);e.l=i;var c={Name:a,Ptg:s};return r<268435455&&(c.Sheet=r),o&&(c.Comment=o),c}},40:{},42:{},43:{f:function(e,t,n){var i={};i.sz=e.read_shift(2)/20;var r=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1),700===e.read_shift(2)&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript"}var a=e.read_shift(1);0!=a&&(i.underline=a);var s=e.read_shift(1);s>0&&(i.family=s);var o=e.read_shift(1);switch(o>0&&(i.charset=o),e.l++,i.color=function(e){var t={},n=e.read_shift(1)>>>1,i=e.read_shift(1),r=e.read_shift(2,"i"),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=sF[i];c&&(t.rgb=HI(c));break;case 2:t.rgb=HI([a,s,o]);break;case 3:t.theme=i}return 0!=r&&(t.tint=r>0?r/32767:r/32768),t}(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor"}return i.name=LU(e),i}},44:{f:function(e,t){return[e.read_shift(2),LU(e)]}},45:{f:aR},46:{f:sR},47:{f:function(e,t){var n=e.l+t,i=e.read_shift(2),r=e.read_shift(2);return e.l=n,{ixfe:i,numFmtId:r}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uI},62:{f:function(e){return[zU(e),BU(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=UU(n);var i=e.read_shift(1);return 2&i&&(t.l="1"),8&i&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:bU,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},i=e[e.l];return++e.l,n.above=!(64&i),n.left=!(128&i),e.l+=18,n.name=VU(e),n}},148:{f:SN,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},i=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var r=t>8?LU(e):"";return r.length>0&&(n.CodeName=r),n.autoCompressPictures=!!(65536&i),n.backupFile=!!(64&i),n.checkCompatibility=!!(4096&i),n.date1904=!!(1&i),n.filterPrivacy=!!(8&i),n.hidePivotFieldList=!!(1024&i),n.promptedSolutions=!!(16&i),n.publishItems=!!(2048&i),n.refreshAllConnections=!!(262144&i),n.saveExternalLinkValues=!!(128&i),n.showBorderUnselectedTables=!!(4&i),n.showInkAnnotation=!!(32&i),n.showObjects=["all","placeholders","none"][i>>13&3],n.showPivotChartFilter=!!(32768&i),n.updateLinks=["userSet","never","always"][i>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=qU(e),n.name=LU(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:YU},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:UN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:LU(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qU},357:{},358:{},359:{},360:{T:1},361:{},362:{f:lI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var i=e.l+t,r=KU(e),a=e.read_shift(1),s=[r];if(s[2]=a,n.cellFormula){var o=nN(e,i-e.l,n);s[1]=o}else e.l=i;return s}},427:{f:function(e,t,n){var i=e.l+t,r=[YU(e)];if(n.cellFormula){var a=aN(e,i-e.l,n);r[1]=a,e.l=i}else e.l=i;return r}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return FN.forEach(function(n){t[n]=ZU(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,i=YU(e),r=GU(e),a=LU(e),s=LU(e),o=LU(e);e.l=n;var c={rfx:i,relId:r,loc:a,display:o};return s&&(c.Tooltip=s),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qU},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yR},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=YU(e);return t.rfx=n.s,t.ref=UU(n.s),e.l+=16,t}},636:{T:-1},637:{f:jU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:LU(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sM={6:{f:eN},10:{f:RF},12:{f:MF},13:{f:MF},14:{f:NF},15:{f:NF},16:{f:ZU},17:{f:NF},18:{f:NF},19:{f:MF},20:{f:aI},21:{f:aI},23:{f:lI},24:{f:cI},25:{f:NF},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var i=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=jF(e,0,n);return n.biff<8&&e.read_shift(1),[{r:i,c:r},o,s,a]}}(e,0,n)}},29:{},34:{f:NF},35:{f:sI},38:{f:ZU},39:{f:ZU},40:{f:ZU},41:{f:ZU},42:{f:NF},43:{f:NF},47:{f:function(e,t,n){var i={Type:n.biff>=8?e.read_shift(2):0};return i.Type?function(e,t,n){var i=n||{};i.Info=e.read_shift(2),e.l-=2,1===i.Info?i.Data=function(e){var t={},n=t.EncryptionVersionInfo=RI(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):i.Data=function(e,t){var n={},i=n.EncryptionVersionInfo=RI(e,4);if(t-=4,2!=i.Minor)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);n.Flags=e.read_shift(4),t-=4;var r=e.read_shift(4);return t-=4,n.EncryptionHeader=MI(e,r),t-=r,n.EncryptionVerifier=OI(e,t),n}(e,t)}(e,t-2,i):jI(e,n.biff,n,i),i}},49:{f:function(e,t,n){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return i.name=PF(e,0,n),i}},51:{f:MF},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:NF},65:{f:function(){}},66:{f:MF},77:{},80:{},81:{},82:{},85:{f:MF},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var i=e.l,r=jF(e,0,n);return e.read_shift(t+i-e.l),r}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var i=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((dI[i]||bU)(e,t,n)),{cmo:[r,i,a],ft:s}}(e,t,n);var i=ZF(e),r=function(e,t){for(var n=e.l+t,i=[];e.l<n;){var r=e.read_shift(2);e.l-=2;try{i.push(QF[r](e,n-e.l))}catch(a){return e.l=n,i}}return e.l!=n&&(e.l=n),i}(e,t-22,i[1]);return{cmo:i,ft:r}}},94:{},95:{f:NF},96:{},97:{},99:{f:NF},125:{f:uI},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var i=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&i,fBelow:64&i,fRight:128&i}}},130:{f:MF},131:{f:NF},132:{f:NF},133:{f:function(e,t,n){var i=e.read_shift(4),r=3&e.read_shift(1),a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule"}var s=PF(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:i,hs:r,dt:a,name:s}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=iF[t]||t,t=e.read_shift(2),n[1]=iF[t]||t,n}},141:{f:MF},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(VF(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:MF},157:{},158:{},160:{f:pI},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=ZU(e),n.footer=ZU(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,i=e.read_shift(2),r=e.read_shift(2),a=[];e.l<n;)a.push(qF(e));if(e.l!==n)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-r+1)throw new Error("MulRK length mismatch");return{r:i,c:r,C:s,rkrec:a}}},190:{f:function(e,t){for(var n=e.l+t-2,i=e.read_shift(2),r=e.read_shift(2),a=[];e.l<n;)a.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-r+1)throw new Error("MulBlank length mismatch");return{r:i,c:r,C:s,ixfe:a}}},193:{f:RF},197:{},198:{},199:{},200:{},201:{},202:{f:NF},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:MF},220:{},221:{f:NF},222:{},224:{f:function(e,t,n){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,i.data=function(e,t,n,i){var r={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return r.patternType=rF[o>>26],i.cellStyles?(r.alc=7&a,r.fWrap=a>>3&1,r.alcV=a>>4&7,r.fJustLast=a>>7&1,r.trot=a>>8&255,r.cIndent=a>>16&15,r.fShrinkToFit=a>>20&1,r.iReadOrder=a>>22&2,r.fAtrNum=a>>26&1,r.fAtrFnt=a>>27&1,r.fAtrAlc=a>>28&1,r.fAtrBdr=a>>29&1,r.fAtrPat=a>>30&1,r.fAtrProt=a>>31&1,r.dgLeft=15&s,r.dgRight=s>>4&15,r.dgTop=s>>8&15,r.dgBottom=s>>12&15,r.icvLeft=s>>16&127,r.icvRight=s>>23&127,r.grbitDiag=s>>30&3,r.icvTop=127&o,r.icvBottom=o>>7&127,r.icvDiag=o>>14&127,r.dgDiag=o>>21&15,r.icvFore=127&c,r.icvBack=c>>7&127,r.fsxButton=c>>14&1,r):r}(e,0,i.fStyle,n),i}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:RF},227:{},229:{f:function(e,t){for(var n=[],i=e.read_shift(2);i--;)n.push(XF(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,i=e.read_shift(4),r=e.read_shift(4),a=[],s=0;s!=r&&e.l<n;++s)a.push(LF(e));return a.Count=i,a.Unique=r,a}},253:{f:function(e){var t=GF(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:OF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:NF},353:{f:RF},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var i=e.l+t,r=e.read_shift(2),a=e.read_shift(2);if(n.sbcch=a,1025==a||14849==a)return[a,r];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=WF(e,a),o=[];i>e.l;)o.push(BF(e));return[a,r,s,o]}},431:{f:NF},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var i=e.l,r="";try{e.l+=4;var a=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(a)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);e.l+=2}(e);var s=e.read_shift(2);e.read_shift(2),MF(e);var o=e.read_shift(2);e.l+=o;for(var c=1;c<e.lens.length-1;++c){if(e.l-i!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l];if((r+=WF(e,e.lens[c+1]-e.lens[c]-1)).length>=(l?s:2*s))break}if(r.length!==s&&r.length!==2*s)throw new Error("cchText: "+s+" != "+r.length);return e.l=i+t,{t:r}}catch(h){return e.l=i+t,{t:r}}}},439:{f:NF},440:{f:function(e,t){var n=XF(e);e.l+=16;var i=function(e,t){var n=e.l+t,i=e.read_shift(4);if(2!==i)throw new Error("Unrecognized streamVersion: "+i);var r=e.read_shift(2);e.l+=2;var a,s,o,c,l,h,d="";16&r&&(a=zF(e,e.l)),128&r&&(s=zF(e,e.l)),257&~r||(o=zF(e,e.l)),1==(257&r)&&(c=function(e){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,i=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(i=!0),e.l=n);var r=e.read_shift((i?t-24:t)>>1,"utf16le").replace(Nk,"");return i&&(e.l+=24),r}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+i.replace(/\\/g,"/");var r=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(r>>1,"utf16le").replace(Nk,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}(e,e.l)),8&r&&(d=zF(e,e.l)),32&r&&(l=e.read_shift(16)),64&r&&(h=_F(e)),e.l=n;var u=s||o||c||"";u&&d&&(u+="#"+d),u||(u="#"+d),2&r&&"/"==u.charAt(0)&&"/"!=u.charAt(1)&&(u="file://"+u);var f={Target:u};return l&&(f.guid=l),h&&(f.time=h),a&&(f.Tooltip=a),f}(e,t-24);return[n,i]}},441:{},442:{f:BF},443:{},444:{f:MF},445:{},446:{},448:{f:RF},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:RF},512:{f:iI},513:{f:fI},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var i=GF(e),r=ZU(e);return i.val=r,i}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var i=GF(e);2==n.biff&&e.l++;var r=BF(e,e.l,n);return i.val=r,i}},517:{f:rI},519:{f:gI},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,7&i&&(t.level=7&i),32&i&&(t.hidden=!0),64&i&&(t.hpt=n/20),t}},523:{},545:{f:hI},549:{f:tI},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),i=qF(e);return{r:t,c:n,ixfe:i[0],rknum:i[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),jF(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var i=KF(e);e.l++;var r=e.read_shift(1);return[QR(e,t-=8,n),r,i]}},2048:{f:function(e,t){e.read_shift(2);var n=XF(e),i=e.read_shift((t-10)/2,"dbcs-cont");return[n,i=i.replace(Nk,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:eI},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:RF},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),r=[];i-- >0;)r.push(mR(e,e.l));return{ixfe:n,ext:r}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:NF,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var i=e.read_shift(2),r=e.read_shift(2);return[WF(e,i,n),WF(e,r,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var i=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var r,a=e.slice(e.l);e.l=i;try{r=nC(a,{type:"array"})}catch(o){return}var s=eC(r,"theme/theme/theme1.xml",!0);if(s)return gR(s,n)}else e.l=i},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:RF},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:MF},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var i={area:!1};if(5!=n.biff)return e.l+=t,i;var r=e.read_shift(1);return e.l+=3,16&r&&(i.area=!0),i}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(VF(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:iI},1:{},2:{f:function(e){var t=GF(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=GF(e);++e.l;var n=ZU(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var i=GF(e);++e.l;var r=jF(e,0,n);return i.t="str",i.val=r,i}},5:{f:rI},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:eI},11:{},22:{f:MF},30:{f:nI},31:{},32:{},33:{f:hI},36:{},37:{f:tI},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:MF},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(4),r={fmt:t,env:n,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,r}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var i=e.l+t,r=GF(e),a=e.read_shift(2),s=WF(e,a,n);return e.l=i,r.t="str",r.val=s,r}},223:{},234:{},354:{},421:{},518:{f:eN},521:{f:eI},536:{f:cI},547:{f:sI},561:{},579:{},1030:{f:eN},1033:{f:eI},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oM(e,t,n,i){var r=t;if(!isNaN(r)){var a=(n||[]).length||0,s=e.next(4);s.write_shift(2,r),s.write_shift(2,a),a>0&&iU(n)&&e.push(n)}}function cM(e,t){var n=t||{},i=n.dense?[]:{},r=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=r.index,o=a&&a.index||e.length,c=XS(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,h=0,d=0,u=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<c.length;++s){var g=c[s].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var b=g.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var v=b[o].trim();if(v.match(/<t[dh]/i)){for(var y=v,w=0;"<"==y.charAt(0)&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var x=0;x<p.length;++x){var _=p[x];_.s.c==h&&_.s.r<l&&l<=_.e.r&&(h=_.e.c+1,x=-1)}var T=hC(v.slice(0,v.indexOf(">")));u=T.colspan?+T.colspan:1,((d=+T.rowspan)>1||u>1)&&p.push({s:{r:l,c:h},e:{r:l+(d||1)-1,c:h+u-1}});var D=T.t||T["data-t"]||"";if(y.length)if(y=kC(y),f.s.r>l&&(f.s.r=l),f.e.r<l&&(f.e.r=l),f.s.c>h&&(f.s.c=h),f.e.c<h&&(f.e.c=h),y.length){var E={t:"s",v:y};n.raw||!y.trim().length||"s"==D||("TRUE"===y?E={t:"b",v:!0}:"FALSE"===y?E={t:"b",v:!1}:isNaN(GS(y))?isNaN(qS(y).getDate())||(E={t:"d",v:jS(y)},n.cellDates||(E={t:"n",v:IS(E.v)}),E.z=n.dateNF||Gk[14]):E={t:"n",v:GS(y)}),n.dense?(i[l]||(i[l]=[]),i[l][h]=E):i[UU({r:l,c:h})]=E,h+=u}else h+=u;else h+=u}}}}else{if(++l,n.sheetRows&&n.sheetRows<=l){--l;break}h=0}}return i["!ref"]=IU(f),p.length&&(i["!merges"]=p),i}function lM(e,t,n,i){for(var r=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,l=0;l<r.length;++l)if(!(r[l].s.r>n||r[l].s.c>s||r[l].e.r<n||r[l].e.c<s)){if(r[l].s.r<n||r[l].s.c<s){o=-1;break}o=r[l].e.r-r[l].s.r+1,c=r[l].e.c-r[l].s.c+1;break}if(!(o<0)){var h=UU({r:n,c:s}),d=i.dense?(e[n]||[])[s]:e[h],u=d&&null!=d.v&&(d.h||bC(d.w||(NU(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),c>1&&(f.colspan=c),i.editable?u='<span contenteditable="true">'+u+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(u='<a href="'+d.l.Target+'">'+u+"</a>")),f.id=(i.id||"sjs")+"-"+h,a.push(RC("td",u,f))}}return"<tr>"+a.join("")+"</tr>"}function hM(e,t,n){var i=n||{},r=0,a=0;if(null!=i.origin)if("number"==typeof i.origin)r=i.origin;else{var s="string"==typeof i.origin?CU(i.origin):i.origin;r=s.r,a=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(i.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:r,c:a}};if(e["!ref"]){var h=FU(e["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),-1==r&&(l.e.r=r=h.e.r+1)}var d=[],u=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,b=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var w=o[p];if(uM(w)){if(i.display)continue;f[g]={hidden:!0}}var x=w.children;for(m=b=0;m<x.length;++m){var _=x[m];if(!i.display||!uM(_)){var T=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):kC(_.innerHTML),D=_.getAttribute("data-z")||_.getAttribute("z");for(u=0;u<d.length;++u){var E=d[u];E.s.c==b+a&&E.s.r<g+r&&g+r<=E.e.r&&(b=E.e.c+1-a,u=-1)}y=+_.getAttribute("colspan")||1,((v=+_.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:g+r,c:b+a},e:{r:g+r+(v||1)-1,c:b+a+(y||1)-1}});var A={t:"s",v:T},k=_.getAttribute("data-t")||_.getAttribute("t")||"";null!=T&&(0==T.length?A.t=k||"z":i.raw||0==T.trim().length||"s"==k||("TRUE"===T?A={t:"b",v:!0}:"FALSE"===T?A={t:"b",v:!1}:isNaN(GS(T))?isNaN(qS(T).getDate())||(A={t:"d",v:jS(T)},i.cellDates||(A={t:"n",v:IS(A.v)}),A.z=i.dateNF||Gk[14]):A={t:"n",v:GS(T)})),void 0===A.z&&null!=D&&(A.z=D);var S="",C=_.getElementsByTagName("A");if(C&&C.length)for(var U=0;U<C.length&&(!C[U].hasAttribute("href")||"#"==(S=C[U].getAttribute("href")).charAt(0));++U);S&&"#"!=S.charAt(0)&&(A.l={Target:S}),i.dense?(e[g+r]||(e[g+r]=[]),e[g+r][b+a]=A):e[UU({c:b+a,r:g+r})]=A,l.e.c<b+a&&(l.e.c=b+a),b+=y}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,g-1+r),e["!ref"]=IU(l),g>=c&&(e["!fullref"]=IU((l.e.r=o.length-p+g-1+r,l))),e}function dM(e,t){return hM((t||{}).dense?[]:{},e,t)}function uM(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function fM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[pC(t.replace(/<[^>]*>/g,""))]}var pM={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gM(e,t){var n,i,r,a,s,o,c=t||{},l=NC(e),h=[],d={name:""},u="",f=0,p={},g=[],m=c.dense?[]:{},b={value:""},v="",y=0,w=[],x=-1,_=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,E={},A=[],k={},S=[],C=1,U=1,F=[],I={Names:[]},R={},N=["",""],M=[],O={},P="",L=0,W=!1,B=!1,j=0;for(MC.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");s=MC.exec(l);)switch(s[3]=s[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===s[1]?(T.e.c>=T.s.c&&T.e.r>=T.s.r?m["!ref"]=IU(T):m["!ref"]="A1:A1",c.sheetRows>0&&c.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=c.sheetRows-1,m["!ref"]=IU(T)),A.length&&(m["!merges"]=A),S.length&&(m["!rows"]=S),r.name=r["名称"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),g.push(r.name),p[r.name]=m,B=!1):"/"!==s[0].charAt(s[0].length-2)&&(r=hC(s[0],!1),x=_=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,m=c.dense?[]:{},A=[],S=[],B=!0);break;case"table-row-group":"/"===s[1]?--D:++D;break;case"table-row":case"行":if("/"===s[1]){x+=C,C=1;break}if((a=hC(s[0],!1))["行号"]?x=a["行号"]-1:-1==x&&(x=0),(C=+a["number-rows-repeated"]||1)<10)for(j=0;j<C;++j)D>0&&(S[x+j]={level:D});_=-1;break;case"covered-table-cell":"/"!==s[1]&&++_,c.sheetStubs&&(c.dense?(m[x]||(m[x]=[]),m[x][_]={t:"z"}):m[UU({r:x,c:_})]={t:"z"}),v="",w=[];break;case"table-cell":case"数据":if("/"===s[0].charAt(s[0].length-2))++_,b=hC(s[0],!1),U=parseInt(b["number-columns-repeated"]||"1",10),o={t:"z",v:null},b.formula&&0!=c.cellFormula&&(o.f=lN(pC(b.formula))),"string"==(b["数据类型"]||b["value-type"])&&(o.t="s",o.v=pC(b["string-value"]||""),c.dense?(m[x]||(m[x]=[]),m[x][_]=o):m[UU({r:x,c:_})]=o),_+=U-1;else if("/"!==s[1]){v="",y=0,w=[],U=1;var z=C?x+C-1:x;if(++_>T.e.c&&(T.e.c=_),_<T.s.c&&(T.s.c=_),x<T.s.r&&(T.s.r=x),z>T.e.r&&(T.e.r=z),M=[],O={},o={t:(b=hC(s[0],!1))["数据类型"]||b["value-type"],v:null},c.cellFormula)if(b.formula&&(b.formula=pC(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(k={s:{r:x,c:_},e:{r:x+(parseInt(b["number-matrix-rows-spanned"],10)||0)-1,c:_+(parseInt(b["number-matrix-columns-spanned"],10)||0)-1}},o.F=IU(k),F.push([k,o.F])),b.formula)o.f=lN(b.formula);else for(j=0;j<F.length;++j)x>=F[j][0].s.r&&x<=F[j][0].e.r&&_>=F[j][0].s.c&&_<=F[j][0].e.c&&(o.F=F[j][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(k={s:{r:x,c:_},e:{r:x+(parseInt(b["number-rows-spanned"],10)||0)-1,c:_+(parseInt(b["number-columns-spanned"],10)||0)-1}},A.push(k)),b["number-columns-repeated"]&&(U=parseInt(b["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=yC(b["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(b.value);break;case"date":o.t="d",o.v=jS(b["date-value"]),c.cellDates||(o.t="n",o.v=IS(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=PS(b["time-value"])/86400,c.cellDates&&(o.t="d",o.v=OS(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(b["数据数值"]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=b["string-value"]&&(v=pC(b["string-value"]),w=[])}}else{if(W=!1,"s"===o.t&&(o.v=v||"",w.length&&(o.R=w),W=0==y),R.Target&&(o.l=R),M.length>0&&(o.c=M,M=[]),v&&!1!==c.cellText&&(o.w=v),W&&(o.t="z",delete o.v),(!W||c.sheetStubs)&&!(c.sheetRows&&c.sheetRows<=x))for(var H=0;H<C;++H){if(U=parseInt(b["number-columns-repeated"]||"1",10),c.dense)for(m[x+H]||(m[x+H]=[]),m[x+H][_]=0==H?o:HS(o);--U>0;)m[x+H][_+U]=HS(o);else for(m[UU({r:x+H,c:_})]=o;--U>0;)m[UU({r:x+H,c:_+U})]=HS(o);T.e.c<=_&&(T.e.c=_)}_+=(U=parseInt(b["number-columns-repeated"]||"1",10))-1,U=0,o={},v="",w=[]}R={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===s[1]){if((n=h.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&h.push([s[3],!0]);break;case"annotation":if("/"===s[1]){if((n=h.pop())[0]!==s[3])throw"Bad state: "+n;O.t=v,w.length&&(O.R=w),O.a=P,M.push(O)}else"/"!==s[0].charAt(s[0].length-2)&&h.push([s[3],!1]);P="",L=0,v="",y=0,w=[];break;case"creator":"/"===s[1]?P=l.slice(L,s.index):L=s.index+s[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===s[1]){if((n=h.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&h.push([s[3],!1]);v="",y=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===s[1]){if(E[d.name]=u,(n=h.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&(u="",d=hC(s[0],!1),h.push([s[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(h[h.length-1][0]){case"time-style":case"date-style":i=hC(s[0],!1),u+=pM[s[3]]["long"===i.style?1:0]}break;case"text":if("/>"===s[0].slice(-2))break;if("/"===s[1])switch(h[h.length-1][0]){case"number-style":case"date-style":case"time-style":u+=l.slice(f,s.index)}else f=s.index+s[0].length;break;case"named-range":N=hN((i=hC(s[0],!1))["cell-range-address"]);var V={Name:i.name,Ref:N[0]+"!"+N[1]};B&&(V.Sheet=g.length),I.Names.push(V);break;case"p":case"文本串":if(["master-styles"].indexOf(h[h.length-1][0])>-1)break;if("/"!==s[1]||b&&b["string-value"])hC(s[0],!1),y=s.index+s[0].length;else{var G=fM(l.slice(y,s.index));v=(v.length>0?v+"\n":"")+G[0]}break;case"database-range":if("/"===s[1])break;try{p[(N=hN(hC(s[0])["target-range-address"]))[0]]["!autofilter"]={ref:N[1]}}catch(q){}break;case"a":if("/"!==s[1]){if(!(R=hC(s[0],!1)).href)break;R.Target=pC(R.href),delete R.href,"#"==R.Target.charAt(0)&&R.Target.indexOf(".")>-1?(N=hN(R.Target.slice(1)),R.Target="#"+N[0]+"!"+N[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;default:switch(s[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(c.WTF)throw new Error(s)}}var $={Sheets:p,SheetNames:g,Workbook:I};return c.bookSheets&&delete $.Sheets,$}function mM(e,t){t=t||{},ZS(e,"META-INF/manifest.xml")&&function(e,t){for(var n,i,r=NC(e);n=MC.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(i=hC(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==i.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(QS(e,"META-INF/manifest.xml"),t);var n=eC(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var i=gM(DC(n),t);return ZS(e,"meta.xml")&&(i.Props=gF(QS(e,"meta.xml"))),i}function bM(e,t){return gM(e,t)}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function vM(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yM(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):DC(Fk(e))}function wM(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),i=0;return e.forEach(function(e){n.set(e,i),i+=e.length}),n}function xM(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function _M(e,t){var n=t?t[0]:0,i=127&e[n];e:if(e[n++]>=128){if(i|=(127&e[n])<<7,e[n++]<128)break e;if(i|=(127&e[n])<<14,e[n++]<128)break e;if(i|=(127&e[n])<<21,e[n++]<128)break e;if(i+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(i+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(i+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),i}function TM(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function DM(e){for(var t=[],n=[0];n[0]<e.length;){var i,r=n[0],a=_M(e,n),s=7&a,o=0;if(0==(a=Math.floor(a/8)))break;switch(s){case 0:for(var c=n[0];e[n[0]++]>=128;);i=e.slice(c,n[0]);break;case 5:o=4,i=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,i=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=_M(e,n),i=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(r))}var l={data:i,type:s};null==t[a]?t[a]=[l]:t[a].push(l)}return t}function EM(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function AM(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],i=_M(t,n),r=[];n[0]<t.length;){var a=3&t[n[0]];if(0!=a){var s=0,o=0;if(1==a?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==a?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),r=[wM(r)],0==s)throw new Error("Invalid offset 0");if(s>r[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(r.push(r[0].slice(-s)),o-=s;o>=r[r.length-1].length;)r.push(r[r.length-1]),o-=r[r.length-1].length;r.push(r[0].slice(-s,-s+o))}else{var c=t[n[0]++]>>2;if(c<60)++c;else{var l=c-59;c=t[n[0]],l>1&&(c|=t[n[0]+1]<<8),l>2&&(c|=t[n[0]+2]<<16),l>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=l}r.push(t.slice(n[0],n[0]+c)),n[0]+=c}}var h=wM(r);if(h.length!=i)throw new Error("Unexpected length: ".concat(h.length," != ").concat(i));return h}function kM(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,i){var r,a=vM(e),s=a.getUint32(4,!0),o=(i>1?12:8)+4*xM(s&(i>1?3470:398)),c=-1,l=-1,h=NaN,d=new Date(2001,0,1);switch(512&s&&(c=a.getUint32(o,!0),o+=4),o+=4*xM(s&(i>1?12288:4096)),16&s&&(l=a.getUint32(o,!0),o+=4),32&s&&(h=a.getFloat64(o,!0),o+=8),64&s&&(d.setTime(d.getTime()+1e3*a.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:r={t:"n",v:h};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:h>0};break;case 7:r={t:"n",v:h/86400};break;case 8:r={t:"e",v:0};break;case 9:if(c>-1)r={t:"s",v:n[c]};else if(l>-1)r={t:"s",v:t[l]};else{if(isNaN(h))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));r={t:"n",v:h}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return r}(e,t,n,e[0]);case 5:return function(e,t,n){var i,r=vM(e),a=r.getUint32(8,!0),s=12,o=-1,c=-1,l=NaN,h=NaN,d=new Date(2001,0,1);switch(1&a&&(l=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,i=1&e[t+14],r=t+13;r>=t;--r)i=256*i+e[r];return(128&e[t+15]?-i:i)*Math.pow(10,n-6176)}(e,s),s+=16),2&a&&(h=r.getFloat64(s,!0),s+=8),4&a&&(d.setTime(d.getTime()+1e3*r.getFloat64(s,!0)),s+=8),8&a&&(c=r.getUint32(s,!0),s+=4),16&a&&(o=r.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:i={t:"n",v:l};break;case 3:i={t:"s",v:t[c]};break;case 5:i={t:"d",v:d};break;case 6:i={t:"b",v:h>0};break;case 7:i={t:"n",v:h/86400};break;case 8:i={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&a," : ").concat(e.slice(0,4)));i={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&a," : ").concat(e.slice(0,4)))}return i}(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function SM(e){return _M(DM(e)[1][0].data)}function CM(e,t){var n=DM(t.data),i=TM(n[1][0].data),r=n[3],a=[];return(r||[]).forEach(function(t){var n=DM(t.data),r=TM(n[1][0].data)>>>0;switch(i){case 1:a[r]=yM(n[3][0].data);break;case 8:var s=DM(e[SM(n[9][0].data)][0].data),o=e[SM(s[1][0].data)][0],c=TM(o.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var l=DM(o.data);a[r]=l[3].map(function(e){return yM(e.data)}).join("")}}),a}function UM(e,t){var n={"!ref":"A1"},i=e[SM(DM(t.data)[2][0].data)],r=TM(i[0].meta[1][0].data);if(6001!=r)throw new Error("6000 unexpected reference to ".concat(r));return function(e,t,n){var i,r=DM(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(TM(r[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(a.e.c=(TM(r[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));n["!ref"]=IU(a);var s=DM(r[4][0].data),o=CM(e,e[SM(s[4][0].data)][0]),c=(null==(i=s[17])?void 0:i[0])?CM(e,e[SM(s[17][0].data)][0]):[],l=DM(s[3][0].data),h=0;l[1].forEach(function(t){var i=DM(t.data),r=e[SM(i[2][0].data)][0],a=TM(r.meta[1][0].data);if(6002!=a)throw new Error("6001 unexpected reference to ".concat(a));var s=function(e,t){var n,i=DM(t.data),r=(null==(n=null==i?void 0:i[7])?void 0:n[0])?TM(i[7][0].data)>>>0>0?1:0:-1,a=EM(i[5],function(e){return function(e,t){var n,i,r,a,s,o,c,l,h,d,u,f,p,g,m,b,v=DM(e),y=TM(v[1][0].data)>>>0,w=TM(v[2][0].data)>>>0,x=(null==(i=null==(n=v[8])?void 0:n[0])?void 0:i.data)&&TM(v[8][0].data)>0||!1;if((null==(a=null==(r=v[7])?void 0:r[0])?void 0:a.data)&&0!=t)m=null==(o=null==(s=v[7])?void 0:s[0])?void 0:o.data,b=null==(l=null==(c=v[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(d=null==(h=v[4])?void 0:h[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(u=v[4])?void 0:u[0])?void 0:f.data,b=null==(g=null==(p=v[3])?void 0:p[0])?void 0:g.data}for(var _=x?4:1,T=vM(m),D=[],E=0;E<m.length/2;++E){var A=T.getUint16(2*E,!0);A<65535&&D.push([E,A])}if(D.length!=w)throw"Expected ".concat(w," cells, found ").concat(D.length);var k=[];for(E=0;E<D.length-1;++E)k[D[E][0]]=b.subarray(D[E][1]*_,D[E+1][1]*_);return D.length>=1&&(k[D[D.length-1][0]]=b.subarray(D[D.length-1][1]*_)),{R:y,cells:k}}(e,r)});return{nrows:TM(i[4][0].data)>>>0,data:a.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(n,i){if(e[t.R][i])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(i));e[t.R][i]=n}),e},[])}}(0,r);s.data.forEach(function(e,t){e.forEach(function(e,i){var r=UU({r:h+t,c:i}),a=kM(e,o,c);a&&(n[r]=a)})}),h+=s.nrows})}(e,i[0],n),n}function FM(e){var t,n,i,r,a={},s=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=function(e){for(var t=[],n=0;n<e.length;){var i=e[n++],r=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(AM(i,e.slice(n,n+r))),n+=r}if(n!==e.length)throw new Error("data is not a valid framed stream!");return wM(t)}(e.content)}catch(i){return}try{n=function(e){for(var t,n=[],i=[0];i[0]<e.length;){var r=_M(e,i),a=DM(e.slice(i[0],i[0]+r));i[0]+=r;var s={id:TM(a[1][0].data),messages:[]};a[2].forEach(function(t){var n=DM(t.data),r=TM(n[3][0].data);s.messages.push({meta:n,data:e.slice(i[0],i[0]+r)}),i[0]+=r}),(null==(t=a[3])?void 0:t[0])&&(s.merge=TM(a[3][0].data)>>>0>0),n.push(s)}return n}(t)}catch(i){return}n.forEach(function(e){a[e.id]=e.messages,s.push(e.id)})}}),!s.length)throw new Error("File has no messages");var o=(null==(r=null==(i=null==(n=null==(t=null==a?void 0:a[1])?void 0:t[0])?void 0:n.meta)?void 0:i[1])?void 0:r[0].data)&&1==TM(a[1][0].meta[1][0].data)&&a[1][0];if(o||s.forEach(function(e){a[e].forEach(function(e){if(1==TM(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return function(e,t){var n={SheetNames:[],Sheets:{}};if(EM(DM(t.data)[1],SM).forEach(function(t){e[t].forEach(function(t){if(2==TM(t.meta[1][0].data)){var i=function(e,t){var n,i=DM(t.data),r={name:(null==(n=i[1])?void 0:n[0])?yM(i[1][0].data):"",sheets:[]};return EM(i[2],SM).forEach(function(t){e[t].forEach(function(t){6e3==TM(t.meta[1][0].data)&&r.sheets.push(UM(e,t))})}),r}(e,t);i.sheets.forEach(function(e,t){XM(n,e,0==t?i.name:i.name+"_"+t,!0)})}})}),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}(a,o)}function IM(e){var t;(t=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var n=0;n!=t.length;++n){var i=t[n];void 0===e[i[0]]&&(e[i[0]]=i[1]),"n"===i[2]&&(e[i[0]]=Number(e[i[0]]))}})(e)}function RM(e,t,n,i,r,a,s,o,c,l,h,d){try{a[i]=uF(eC(e,n,!0),t);var u,f=QS(e,t);switch(o){case"sheet":u=zN(f,t,r,c,a[i],l,h,d);break;case"chart":if(!(u=function(e,t,n,i,r,a){return".bin"===t.slice(-4)?function(e,t,n,i,r){if(!e)return e;i||(i={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return yU(e,function(e,i,o){switch(o){case 550:a["!rel"]=e;break;case 651:r.Sheets[n]||(r.Sheets[n]={}),e.name&&(r.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T>0);else if(i.T<0);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},t),i["!id"][a["!rel"]]&&(a["!drawel"]=i["!id"][a["!rel"]]),a}(e,i,n,r,a):function(e,t,n,i,r){if(!e)return e;i||(i={"!id":{}});var a,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(_N);return o&&EN(o[0],0,r,n),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}(e,0,n,r,a)}(f,t,r,c,a[i],l))||!u["!drawel"])break;var p=iC(u["!drawel"].Target,t),g=dF(p),m=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(eC(e,p,!0),uF(eC(e,g,!0),p)),b=iC(m,p),v=dF(b);u=function(e,t,n,i,r,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,l="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,n=[],i=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=i?+t[2]:t[2])});var r=pC((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,r,t]}(e);h.s.r=h.s.c=0,h.e.c=o,l=SU(o),t[0].forEach(function(e,n){s[l+AU(n)]={t:"n",v:e,z:t[1]},c=n}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(s["!ref"]=IU(h)),s}(eC(e,b,!0),0,0,uF(eC(e,v,!0),b),0,u);break;case"macro":w=t,a[i],w.slice(-4),u={"!type":"macro"};break;case"dialog":u=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,a[i]);break;default:throw new Error("Unrecognized sheet type "+o)}s[i]=u;var y=[];a&&a[i]&&CS(a[i]).forEach(function(n){var r="";if(a[i][n].Type==hF.CMNT){r=iC(a[i][n].Target,t);var s=function(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],i=[],r={},a=!1;return yU(e,function(e,s,o){switch(o){case 632:i.push(e);break;case 635:r=e;break;case 637:r.t=e.t,r.h=e.h,r.r=e.r;break;case 636:if(r.author=i[r.iauthor],delete r.iauthor,t.sheetRows&&r.rfx&&t.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,n.push(r);break;case 3072:case 37:case 38:break;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T);else if(!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],i=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?comment[^>]*>/);if(r){var a=hC(r[0]),s={author:a.authorId&&n[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},o=CU(a.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&SI(c[1])||{r:"",t:"",h:""};s.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),s.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=l.h),i.push(s)}}}}),i}(e,n)}(QS(e,r,!0),r,c);if(!s||!s.length)return;vR(u,s,!1)}a[i][n].Type==hF.TCMNT&&(r=iC(a[i][n].Target,t),y=y.concat(function(e,t){var n=[],i=!1,r={},a=0;return e.replace(oC,function(s,o){var c=hC(s);switch(dC(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":r={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=r.t&&n.push(r);break;case"<text>":case"<text":a=o+s.length;break;case"</text>":r.t=e.slice(a,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":i=!0;break;case"</mentions>":case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return s}),n}(QS(e,r,!0),c)))}),y&&y.length&&vR(u,y,!0,c.people||[])}catch(x){if(c.WTF)throw x}var w}function NM(e){return"/"==e.charAt(0)?e.slice(1):e}function MM(e,t){if(DS(),IM(t=t||{}),ZS(e,"META-INF/manifest.xml"))return mM(e,t);if(ZS(e,"objectdata.xml"))return mM(e,t);if(ZS(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==FM){if(e.FileIndex)return FM(e);var n=SS.utils.cfb_new();return tC(e).forEach(function(t){!function(e,t,n){if(e.FullPaths){var i;if("string"==typeof n)return i=Ak?kk(n):function(e){for(var t=[],n=0,i=e.length+250,r=Sk(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)r[n++]=s;else if(s<2048)r[n++]=192|s>>6&31,r[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++a);r[n++]=240|s>>8&7,r[n++]=128|s>>2&63,r[n++]=128|o>>6&15|(3&s)<<4,r[n++]=128|63&o}else r[n++]=224|s>>12&15,r[n++]=128|s>>6&63,r[n++]=128|63&s;n>i&&(t.push(r.slice(0,n)),n=0,r=Sk(65535),i=65530)}return t.push(r.slice(0,n)),Rk(t)}(n),SS.utils.cfb_add(e,t,i);SS.utils.cfb_add(e,t,n)}else e.file(t,n)}(n,t,function(e,t){return YS(JS(e,t))}(e,t))}),FM(n)}throw new Error("Unsupported NUMBERS file")}if(!ZS(e,"[Content_Types].xml")){if(ZS(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(ZS(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var i,r,a=tC(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(oC)||[]).forEach(function(e){var i=hC(e);switch(i[0].replace(cC,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":void 0!==t[lF[i.ContentType]]&&t[lF[i.ContentType]].push(i.PartName)}}),"http://schemas.openxmlformats.org/package/2006/content-types"!==t.xmlns)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(eC(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&QS(e,r="xl/workbook.xml",!0)&&s.workbooks.push(r),0===s.workbooks.length){if(!QS(e,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(r),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(dN=[],s.sst)try{dN=function(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],i=!1;return yU(e,function(e,r,a){switch(a){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(r.T,!i||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}(e,n):function(e,t){var n=[],i="";if(!e)return n;var r=e.match(CI);if(r){i=r[2].replace(UI,"").split(FI);for(var a=0;a!=i.length;++a){var s=SI(i[a].trim(),t);null!=s&&(n[n.length]=s)}r=hC(r[1]),n.Count=r.count,n.Unique=r.uniqueCount}return n}(e,n)}(QS(e,NM(s.sst)),s.sst,t)}catch(F){if(t.WTF)throw F}t.cellStyles&&s.themes.length&&(c=function(e,t,n){return gR(e,n)}(eC(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(l=function(e,t,n,i){return".bin"===t.slice(-4)?function(e,t,n){var i={NumberFmt:[]};for(var r in Gk)i.NumberFmt[r]=Gk[r];i.CellXf=[],i.Fonts=[];var a=[],s=!1;return yU(e,function(e,r,o){switch(o){case 44:i.NumberFmt[e[0]]=e[1],TS(e[1],e[0]);break;case 43:i.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=VI(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==a[a.length-1]&&i.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(o),s=!0;break;case 38:a.pop(),s=!1;break;default:if(r.T>0)a.push(o);else if(r.T<0)a.pop();else if(!s||n.WTF&&37!=a[a.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),i}(e,n,i):rR(e,n,i)}(QS(e,NM(s.style)),s.style,c,t))}s.links.map(function(n){try{return uF(eC(e,dF(NM(n))),n),function(e,t,n,i){if(".bin"===n.slice(-4))return function(e,t,n,i){if(!e)return e;var r=i||{},a=!1;yU(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(t.T);else if(!a||r.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}},r)}(e,0,0,i)}(QS(e,NM(n)),0,n,t)}catch(F){}});var h=function(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],r=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],aM[16]={n:"BrtFRTArchID$",f:jN},yU(e,function(e,o,c){switch(c){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=ZR(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,a.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([c,e]):s[0]=[c,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:i.push(c),r=!0;break;case 36:case 38:i.pop(),r=!1;break;default:if(o.T);else if(!r||t.WTF&&37!=i[i.length-1]&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}},t),LN(n),n.Names=a,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,r="xmlns",a={},s=0;if(e.replace(oC,function(o,c){var l=hC(o);switch(dC(l[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(BN)&&(r="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=l[r];break;case"<fileVersion":delete l[0],n.AppVersion=l;break;case"<workbookPr":case"<workbookPr/>":IN.forEach(function(e){if(null!=l[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=yC(l[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:n.WBProps[e[0]]=l[e[0]]}}),l.codeName&&(n.WBProps.CodeName=DC(l.codeName));break;case"<workbookView":case"<workbookView/>":delete l[0],n.WBView.push(l);break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=pC(DC(l.name)),delete l[0],n.Sheets.push(l);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":i=!1;break;case"<definedName":(a={}).Name=DC(l.name),l.comment&&(a.Comment=l.comment),l.localSheetId&&(a.Sheet=+l.localSheetId),yC(l.hidden||"0")&&(a.Hidden=!0),s=c+o.length;break;case"</definedName>":a.Ref=pC(DC(e.slice(s,c))),n.Names.push(a);break;case"<calcPr":case"<calcPr/>":delete l[0],n.CalcPr=l;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return o}),-1===OC.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return LN(n),n}(e,n)}(QS(e,NM(s.workbooks[0])),s.workbooks[0],t),d={},u="";s.coreprops.length&&((u=QS(e,NM(s.coreprops[0]),!0))&&(d=gF(u)),0!==s.extprops.length&&(u=QS(e,NM(s.extprops[0]),!0))&&function(e,t,n){var i={};t||(t={}),e=DC(e),mF.forEach(function(n){var r=(e.match(AC(n[0]))||[])[1];switch(n[2]){case"string":r&&(t[n[1]]=pC(r));break;case"bool":t[n[1]]="true"===r;break;case"raw":var a=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(i[n[1]]=a[1])}}),i.HeadingPairs&&i.TitlesOfParts&&bF(i.HeadingPairs,i.TitlesOfParts,t,n)}(u,d,t));var f={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(u=eC(e,NM(s.custprops[0]),!0))&&(f=function(e,t){var n={},i="",r=e.match(yF);if(r)for(var a=0;a!=r.length;++a){var s=r[a],o=hC(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":i=pC(o.name);break;case"</property>":i=null;break;default:if(0===s.indexOf("<vt:")){var c=s.split(">"),l=c[0].slice(4),h=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[i]=pC(h);break;case"bool":n[i]=yC(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[i]=parseInt(h,10);break;case"r4":case"r8":case"decimal":n[i]=parseFloat(h);break;case"filetime":case"date":n[i]=jS(h);break;default:if("/"==l.slice(-1))break;t.WTF}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(u,t));var p={};if((t.bookSheets||t.bookProps)&&(h.Sheets?i=h.Sheets.map(function(e){return e.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&void 0!==i&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var g,m={};t.bookDeps&&s.calcchain&&(g=QS(e,NM(s.calcchain)),m=".bin"===s.calcchain.slice(-4)?function(e){var t=[];return yU(e,function(e,n,i){if(63===i)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+i.toString(16))}),t}(g):function(e){var t=[];if(!e)return t;var n=1;return(e.match(oC)||[]).forEach(function(e){var i=hC(e);switch(i[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,t.push(i)}}),t}(g));var b,v,y=0,w={},x=h.Sheets;d.Worksheets=x.length,d.SheetNames=[];for(var _=0;_!=x.length;++_)d.SheetNames[_]=x[_].name;var T=o?"bin":"xml",D=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,D+1)+"_rels/"+s.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");ZS(e,E)||(E="xl/_rels/workbook."+T+".rels");var A=uF(eC(e,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=function(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var i={Types:[],Cell:[],Value:[]},r=n||{},a=[],s=!1,o=2;return yU(e,function(e,t,n){switch(n){case 335:i.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?i.Cell.push({type:i.Types[e[0]-1].name,index:e[1]}):0==o&&i.Value.push({type:i.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:a.push(n),s=!0;break;case 36:a.pop(),s=!1;break;default:if(t.T);else if(!s||r.WTF&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}}),i}(e,0,n):function(e,t,n){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var r,a=!1,s=2;return e.replace(oC,function(e){var t=hC(e);switch(dC(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":i.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<i.Types.length;++o)i.Types[o].name==t.name&&(r=i.Types[o]);break;case"<rc":1==s?i.Cell.push({type:i.Types[t.t-1].name,index:+t.v}):0==s&&i.Value.push({type:i.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!r)break;r.offsets||(r.offsets=[]),r.offsets.push(+t.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),i}(e,0,n)}(QS(e,NM(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var n=[],i=!1;return e.replace(oC,function(e){var r=hC(e);switch(dC(r[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:r.displayname,id:r.id});break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),n}(QS(e,NM(s.people[0])),t)),A&&(A=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,hF.WS.indexOf(n)>-1?"sheet":n==hF.CS?"chart":n==hF.DS?"dialog":n==hF.MS?"macro":n&&n.length?n:"sheet")];var n})}catch(F){return null}return e&&0!==e.length?e:null}(A,h.Sheets));var k=QS(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var S="sheet";if(A&&A[y]?(b="xl/"+A[y][1].replace(/[\/]?xl\//,""),ZS(e,b)||(b=A[y][1]),ZS(e,b)||(b=E.replace(/_rels\/.*$/,"")+A[y][1]),S=A[y][2]):b=(b="xl/worksheets/sheet"+(y+1-k)+"."+T).replace(/sheet0\./,"sheet."),v=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,U=0;U!=t.sheets.length;++U)"number"==typeof t.sheets[U]&&t.sheets[U]==y&&(C=1),"string"==typeof t.sheets[U]&&t.sheets[U].toLowerCase()==d.SheetNames[y].toLowerCase()&&(C=1);if(!C)continue e}}RM(e,b,v,d.SheetNames[y],y,w,i,S,t,h,c,l)}return p={Directory:s,Workbook:h,Props:d,Custprops:f,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:dN,Styles:l,Themes:c,SSF:HS(Gk)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=QS(e,NM(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(p.vbaraw=QS(e,"xl/vbaProject.bin",!0))),p}function OM(e,t){var n,i,r=t||{},a="Workbook",s=SS.find(e,a);try{if(a="/!DataSpaces/Version",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(n=s.content,(i={}).id=n.read_shift(0,"lpp4"),i.R=RI(n,4),i.U=RI(n,4),i.W=RI(n,4),a="/!DataSpaces/DataSpaceMap",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(NI(e));return t}(s.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(s.content);if(1!=c.length||"StrongEncryptionTransform"!=c[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);!function(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=RI(e,4),t.U=RI(e,4),t.W=RI(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record")}(s.content)}catch(h){}if(a="/EncryptionInfo",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=function(e){var t=RI(e);switch(t.Minor){case 2:return[t.Minor,PI(e)];case 3:return[t.Minor,LI()];case 4:return[t.Minor,WI(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(s.content);if(a="/EncryptedPackage",!(s=SS.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==l[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(l[1],s.content,r.password||"",r);if(2==l[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function PM(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Ek(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function LM(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return QN(e.slice(n),t);default:break e}return xI.to_workbook(e,t)}function WM(e,t,n,i){return i?(n.type="string",xI.to_workbook(e,n)):xI.to_workbook(t,n)}function BM(e,t){mk();var n=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return BM(new Uint8Array(e),((n=HS(n)).type="array",n));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!=typeof Deno?"buffer":"array");var i,r=e,a=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),uN={},n.dateNF&&(uN.dateNF=n.dateNF),n.type||(n.type=Ak&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=Ak?"buffer":"binary",r=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||Ak||(n.type="array")),"string"==n.type&&(a=!0,n.type="binary",n.codepage=65001,r=function(e){return e.match(/[^\x00-\x7F]/)?EC(e):e}(e)),"array"==n.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(n=HS(n)).type="array",BM(Ik(r),n)}switch((i=PM(r,n))[0]){case 208:if(207===i[1]&&17===i[2]&&224===i[3]&&161===i[4]&&177===i[5]&&26===i[6]&&225===i[7])return function(e,t){return SS.find(e,"EncryptedPackage")?OM(e,t):rM(e,t)}(SS.read(r,n),n);break;case 9:if(i[1]<=8)return rM(r,n);break;case 60:return QN(r,n);case 73:if(73===i[1]&&42===i[2]&&0===i[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===i[1])return function(e,t){var n=t||{},i=!!n.WTF;n.WTF=!0;try{var r=vI.to_workbook(e,n);return n.WTF=i,r}catch(a){if(n.WTF=i,!a.message.match(/SYLK bad record ID/)&&i)throw a;return xI.to_workbook(e,t)}}(r,n);break;case 84:if(65===i[1]&&66===i[2]&&76===i[3])return yI.to_workbook(r,n);break;case 80:return 75===i[1]&&i[2]<9&&i[3]<9?function(e,t){var n=e,i=t||{};return i.type||(i.type=Ak&&Buffer.isBuffer(e)?"buffer":"base64"),MM(nC(n,i),i)}(r,n):WM(e,r,n,a);case 239:return 60===i[3]?QN(r,n):WM(e,r,n,a);case 255:if(254===i[1])return function(e,t){var n=e;return"base64"==t.type&&(n=Ek(n)),n=yk.utils.decode(1200,n.slice(2),"str"),t.type="binary",LM(n,t)}(r,n);if(0===i[1]&&2===i[2]&&0===i[3])return _I.to_workbook(r,n);break;case 0:if(0===i[1]){if(i[2]>=2&&0===i[3])return _I.to_workbook(r,n);if(0===i[2]&&(8===i[3]||9===i[3]))return _I.to_workbook(r,n)}break;case 3:case 131:case 139:case 140:return bI.to_workbook(r,n);case 123:if(92===i[1]&&114===i[2]&&116===i[3])return zI.to_workbook(r,n);break;case 10:case 13:case 32:return function(e,t){var n="",i=PM(e,t);switch(t.type){case"base64":n=Ek(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=zS(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==i[0]&&187==i[1]&&191==i[2]&&(n=DC(n)),t.type="binary",LM(n,t)}(r,n);case 137:if(80===i[1]&&78===i[2]&&71===i[3])throw new Error("PNG Image File is not a spreadsheet")}return mI.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?bI.to_workbook(r,n):WM(e,r,n,a)}function jM(e,t,n,i,r,a,s,o){var c=AU(n),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,u=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:n,enumerable:!1})}catch(m){u.__rowNum__=n}else u.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[i[f]+c];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=a[f]){if(null==g)if("e"==p.t&&null===g)u[a[f]]=null;else if(void 0!==l)u[a[f]]=l;else{if(!h||null!==g)continue;u[a[f]]=null}else u[a[f]]=h&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?g:NU(p,g,o);null!=g&&(d=!1)}}else{if(void 0===l)continue;null!=a[f]&&(u[a[f]]=l)}}return{row:u,isempty:d}}function zM(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},i=0,r=1,a=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},h=null!=l.range?l.range:e["!ref"];switch(1===l.header?i=1:"A"===l.header?i=2:Array.isArray(l.header)?i=3:null==l.header&&(i=0),typeof h){case"string":c=RU(h);break;case"number":(c=RU(e["!ref"])).s.r=h;break;default:c=h}i>0&&(r=0);var d=AU(c.s.r),u=[],f=[],p=0,g=0,m=Array.isArray(e),b=c.s.r,v=0,y={};m&&!e[b]&&(e[b]=[]);var w=l.skipHidden&&e["!cols"]||[],x=l.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(w[v]||{}).hidden)switch(u[v]=SU(v),n=m?e[b][v]:e[u[v]+d],i){case 1:a[v]=v-c.s.c;break;case 2:a[v]=u[v];break;case 3:a[v]=l.header[v-c.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=NU(n,null,l),g=y[s]||0){do{o=s+"_"+g++}while(y[o]);y[s]=g,y[o]=1}else y[s]=1;a[v]=o}for(b=c.s.r+r;b<=c.e.r;++b)if(!(x[b]||{}).hidden){var _=jM(e,c,b,u,i,a,m,l);(!1===_.isempty||(1===i?!1!==l.blankrows:l.blankrows))&&(f[p++]=_.row)}return f.length=p,f}var HM=/"/g;function VM(e,t,n,i,r,a,s,o){for(var c=!0,l=[],h="",d=AU(n),u=t.s.c;u<=t.e.c;++u)if(i[u]){var f=o.dense?(e[n]||[])[u]:e[i[u]+d];if(null==f)h="";else if(null!=f.v){c=!1,h=""+(o.rawNumbers&&"n"==f.t?f.v:NU(f,null,o));for(var p=0,g=0;p!==h.length;++p)if((g=h.charCodeAt(p))===r||g===a||34===g||o.forceQuotes){h='"'+h.replace(HM,'""')+'"';break}"ID"==h&&(h='"ID"')}else null==f.f||f.F?h="":(c=!1,(h="="+f.f).indexOf(",")>=0&&(h='"'+h.replace(HM,'""')+'"'));l.push(h)}return!1===o.blankrows&&c?null:l.join(s)}function GM(e,t){var n=[],i=null==t?{}:t;if(null==e||null==e["!ref"])return"";var r=RU(e["!ref"]),a=void 0!==i.FS?i.FS:",",s=a.charCodeAt(0),o=void 0!==i.RS?i.RS:"\n",c=o.charCodeAt(0),l=new RegExp(("|"==a?"\\|":a)+"+$"),h="",d=[];i.dense=Array.isArray(e);for(var u=i.skipHidden&&e["!cols"]||[],f=i.skipHidden&&e["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(u[p]||{}).hidden||(d[p]=SU(p));for(var g=0,m=r.s.r;m<=r.e.r;++m)(f[m]||{}).hidden||null!=(h=VM(e,r,m,d,s,c,a,i))&&(i.strip&&(h=h.replace(l,"")),(h||!1!==i.blankrows)&&n.push((g++?o:"")+h));return delete i.dense,n.join("")}function $M(e,t,n){var i,r=n||{},a=+!r.skipHeader,s=e||{},o=0,c=0;if(s&&null!=r.origin)if("number"==typeof r.origin)o=r.origin;else{var l="string"==typeof r.origin?CU(r.origin):r.origin;o=l.r,c=l.c}var h={s:{c:0,r:0},e:{c:c,r:o+t.length-1+a}};if(s["!ref"]){var d=RU(s["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),-1==o&&(o=d.e.r+1,h.e.r=o+t.length-1+a)}else-1==o&&(o=0,h.e.r=t.length-1+a);var u=r.header||[],f=0;t.forEach(function(e,t){CS(e).forEach(function(n){-1==(f=u.indexOf(n))&&(u[f=u.length]=n);var l=e[n],h="z",d="",p=UU({c:c+f,r:o+t+a});i=qM(s,p),!l||"object"!=typeof l||l instanceof Date?("number"==typeof l?h="n":"boolean"==typeof l?h="b":"string"==typeof l?h="s":l instanceof Date?(h="d",r.cellDates||(h="n",l=IS(l)),d=r.dateNF||Gk[14]):null===l&&r.nullError&&(h="e",l=0),i?(i.t=h,i.v=l,delete i.w,delete i.R,d&&(i.z=d)):s[p]=i={t:h,v:l},d&&(i.z=d)):s[p]=l})}),h.e.c=Math.max(h.e.c,c+u.length-1);var p=AU(o);if(a)for(f=0;f<u.length;++f)s[SU(f+c)+p]={t:"s",v:u[f]};return s["!ref"]=IU(h),s}function qM(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var i=CU(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return qM(e,UU("number"!=typeof t?t:{r:t,c:n||0}))}function XM(e,t,n,i){var r=1;if(!n)for(;r<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+r);++r,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(n)>=0){var a=n.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var s=a&&a[1]||n;for(++r;r<=65535&&-1!=e.SheetNames.indexOf(n=s+r);++r);}if(function(e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");WN.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function KM(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var YM,ZM,JM,QM,eO,tO={encode_col:SU,encode_row:AU,encode_cell:UU,encode_range:IU,decode_col:kU,decode_row:EU,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:CU,decode_range:FU,format_cell:NU,sheet_add_aoa:OU,sheet_add_json:$M,sheet_add_dom:hM,aoa_to_sheet:PU,json_to_sheet:function(e,t){return $M(null,e,t)},table_to_sheet:dM,table_to_book:function(e,t){return MU(dM(e,t),t)},sheet_to_csv:GM,sheet_to_txt:function(e,t){return t||(t={}),t.FS="\t",t.RS="\n",GM(e,t)},sheet_to_json:zM,sheet_to_html:function(e,t){var n=t||{},i=null!=n.header?n.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r=null!=n.footer?n.footer:"</body></html>",a=[i],s=FU(e["!ref"]);n.dense=Array.isArray(e),a.push(function(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)a.push(lM(e,s,o,n));return a.push("</table>"+r),a.join("")},sheet_to_formulae:function(e){var t,n="",i="";if(null==e||null==e["!ref"])return[];var r,a=RU(e["!ref"]),s="",o=[],c=[],l=Array.isArray(e);for(r=a.s.c;r<=a.e.c;++r)o[r]=SU(r);for(var h=a.s.r;h<=a.e.r;++h)for(s=AU(h),r=a.s.c;r<=a.e.c;++r)if(n=o[r]+s,i="",void 0!==(t=l?(e[h]||[])[r]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;i=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)i=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)i=""+t.v;else if("b"==t.t)i=t.v?"TRUE":"FALSE";else if(void 0!==t.w)i="'"+t.w;else{if(void 0===t.v)continue;i="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=n+"="+i}return c},sheet_to_row_object_array:zM,sheet_get_cell:qM,book_new:function(){return{SheetNames:[],Sheets:{}}},book_append_sheet:XM,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[i].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:KM,cell_set_internal_link:function(e,t,n){return KM(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,i){for(var r="string"!=typeof t?t:RU(t),a="string"==typeof t?t:IU(t),s=r.s.r;s<=r.e.r;++s)for(var o=r.s.c;o<=r.e.c;++o){var c=qM(e,s,o);c.t="n",c.F=a,delete c.v,s==r.s.r&&o==r.s.c&&(c.f=n,i&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},nO={exports:{}};function iO(){return YM||(YM=1,function(){var e=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(R){l=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var a=t&&t.prototype instanceof b?t:b,s=Object.create(a.prototype),o=new U(i||[]);return r(s,"_invoke",{value:A(e,n,o)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}e.wrap=h;var u="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function b(){}function v(){}function y(){}var w={};l(w,s,function(){return this});var x=Object.getPrototypeOf,_=x&&x(x(F([])));_&&_!==n&&i.call(_,s)&&(w=_);var T=y.prototype=b.prototype=Object.create(w);function D(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){function n(r,a,s,o){var c=d(e[r],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&i.call(h,"__await")?t.resolve(h.__await).then(function(e){n("next",e,s,o)},function(e){n("throw",e,s,o)}):t.resolve(h).then(function(e){l.value=e,s(l)},function(e){return n("throw",e,s,o)})}o(c.arg)}var a;r(this,"_invoke",{value:function(e,i){function r(){return new t(function(t,r){n(e,i,t,r)})}return a=a?a.then(r,r):r()}})}function A(e,t,n){var i=u;return function(r,a){if(i===p)throw new Error("Generator is already running");if(i===g){if("throw"===r)throw a;return I()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var o=k(s,n);if(o){if(o===m)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=d(e,t,n);if("normal"===c.type){if(i=n.done?g:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=g,n.method="throw",n.arg=c.arg)}}}function k(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var a=d(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var s=a.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function U(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function F(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:I}}function I(){return{value:t,done:!0}}return v.prototype=y,r(T,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:v,configurable:!0}),v.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},D(E.prototype),l(E.prototype,o,function(){return this}),e.AsyncIterator=E,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var s=new E(h(t,n,i,r),a);return e.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},D(T),l(T,c,"Generator"),l(T,s,function(){return this}),l(T,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=F,U.prototype={constructor:U,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:F(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}(nO.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}()),nO.exports}function rO(){return JM?ZM:(JM=1,ZM=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`)}function aO(){if(eO)return QM;eO=1;const e=rO();let t=0;return QM=({id:n,action:i,payload:r={}})=>{let a=n;return void 0===a&&(a=e("Job",t),t+=1),{id:a,action:i,payload:r}}}var sO,oO,cO,lO,hO,dO,uO,fO,pO,gO={};function mO(){if(sO)return gO;sO=1;let e=!1;return gO.logging=e,gO.setLogging=t=>{e=t},gO.log=(...t)=>e?void 0:null,gO}function bO(){return pO?fO:(pO=1,fO={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3})}var vO,yO,wO,xO,_O,TO,DO,EO,AO,kO,SO,CO,UO,FO,IO,RO,NO,MO,OO,PO,LO,WO,BO,jO,zO,HO;function VO(){if(RO)return IO;RO=1;const e=function(){if(xO)return wO;xO=1;const e=yO?vO:(yO=1,vO={workerBlobURL:!0,logger:()=>{}});return wO={...e,workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@v6.0.1/dist/worker.min.js"}}(),t=TO?_O:(TO=1,_O=({workerPath:e,workerBlobURL:t})=>{let n;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(t))}else n=new Worker(e);return n}),n=EO?DO:(EO=1,DO=e=>{e.terminate()}),i=kO?AO:(kO=1,AO=(e,t)=>{e.onmessage=({data:e})=>{t(e)}}),r=CO?SO:(CO=1,SO=async(e,t)=>{e.postMessage(t)}),a=function(){if(FO)return UO;FO=1;const e=e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=({target:{error:{code:e}}})=>{n(Error(`File could not be read! Code=${e}`))},i.readAsArrayBuffer(e)}),t=async n=>{let i=n;if(void 0===n)return"undefined";if("string"==typeof n)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n))i=atob(n.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const e=await fetch(n);i=await e.arrayBuffer()}else if("undefined"!=typeof HTMLElement&&n instanceof HTMLElement)"IMG"===n.tagName&&(i=await t(n.src)),"VIDEO"===n.tagName&&(i=await t(n.poster)),"CANVAS"===n.tagName&&await new Promise(t=>{n.toBlob(async n=>{i=await e(n),t()})});else if("undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas){const t=await n.convertToBlob();i=await e(t)}else(n instanceof File||n instanceof Blob)&&(i=await e(n));return new Uint8Array(i)};return UO=t}();return IO={defaultOptions:e,spawnWorker:t,terminateWorker:n,onMessage:i,send:r,loadImage:a}}function GO(){if(MO)return NO;MO=1;const e=function(){if(uO)return dO;uO=1;const e="browser"===(hO?lO:(hO=1,lO=e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":"object"==typeof document?t.type="browser":"object"==typeof process&&"function"==typeof Sh&&(t.type="node"),void 0===e?t:t[e]}))("type")?e=>new URL(e,window.location.href).href:e=>e;return dO=t=>{const n={...t};return["corePath","workerPath","langPath"].forEach(i=>{t[i]&&(n[i]=e(n[i]))}),n}}(),t=aO(),{log:n}=mO(),i=rO(),r=bO(),{defaultOptions:a,spawnWorker:s,terminateWorker:o,onMessage:c,loadImage:l,send:h}=VO();let d=0;return NO=async(u="eng",f=r.LSTM_ONLY,p={},g={})=>{const m=i("Worker",d),{logger:b,errorHandler:v,...y}=e({...a,...p}),w={},x="string"==typeof u?u.split("+"):u;let _=f,T=g;const D=[r.DEFAULT,r.LSTM_ONLY].includes(f)&&!y.legacyCore;let E,A;const k=new Promise((e,t)=>{A=e,E=t});let S=s(y);S.onerror=e=>{E(e.message)},d+=1;const C=({id:e,action:t,payload:i})=>new Promise((r,a)=>{n(`[${m}]: Start ${e}, action=${t}`),w[`${t}-${e}`]={resolve:r,reject:a},h(S,{workerId:m,jobId:e,action:t,payload:i})}),U=(e,n)=>C(t({id:n,action:"loadLanguage",payload:{langs:e,options:{langPath:y.langPath,dataPath:y.dataPath,cachePath:y.cachePath,cacheMethod:y.cacheMethod,gzip:y.gzip,lstmOnly:[r.DEFAULT,r.LSTM_ONLY].includes(_)&&!y.legacyLang}}})),F=(e,n,i,r)=>C(t({id:r,action:"initialize",payload:{langs:e,oem:n,config:i}}));c(S,({workerId:e,jobId:t,status:i,action:r,data:a})=>{const s=`${r}-${t}`;if("resolve"===i)n(`[${e}]: Complete ${t}`),w[s].resolve({jobId:t,data:a}),delete w[s];else if("reject"===i){if(w[s].reject(a),delete w[s],"load"===r&&E(a),!v)throw Error(a);v(a)}else"progress"===i&&b({...a,userJobId:t})});const I={id:m,worker:S,load:()=>{},writeText:(e,n,i)=>C(t({id:i,action:"FS",payload:{method:"writeFile",args:[e,n]}})),readText:(e,n)=>C(t({id:n,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,n)=>C(t({id:n,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,n,i)=>C(t({id:i,action:"FS",payload:{method:e,args:n}})),reinitialize:(e="eng",t,n,i)=>{if(D&&[r.TESSERACT_ONLY,r.TESSERACT_LSTM_COMBINED].includes(t))throw Error("Legacy model requested but code missing.");const a=t||_;_=a;const s=n||T;T=s;const o=("string"==typeof e?e.split("+"):e).filter(e=>!x.includes(e));return x.push(...o),o.length>0?U(o,i).then(()=>F(e,a,s,i)):F(e,a,s,i)},setParameters:(e={},n)=>C(t({id:n,action:"setParameters",payload:{params:e}})),recognize:async(e,n={},i={text:!0},r)=>C(t({id:r,action:"recognize",payload:{image:await l(e),options:n,output:i}})),detect:async(e,n)=>{if(D)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return C(t({id:n,action:"detect",payload:{image:await l(e)}}))},terminate:async()=>(null!==S&&(o(S),S=null),Promise.resolve())};return C(t({id:undefined,action:"load",payload:{options:{lstmOnly:D,corePath:y.corePath,logging:y.logging}}})).then(()=>U(u)).then(()=>F(u,f,g)).then(()=>A(I)).catch(()=>{}),k}}const $O=Ch(function(){if(HO)return zO;HO=1,iO();const e=function(){if(cO)return oO;cO=1;const e=aO(),{log:t}=mO(),n=rO();let i=0;return oO=()=>{const r=n("Scheduler",i),a={},s={};let o=[];i+=1;const c=()=>Object.keys(a).length,l=()=>{if(0!==o.length){const e=Object.keys(a);for(let t=0;t<e.length;t+=1)if(void 0===s[e[t]]){o[0](a[e[t]]);break}}},h=(n,i)=>new Promise((a,c)=>{const h=e({action:n,payload:i});o.push(async e=>{o.shift(),s[e.id]=h;try{a(await e[n].apply(this,[...i,h.id]))}catch(t){c(t)}finally{delete s[e.id],l()}}),t(`[${r}]: Add ${h.id} to JobQueue`),t(`[${r}]: JobQueue length=${o.length}`),l()});return{addWorker:e=>(a[e.id]=e,t(`[${r}]: Add ${e.id}`),t(`[${r}]: Number of workers=${c()}`),l(),e.id),addJob:async(e,...t)=>{if(0===c())throw Error(`[${r}]: You need to have at least one worker before adding jobs`);return h(e,t)},terminate:async()=>{Object.keys(a).forEach(async e=>{await a[e].terminate()}),o=[]},getQueueLen:()=>o.length,getNumWorkers:c}}}(),t=GO(),n=function(){if(PO)return OO;PO=1;const e=GO();return OO={recognize:async(t,n,i)=>{const r=await e(n,1,i);return r.recognize(t).finally(async()=>{await r.terminate()})},detect:async(t,n)=>{const i=await e("osd",0,n);return i.detect(t).finally(async()=>{await i.terminate()})}}}(),i=WO?LO:(WO=1,LO={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),r=bO(),a=jO?BO:(jO=1,BO={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),{setLogging:s}=mO();return zO={languages:i,OEM:r,PSM:a,createScheduler:e,createWorker:t,setLogging:s,...n}}());if("undefined"!=typeof window)try{Ig.workerSrc="/pdf.worker.min.js"}catch(ZO){}const qO=class e{constructor(){}static getInstance(){return e.instance||(e.instance=new e),e.instance}getSupportedFileTypes(){return[{extension:".txt",mimeType:"text/plain",description:"纯文本文件"},{extension:".md",mimeType:"text/markdown",description:"Markdown 文档"},{extension:".csv",mimeType:"text/csv",description:"CSV 表格文件"},{extension:".json",mimeType:"application/json",description:"JSON 数据文件"},{extension:".pdf",mimeType:"application/pdf",description:"PDF 文档"},{extension:".docx",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",description:"Word 文档"},{extension:".doc",mimeType:"application/msword",description:"Word 文档（旧版）"},{extension:".xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",description:"Excel 表格"},{extension:".xls",mimeType:"application/vnd.ms-excel",description:"Excel 表格（旧版）"},{extension:".pptx",mimeType:"application/vnd.openxmlformats-officedocument.presentationml.presentation",description:"PowerPoint 演示文稿"},{extension:".ppt",mimeType:"application/vnd.ms-powerpoint",description:"PowerPoint 演示文稿（旧版）"},{extension:".jpg",mimeType:"image/jpeg",description:"JPEG 图片"},{extension:".jpeg",mimeType:"image/jpeg",description:"JPEG 图片"},{extension:".png",mimeType:"image/png",description:"PNG 图片"},{extension:".gif",mimeType:"image/gif",description:"GIF 图片"},{extension:".bmp",mimeType:"image/bmp",description:"BMP 图片"},{extension:".webp",mimeType:"image/webp",description:"WebP 图片"}]}isFileTypeSupported(e){var t;const n=this.getSupportedFileTypes(),i="."+(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase()),r=n.some(t=>e.type===t.mimeType||e.type.includes(t.extension.slice(1))),a=n.some(e=>i===e.extension);return r||a}async analyzeBrandContent(e){var t,n,i;if(!e||e.trim().length<10)return{keywords:["品牌建设","市场定位","用户价值"],tone:"专业、可靠、创新",suggestions:["请提供更多品牌资料以获得更准确的分析","建议包含品牌介绍、产品描述、市场定位等信息"]};const r=`\n作为一名品牌策略专家，请分析以下品牌资料，提取关键信息并按照不同维度进行分类：\n\n品牌资料内容：\n${e}\n\n请严格按照以下JSON格式返回分析结果，不要包含任何其他文字说明：\n\n{\n  "brandKeywords": ["品牌核心概念1", "品牌核心概念2", "品牌核心概念3"],\n  "productKeywords": ["产品特征1", "产品特征2", "产品特征3"],\n  "targetAudience": ["目标受众1", "目标受众2", "目标受众3"],\n  "brandStory": ["品牌故事元素1", "品牌故事元素2", "品牌故事元素3"],\n  "competitiveAdvantage": ["竞争优势1", "竞争优势2", "竞争优势3"],\n  "tone": "语气特征描述",\n  "suggestions": ["建议1", "建议2", "建议3"]\n}\n\n要求：\n1. brandKeywords：品牌核心概念、价值主张、品牌定位相关的词汇\n2. productKeywords：具体产品特征、功能、材质、技术相关的词汇\n3. targetAudience：用户群体、市场定位、消费者特征相关的词汇\n4. brandStory：历史、文化、情感、传承相关的词汇\n5. competitiveAdvantage：差异化、优势、特色、领先相关的词汇\n6. tone：描述品牌的语调风格，如"专业、可靠、创新"或"年轻、活力、时尚"\n7. suggestions：提供3条具体的品牌建设建议\n\n注意：\n- 每个维度至少提供3个关键词，最多5个\n- 不同维度之间避免重复\n- 必须返回有效的JSON格式，不要包含任何解释性文字\n- 如果某个维度信息不足，可以基于品牌特征进行合理推测\n`;try{const e=await ef([{role:"system",content:"你是一名专业的品牌策略分析专家。你的任务是将品牌资料分析为JSON格式。重要：1) 只返回JSON格式，不要包含任何其他文字；2) 确保JSON格式完全正确；3) 如果内容不足，基于常见品牌特征进行合理推测。"},{role:"user",content:r}],"gpt-4o",.1,2e3);if(!e.success||!e.data)throw new Error("AI分析服务请求失败");let s=e.data.choices;if(!s&&e.data.data&&e.data.data.choices&&(s=e.data.data.choices),!Array.isArray(s)||!s[0]||!s[0].message)throw new Error("AI分析服务返回数据格式异常，请稍后重试");const o=s[0].message.content;if(!o)throw new Error("API返回空内容");let c;try{let e=o.trim();e.startsWith("```json")?e=e.replace(/^```json\s*/,"").replace(/\s*```$/,""):e.startsWith("```")&&(e=e.replace(/^```\s*/,"").replace(/\s*```$/,"")),c=JSON.parse(e)}catch(a){if(o.includes("请提供")||o.includes("内容不足")||o.length<50)c={keywords:["品牌建设","市场定位","用户价值","产品创新","用户体验"],tone:"专业、可靠、创新",suggestions:["请提供更多品牌资料以获得更准确的分析","建议包含品牌介绍、产品描述、市场定位等信息","可以上传品牌手册、产品介绍等文档"]};else{const e=(null==(t=o.match(/关键词[：:]\s*([^，。\n]+)/g))?void 0:t.map(e=>e.replace(/关键词[：:]\s*/,"")))||["品牌建设","市场定位","用户价值"],r=(null==(n=o.match(/语气[：:]\s*([^，。\n]+)/))?void 0:n.pop())||"专业、可靠、创新",a=(null==(i=o.match(/建议[：:]\s*([^，。\n]+)/g))?void 0:i.map(e=>e.replace(/建议[：:]\s*/,"")))||["加强品牌故事传播","突出产品差异化优势","建立用户情感连接"];c={keywords:e.slice(0,5),tone:r,suggestions:a.slice(0,3)}}}const l=c.keywords||c.brandKeywords||[],h=c.brandKeywords||l,d=c.productKeywords||[],u=c.targetAudience||[];return{keywords:l,brandKeywords:h,productKeywords:d,targetAudience:u,brandStory:c.brandStory||[],competitiveAdvantage:c.competitiveAdvantage||[],tone:c.tone,suggestions:c.suggestions}}catch(ZO){throw new Error("品牌资料分析失败")}}async analyzeFiles(e){try{const t=[];for(const i of e)if(this.isFileTypeSupported(i)){const e=await this.readFileContent(i);t.push(e)}if(0===t.length)throw new Error("没有可分析的文件内容");const n=t.join("\n\n");return await this.analyzeBrandContent(n)}catch(ZO){throw new Error("文件分析失败")}}async checkContent(e,t){const n=`\n作为品牌语气检查专家，请分析以下内容是否符合品牌调性要求：\n\n内容：\n${e}\n\n品牌要求：\n- 品牌名称：${t.name}\n- 目标语气：${t.tone}\n- 关键词：${t.keywords.join("、")}\n- 禁用词：${t.forbiddenWords.join("、")}\n\n请检查以下方面：\n1. 是否使用了禁用词\n2. 语气是否符合品牌调性\n3. 是否合理使用了品牌关键词\n4. 内容是否积极正面\n\n请按照以下 JSON 格式返回：\n{\n  "isValid": true/false,\n  "issues": ["问题1", "问题2", ...],\n  "suggestions": ["建议1", "建议2", ...]\n}\n`;try{const e=await ef([{role:"system",content:"你是一名专业的品牌语气检查专家，擅长评估内容是否符合品牌调性。请严格按照JSON格式返回分析结果。"},{role:"user",content:n}],"gpt-4o",.3,2e3);if(!e.success||!e.data)throw new Error("AI分析服务请求失败");let t=e.data.choices;if(!t&&e.data.data&&e.data.data.choices&&(t=e.data.data.choices),!Array.isArray(t)||!t[0]||!t[0].message)throw new Error("AI分析服务返回数据格式异常，请稍后重试");const r=t[0].message.content;if(!r)throw new Error("API返回空内容");try{let e=r.trim();return e.startsWith("```json")?e=e.replace(/^```json\s*/,"").replace(/\s*```$/,""):e.startsWith("```")&&(e=e.replace(/^```\s*/,"").replace(/\s*```$/,"")),JSON.parse(e)}catch(i){return{isValid:!0,issues:[],suggestions:["建议检查内容是否符合品牌调性"]}}}catch(ZO){throw new Error("内容检查失败")}}async readFileContent(e){return new Promise((t,n)=>{var i;const r=new FileReader;r.onload=async i=>{var r,a,s,o,c,l,h;try{const p="."+(null==(r=e.name.split(".").pop())?void 0:r.toLowerCase());if(e.type.includes("text")||e.type.includes("markdown")||".txt"===p||".md"===p||".csv"===p||".json"===p)t(null==(a=i.target)?void 0:a.result);else if(e.type.includes("pdf")||".pdf"===p)try{const e=new Uint8Array(null==(s=i.target)?void 0:s.result),n=await hm({data:e,useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise;let r="";const a=Math.min(n.numPages,10);for(let t=1;t<=a;t++)try{const e=await n.getPage(t);r+=(await e.getTextContent()).items.map(e=>e.str).join(" ")+"\n"}catch(d){continue}if(0===r.trim().length)throw new Error("PDF内容为空");t(r)}catch(u){const n=e.size,i=`PDF文件: ${e.name}\n文件大小: ${(n/1024).toFixed(2)} KB\n\n由于PDF解析技术限制，无法提取文本内容。\n建议：\n1. 将PDF转换为Word文档后上传\n2. 复制PDF内容到文本文件后上传\n3. 手动输入品牌资料内容`;t(i)}else if(e.type.includes("word")||".docx"===p||".doc"===p){const e=null==(o=i.target)?void 0:o.result,n=await hk.extractRawText({arrayBuffer:e});t(n.value)}else if(e.type.includes("excel")||e.type.includes("spreadsheet")||".xlsx"===p||".xls"===p){const e=BM(null==(c=i.target)?void 0:c.result,{type:"array"});let n="";e.SheetNames.forEach(t=>{const i=e.Sheets[t];tO.sheet_to_json(i,{header:1}).forEach(e=>{Array.isArray(e)&&(n+=e.join("\t")+"\n")})}),t(n)}else if(e.type.includes("powerpoint")||e.type.includes("presentation")||".pptx"===p||".ppt"===p)null==(l=i.target)||l.result,t("PowerPoint 文件内容提取功能正在开发中...");else if(e.type.includes("image")||".jpg"===p||".jpeg"===p||".png"===p||".gif"===p||".bmp"===p||".webp"===p)try{const n=null==(h=i.target)?void 0:h.result,r=new Blob([n],{type:e.type}),a=(await $O.recognize(r,"chi_sim+eng",{logger:e=>{}})).data.text.trim();t(a||"图片未识别到有效文字，请上传包含清晰文字的图片。")}catch(f){t("图片内容识别失败，请确保图片为清晰的文字图片。")}else n(new Error(`暂不支持该文件类型: ${e.type} (${p})`))}catch(p){n(new Error("文件解析失败: "+p.message))}},r.onerror=e=>{n(new Error("文件读取失败"))};const a="."+(null==(i=e.name.split(".").pop())?void 0:i.toLowerCase());e.type.includes("text")||e.type.includes("markdown")||".txt"===a||".md"===a||".csv"===a||".json"===a?r.readAsText(e):r.readAsArrayBuffer(e)})}};sh(qO,"instance");let XO=qO;function KO(){const[e,t]=ph.useState("dimensions"),[n,i]=ph.useState([]),[r,a]=ph.useState(null),[s,o]=ph.useState(!1),[c,l]=ph.useState(0),[h,d]=ph.useState(""),[u,f]=ph.useState(!1),[p,g]=ph.useState(0),[m,b]=ph.useState(!1),[v,y]=ph.useState("品牌资料"),[w,x]=ph.useState(!1),_=["品牌资料","产品介绍","营销素材","用户反馈","竞品分析","行业报告","其他"],[T,D]=ph.useState(!1),[E,A]=ph.useState(null),[k,S]=ph.useState(null),[C,U]=ph.useState("date-new"),[F,I]=ph.useState([]),[R,N]=ph.useState(null),[M,O]=ph.useState(""),[P,L]=ph.useState(""),[W,B]=ph.useState(""),[j,z]=ph.useState(null),[H,V]=ph.useState(null),[G,$]=ph.useState(""),{toast:q}=Uh();Fh();const X=ph.useRef(null),[K,Y]=ph.useState([{id:"brandName",title:"品牌名称",description:"品牌的名字",icon:gh.jsx(Ad,{className:"h-4 w-4"}),placeholder:"请输入您的品牌名称...",value:"",keywords:[],isRequired:!1,category:"basic"},{id:"brandDescription",title:"品牌描述",description:"简要描述品牌定位和特色",icon:gh.jsx(Ih,{className:"h-4 w-4"}),placeholder:"请描述您的品牌定位、特色和核心价值...",value:"",keywords:[],isRequired:!1,category:"basic"},{id:"brandSlogan",title:"品牌Slogan",description:"品牌的口号",icon:gh.jsx(pd,{className:"h-4 w-4"}),placeholder:"请输入您的品牌口号...",value:"",keywords:[],isRequired:!1,category:"identity"},{id:"brandValues",title:"品牌价值观",description:"驱动品牌行为和决策的基本原则是什么？",icon:gh.jsx(kd,{className:"h-4 w-4"}),placeholder:"请描述您的品牌价值观和基本原则...",value:"",keywords:[],isRequired:!1,category:"identity"},{id:"brandVision",title:"品牌愿景与使命",description:"你的品牌存在的根本原因是什么？长期目标是什么？",icon:gh.jsx(Ad,{className:"h-4 w-4"}),placeholder:"请描述您的品牌愿景、使命和长期目标...",value:"",keywords:[],isRequired:!1,category:"identity"},{id:"brandStory",title:"品牌故事",description:"品牌起源故事",icon:gh.jsx(Cd,{className:"h-4 w-4"}),placeholder:"请讲述您的品牌起源故事...",value:"",keywords:[],isRequired:!1,category:"identity"},{id:"adSlogans",title:"广告语集",description:"品牌过往广告中使用的标语口号",icon:gh.jsx(Ud,{className:"h-4 w-4"}),placeholder:"请列出您的品牌广告语和标语...",value:"",keywords:[],isRequired:!1,category:"content"},{id:"productKeywords",title:"产品描述词库",description:"描述品牌产品或服务的核心关键词",icon:gh.jsx(jd,{className:"h-4 w-4"}),placeholder:"请列出描述您产品的核心关键词...",value:"",keywords:[],isRequired:!1,category:"content"},{id:"brandTone",title:"品牌语调/语气",description:"包括语言风格、语气、情感倾向（如正式、友好、幽默、专业等）",icon:gh.jsx(Fd,{className:"h-4 w-4"}),placeholder:"请描述您的品牌语调、语气和语言风格...",value:"",keywords:[],isRequired:!1,category:"voice"},{id:"brandPersonality",title:"品牌个性",description:"如果你的品牌是一个人，它会是什么样的性格？",icon:gh.jsx(zd,{className:"h-4 w-4"}),placeholder:"请描述您的品牌个性特征...",value:"",keywords:[],isRequired:!1,category:"voice"},{id:"coreTopics",title:"品牌核心话题",description:"品牌内容的核心主题和指引方向",icon:gh.jsx(Rh,{className:"h-4 w-4"}),placeholder:"请列出您的品牌核心话题和内容方向...",value:"",keywords:[],isRequired:!1,category:"content"},{id:"brandHashtags",title:"品牌Hashtags",description:"以#话题的形式，在品牌内容结尾出现，推荐用户使用这些",icon:gh.jsx(gd,{className:"h-4 w-4"}),placeholder:"请列出您的品牌标签，如：#品牌名 #产品特色...",value:"",keywords:[],isRequired:!1,category:"content"},{id:"brandKeywords",title:"品牌关键词",description:"尽量在品牌内容中使用的词",icon:gh.jsx(Id,{className:"h-4 w-4"}),placeholder:"请列出您的品牌关键词...",value:"",keywords:[],isRequired:!1,category:"content"},{id:"forbiddenWords",title:"品牌禁用词",description:"禁止在品牌内容中出现的词",icon:gh.jsx(md,{className:"h-4 w-4"}),placeholder:"请列出您的品牌禁用词...",value:"",keywords:[],isRequired:!1,category:"content"}]);ph.useEffect(()=>{a({id:"1",name:"我的品牌",tone:"专业而亲切",slogans:["专业可靠","用户友好","创新引领"],keywords:["专业","可靠","创新","用户友好"],forbiddenWords:["过度营销","技术术语","负面词汇"],files:[],createdAt:new Date,updatedAt:new Date,aiAnalysis:{toneAnalysis:"专业而亲切",keyThemes:["专业","可靠","创新"],brandPersonality:"专业可靠的品牌形象",targetAudience:"追求专业解决方案的用户",contentSuggestions:["强调专业性","突出可靠性","展现创新性"],valueAlignment:["建议1","建议2"],topicConsistency:["建议1","建议2"]}})},[]);const Z=async e=>{var t,n,r,a,s;V(e.id);try{i(t=>t.map(t=>t.id===e.id?{...t,processingStatus:"processing"}:t));const o=XO.getInstance(),c=await o.analyzeBrandContent(e.content||"品牌资料内容"),l=`AI分析结果：\n\n1. 品牌关键词：${(null==(t=c.brandKeywords)?void 0:t.join("、"))||c.keywords.join("、")}\n2. 产品关键词：${(null==(n=c.productKeywords)?void 0:n.join("、"))||""}\n3. 目标受众：${(null==(r=c.targetAudience)?void 0:r.join("、"))||""}\n4. 品牌故事：${(null==(a=c.brandStory)?void 0:a.join("、"))||""}\n5. 竞争优势：${(null==(s=c.competitiveAdvantage)?void 0:s.join("、"))||""}\n6. 品牌语气特征：${c.tone}\n7. 内容建议：${c.suggestions.join("、")}`,h=[...c.brandKeywords||[],...c.productKeywords||[],...c.targetAudience||[],...c.brandStory||[],...c.competitiveAdvantage||[]];i(t=>t.map(t=>t.id===e.id?{...t,content:l,extractedKeywords:h,processingStatus:"completed"}:t)),Q(c,l),q({title:"AI分析完成",description:`已成功分析 ${e.name}，并补充到品牌语料库`})}catch(ZO){i(t=>t.map(t=>t.id===e.id?{...t,processingStatus:"failed"}:t)),q({title:"AI分析失败",description:ZO instanceof Error?ZO.message:"请稍后重试",variant:"destructive"})}finally{V(null)}},J=async()=>{var e,t,r,a,s;const o=n.filter(e=>"completed"!==e.processingStatus);if(0!==o.length){f(!0),g(0);try{const n=XO.getInstance();for(let c=0;c<o.length;c++){const l=o[c];i(e=>e.map(e=>e.id===l.id?{...e,processingStatus:"processing"}:e));try{const o=await n.analyzeBrandContent(l.content||"品牌资料内容"),c=`AI分析结果：\n\n1. 品牌关键词：${(null==(e=o.brandKeywords)?void 0:e.join("、"))||o.keywords.join("、")}\n2. 产品关键词：${(null==(t=o.productKeywords)?void 0:t.join("、"))||""}\n3. 目标受众：${(null==(r=o.targetAudience)?void 0:r.join("、"))||""}\n4. 品牌故事：${(null==(a=o.brandStory)?void 0:a.join("、"))||""}\n5. 竞争优势：${(null==(s=o.competitiveAdvantage)?void 0:s.join("、"))||""}\n6. 品牌语气特征：${o.tone}\n7. 内容建议：${o.suggestions.join("、")}`,h=[...o.brandKeywords||[],...o.productKeywords||[],...o.targetAudience||[],...o.brandStory||[],...o.competitiveAdvantage||[]];i(e=>e.map(e=>e.id===l.id?{...e,content:c,extractedKeywords:h,processingStatus:"completed"}:e)),Q(o,c)}catch(ZO){i(e=>e.map(e=>e.id===l.id?{...e,processingStatus:"failed"}:e))}g((c+1)/o.length*100)}q({title:"批量AI分析完成",description:"已自动分析所有品牌资料并补充语料库"})}catch(ZO){q({title:"批量AI分析失败",description:ZO instanceof Error?ZO.message:"请稍后重试",variant:"destructive"})}finally{f(!1),g(0)}}else q({title:"无需处理",description:"所有文件都已处理完成"})},Q=(e,t)=>{Y(n=>n.map(n=>{let i=n.value,r=[...n.keywords];switch(n.id){case"brandKeywords":if(""===n.value){const t=e.brandKeywords||e.keywords||[];t.length>0&&(i=t.join("、"),r=[...n.keywords,...t])}break;case"productKeywords":if(""===n.value){const t=e.productKeywords||[];t.length>0&&(i=t.join("、"),r=t)}break;case"targetAudience":if(""===n.value){const t=e.targetAudience||[];t.length>0&&(i=t.join("、"),r=t)}break;case"brandStory":if(""===n.value){const t=e.brandStory||[];t.length>0&&(i=t.join("、"),r=t)}break;case"competitiveAdvantage":if(""===n.value){const t=e.competitiveAdvantage||[];t.length>0&&(i=t.join("、"),r=t)}break;case"brandDescription":""===n.value&&(i=t.substring(0,200)+"...");break;case"brandTone":""===n.value&&(i=e.tone||"专业、可靠、创新");break;case"brandPersonality":""===n.value&&(i="专业可靠、用户友好、创新引领")}return{...n,value:i,keywords:r}}))},ee=(e,t)=>{Y(n=>n.map(n=>n.id===e?{...n,value:t}:n))},te=(e,t)=>{t.trim()&&Y(n=>n.map(n=>{if(n.id===e){const e=[...n.keywords,t.trim()],i=n.value?`${n.value}、${t.trim()}`:t.trim();return{...n,keywords:e,value:i}}return n}))},ne=(e,t)=>{Y(n=>n.map(n=>{if(n.id===e){const e=n.keywords.filter(e=>e!==t),i=e.join("、");return{...n,keywords:e,value:i}}return n}))},ie=e=>K.filter(t=>t.category===e),re=n.filter(e=>{var t,n;if(h){const i=h.toLowerCase();return e.name.toLowerCase().includes(i)||(null==(t=e.description)?void 0:t.toLowerCase().includes(i))||(null==(n=e.category)?void 0:n.toLowerCase().includes(i))}return!(F.length>0)||e.category&&F.includes(e.category)}).sort((e,t)=>{switch(C){case"date-new":return new Date(t.uploadDate).getTime()-new Date(e.uploadDate).getTime();case"date-old":return new Date(e.uploadDate).getTime()-new Date(t.uploadDate).getTime();case"name-asc":return e.name.localeCompare(t.name);case"name-desc":return t.name.localeCompare(e.name);case"size-asc":return parseFloat(e.size||"0")-parseFloat(t.size||"0");case"size-desc":return parseFloat(t.size||"0")-parseFloat(e.size||"0");default:return 0}});return gh.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[gh.jsx(Ed,{title:"多维品牌语料库",description:"AI智能分析品牌资料，自动构建完整的品牌语料库，支持多维度自定义完善",showAdaptButton:!1,showUpgradeButton:!0}),gh.jsxs("div",{className:"container mx-auto px-4 py-8",children:[gh.jsx("input",{ref:X,type:"file",multiple:!0,accept:".pdf,.doc,.docx,.txt,.md,.jpg,.jpeg,.png,.gif,.bmp,.webp,.xls,.xlsx,.ppt,.pptx",onChange:async e=>{const t=e.target.files;if(!t||0===t.length)return;o(!0),l(0);const n=[];for(let i=0;i<t.length;i++){const e=t[i];let r=gh.jsx(Ih,{className:"h-8 w-8 text-blue-500"});e.type.includes("pdf")?r=gh.jsx(Td,{className:"h-8 w-8 text-red-500"}):e.type.includes("image")?r=gh.jsx(Ld,{className:"h-8 w-8 text-green-500"}):e.type.includes("word")&&(r=gh.jsx(Ih,{className:"h-8 w-8 text-blue-700"}));const a=v;try{const t=XO.getInstance();let s="";s=t.isFileTypeSupported(e)?await t.readFileContent(e):`不支持的文件类型: ${e.type}`;const o={id:`asset-${Date.now()}-${i}`,name:e.name,type:"document",content:s,uploadDate:new Date,fileIcon:r,description:"",category:a,processingStatus:"pending"};n.push(o)}catch(ZO){const s={id:`asset-${Date.now()}-${i}`,name:e.name,type:"document",content:`文件读取失败: ${ZO instanceof Error?ZO.message:"未知错误"}`,uploadDate:new Date,fileIcon:r,description:"",category:a,processingStatus:"failed"};n.push(s)}l((i+1)/t.length*100),await new Promise(e=>setTimeout(e,500))}i(e=>[...e,...n]),e.target.value="",o(!1),l(0),q({title:"文件上传成功",description:`已成功上传 ${n.length} 个品牌资料文件，AI正在自动分析...`}),setTimeout(()=>{J()},1e3),setTimeout(()=>{J()},1e3)},className:"hidden"}),s&&gh.jsx(jh,{className:"mb-6",children:gh.jsxs(zh,{className:"pt-6",children:[gh.jsxs("div",{className:"flex items-center justify-between mb-2",children:[gh.jsx("span",{className:"text-sm font-medium",children:"上传进度"}),gh.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(c),"%"]})]}),gh.jsx(Qu,{value:c,className:"w-full"})]})}),u&&gh.jsx(jh,{className:"mb-6",children:gh.jsxs(zh,{className:"pt-6",children:[gh.jsxs("div",{className:"flex items-center justify-between mb-2",children:[gh.jsx("span",{className:"text-sm font-medium",children:"AI分析进度"}),gh.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(p),"%"]})]}),gh.jsx(Qu,{value:p,className:"w-full"}),gh.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"AI正在分析品牌资料，自动补充语料库内容..."})]})}),gh.jsxs(Vd,{className:"mb-6",children:[gh.jsx(Bd,{className:"h-4 w-4"}),gh.jsxs(Gd,{children:[gh.jsx("strong",{children:"使用提示："}),"上传品牌资料越多，AI分析越准确。建议上传品牌手册、产品介绍、营销文案等资料。 所有维度都支持手动编辑，AI会自动补充关键词建议。"]})]}),gh.jsxs(Yh,{value:e,onValueChange:t,className:"space-y-6",children:[gh.jsxs(Zh,{className:"grid w-full grid-cols-2",children:[gh.jsx(Jh,{value:"dimensions",children:"品牌语料库"}),gh.jsx(Jh,{value:"assets",children:"资料管理"})]}),gh.jsxs(Qh,{value:"dimensions",className:"space-y-6",children:[gh.jsx("div",{className:"flex justify-end mb-4",children:gh.jsxs(Nh,{onClick:()=>{localStorage.setItem("brandDimensions",JSON.stringify(K)),q({title:"保存成功",description:"品牌语料库已保存"})},children:[gh.jsx(xd,{className:"h-4 w-4 mr-2"}),"保存语料库"]})}),gh.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[gh.jsxs(jh,{children:[gh.jsxs(Hh,{className:"pb-3",children:[gh.jsxs(Vh,{className:"flex items-center gap-2 text-lg",children:[gh.jsx(Ad,{className:"h-5 w-5 text-blue-600"}),"基础信息"]}),gh.jsx(Gh,{children:"品牌的基本信息和定位"})]}),gh.jsx(zh,{className:"space-y-4",children:ie("basic").map(e=>gh.jsx(YO,{dimension:e,onUpdate:ee,onAddKeyword:te,onRemoveKeyword:ne,isEditing:k===e.id,onEdit:()=>S(e.id),onCancel:()=>S(null)},e.id))})]}),gh.jsxs(jh,{children:[gh.jsxs(Hh,{className:"pb-3",children:[gh.jsxs(Vh,{className:"flex items-center gap-2 text-lg",children:[gh.jsx(Fd,{className:"h-5 w-5 text-orange-600"}),"语调风格"]}),gh.jsx(Gh,{children:"品牌的语音特征和表达方式"})]}),gh.jsx(zh,{className:"space-y-4",children:ie("voice").map(e=>gh.jsx(YO,{dimension:e,onUpdate:ee,onAddKeyword:te,onRemoveKeyword:ne,isEditing:k===e.id,onEdit:()=>S(e.id),onCancel:()=>S(null)},e.id))})]}),gh.jsxs(jh,{children:[gh.jsxs(Hh,{className:"pb-3",children:[gh.jsxs(Vh,{className:"flex items-center gap-2 text-lg",children:[gh.jsx(Sd,{className:"h-5 w-5 text-purple-600"}),"品牌身份"]}),gh.jsx(Gh,{children:"品牌的核心价值观和使命愿景"})]}),gh.jsx(zh,{className:"space-y-4",children:ie("identity").map(e=>gh.jsx(YO,{dimension:e,onUpdate:ee,onAddKeyword:te,onRemoveKeyword:ne,isEditing:k===e.id,onEdit:()=>S(e.id),onCancel:()=>S(null)},e.id))})]}),gh.jsxs(jh,{children:[gh.jsxs(Hh,{className:"pb-3",children:[gh.jsxs(Vh,{className:"flex items-center gap-2 text-lg",children:[gh.jsx(Nd,{className:"h-5 w-5 text-green-600"}),"内容策略"]}),gh.jsx(Gh,{children:"品牌内容创作的核心要素"})]}),gh.jsx(zh,{className:"space-y-4",children:ie("content").map(e=>gh.jsx(YO,{dimension:e,onUpdate:ee,onAddKeyword:te,onRemoveKeyword:ne,isEditing:k===e.id,onEdit:()=>S(e.id),onCancel:()=>S(null)},e.id))})]})]})]}),gh.jsx(Qh,{value:"assets",className:"space-y-6",children:gh.jsxs(jh,{children:[gh.jsxs(Hh,{children:[gh.jsx(Vh,{children:"品牌资料管理"}),gh.jsx(Gh,{children:"管理上传的品牌资料文件"})]}),gh.jsxs(zh,{children:[gh.jsxs("div",{className:"flex gap-2 mb-4 items-center",children:[gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx(Xh,{className:"text-sm font-medium",children:"分类："}),gh.jsxs(ed,{value:v,onValueChange:y,children:[gh.jsx(td,{className:"w-40",children:gh.jsx(nd,{placeholder:"选择分类"})}),gh.jsx(id,{children:_.map(e=>gh.jsx(rd,{value:e,children:e},e))})]})]}),gh.jsxs(Nh,{variant:"outline",onClick:()=>{var e;return null==(e=X.current)?void 0:e.click()},disabled:s,children:[gh.jsx(ud,{className:"h-4 w-4 mr-2"}),s?"上传中...":"上传资料"]}),gh.jsxs(Nh,{onClick:J,disabled:u||0===n.length,children:[gh.jsx(_d,{className:"h-4 w-4 mr-2"}),u?"AI分析中...":"批量AI分析"]})]}),gh.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:gh.jsxs("div",{className:"flex items-start gap-3",children:[gh.jsx(Bd,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),gh.jsxs("div",{className:"flex-1",children:[gh.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"支持的文件格式"}),gh.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 text-sm",children:[gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx(Ih,{className:"h-4 w-4 text-blue-600"}),gh.jsx("span",{children:"文档：PDF, DOC, DOCX, TXT, MD"})]}),gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx(Ld,{className:"h-4 w-4 text-green-600"}),gh.jsx("span",{children:"图片：JPG, PNG, GIF, BMP, WEBP"})]}),gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx(Td,{className:"h-4 w-4 text-red-600"}),gh.jsx("span",{children:"表格：XLS, XLSX"})]}),gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx(Ih,{className:"h-4 w-4 text-purple-600"}),gh.jsx("span",{children:"演示：PPT, PPTX"})]})]}),gh.jsxs("p",{className:"text-xs text-blue-700 mt-2",children:[gh.jsx("strong",{children:"注意："}),"单个文件大小建议不超过10MB，支持批量上传多个文件。AI将自动分析文件内容并提取品牌相关信息。"]})]})]})}),gh.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[gh.jsx("div",{className:"flex-1",children:gh.jsxs("div",{className:"relative",children:[gh.jsx(wd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),gh.jsx($h,{placeholder:"搜索资料...",value:h,onChange:e=>d(e.target.value),className:"pl-10"})]})}),gh.jsxs("div",{className:"flex gap-2",children:[gh.jsxs(ed,{value:C,onValueChange:e=>U(e),children:[gh.jsx(td,{className:"w-[180px]",children:gh.jsx(nd,{placeholder:"排序方式"})}),gh.jsxs(id,{children:[gh.jsx(rd,{value:"date-new",children:"最新上传"}),gh.jsx(rd,{value:"date-old",children:"最早上传"}),gh.jsx(rd,{value:"name-asc",children:"名称 A-Z"}),gh.jsx(rd,{value:"name-desc",children:"名称 Z-A"})]})]}),gh.jsxs(bd,{children:[gh.jsx(vd,{asChild:!0,children:gh.jsxs(Nh,{variant:"outline",className:"w-[120px]",children:[gh.jsx(ad,{className:"h-4 w-4 mr-2"}),"分类"]})}),gh.jsx(yd,{className:"w-48",children:gh.jsxs(Iu,{children:[gh.jsx(Ru,{placeholder:"搜索分类..."}),gh.jsxs(Nu,{children:[gh.jsx(Mu,{children:"未找到分类"}),gh.jsx(Ou,{children:["品牌手册","文案指南","产品介绍","营销素材","新闻稿","企业介绍","VI规范","品牌故事"].map(e=>gh.jsx(Pu,{onSelect:()=>(e=>{I(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),children:gh.jsxs("div",{className:"flex items-center space-x-2",children:[gh.jsx("input",{type:"checkbox",checked:F.includes(e),onChange:()=>{},className:"h-4 w-4"}),gh.jsx("span",{children:e})]})},e))})]})]})})]})]})]}),0===n.length?gh.jsxs("div",{className:"text-center py-8",children:[gh.jsx(Wd,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),gh.jsx("p",{className:"text-gray-500",children:"暂无品牌资料，请上传文件开始构建语料库"})]}):gh.jsx("div",{className:"space-y-4",children:re.map(e=>gh.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>(async e=>{z(e.id);try{const t=`文件名称：${e.name}\n文件大小：${e.size||"未知"} KB\n上传时间：${e.uploadDate.toLocaleString()}\n文件类型：${e.type}\n\n原始内容：\n${e.content||"暂无内容"}`;$(t)}catch(ZO){$("无法读取文件内容")}})(e),children:[gh.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.fileIcon,gh.jsx("div",{className:"flex-1 min-w-0",children:gh.jsxs("div",{children:[gh.jsxs("div",{className:"flex items-center gap-2",children:[gh.jsx("p",{className:"font-medium truncate",children:e.name}),e.category&&gh.jsx(fd,{variant:"secondary",className:"text-xs",children:e.category})]}),gh.jsx("p",{className:"text-sm text-gray-500",children:e.uploadDate.toLocaleDateString()}),e.description&&gh.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})})]}),gh.jsxs("div",{className:"flex items-center gap-2",children:["pending"===e.processingStatus&&gh.jsxs(gh.Fragment,{children:[gh.jsxs(fd,{variant:"secondary",children:[gh.jsx(Md,{className:"h-3 w-3 mr-1"}),"待分析"]}),gh.jsxs(Nh,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),Z(e)},disabled:H===e.id,children:[gh.jsx(_d,{className:"h-3 w-3 mr-1"}),H===e.id?"分析中...":"AI分析"]})]}),"processing"===e.processingStatus&&gh.jsxs(fd,{variant:"default",children:[gh.jsx(Dd,{className:"h-3 w-3 mr-1 animate-spin"}),"分析中"]}),"completed"===e.processingStatus&&gh.jsxs(fd,{variant:"default",children:[gh.jsx(Mh,{className:"h-3 w-3 mr-1"}),"已完成"]}),"failed"===e.processingStatus&&gh.jsxs(gh.Fragment,{children:[gh.jsxs(fd,{variant:"destructive",children:[gh.jsx(Oh,{className:"h-3 w-3 mr-1"}),"分析失败"]}),gh.jsxs(Nh,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),Z(e)},disabled:H===e.id,children:[gh.jsx(_d,{className:"h-3 w-3 mr-1"}),H===e.id?"分析中...":"重新分析"]})]}),gh.jsxs(Ph,{children:[gh.jsx(Lh,{asChild:!0,children:gh.jsx(Nh,{variant:"ghost",size:"sm",onClick:e=>e.stopPropagation(),children:gh.jsx(Pd,{className:"h-4 w-4"})})}),gh.jsxs(Wh,{align:"end",children:[gh.jsxs(Bh,{onClick:t=>{t.stopPropagation(),(e=>{A(e),O(e.name),L(e.description||""),B(e.category||"品牌资料"),N(e.id)})(e)},children:[gh.jsx(Rd,{className:"h-4 w-4 mr-2"}),"编辑"]}),gh.jsxs(Bh,{onClick:()=>{return t=e.id,i(e=>e.filter(e=>e.id!==t)),void q({title:"删除成功",description:"品牌资料已删除"});var t},children:[gh.jsx(qh,{className:"h-4 w-4 mr-2"}),"删除"]})]})]})]})]},e.id))})]})]})})]})]}),gh.jsx(sd,{open:null!==j,onOpenChange:()=>z(null),children:gh.jsxs(od,{className:"max-w-4xl max-h-[80vh]",children:[gh.jsx(cd,{children:gh.jsx(ld,{children:"资料内容"})}),gh.jsx("div",{className:"space-y-4",children:gh.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:gh.jsx("pre",{className:"whitespace-pre-wrap text-sm overflow-auto max-h-[60vh]",children:G})})})]})}),gh.jsx(sd,{open:null!==R,onOpenChange:()=>{N(null),O(""),L(""),B("")},children:gh.jsxs(od,{className:"max-w-2xl",children:[gh.jsxs(cd,{children:[gh.jsx(ld,{children:"编辑资料"}),gh.jsx(hd,{children:"修改资料的基本信息，包括名称、描述和分类"})]}),gh.jsxs("div",{className:"space-y-4",children:[gh.jsxs("div",{children:[gh.jsx(Xh,{htmlFor:"asset-name",children:"资料名称"}),gh.jsx($h,{id:"asset-name",value:M,onChange:e=>O(e.target.value),placeholder:"请输入资料名称"})]}),gh.jsxs("div",{children:[gh.jsx(Xh,{htmlFor:"asset-category",children:"分类"}),gh.jsxs(ed,{value:W,onValueChange:B,children:[gh.jsx(td,{children:gh.jsx(nd,{placeholder:"选择分类"})}),gh.jsx(id,{children:_.map(e=>gh.jsx(rd,{value:e,children:e},e))})]})]}),gh.jsxs("div",{children:[gh.jsx(Xh,{htmlFor:"asset-description",children:"描述"}),gh.jsx(Kh,{id:"asset-description",value:P,onChange:e=>L(e.target.value),placeholder:"请输入资料描述（可选）",rows:3})]})]}),gh.jsxs(dd,{children:[gh.jsx(Nh,{variant:"outline",onClick:()=>{N(null),O(""),L(""),B("")},children:"取消"}),gh.jsx(Nh,{onClick:()=>{E&&(i(e=>e.map(e=>e.id===E.id?{...e,name:M,description:P,category:W}:e)),N(null),A(null),O(""),L(""),B(""),q({title:"保存成功",description:"品牌资料信息已更新"}))},children:"保存"})]})]})})]})}function YO({dimension:e,onUpdate:t,onAddKeyword:n,onRemoveKeyword:i,isEditing:r,onEdit:a,onCancel:s}){const[o,c]=ph.useState(""),l=()=>{o.trim()&&(n(e.id,o),c(""))};return gh.jsxs("div",{className:"space-y-3",children:[gh.jsxs("div",{className:"flex items-start justify-between",children:[gh.jsxs("div",{className:"flex items-center gap-2",children:[e.icon,gh.jsxs("div",{children:[gh.jsx(Xh,{className:"text-sm font-medium",children:e.title}),gh.jsx("p",{className:"text-xs text-gray-500",children:e.description})]})]}),r?gh.jsx(Nh,{variant:"ghost",size:"sm",onClick:s,children:gh.jsx(Oh,{className:"h-4 w-4"})}):gh.jsx(Nh,{variant:"ghost",size:"sm",onClick:a,children:gh.jsx(Rd,{className:"h-4 w-4"})})]}),r?gh.jsxs("div",{className:"space-y-3",children:[gh.jsx(Kh,{placeholder:e.placeholder,value:e.value,onChange:n=>t(e.id,n.target.value),className:"min-h-[80px]"}),gh.jsxs("div",{className:"space-y-2",children:[gh.jsx(Xh,{className:"text-xs font-medium",children:"关键词"}),gh.jsxs("div",{className:"flex gap-2",children:[gh.jsx($h,{placeholder:"添加关键词...",value:o,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&l(),className:"flex-1"}),gh.jsx(Nh,{size:"sm",onClick:l,children:gh.jsx(Od,{className:"h-4 w-4"})})]}),e.keywords.length>0&&gh.jsx("div",{className:"flex flex-wrap gap-1",children:e.keywords.map((t,n)=>gh.jsxs(fd,{variant:"secondary",className:"cursor-pointer hover:bg-red-100",onClick:()=>i(e.id,t),children:[t," ",gh.jsx(Oh,{className:"h-3 w-3 ml-1"})]},n))})]})]}):gh.jsxs("div",{className:"p-3 bg-gray-50 rounded-md",children:[e.value?gh.jsx("p",{className:"text-sm",children:e.value}):gh.jsx("p",{className:"text-sm text-gray-400",children:"暂无内容"}),e.keywords.length>0&&gh.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.keywords.map((e,t)=>gh.jsx(fd,{variant:"outline",className:"text-xs",children:e},t))})]})]})}export{KO as default};
