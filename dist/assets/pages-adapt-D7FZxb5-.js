import{j as e,P as s,C as t,a,b as r,c as i,d as l,L as n,e as o,f as c,g as d,h as m,i as h,k as x,I as u,l as p,m as f,n as g,o as j,V as b,p as N,q as v,s as w,t as y,u as I,v as k,w as S,x as C,y as z,z as O,A,B as T,D as P,E,F as R,G as $,H as U,J as D,O as B}from"./ui-core-DvCHSSHi.js";import{r as F,u as J}from"./router-C2V8BG2_.js";import{P as M}from"./components-layout-1yKIHtlJ.js";import{c as H,u as _,B as L,C as G,a as V,b as K,d as q,e as W}from"./pages-home-D0WvN7gs.js";import{a as X,f as Z,g as Q,h as Y,i as ee,X as se,j as te,k as ae,l as re,K as ie,m as le,E as ne,n as oe,o as ce,p as de,C as me,A as he,q as xe,e as ue,B as pe,M as fe,V as ge,S as je,T as be,b as Ne,G as ve,Z as we,R as ye,r as Ie,s as ke,u as Se,H as Ce,v as ze,w as Oe,x as Ae,y as Te}from"./utils-OoJFdsFh.js";const Pe=a,Ee=r,Re=i,$e=F.forwardRef(({className:a,sideOffset:r=4,...i},l)=>e.jsx(s,{children:e.jsx(t,{ref:l,sideOffset:r,className:H("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...i})}));$e.displayName=t.displayName;const Ue=X("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",premium:"border-transparent bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg",success:"border-transparent bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-md",warning:"border-transparent bg-gradient-to-r from-yellow-500 to-orange-600 text-white shadow-md",info:"border-transparent bg-gradient-to-r from-blue-500 to-cyan-600 text-white shadow-md",neon:"border-2 border-blue-500 text-blue-500 bg-transparent shadow-glow",neonPurple:"border-2 border-purple-500 text-purple-500 bg-transparent shadow-glow-purple",neonGreen:"border-2 border-green-500 text-green-500 bg-transparent shadow-glow-green",soft:"border border-gray-200 bg-white/80 backdrop-blur-sm text-gray-700 shadow-sm",glass:"border border-white/20 bg-white/10 backdrop-blur-md text-white shadow-sm",glassBlue:"border border-blue-500/20 bg-blue-500/5 backdrop-blur-sm text-blue-700 shadow-sm",glassPurple:"border border-purple-500/20 bg-purple-500/5 backdrop-blur-sm text-purple-700 shadow-sm",glassGreen:"border border-green-500/20 bg-green-500/5 backdrop-blur-sm text-green-700 shadow-sm",dark:"border border-gray-700 bg-gray-900 text-white shadow-md",light:"border border-gray-200 bg-gray-100 text-gray-900 shadow-sm"},size:{default:"px-2.5 py-0.5 text-xs",sm:"px-2 py-0.5 text-xs",lg:"px-3 py-1 text-sm",xl:"px-4 py-1.5 text-base"},animation:{none:"",pulse:"animate-pulse",bounce:"animate-bounce",glow:"animate-glow",wave:"animate-wave",float:"animate-float"}},defaultVariants:{variant:"default",size:"default",animation:"none"}});function De({className:s,variant:t,size:a,animation:r,...i}){return e.jsx("div",{className:H(Ue({variant:t,size:a,animation:r}),s),...i})}const Be=F.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:H("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...a}));Be.displayName="Input";const Fe=X("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Je=F.forwardRef(({className:s,...t},a)=>e.jsx(l,{ref:a,className:H(Fe(),s),...t}));Je.displayName=l.displayName;const Me=d,He=F.forwardRef(({className:s,...t},a)=>e.jsx(n,{ref:a,className:H("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));He.displayName=n.displayName;const _e=F.forwardRef(({className:s,...t},a)=>e.jsx(o,{ref:a,className:H("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t}));_e.displayName=o.displayName;const Le=F.forwardRef(({className:s,...t},a)=>e.jsx(c,{ref:a,className:H("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));Le.displayName=c.displayName;const Ge=F.forwardRef(({className:s,...t},a)=>e.jsx(m,{ref:a,className:H("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(h,{className:H("flex items-center justify-center text-current"),children:e.jsx(Z,{className:"h-4 w-4"})})}));Ge.displayName=m.displayName;const Ve=F.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:H("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...t}));Ve.displayName="Textarea";const Ke=k,qe=S,We=F.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(x,{ref:r,className:H("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(u,{asChild:!0,children:e.jsx(Q,{className:"h-4 w-4 opacity-50"})})]}));We.displayName=x.displayName;const Xe=F.forwardRef(({className:s,...t},a)=>e.jsx(p,{ref:a,className:H("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Y,{className:"h-4 w-4"})}));Xe.displayName=p.displayName;const Ze=F.forwardRef(({className:s,...t},a)=>e.jsx(f,{ref:a,className:H("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Q,{className:"h-4 w-4"})}));Ze.displayName=f.displayName;const Qe=F.forwardRef(({className:s,children:t,position:a="popper",...r},i)=>e.jsx(g,{children:e.jsxs(j,{ref:i,className:H("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(Xe,{}),e.jsx(b,{className:H("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Ze,{})]})}));Qe.displayName=j.displayName,F.forwardRef(({className:s,...t},a)=>e.jsx(N,{ref:a,className:H("px-2 py-1.5 text-sm font-semibold",s),...t})).displayName=N.displayName;const Ye=F.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(v,{ref:r,className:H("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(w,{children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(y,{children:t})]}));Ye.displayName=v.displayName,F.forwardRef(({className:s,...t},a)=>e.jsx(I,{ref:a,className:H("-mx-1 my-1 h-px bg-muted",s),...t})).displayName=I.displayName;const es=F.forwardRef(({className:s,...t},a)=>e.jsxs(C,{ref:a,className:H("relative flex w-full touch-none select-none items-center",s),...t,children:[e.jsx(z,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(O,{className:"absolute h-full bg-primary"})}),e.jsx(A,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));es.displayName=C.displayName;const ss={"gpt-4o":{id:"gpt-4o",name:"OpenAI GPT-4o",provider:"OpenAI",description:"最新最强大的AI模型，性能卓越，创意丰富，支持多模态输入输出",features:["超强理解能力","创意内容生成","多模态支持","上下文记忆优秀","代码生成能力强"],maxTokens:128e3,pricing:{input:.0025,output:.01}},"gpt-4o-mini":{id:"gpt-4o-mini",name:"OpenAI GPT-4o mini",provider:"OpenAI",description:"GPT-4o的轻量版本，性价比极高，适合日常使用",features:["性价比极高","响应速度快","理解能力优秀","适合日常对话","成本控制友好"],maxTokens:128e3,pricing:{input:15e-5,output:6e-4}},"deepseek-v3":{id:"deepseek-v3",name:"DeepSeek V3",provider:"DeepSeek",description:"中文优化模型，理解力强，适合本地化内容和中文创作",features:["中文理解优秀","本地化内容创作","文化语境理解","中文表达自然","适合中文用户"],maxTokens:128e3,pricing:{input:14e-5,output:56e-5}}},ts={trial:["gpt-4o-mini","deepseek-v3"],pro:["gpt-4o","gpt-4o-mini","deepseek-v3"],premium:["gpt-4o","gpt-4o-mini","deepseek-v3"]};function as(e){return ss[e]}function rs(e,s){let t;try{t=e()}catch(a){return}return{getItem:e=>{var s;const a=e=>null===e?null:JSON.parse(e,void 0),r=null!=(s=t.getItem(e))?s:null;return r instanceof Promise?r.then(a):a(r)},setItem:(e,s)=>t.setItem(e,JSON.stringify(s,void 0)),removeItem:e=>t.removeItem(e)}}const is=e=>s=>{try{const t=e(s);return t instanceof Promise?t:{then:e=>is(e)(t),catch(e){return this}}}catch(t){return{then(e){return this},catch:e=>is(e)(t)}}},ls=()=>{let e="";for(let s=0;s<8;s++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(36*Math.random()));return e},ns=ee()((hs=(e,s)=>({usageRemaining:10,lastReset:null,userInviteCode:ls(),userInviteStats:{totalClicks:0,totalRegistrations:0,totalRewardsClaimed:0,invitationLinks:[]},decrementUsage:()=>{const{usageRemaining:t}=s();t>0&&e({usageRemaining:t-1})},addUsageFromInvite:t=>{const{usageRemaining:a}=s();e({usageRemaining:a+t})},addUsageFromClick:()=>{const{usageRemaining:t}=s();e({usageRemaining:t+1})},resetMonthlyUsage:()=>{const s=(new Date).toISOString();e({usageRemaining:10,lastReset:s})},generateInviteCode:()=>{const s=ls();return e({userInviteCode:s}),s},registerClick:()=>{const{userInviteStats:t}=s(),a={...t,totalClicks:t.totalClicks+1};e({userInviteStats:a})},registerInvite:()=>{const{userInviteStats:t}=s(),a={...t,totalRegistrations:t.totalRegistrations+1};e({userInviteStats:a})},checkAndResetWeeklyLimit:()=>{}}),"getStorage"in(xs={name:"user-store",partialize:e=>({usageRemaining:e.usageRemaining,lastReset:e.lastReset,userInviteCode:e.userInviteCode,userInviteStats:e.userInviteStats})})||"serialize"in xs||"deserialize"in xs?((e,s)=>(t,a,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,s)=>({...s,...e}),...s},l=!1;const n=new Set,o=new Set;let c;try{c=i.getStorage()}catch(f){}if(!c)return e((...e)=>{t(...e)},a,r);const d=is(i.serialize),m=()=>{const e=i.partialize({...a()});let s;const t=d({state:e,version:i.version}).then(e=>c.setItem(i.name,e)).catch(e=>{s=e});if(s)throw s;return t},h=r.setState;r.setState=(e,s)=>{h(e,s),m()};const x=e((...e)=>{t(...e),m()},a,r);let u;const p=()=>{var e;if(!c)return;l=!1,n.forEach(e=>e(a()));const s=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,a()))||void 0;return is(c.getItem.bind(c))(i.name).then(e=>{if(e)return i.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version)}}).then(e=>{var s;return u=i.merge(e,null!=(s=a())?s:x),t(u,!0),m()}).then(()=>{null==s||s(u,void 0),l=!0,o.forEach(e=>e(u))}).catch(e=>{null==s||s(void 0,e)})};return r.persist={setOptions:e=>{i={...i,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>l,onHydrate:e=>(n.add(e),()=>{n.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},p(),u||x})(hs,xs):((e,s)=>(t,a,r)=>{let i={storage:rs(()=>localStorage),partialize:e=>e,version:0,merge:(e,s)=>({...s,...e}),...s},l=!1;const n=new Set,o=new Set;let c=i.storage;if(!c)return e((...e)=>{t(...e)},a,r);const d=()=>{const e=i.partialize({...a()});return c.setItem(i.name,{state:e,version:i.version})},m=r.setState;r.setState=(e,s)=>{m(e,s),d()};const h=e((...e)=>{t(...e),d()},a,r);let x;r.getInitialState=()=>h;const u=()=>{var e,s;if(!c)return;l=!1,n.forEach(e=>{var s;return e(null!=(s=a())?s:h)});const r=(null==(s=i.onRehydrateStorage)?void 0:s.call(i,null!=(e=a())?e:h))||void 0;return is(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate)return[!0,i.migrate(e.state,e.version)]}return[!1,void 0]}).then(e=>{var s;const[r,l]=e;if(x=i.merge(l,null!=(s=a())?s:h),t(x,!0),r)return d()}).then(()=>{null==r||r(x,void 0),x=a(),l=!0,o.forEach(e=>e(x))}).catch(e=>{null==r||r(void 0,e)})};return r.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>u(),hasHydrated:()=>l,onHydrate:e=>(n.add(e),()=>{n.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},i.skipHydration||u(),x||h})(hs,xs))),os=T,cs=P,ds=E,ms=F.forwardRef(({className:s,...t},a)=>e.jsx(B,{ref:a,className:H("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));var hs,xs;ms.displayName=B.displayName;const us=F.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(ds,{children:[e.jsx(ms,{}),e.jsxs(R,{ref:r,className:H("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs($,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));us.displayName=R.displayName;const ps=({className:s,...t})=>e.jsx("div",{className:H("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});ps.displayName="DialogHeader";const fs=({className:s,...t})=>e.jsx("div",{className:H("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});fs.displayName="DialogFooter";const gs=F.forwardRef(({className:s,...t},a)=>e.jsx(U,{ref:a,className:H("text-lg font-semibold leading-none tracking-tight",s),...t}));gs.displayName=U.displayName;const js=F.forwardRef(({className:s,...t},a)=>e.jsx(D,{ref:a,className:H("text-sm text-muted-foreground",s),...t}));js.displayName=D.displayName;const bs={weibo:{platformId:"weibo",platformName:"微博",authUrl:"https://open.weibo.com/oauth2/authorize",apiBaseUrl:"https://api.weibo.com/2",isAuthorized:!1},zhihu:{platformId:"zhihu",platformName:"知乎",authUrl:"https://www.zhihu.com/oauth/authorize",apiBaseUrl:"https://api.zhihu.com",isAuthorized:!1},xiaohongshu:{platformId:"xiaohongshu",platformName:"小红书",authUrl:"https://oauth.xiaohongshu.com/oauth/authorize",apiBaseUrl:"https://api.xiaohongshu.com",isAuthorized:!1},bilibili:{platformId:"bilibili",platformName:"B站",authUrl:"https://passport.bilibili.com/login",apiBaseUrl:"https://api.bilibili.com",isAuthorized:!1},douyin:{platformId:"douyin",platformName:"抖音",authUrl:"https://open.douyin.com/oauth/authorize",apiBaseUrl:"https://open.douyin.com",isAuthorized:!1},twitter:{platformId:"twitter",platformName:"Twitter",authUrl:"https://twitter.com/i/oauth2/authorize",apiBaseUrl:"https://api.twitter.com/2",isAuthorized:!1},linkedin:{platformId:"linkedin",platformName:"LinkedIn",authUrl:"https://www.linkedin.com/oauth/v2/authorization",apiBaseUrl:"https://api.linkedin.com/v2",isAuthorized:!1}};function Ns(){return Object.values(bs)}function vs(e){const s=`platform_api_config_${e}`,t=localStorage.getItem(s);if(!t)return null;try{const s=JSON.parse(t);return{...bs[e],...s}}catch{return null}}async function ws(e,s){const t=vs(e);if(!t)return{success:!1,error:"平台配置不存在"};switch(e){case"weibo":return await async function(e,s){var t;try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成微博授权"};const a=await fetch(`${s.apiBaseUrl}/statuses/update.json`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${s.accessToken}`},body:new URLSearchParams({status:e.text,source:"wenpai-app"})}),r=await a.json();return r.id?{success:!0,publishId:r.id,publishUrl:`https://weibo.com/${null==(t=r.user)?void 0:t.id}/${r.id}`,response:r}:{success:!1,error:r.error||"发布失败"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"网络错误"}}}(s,t);case"zhihu":return await async function(e,s){try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成知乎授权"};const t=await fetch(`${s.apiBaseUrl}/drafts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.accessToken}`},body:JSON.stringify({title:e.title||"新文章",content:e.text,topics:e.hashtags||[]})}),a=await t.json();if(a.id){const e=await fetch(`${s.apiBaseUrl}/drafts/${a.id}/publish`,{method:"POST",headers:{Authorization:`Bearer ${s.accessToken}`}}),t=await e.json();if(t.url)return{success:!0,publishId:a.id,publishUrl:t.url,response:t}}return{success:!1,error:"发布失败"}}catch(t){return{success:!1,error:t instanceof Error?t.message:"网络错误"}}}(s,t);case"twitter":return await async function(e,s){var t,a,r;try{if(!s.accessToken)return{success:!1,error:"未授权，请先完成Twitter授权"};const i=await fetch(`${s.apiBaseUrl}/tweets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.accessToken}`},body:JSON.stringify({text:e.text})}),l=await i.json();return(null==(t=l.data)?void 0:t.id)?{success:!0,publishId:l.data.id,publishUrl:`https://twitter.com/user/status/${l.data.id}`,response:l}:{success:!1,error:(null==(r=null==(a=l.errors)?void 0:a[0])?void 0:r.message)||"发布失败"}}catch(i){return{success:!1,error:i instanceof Error?i.message:"网络错误"}}}(s,t);default:return{success:!1,error:"暂不支持该平台的API直发"}}}function ys(e){const s=vs(e);return(null==s?void 0:s.isAuthorized)||!1}function Is({open:s,onOpenChange:t}){const{toast:a}=_(),[r,i]=F.useState([]),[l,n]=F.useState(null),[o,c]=F.useState(!1),[d,m]=F.useState(""),[h,x]=F.useState(""),[u,p]=F.useState("");F.useEffect(()=>{if(s){const e=Ns().map(e=>vs(e.platformId)||e);i(e)}},[s]);const f=s=>s.isAuthorized?e.jsx(ce,{className:"w-4 h-4 text-green-500"}):s.accessToken?e.jsx(de,{className:"w-4 h-4 text-yellow-500"}):e.jsx(oe,{className:"w-4 h-4 text-gray-400"}),g=e=>e.isAuthorized?"已授权":e.accessToken?"待验证":"未配置",j=e=>e.isAuthorized?"bg-green-100 text-green-800 border-green-200":e.accessToken?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-600 border-gray-200";return e.jsx(os,{open:s,onOpenChange:t,children:e.jsxs(us,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsx(ps,{children:e.jsxs(gs,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"平台API配置管理"]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(Me,{defaultValue:"platforms",className:"h-full",children:[e.jsxs(He,{className:"grid w-full grid-cols-2",children:[e.jsx(_e,{value:"platforms",children:"平台配置"}),e.jsx(_e,{value:"help",children:"使用说明"})]}),e.jsx(Le,{value:"platforms",className:"h-full overflow-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"配置平台API密钥和访问令牌，支持内容直发功能"})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{const e=Ns().map(e=>vs(e.platformId)||e);i(e),a({title:"状态已刷新",description:"平台配置状态已更新"})},children:[e.jsx(re,{className:"w-4 h-4 mr-1"}),"刷新状态"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(s=>e.jsxs(G,{className:"relative",children:[e.jsxs(V,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(K,{className:"text-lg",children:s.platformName}),e.jsxs("div",{className:"flex items-center gap-2",children:[f(s),e.jsx(De,{variant:"outline",className:j(s),children:g(s)})]})]}),e.jsxs(q,{children:["平台ID: ",s.platformId]})]}),e.jsxs(W,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["API密钥: ",s.apiKey?"已配置":"未配置"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(le,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["访问令牌: ",s.accessToken?"已配置":"未配置"]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>(e=>{n(e),m(e.apiKey||""),x(e.accessToken||""),p(e.userId||""),c(!0)})(s),children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),"配置"]}),s.authUrl&&e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>(e=>{const s=function(e){const s=function(e){return bs[e]||null}(e);return(null==s?void 0:s.authUrl)||null}(e.platformId);s?(window.open(s,"_blank","noopener,noreferrer"),a({title:"授权页面已打开",description:"请在授权页面完成授权，然后返回配置访问令牌"})):a({title:"授权失败",description:"该平台暂不支持授权",variant:"destructive"})})(s),children:[e.jsx(ne,{className:"w-4 h-4 mr-1"}),"授权"]}),(s.apiKey||s.accessToken)&&e.jsxs(L,{size:"sm",variant:"outline",onClick:()=>{return function(e){const s=`platform_api_config_${e}`;localStorage.removeItem(s)}(e=s.platformId),i(s=>s.map(s=>s.platformId===e?{...s,apiKey:void 0,accessToken:void 0,userId:void 0,isAuthorized:!1}:s)),void a({title:"配置已清除",description:"平台API配置已清除"});var e},children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"清除"]})]})]})]},s.platformId))})]})}),e.jsx(Le,{value:"help",className:"h-full overflow-auto",children:e.jsx("div",{className:"space-y-6",children:e.jsxs(G,{children:[e.jsx(V,{children:e.jsx(K,{children:"API直发功能说明"})}),e.jsxs(W,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"什么是API直发？"}),e.jsx("p",{className:"text-sm text-gray-600",children:"API直发功能允许您通过平台的官方API直接发布内容，无需手动复制粘贴。 配置完成后，可以一键将AI生成的内容直接发布到各平台。"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"支持的平台"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• 微博 - 支持文本发布"}),e.jsx("li",{children:"• 知乎 - 支持文章发布"}),e.jsx("li",{children:"• Twitter - 支持推文发布"}),e.jsx("li",{children:"• 更多平台开发中..."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"配置步骤"}),e.jsxs("ol",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'1. 点击"授权"按钮，在平台官网完成授权'}),e.jsx("li",{children:"2. 获取API密钥和访问令牌"}),e.jsx("li",{children:"3. 在配置页面填入相关信息"}),e.jsx("li",{children:"4. 保存配置，即可使用API直发功能"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"安全说明"}),e.jsx("p",{className:"text-sm text-gray-600",children:"所有API密钥和访问令牌仅存储在您的浏览器本地，不会上传到服务器。 请妥善保管您的密钥信息，不要泄露给他人。"})]})]})]})})})]})}),e.jsx(os,{open:o,onOpenChange:c,children:e.jsxs(us,{children:[e.jsx(ps,{children:e.jsxs(gs,{children:["配置 ",null==l?void 0:l.platformName," API"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"apiKey",children:"API密钥"}),e.jsx(Be,{id:"apiKey",type:"password",placeholder:"请输入API密钥",value:d,onChange:e=>m(e.target.value)})]}),e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"accessToken",children:"访问令牌"}),e.jsx(Be,{id:"accessToken",type:"password",placeholder:"请输入访问令牌",value:h,onChange:e=>x(e.target.value)})]}),e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"userId",children:"用户ID"}),e.jsx(Be,{id:"userId",placeholder:"请输入用户ID（可选）",value:u,onChange:e=>p(e.target.value)})]})]}),e.jsxs(fs,{children:[e.jsx(L,{variant:"outline",onClick:()=>c(!1),children:"取消"}),e.jsx(L,{onClick:()=>{if(!l)return;const e={apiKey:d.trim()||void 0,accessToken:h.trim()||void 0,userId:u.trim()||void 0,isAuthorized:!!h.trim()};!function(e,s){const t=`platform_api_config_${e}`;localStorage.setItem(t,JSON.stringify(s))}(l.platformId,e),i(s=>s.map(s=>s.platformId===l.platformId?{...s,...e}:s)),c(!1),n(null),a({title:"配置已保存",description:`${l.platformName}的API配置已更新`})},children:"保存配置"})]})]})})]})})}function ks({isOpen:s,onClose:t,onUpgrade:a,remainingCount:r,userType:i}){const l="trial"===i?{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会，立即升级享受更多功能！`,upgradeText:"立即升级",upgradeDescription:"升级后享受更多使用次数和高级功能"}:"pro"===i?{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会，升级后不限次！`,upgradeText:"升级高级版",upgradeDescription:"升级到高级版享受不限量使用"}:{title:"使用次数即将用完",description:`仅剩 ${r} 次调用机会`,upgradeText:"立即升级",upgradeDescription:"升级后享受更多使用次数"};return e.jsx(os,{open:s,onOpenChange:t,children:e.jsxs(us,{className:"sm:max-w-md",children:[e.jsx(ps,{children:e.jsxs(gs,{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(de,{className:"h-5 w-5"}),l.title]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600 mb-2",children:["仅剩 ",r," 次"]}),e.jsx("p",{className:"text-gray-600",children:l.description})]}),"trial"===i&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"升级专业版特权"]}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• 30次/月AI内容适配"}),e.jsx("li",{children:"• 创意魔方功能"}),e.jsx("li",{children:"• 高级AI模型"}),e.jsx("li",{children:"• 余额继承机制"})]})]}),"pro"===i&&e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200",children:[e.jsxs("h4",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"升级高级版特权"]}),e.jsxs("ul",{className:"text-sm text-amber-700 space-y-1",children:[e.jsx("li",{children:"• 不限量AI内容适配"}),e.jsx("li",{children:"• 全网雷达功能"}),e.jsx("li",{children:"• 品牌库功能"}),e.jsx("li",{children:"• 最新AI模型"})]})]})]}),e.jsxs(fs,{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",onClick:t,children:"稍后再说"}),e.jsxs(L,{onClick:a,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:[l.upgradeText,e.jsx(he,{className:"h-4 w-4 ml-2"})]})]})]})})}function Ss({isOpen:s,onClose:t,onUpgrade:a,featureName:r,featureDescription:i}){return e.jsx(os,{open:s,onOpenChange:t,children:e.jsxs(us,{className:"sm:max-w-md",children:[e.jsx(ps,{children:e.jsxs(gs,{className:"flex items-center gap-2 text-purple-600",children:[e.jsx(xe,{className:"h-5 w-5"}),"高级功能权限"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-gray-800 mb-2",children:r}),e.jsx("p",{className:"text-gray-600",children:i})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg border border-purple-200",children:[e.jsxs("h4",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"升级高级版解锁特权"]}),e.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[e.jsx("li",{children:"• 不限量AI内容适配"}),e.jsx("li",{children:"• 创意魔方功能"}),e.jsx("li",{children:"• 全网雷达功能"}),e.jsx("li",{children:"• 品牌库功能"}),e.jsx("li",{children:"• 最新AI模型"}),e.jsx("li",{children:"• 余额继承机制"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 p-3 rounded-lg border border-amber-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"限时优惠：年付省300元"})]})})]}),e.jsxs(fs,{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",onClick:t,children:"稍后再说"}),e.jsxs(L,{onClick:a,className:"bg-gradient-to-r from-purple-500 to-blue-600 hover:from-purple-600 hover:to-blue-700",children:["立即升级解锁",e.jsx(he,{className:"h-4 w-4 ml-2"})]})]})]})})}const Cs={weibo:"https://weibo.com/newpost",xiaohongshu:"https://creator.xiaohongshu.com/publish",zhihu:"https://zhuanlan.zhihu.com/write",bilibili:"https://member.bilibili.com/platform/upload/text",douyin:"https://creator.douyin.com/creator-micro/content/upload",toutiao:"https://mp.toutiao.com/profile_v4/graphic/publish",baijiahao:"https://baijiahao.baidu.com/builder/rc/edit",kuaishou:"https://cp.kuaishou.com/article/publish",wechat:"https://mp.weixin.qq.com/",facebook:"https://www.facebook.com/",twitter:"https://twitter.com/compose/tweet",linkedin:"https://www.linkedin.com/feed/",v2ex:"https://www.v2ex.com/new",github:"https://github.com/new",sspai:"https://sspai.com/write",juejin:"https://juejin.cn/editor/drafts/new",csdn:"https://mp.csdn.net/mp_blog/creation/editor",hellogithub:"https://hellogithub.com/",ithome:"https://my.ithome.com/#/write",ngabbs:"https://bbs.nga.cn/thread.php?fid=-7",weatheralarm:"https://www.nmc.cn/",earthquake:"https://www.ceic.ac.cn/",history:"https://baike.baidu.com/item/%E5%8E%86%E5%8F%B2%E4%B8%8A%E7%9A%84%E4%BB%8A%E5%A4%A9/42704"},zs={weibo:{name:"微博",color:"text-orange-500"},xiaohongshu:{name:"小红书",color:"text-rose-500"},zhihu:{name:"知乎",color:"text-blue-500"},bilibili:{name:"B站",color:"text-blue-400"},douyin:{name:"抖音",color:"text-black"},toutiao:{name:"头条",color:"text-red-500"},baijiahao:{name:"百家号",color:"text-blue-600"},kuaishou:{name:"快手",color:"text-red-600"},wechat:{name:"微信",color:"text-green-500"},facebook:{name:"Facebook",color:"text-blue-600"},twitter:{name:"Twitter",color:"text-blue-400"},linkedin:{name:"LinkedIn",color:"text-blue-700"},v2ex:{name:"V2EX",color:"text-gray-600"},github:{name:"GitHub",color:"text-gray-800"},sspai:{name:"少数派",color:"text-blue-500"},juejin:{name:"掘金",color:"text-blue-600"},csdn:{name:"CSDN",color:"text-red-500"},hellogithub:{name:"HelloGitHub",color:"text-green-600"},ithome:{name:"IT之家",color:"text-blue-500"},ngabbs:{name:"NGA",color:"text-orange-600"},weatheralarm:{name:"天气预警",color:"text-yellow-600"},earthquake:{name:"地震信息",color:"text-red-600"},history:{name:"历史上的今天",color:"text-purple-600"}};function Os(s){const t=s;switch(s){case"zhihu":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 text-blue-500 mr-1"}),e.jsx("span",{className:"text-xs",children:"知乎"})]});case"weibo":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(je,{className:"h-4 w-4 text-orange-500 mr-1"}),e.jsx("span",{className:"text-xs",children:"微博"})]});case"xiaohongshu":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"h-4 w-4 text-rose-500 mr-1"}),e.jsx("span",{className:"text-xs",children:"小红书"})]});case"wechat":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-xs",children:"微信"})]});case"douyin":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"h-4 w-4 text-black mr-1"}),e.jsx("span",{className:"text-xs",children:"抖音"})]});case"video":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-4 w-4 text-green-600 mr-1"}),e.jsx("span",{className:"text-xs",children:"视频号"})]});case"twitter":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{className:"h-4 w-4 text-black mr-1"}),e.jsx("span",{className:"text-xs",children:"Twitter"})]});case"bilibili":return e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"h-4 w-4 text-blue-400 mr-1"}),e.jsx("span",{className:"text-xs",children:"B站"})]});default:return e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-xs",children:t})]})}}function As(e){switch(e){case"zhihu":return 200;case"douyin":case"video":default:return 50;case"xiaohongshu":case"bilibili":return 100;case"wechat":return 300;case"weibo":return 20;case"twitter":return 10}}function Ts(e){switch(e){case"zhihu":return 1e4;case"douyin":case"xiaohongshu":case"video":return 1e3;case"wechat":return 2e4;case"weibo":default:return 2e3;case"twitter":return 280;case"bilibili":return 5e3}}function Ps({icon:s,title:t,description:a,checked:r,onChange:i}){return e.jsxs(G,{className:H("relative border cursor-pointer transition-all duration-200 h-36 flex flex-col",r?"border-primary bg-primary/5 shadow-md ring-1 ring-primary/20":"bg-background hover:shadow-sm hover:border-gray-300"),onClick:()=>i(!r),children:[e.jsx(V,{className:"pb-1 pt-4 flex-shrink-0",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center space-x-2 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0",children:s}),e.jsx(K,{className:"text-sm font-semibold truncate leading-tight",children:t})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ge,{checked:r,onCheckedChange:i,className:"data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground"})})]})}),e.jsx(W,{className:"pt-0 pb-4 flex-grow flex items-start",children:e.jsx(q,{className:"text-xs leading-relaxed overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",maxHeight:"4.8rem"},children:a})})]})}const Es=Object.freeze(Object.defineProperty({__proto__:null,default:function(){var s,t,a;const{toast:r}=_(),i=J(),[l,n]=F.useState(""),[o,c]=F.useState([]),[d,m]=F.useState([]),[h,x]=F.useState(!1),[u,p]=F.useState(!1),[f,g]=F.useState({}),[j,b]=F.useState({}),[N,v]=F.useState(!1),[w,y]=F.useState(null),[I,k]=F.useState({}),[S,C]=F.useState(new Set),[z,O]=F.useState({charCountPreset:"auto",globalEmoji:!1,globalMd:!1}),[A,T]=F.useState("openai"),[P,E]=F.useState("gpt-4o"),[R,$]=F.useState("trial"),U=(ts[R]||[]).map(e=>ss[e]).filter(Boolean),D=Object.values(ss),{usageRemaining:B,decrementUsage:H}=ns(),[X,Z]=F.useState(!1),[ee,se]=F.useState(0),[ae,ie]=F.useState(!1),[le,oe]=F.useState({name:"",description:""}),ce=F.useMemo(()=>[{id:"xiaohongshu",name:"小红书",description:"适合生活方式、美妆、旅行等分享，强调个人体验和情感共鸣",icon:e.jsx(pe,{className:"h-4 w-4 text-rose-500"})},{id:"zhihu",name:"知乎",description:"适合专业知识分享和理性讨论，强调逻辑和论证",icon:e.jsx(fe,{className:"h-4 w-4 text-blue-500"})},{id:"douyin",name:"抖音脚本",description:"适合短视频脚本，活泼有趣，强调视听效果",icon:e.jsx(ge,{className:"h-4 w-4 text-black"})},{id:"weibo",name:"新浪微博",description:"简短有力的观点表达，适合热点话题讨论",icon:e.jsx(je,{className:"h-4 w-4 text-orange-500"})},{id:"wechat",name:"公众号",description:"深度内容，适合教程、观点和专业分析",icon:e.jsx(fe,{className:"h-4 w-4 text-green-500"})},{id:"bilibili",name:"B站",description:"适合视频脚本，兼具专业性和趣味性",icon:e.jsx(ge,{className:"h-4 w-4 text-blue-400"})},{id:"twitter",name:"X（推特）",description:"简短、直接的表达，支持多种语言和国际化视角",icon:e.jsx(be,{className:"h-4 w-4 text-black"})},{id:"video",name:"视频号",description:"视频内容与互动引导并重，亲和力强",icon:e.jsx(Ne,{className:"h-4 w-4 text-green-600"})},{id:"baijia",name:"百家号",description:"长篇深度内容，SEO友好，权威感强，适合资讯类内容",icon:e.jsx(ve,{className:"h-4 w-4 text-blue-700"})},{id:"kuaishou",name:"快手",description:"接地气表达，真实朴实，亲民风格，适合生活记录",icon:e.jsx(we,{className:"h-4 w-4 text-yellow-600"})},{id:"wangyi",name:"网易小蜜蜂",description:"注重原创性，文笔流畅，观点独特，适合深度评论",icon:e.jsx(ye,{className:"h-4 w-4 text-red-500"})},{id:"toutiao",name:"头条号",description:"标题党友好，热点敏感，算法推荐，适合时事评论",icon:e.jsx(ve,{className:"h-4 w-4 text-purple-600"})}],[]),de=F.useCallback(()=>{const e={};ce.forEach(s=>{e[s.id]={charCount:Math.floor(.6*Ts(s.id)),useEmoji:"xiaohongshu"===s.id||"weibo"===s.id,useMdFormat:"zhihu"===s.id||"wechat"===s.id,useAutoFormat:!0}}),g(e);const s={};ce.forEach(e=>{s[e.id]=!1}),b(s)},[ce]),me=()=>{try{localStorage.setItem("platformSettings",JSON.stringify(f)),localStorage.setItem("globalSettings",JSON.stringify(z)),localStorage.setItem("selectedPlatforms",JSON.stringify(o)),r({title:"设置已保存",description:"您的平台设置已成功保存"})}catch{r({title:"保存设置失败",description:"无法保存您的设置，请稍后再试",variant:"destructive"})}};F.useEffect(()=>{Object.keys(f).length>0&&localStorage.setItem("platformSettings",JSON.stringify(f))},[f]),F.useEffect(()=>{Object.keys(z).length>0&&localStorage.setItem("globalSettings",JSON.stringify(z))},[z]),F.useEffect(()=>{o.length>0&&localStorage.setItem("selectedPlatforms",JSON.stringify(o))},[o]),F.useEffect(()=>{const e=localStorage.getItem("platformSettings"),s=localStorage.getItem("globalSettings"),t=localStorage.getItem("selectedPlatforms");if(e)try{const s=JSON.parse(e);g(s)}catch{de()}else de();if(s)try{const e=JSON.parse(s);O(e)}catch{}if(t)try{const e=JSON.parse(t);c(e)}catch{}const a={};ce.forEach(e=>{a[e.id]=!1}),b(a)},[de,ce]),F.useEffect(()=>{de()},[de]);const xe=l.length,ue=l.trim().length>10&&o.length>0&&B>0,Ue=(e,s,t)=>{g(a=>({...a,[e]:{...a[e],[s]:t}}))},Be=(e,s)=>{O(t=>({...t,[e]:s}))},[Fe,Xe]=F.useState(!1),[Ze,rs]=F.useState(null),is=async e=>{await new Promise(e=>setTimeout(e,1e3));let s=e;return Object.entries({"小红书":"Xiaohongshu","抖音":"TikTok","微博":"Weibo","知乎":"Zhihu","公众号":"WeChat Official Account","B站":"Bilibili","视频号":"Video Account","试了":"tried","味道":"taste","治愈":"healing","小时候":"childhood","牛奶糖":"milk candy","甜而不腻":"sweet but not cloying","质地":"texture","冰淇淋":"ice cream","慕斯":"mousse","水润":"moisturizing","吸收":"absorption","粘腻":"sticky","秋冬":"autumn and winter","干皮":"dry skin","姐妹们":"sisters","闭眼冲":"go for it blindly","身体乳":"body lotion","护肤":"skincare","救星":"savior","推荐":"recommend","真的":"really","超级":"super","好用":"good to use","喜欢":"like","分享":"share","体验":"experience","感觉":"feel","效果":"effect","产品":"product","品牌":"brand","购买":"buy","价格":"price","优惠":"discount","活动":"activity","限时":"limited time","抢购":"rush to buy","赶紧":"hurry up","不要":"don't","错过":"miss","机会":"opportunity","最后":"last","一次":"once","时间":"time","结束":"end","开始":"start","立刻":"immediately","今天":"today","明天":"tomorrow","昨天":"yesterday","这周":"this week","下周":"next week","本月":"this month","下月":"next month","今年":"this year","明年":"next year"}).forEach(([e,t])=>{s=s.replace(new RegExp(e,"g"),t)}),s=s.replace(/。/g,". ").replace(/，/g,", ").replace(/！/g,"! ").replace(/？/g,"? ").replace(/：/g,": ").replace(/；/g,"; "),s},[ls,cs]=F.useState(""),[ds,ms]=F.useState(!1),[hs,xs]=F.useState([]),[js,bs]=F.useState([]),[Ns,vs]=F.useState(null),[Es,Rs]=F.useState(!1),[$s,Us]=F.useState([]),Ds=F.useCallback(()=>{const e=JSON.parse(localStorage.getItem("shareHistory")||"[]");Us(e)},[]);F.useEffect(()=>{Es&&Ds()},[Es,Ds]);const[Bs,Fs]=F.useState(!1),[Js,Ms]=F.useState("jump"),[Hs,_s]=F.useState(new Set);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(M,{title:"AI内容适配器",description:"一次创作，多平台适配，让您的内容在每个平台都能发挥最大效果",showAdaptButton:!1,actions:e.jsxs(e.Fragment,{children:[e.jsxs(L,{variant:"outline",onClick:()=>window.location.href="/history",children:[e.jsx(Ie,{className:"h-4 w-4 mr-1"}),"历史记录"]}),e.jsxs(L,{variant:"outline",onClick:()=>Fs(!0),children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"API配置"]})]})}),e.jsxs("div",{className:"container mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"内容创作"}),e.jsx(Pe,{children:e.jsxs(Ee,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"剩余次数:"}),e.jsx(De,{variant:B<=5?"destructive":"default",children:B})]})}),e.jsxs($e,{side:"bottom",children:[e.jsx("p",{children:"每次多平台内容生成消耗1次使用额度"}),e.jsx("p",{children:"每月自动获得20次免费使用机会"}),e.jsx("p",{children:"通过邀请好友可获得额外使用次数"})]})]})})]}),e.jsx(G,{className:"mb-6",children:e.jsx(W,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Je,{className:"text-sm font-medium",children:"发布模式:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(L,{variant:"jump"===Js?"default":"outline",size:"sm",onClick:()=>Ms("jump"),children:[e.jsx(ne,{className:"w-4 h-4 mr-1"}),"跳转发布"]}),e.jsxs(L,{variant:"api"===Js?"default":"outline",size:"sm",onClick:()=>Ms("api"),children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"API直发"]})]}),"api"===Js&&e.jsxs(De,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"需要配置API密钥"]})]})})}),e.jsxs(G,{className:"mb-8",children:[e.jsxs(V,{children:[e.jsx(K,{className:"text-lg",children:"输入原始内容"}),e.jsx(q,{children:"请输入您想要进行多平台适配的原始内容"})]}),e.jsxs(W,{children:[e.jsx(Ve,{placeholder:"在此输入您的原始内容，我们将为您适配到不同平台...",className:"min-h-[200px]",value:l,onChange:e=>n(e.target.value)}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-center",children:[e.jsx(Ge,{id:"use-brand-library",checked:u,onCheckedChange:e=>{e&&("trial"===R&&(oe({name:"品牌库功能",description:"使用品牌库资料进行创作，AI会自动遵循您的品牌语言规范"}),ie(!0),1))||p(!!e)}}),e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"use-brand-library",className:"text-sm cursor-pointer",children:"使用品牌库资料进行创作"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["上传您的品牌资料库，AI在创作时会自动遵循您的语言规范，融入品牌价值，规避公关风险。分发再多平台，品牌形象始终如一。",e.jsx("span",{className:"text-xs text-amber-500 ml-1",children:"（需开通高级功能）"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto justify-center",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>v(e=>!e),className:"text-xs rounded-lg shadow-sm border border-blue-200",children:["适配设置",N?e.jsx(Y,{className:"ml-1 h-3 w-3"}):e.jsx(Q,{className:"ml-1 h-3 w-3"})]}),e.jsxs(De,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[xe," 字符"]})]})]}),N&&e.jsx("div",{className:"mt-2 w-full",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-3 flex flex-col items-center w-full max-w-full",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 w-full px-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Je,{className:"text-xs w-28 flex-shrink-0",children:"全局字符数限制"}),e.jsxs(Ke,{value:z.charCountPreset,onValueChange:e=>Be("charCountPreset",e),children:[e.jsx(We,{className:"h-7 w-36 text-xs",children:e.jsx(qe,{placeholder:"选择字符数限制"})}),e.jsxs(Qe,{children:[e.jsx(Ye,{value:"auto",children:"自动"}),e.jsx(Ye,{value:"mini",children:"精简(50-200字)"}),e.jsx(Ye,{value:"standard",children:"标准(200-800字)"}),e.jsx(Ye,{value:"detailed",children:"详细(800+)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Je,{className:"text-xs w-28 flex-shrink-0",children:"启用表情符号"}),e.jsx(Ge,{id:"global-emoji",checked:z.globalEmoji,onCheckedChange:e=>Be("globalEmoji",!!e)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Je,{className:"text-xs w-28 flex-shrink-0",children:"启用Markdown格式"}),e.jsx(Ge,{id:"global-md",checked:z.globalMd,onCheckedChange:e=>Be("globalMd",!!e)})]})]}),e.jsx("div",{className:"flex justify-center mt-2 w-full",children:e.jsxs(L,{variant:"outline",size:"sm",onClick:me,className:"flex items-center h-7 text-xs px-3",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"保存"]})})]})})]})]}),e.jsxs(G,{className:"mb-8",children:[e.jsxs(V,{children:[e.jsx(K,{className:"text-lg",children:"AI 模型选择"}),e.jsx(q,{children:"选择您喜欢的AI模型生成内容，默认优先推荐GPT-4o"})]}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(s=>{let t=!U.some(e=>e.id===s.id),a="";return"gpt-4o"===s.id&&"trial"===R&&(a="专业版/高级版专属"),e.jsx("div",{className:"p-6 border-2 rounded-xl cursor-pointer transition-all hover:shadow-md "+(P===s.id?"border-blue-500 bg-blue-50 shadow-sm":t?"border-gray-200 bg-gray-100 opacity-60 cursor-not-allowed":"border-gray-200 hover:border-blue-300"),onClick:()=>((e,s)=>{if(s)return;E(e),E(e);const t=function(e){var s;return(null==(s=ss[e])?void 0:s.provider)||"Unknown"}(e);"OpenAI"===t&&T("openai"),"DeepSeek"===t&&T("deepseek")})(s.id,t),children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 mt-0.5 "+(P===s.id?"border-blue-500 bg-blue-500":"border-gray-300"),children:P===s.id&&e.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-blue-600 text-base",children:s.name}),a&&e.jsx(De,{className:"bg-gray-200 text-gray-600 text-xs",children:a})]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:s.description})]})]})},s.id)})}),P&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.jsx("p",{className:"font-medium",children:null==(s=as(P))?void 0:s.name}),e.jsx("p",{children:null==(t=as(P))?void 0:t.description})]}),e.jsxs("div",{className:"mt-4 flex gap-2 items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"模拟订阅等级："}),e.jsx(L,{size:"sm",variant:"trial"===R?"default":"outline",onClick:()=>$("trial"),children:"免费版"}),e.jsx(L,{size:"sm",variant:"pro"===R?"default":"outline",onClick:()=>$("pro"),children:"专业版"}),e.jsx(L,{size:"sm",variant:"premium"===R?"default":"outline",onClick:()=>$("premium"),children:"高级版"})]})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"选择目标平台"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 auto-rows-fr",children:ce.map(s=>e.jsx(Ps,{icon:s.icon,title:s.name,description:s.description,checked:o.includes(s.id),onChange:e=>{return t=s.id,void c(e?e=>[...e,t]:e=>e.filter(e=>e!==t));var t}},s.id))}),o.length>0&&e.jsxs(G,{className:"mt-6",children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx(K,{className:"text-base",children:"平台设置"}),e.jsxs(De,{variant:"secondary",className:"text-xs",children:[o.length,"个平台"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:me,children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"保存设置"]}),e.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>v(!N),children:[N?"收起":"展开",N?e.jsx(Y,{className:"ml-1 h-4 w-4"}):e.jsx(Q,{className:"ml-1 h-4 w-4"})]})]})]})}),N&&e.jsx(W,{className:"pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"全局设置"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"global-emoji",checked:z.globalEmoji,onCheckedChange:e=>Be("globalEmoji",!!e)}),e.jsxs(Je,{htmlFor:"global-emoji",className:"text-sm cursor-pointer flex items-center",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"全局添加emoji表情"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"global-md",checked:z.globalMd,onCheckedChange:e=>Be("globalMd",!!e)}),e.jsxs(Je,{htmlFor:"global-md",className:"text-sm cursor-pointer flex items-center",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"全局MD格式"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:"global-auto",checked:!0,disabled:!0}),e.jsxs(Je,{htmlFor:"global-auto",className:"text-sm cursor-pointer flex items-center text-gray-500",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"全局自动排版"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"平台特定设置"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:o.map(s=>{const t=ce.find(e=>e.id===s),a=f[s]||{},r=["zhihu","wechat","weibo","xiaohongshu"].includes(s);return t?e.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.icon,e.jsx("span",{className:"text-sm font-medium",children:t.name}),r&&e.jsx(De,{variant:"outline",className:"text-xs",children:"优化"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs(Je,{className:"text-xs",children:["字符数: ",a.charCount||Ts(s)]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[As(s),"-",Ts(s)]})]}),e.jsx(es,{value:[a.charCount||Ts(s)],min:As(s),max:Ts(s),step:10,onValueChange:e=>Ue(s,"charCount",e[0]),className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:`${s}-emoji`,checked:a.useEmoji,onCheckedChange:e=>Ue(s,"useEmoji",!!e)}),e.jsxs(Je,{htmlFor:`${s}-emoji`,className:"text-xs cursor-pointer flex items-center",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"emoji"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{id:`${s}-md`,checked:a.useMdFormat,onCheckedChange:e=>Ue(s,"useMdFormat",!!e)}),e.jsxs(Je,{htmlFor:`${s}-md`,className:"text-xs cursor-pointer flex items-center",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"MD格式"]})]})]}),r&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs text-blue-600",children:["zhihu"===s&&"知乎: MD格式优化专业排版，自动排版添加分割线","wechat"===s&&"公众号: MD格式适合深度阅读，专业排版","weibo"===s&&"微博: emoji提升互动性，字数限制2000字","xiaohongshu"===s&&"小红书: emoji增加亲和力，自动排版优化视觉效果"]})]})]},s):null})})]})]})})]})]}),e.jsx("div",{className:"flex justify-center mb-12",children:e.jsx(L,{size:"lg",disabled:!ue||h,onClick:async()=>{if(!ue)return;if(B<=3&&B>0&&(se(B),Z(!0),1))return;if(B<=0)return void r({title:"使用次数已用完",description:"请通过邀请好友获取更多使用机会",variant:"destructive"});x(!0),(()=>{const e={...f};z.globalEmoji&&Object.keys(e).forEach(s=>{e[s].useEmoji=!0}),z.globalMd&&Object.keys(e).forEach(s=>{e[s].useMdFormat=!0}),"auto"!==z.charCountPreset&&Object.keys(e).forEach(s=>{switch(z.charCountPreset){case"mini":e[s].charCount=Math.min(200,Ts(s));break;case"standard":e[s].charCount=Math.min(800,Ts(s));break;case"detailed":e[s].charCount=Ts(s)}}),g(e)})();const e=o.map(e=>({platformId:e,content:"",steps:[{status:"loading",message:"分析原始内容..."},{status:"waiting",message:"提取核心信息..."},{status:"waiting",message:"进行平台适配..."},{status:"waiting",message:"优化输出结果..."}]}));m(e);try{const e={};o.forEach(s=>{const t=f[s];e[`${s}-charCount`]=(null==t?void 0:t.charCount)||.6*Ts(s),e[`${s}-emoji`]=(null==t?void 0:t.useEmoji)||!1,e[`${s}-mdFormat`]=(null==t?void 0:t.useMdFormat)||!1,e[`${s}-autoFormat`]=(null==t?void 0:t.useAutoFormat)||!1,e[`${s}-brandLibrary`]=u});const s={success:!0,results:o.map(e=>({platform:e,content:`这是为${e}平台适配的内容示例。`,success:!0}))};for(let t=0;t<o.length;t++){const e=o[t],a=(s,t)=>{m(a=>a.map(a=>a.platformId===e?{...a,steps:a.steps.map((e,a)=>a===s?{...e,status:t}:e)}:a))};a(0,"completed"),await new Promise(e=>setTimeout(e,300)),a(1,"loading"),await new Promise(e=>setTimeout(e,300)),a(1,"completed"),a(2,"loading"),await new Promise(e=>setTimeout(e,300)),a(2,"completed"),a(3,"loading"),await new Promise(e=>setTimeout(e,300));for(const t of o){const e=s.results.find(e=>e.platform===t);e&&e.content?(a(3,"completed"),m(s=>s.map(s=>s.platformId===t?{...s,content:e.content,source:"ai",error:e.success?void 0:"生成失败"}:s))):(a(3,"error"),m(e=>e.map(e=>e.platformId===t?{...e,error:"生成失败：无法获取适配内容"}:e)))}}H(),(e=>{const s="history_anonymous",t=localStorage.getItem(s);let a=[];if(t)try{a=JSON.parse(t)}catch{}const r=(new Date).toISOString();e.forEach(e=>{e.content&&a.push({platformId:e.platformId,content:e.content,timestamp:r})}),localStorage.setItem(s,JSON.stringify(a))})(d),r({title:"内容已生成",description:`已成功为${o.length}个平台生成内容`})}catch(s){m(e=>e.map(e=>({...e,steps:e.steps.map(e=>"loading"===e.status?{...e,status:"error"}:e),error:s instanceof Error?s.message:"生成失败"}))),r({title:"生成失败",description:s instanceof Error?s.message:"内容生成过程中发生错误，请稍后重试",variant:"destructive"})}finally{x(!1)}},className:"w-full max-w-md",children:h?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4 animate-spin"}),"正在生成中..."]}):e.jsxs(e.Fragment,{children:["开始生成",e.jsx(he,{className:"ml-2 h-4 w-4"})]})})}),d.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"平台适配结果"}),e.jsxs(L,{size:"lg",variant:"default",onClick:()=>{const e=d.filter(e=>e.content).map(e=>e.platformId);xs(e),ms(!0)},disabled:0===d.filter(e=>e.content).length,children:["api"===Js?e.jsx(we,{className:"h-5 w-5 mr-2"}):e.jsx(ne,{className:"h-5 w-5 mr-2"}),"api"===Js?"批量API直发":"批量一键转发"]})]}),e.jsxs(Me,{defaultValue:null==(a=d[0])?void 0:a.platformId,className:"w-full",children:[e.jsx(He,{className:"mb-6 grid w-full grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 h-12 overflow-x-auto",children:d.map(s=>e.jsx(_e,{value:s.platformId,className:"text-xs sm:text-sm font-medium min-w-0",children:e.jsx("div",{className:"flex items-center",children:Os(s.platformId)})},s.platformId))}),d.map(s=>{var t,a;return e.jsx(Le,{value:s.platformId,children:e.jsxs(G,{className:"p-8 shadow-lg border-2",children:[e.jsx(V,{className:"pb-4",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs(K,{className:"text-2xl flex items-center",children:[Os(s.platformId),e.jsx("span",{className:"ml-3",children:(null==(t=zs[s.platformId])?void 0:t.name)||s.platformId})]})})}),e.jsxs(W,{className:"space-y-6",children:[e.jsx("div",{className:"space-y-3",children:s.steps.map((s,t)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium "+("completed"===s.status?"bg-green-500 text-white":"loading"===s.status?"bg-blue-500 text-white animate-spin":"error"===s.status?"bg-red-500 text-white":"bg-gray-200 text-gray-600"),children:"completed"===s.status?"✓":"loading"===s.status?"⟳":"error"===s.status?"✗":t+1}),e.jsx("span",{className:"text-sm "+("completed"===s.status?"text-green-600":"loading"===s.status?"text-blue-600":"error"===s.status?"text-red-600":"text-gray-500"),children:s.message})]},t))}),s.error&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✗"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"生成失败"}),e.jsx("div",{className:"mt-1 text-sm text-red-700",children:s.error})]})]})}),s.content&&!s.error&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✓"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-green-800",children:"AI生成内容"}),e.jsx("div",{className:"mt-1 text-sm text-green-700",children:"内容已成功生成，您可以编辑、复制或收藏"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"生成结果"}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-blue-500 to-purple-600 mx-auto rounded-full"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center xl:justify-start gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"生成内容"}),e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),s.content?w===s.platformId?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ve,{value:s.content,onChange:e=>{m(t=>t.map(t=>t.platformId===s.platformId?{...t,content:e.target.value}:t))},className:"min-h-[300px] text-base resize-none"}),e.jsxs("div",{className:"flex gap-3 justify-center lg:justify-start",children:[e.jsx(L,{size:"sm",onClick:()=>{return e=s.platformId,t=s.content,m(s=>s.map(s=>s.platformId===e?{...s,content:t}:s)),y(null),void r({title:"保存成功",description:"内容已更新"});var e,t},className:"bg-green-600 hover:bg-green-700",children:"保存"}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>y(null),children:"取消"})]})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"whitespace-pre-wrap rounded-lg border-2 p-6 overflow-auto max-h-[600px] text-base leading-relaxed shadow-sm "+("xiaohongshu"===s.platformId?"bg-rose-50 border-rose-200":"douyin"===s.platformId?"bg-black text-white border-gray-800":"weibo"===s.platformId?"bg-orange-50 border-orange-200":"zhihu"===s.platformId?"bg-blue-50 border-blue-200":"wechat"===s.platformId?"bg-green-50 border-green-200":"bilibili"===s.platformId?"bg-pink-50 border-pink-200":"video"===s.platformId?"bg-emerald-50 border-emerald-200":"twitter"===s.platformId?"bg-sky-50 border-sky-200":"bg-gray-50 border-gray-200"),children:s.content}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-xs font-medium text-gray-700 shadow-sm",children:(null==(a=zs[s.platformId])?void 0:a.name)||s.platformId})})]}):s.error?e.jsx("div",{className:"rounded-lg border-2 border-dashed border-red-200 p-12 flex items-center justify-center bg-red-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 text-lg font-medium",children:"生成失败"}),e.jsx("p",{className:"text-red-500 text-sm mt-2",children:s.error})]})}):e.jsx("div",{className:"rounded-lg border-2 border-dashed border-gray-200 p-12 flex items-center justify-center bg-gray-50",children:e.jsx("p",{className:"text-muted-foreground text-lg",children:"生成的内容将显示在这里..."})})]}),I[s.platformId]&&e.jsx("div",{className:"hidden lg:flex items-center justify-center absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10",children:e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("div",{className:"w-0 h-0 border-l-2 border-r-2 border-t-2 border-white"})})}),I[s.platformId]&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"翻译内容"}),e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"whitespace-pre-wrap rounded-lg border-2 border-blue-200 p-6 bg-blue-50 overflow-auto max-h-[600px] text-base leading-relaxed shadow-sm",children:I[s.platformId]}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-xs font-medium text-blue-700 shadow-sm",children:"翻译版本"})})]})]})]})]}),s.content&&e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[e.jsxs(L,{size:"lg",variant:"outline",onClick:()=>(async e=>{if(!h){m(s=>s.map(s=>s.platformId===e?{...s,steps:[{status:"loading",message:"重新分析内容..."},{status:"waiting",message:"提取核心信息..."},{status:"waiting",message:"进行平台适配..."},{status:"waiting",message:"优化输出结果..."}]}:s));try{const s={},t=f[e];s[`${e}-charCount`]=(null==t?void 0:t.charCount)||.6*Ts(e),s[`${e}-emoji`]=(null==t?void 0:t.useEmoji)||!1,s[`${e}-mdFormat`]=(null==t?void 0:t.useMdFormat)||!1,s[`${e}-autoFormat`]=(null==t?void 0:t.useAutoFormat)||!1,s[`${e}-brandLibrary`]=u;const a=(s,t)=>{m(a=>a.map(a=>a.platformId===e?{...a,steps:a.steps.map((e,a)=>a===s?{...e,status:t}:e)}:a))};a(0,"completed"),await new Promise(e=>setTimeout(e,300)),a(1,"loading"),await new Promise(e=>setTimeout(e,300)),a(1,"completed"),a(2,"loading"),await new Promise(e=>setTimeout(e,300)),a(2,"completed"),a(3,"loading"),await new Promise(e=>setTimeout(e,300));const i={content:`重新生成的内容 - ${e}`,source:"ai",error:void 0};a(3,"completed"),m(s=>s.map(s=>s.platformId===e?{...s,content:i.content,source:i.source,error:i.error}:s)),r({title:"重新生成成功",description:`已为${e}重新生成内容`})}catch(s){m(t=>t.map(t=>t.platformId===e?{...t,steps:t.steps.map(e=>"loading"===e.status?{...e,status:"error"}:e),error:s instanceof Error?s.message:"重新生成失败"}:t)),r({title:"重新生成失败",description:s instanceof Error?s.message:`适配${e}内容时出错`,variant:"destructive"})}}})(s.platformId),disabled:h,children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"重新生成"]}),e.jsxs(L,{size:"lg",variant:"outline",onClick:()=>{return e=s.platformId,void y(w===e?null:e);var e},children:[e.jsx(ze,{className:"h-5 w-5 mr-2"}),w===s.platformId?"取消编辑":"编辑"]}),e.jsxs(L,{size:"lg",variant:"outline",onClick:()=>(e=>{const s=d.find(s=>s.platformId===e);if(!s||!s.content)return void r({title:"无法收藏",description:"没有可收藏的内容",variant:"destructive"});const t=JSON.parse(localStorage.getItem("favorites")||"[]"),a={id:Date.now().toString(),platformId:e,content:s.content,platformName:e,timestamp:(new Date).toISOString()};t.push(a),localStorage.setItem("favorites",JSON.stringify(t)),r({title:"收藏成功",description:"内容已添加到收藏，可在我的页面查看"})})(s.platformId),children:[e.jsx(Oe,{className:"h-5 w-5 mr-2"}),"收藏"]}),e.jsxs(L,{size:"lg",variant:"outline",onClick:()=>{return e=s.content,navigator.clipboard.writeText(e),void r({title:"已复制到剪贴板",description:"内容已成功复制，可直接粘贴使用"});var e},children:[e.jsx(Ae,{className:"h-5 w-5 mr-2"}),"一键复制"]}),e.jsxs(L,{size:"lg",variant:"outline",onClick:()=>(async(e,s)=>{if(S.has(e))r({title:"请勿频繁点击",description:"翻译进行中，请稍候...",variant:"destructive"});else{C(s=>new Set(s).add(e));try{const t=await(async e=>{try{const s=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,targetLang:"en",sourceLang:"zh"})});if(!s.ok)throw new Error("Translation API failed");return(await s.json()).translatedText||e}catch{return is(e)}})(s);k(s=>({...s,[e]:t})),r({title:"翻译完成",description:"内容已翻译为英文"})}catch{r({title:"翻译失败",description:"翻译过程中出现错误，请稍后重试",variant:"destructive"})}finally{setTimeout(()=>{C(s=>{const t=new Set(s);return t.delete(e),t})},3e3)}}})(s.platformId,s.content),disabled:S.has(s.platformId),children:[e.jsx(Te,{className:"h-5 w-5 mr-2"}),"一键翻译"]}),e.jsxs(L,{size:"lg",variant:"default",onClick:()=>(e=>{const s=d.find(s=>s.platformId===e);s&&s.content?(rs({platformId:e,content:s.content}),Xe(!0)):r({title:"无法发布",description:"没有可发布的内容",variant:"destructive"})})(s.platformId),disabled:Hs.has(s.platformId),children:[Hs.has(s.platformId)?e.jsx(re,{className:"h-5 w-5 mr-2 animate-spin"}):"api"===Js?e.jsx(we,{className:"h-5 w-5 mr-2"}):e.jsx(ne,{className:"h-5 w-5 mr-2"}),Hs.has(s.platformId)?"发布中...":"api"===Js?"API直发":"立刻发布"]})]})]})]})},s.platformId)})]})]})]}),e.jsx(os,{open:Fe,onOpenChange:Xe,children:e.jsxs(us,{children:[e.jsx(ps,{children:e.jsx(gs,{children:"一键转发确认"})}),e.jsxs("div",{className:"py-2 text-gray-700",children:[e.jsx("p",{children:"api"===Js?"是否通过API直接发布内容？":"内容已复制到剪贴板，是否跳转到平台发布页？"}),e.jsx("div",{className:"bg-gray-100 rounded p-2 mt-2 text-xs break-all max-h-32 overflow-auto",children:null==Ze?void 0:Ze.content})]}),e.jsxs(fs,{children:[e.jsx(L,{variant:"outline",onClick:()=>Xe(!1),children:"取消"}),e.jsx(L,{variant:"default",onClick:()=>{if(!Ze)return;const{platformId:e,content:s}=Ze;if("api"===Js)(async(e,s)=>{if(!ys(e))return r({title:"未授权",description:"请先配置平台API授权信息",variant:"destructive"}),void Fs(!0);_s(s=>new Set(s).add(e));try{const t={text:s,title:`AI生成内容 - ${(new Date).toLocaleString()}`,hashtags:[]},a=await ws(e,t);if(a.success){const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t)),r({title:"发布成功",description:`内容已成功发布到${e}`}),a.publishUrl&&window.open(a.publishUrl,"_blank","noopener,noreferrer")}else r({title:"发布失败",description:a.error||"发布过程中出现错误",variant:"destructive"})}catch(t){r({title:"发布失败",description:t instanceof Error?t.message:"网络错误",variant:"destructive"})}finally{_s(s=>{const t=new Set(s);return t.delete(e),t})}})(e,s);else{navigator.clipboard.writeText(s);const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t));const a=Cs[e];a?(window.open(a,"_blank","noopener,noreferrer"),r({title:"内容已复制，正在跳转",description:`内容已复制到剪贴板，正在打开${e}官网`})):r({title:"内容已复制",description:"内容已复制到剪贴板，但该平台的发布链接暂未配置"})}Xe(!1),rs(null)},children:"api"===Js?"确认发布":"跳转并发布"})]})]})}),e.jsx(os,{open:ds,onOpenChange:ms,children:e.jsxs(us,{children:[e.jsx(ps,{children:e.jsx(gs,{children:"批量一键转发"})}),e.jsxs("div",{className:"py-2 text-gray-700",children:[e.jsx("p",{children:"请选择要批量转发的平台："}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:d.filter(e=>e.content).map(s=>e.jsx(L,{variant:hs.includes(s.platformId)?"default":"outline",onClick:()=>xs(e=>e.includes(s.platformId)?e.filter(e=>e!==s.platformId):[...e,s.platformId]),children:s.platformId},s.platformId))})]}),e.jsxs(fs,{children:[e.jsx(L,{variant:"outline",onClick:()=>ms(!1),children:"取消"}),e.jsx(L,{variant:"default",onClick:()=>{const e=hs.map(e=>{const s=d.find(s=>s.platformId===e);return s&&s.content?{platformId:e,content:s.content}:null}).filter(Boolean);"api"===Js?((async e=>{const s=e.filter(e=>!ys(e));if(s.length>0)return r({title:"部分平台未授权",description:`请先配置 ${s.join(", ")} 的API授权信息`,variant:"destructive"}),void Fs(!0);const t=e.filter(e=>ys(e));if(0===t.length)return void r({title:"无可用平台",description:"请先配置至少一个平台的API授权信息",variant:"destructive"});const a=d.find(e=>e.platformId===t[0]);if(null==a?void 0:a.content){_s(new Set(t));try{const e={text:a.content,title:`AI生成内容 - ${(new Date).toLocaleString()}`,hashtags:[]},s=await async function(e,s){const t=[];for(const r of e)try{const e=await ws(r,s);t.push(e)}catch(a){t.push({success:!1,error:a instanceof Error?a.message:"发布失败"})}return t}(t,e),i=s.filter(e=>e.success).length,l=s.length-i,n=JSON.parse(localStorage.getItem("shareHistory")||"[]");s.forEach((e,s)=>{e.success&&n.unshift({id:Date.now().toString()+s,platformId:t[s],platformName:t[s],content:a.content,time:(new Date).toISOString()})}),localStorage.setItem("shareHistory",JSON.stringify(n)),r({title:"批量发布完成",description:`成功: ${i}个平台，失败: ${l}个平台`}),s.forEach((e,s)=>{e.success&&e.publishUrl&&setTimeout(()=>{window.open(e.publishUrl,"_blank","noopener,noreferrer")},500*s)})}catch(i){r({title:"批量发布失败",description:i instanceof Error?i.message:"网络错误",variant:"destructive"})}finally{_s(new Set)}}else r({title:"无内容可发布",description:"请先生成内容",variant:"destructive"})})(hs),ms(!1)):(bs(e),ms(!1),e.length>0&&vs(e[0]))},disabled:0===hs.length,children:"开始批量转发"})]})]})}),e.jsx(os,{open:!!Ns,onOpenChange:e=>{e||vs(null)},children:e.jsxs(us,{children:[e.jsx(ps,{children:e.jsx(gs,{children:"批量一键转发"})}),e.jsxs("div",{className:"py-2 text-gray-700",children:[e.jsxs("p",{children:["内容已复制到剪贴板，是否跳转到 ",null==Ns?void 0:Ns.platformId," 发布页？"]}),e.jsx("div",{className:"bg-gray-100 rounded p-2 mt-2 text-xs break-all max-h-32 overflow-auto",children:null==Ns?void 0:Ns.content})]}),e.jsxs(fs,{children:[e.jsx(L,{variant:"outline",onClick:()=>{if(!Ns)return;const e=js.findIndex(e=>e.platformId===Ns.platformId);e>=0&&e<js.length-1?vs(js[e+1]):(vs(null),bs([]),r({title:"批量转发完成",description:"已完成所有平台的转发"}))},children:"跳过"}),e.jsx(L,{variant:"default",onClick:()=>{if(!Ns)return;const{platformId:e,content:s}=Ns;navigator.clipboard.writeText(s);const t=JSON.parse(localStorage.getItem("shareHistory")||"[]");t.unshift({id:Date.now().toString(),platformId:e,platformName:e,content:s,time:(new Date).toISOString()}),localStorage.setItem("shareHistory",JSON.stringify(t));const a=Cs[e];a&&window.open(a,"_blank","noopener,noreferrer");const i=js.findIndex(s=>s.platformId===e);i>=0&&i<js.length-1?vs(js[i+1]):(vs(null),bs([]),r({title:"批量转发完成",description:"已完成所有平台的转发"}))},children:"跳转并发布"})]})]})}),e.jsx(os,{open:Es,onOpenChange:Rs,children:e.jsxs(us,{className:"max-w-2xl",children:[e.jsx(ps,{children:e.jsx(gs,{children:"转发历史"})}),e.jsx("div",{className:"py-2 text-gray-700 max-h-[60vh] overflow-auto",children:0===$s.length?e.jsx("div",{className:"text-center text-gray-400 py-8",children:"暂无转发历史"}):e.jsx("div",{className:"space-y-4",children:$s.map(s=>e.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-bold text-blue-600",children:s.platformName}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.time).toLocaleString()})]}),e.jsx("div",{className:"text-xs break-all mb-1",children:s.content}),e.jsx(L,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(s.content),children:"复制内容"})]},s.id))})}),e.jsxs(fs,{children:[e.jsx(L,{variant:"outline",onClick:()=>{localStorage.removeItem("shareHistory"),Us([]),r({title:"已清空",description:"转发历史已清空"})},disabled:0===$s.length,children:"清空历史"}),e.jsx(L,{variant:"default",onClick:()=>Rs(!1),children:"关闭"})]})]})}),e.jsx(Is,{open:Bs,onOpenChange:Fs}),e.jsx(ks,{isOpen:X,onClose:()=>Z(!1),onUpgrade:()=>{Z(!1),i("/payment")},remainingCount:ee,userType:"trial"===R?"trial":"pro"}),e.jsx(Ss,{isOpen:ae,onClose:()=>ie(!1),onUpgrade:()=>{ie(!1),i("/payment")},featureName:le.name,featureDescription:le.description})]})}},Symbol.toStringTag,{value:"Module"}));export{Es as A,De as B,Ge as C,os as D,Be as I,Je as L,Ke as S,Ve as T,cs as a,us as b,ps as c,gs as d,We as e,qe as f,Qe as g,Ye as h,Me as i,He as j,_e as k,Le as l,js as m,fs as n,es as o,Pe as p,ns as u};
