import{j as e,ag as s,ah as a,ai as r}from"./ui-core-CkDiOLPZ.js";import{g as l,c as i,h as n,B as t}from"./pages-home-cm4XWoxC.js";import{d as c,N as d,r as m}from"./router-CDHmMMQ-.js";import{D as o,b as h,c as x,h as f,i as j,d as u}from"./pages-brand-CdVj9KMe.js";import"./pages-adapt-BekQTgf9.js";const p=({children:s,requireAuth:a=!0,redirectTo:r="/login",loadingComponent:i=e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"正在验证权限..."})]})})})=>{const n=c(),{isAuthenticated:t,isLoading:m}=l();return m?e.jsx(e.Fragment,{children:i}):a&&!t?e.jsx(d,{to:r,state:{from:n},replace:!0}):e.jsx(e.Fragment,{children:s})},N=m.forwardRef(({className:a,...r},l)=>e.jsx(s,{ref:l,className:i("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r}));N.displayName=s.displayName;const g=m.forwardRef(({className:s,...r},l)=>e.jsx(a,{ref:l,className:i("aspect-square h-full w-full",s),...r}));g.displayName=a.displayName;const w=m.forwardRef(({className:s,...a},l)=>e.jsx(r,{ref:l,className:i("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));w.displayName=r.displayName;const y=({user:s,showDropdown:a=!0,size:r="md"})=>{const{logout:i}=l(),{hasRole:c}=n();if(!s)return e.jsx(N,{className:"sm"===r?"h-8 w-8":"lg"===r?"h-12 w-12":"h-10 w-10",children:e.jsx(w,{children:"?"})});const d=s.nickname||s.username||s.email||"用户",m=d.slice(0,2).toUpperCase(),p=c("premium")||c("pro")||c("admin"),y=e.jsxs(N,{className:"sm"===r?"h-8 w-8":"lg"===r?"h-12 w-12":"h-10 w-10",children:[e.jsx(g,{src:s.avatar,alt:d}),e.jsx(w,{className:"bg-primary text-primary-foreground",children:m})]});return a?e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(t,{variant:"ghost",className:"relative h-auto w-auto p-0",children:y})}),e.jsxs(x,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(f,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:d}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.email}),p&&e.jsx("p",{className:"text-xs leading-none text-primary font-medium",children:"⭐ 专业用户"})]})}),e.jsx(j,{}),e.jsx(u,{asChild:!0,children:e.jsx("a",{href:"/profile",children:"个人中心"})}),e.jsx(j,{}),e.jsx(u,{onClick:i,children:"退出登录"})]})]}):y};export{N as A,p as P,y as U,g as a,w as b};
