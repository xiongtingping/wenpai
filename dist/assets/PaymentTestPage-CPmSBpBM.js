import{j as e}from"./ui-core-BoM6Gtru.js";import{r as s}from"./router-CDHmMMQ-.js";import{u as t,j as r,C as n,a,b as i,e as l,B as c,v as d,w as o}from"./pages-home-B-YLcn0z.js";import{A as m}from"./AlipayQRCode-JEFMIS55.js";import{aO as x}from"./utils-Ck01-_Du.js";import"./react-vendor-D7XYiaTe.js";import"./components-landing-CGa4OaD-.js";import"./components-layout-B8FsrdzO.js";import"./pages-brand-BuX6qQ3s.js";import"./pages-adapt-CSkmXLuc.js";import"./api-services-DPZFfcoz.js";import"./pages-content-extractor-C4B3q1d0.js";import"./components-auth-BBdw3eti.js";import"./creemClientService-DNWMJNoV.js";import"./browser-C5-Pn058.js";function h(){const{toast:h}=t(),{user:j,isAuthenticated:g}=r(),[u,p]=s.useState(0),[b,f]=s.useState(!1),[N]=s.useState({name:"Pro月付",tier:"pro"}),[v]=s.useState("monthly"),w=()=>{if(!j)return;const e=localStorage.getItem("user_registration_time");if(e)return new Date(parseInt(e,10));const s=new Date;return localStorage.setItem("user_registration_time",s.getTime().toString()),s},y=()=>{if(u<=0)return"已结束";const e=Math.floor(u/1e3),s=Math.floor(e/60),t=Math.floor(s/60);return t>0?`${t}小时${s%60}分钟${e%60}秒`:s>0?`${s}分钟${e%60}秒`:`${e}秒`},P=()=>{if(!g)return!1;const e=w();return!!e&&d(e)};s.useEffect(()=>{if(!g)return;const e=w();if(!e)return;const s=()=>{const s=o(e);p(s)};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[g]);const S=P()&&u>0?{currentPrice:69,originalPrice:99,savedAmount:30,isDiscount:!0}:{currentPrice:99,originalPrice:99,savedAmount:0,isDiscount:!1};return e.jsxs("div",{className:"container mx-auto py-16 px-4 max-w-4xl",children:[e.jsxs("div",{className:"mb-12 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"支付测试页面"}),e.jsx("p",{className:"text-muted-foreground",children:"验证限时优惠和支付二维码联动"})]}),u>0&&e.jsx("div",{className:"mb-8 p-4 bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:"新用户限时优惠：30分钟"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl font-bold text-red-600",children:"优惠倒计时："}),e.jsx("span",{className:"text-2xl font-bold bg-red-100 px-4 py-2 rounded-lg border-2 border-red-300",children:y()})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(n,{className:"border-green-100 bg-gradient-to-br from-green-50 to-white",children:[e.jsx(a,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(x,{className:"h-4 w-4 text-white"})}),"价格信息"]})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-green-900",children:N.name}),e.jsx("span",{className:"text-sm text-green-700",children:"monthly"===v?"月付":"年付"})]}),S.isDiscount?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-green-700",children:"限时优惠价"}),e.jsxs("span",{className:"text-2xl font-bold text-red-600",children:["¥",S.currentPrice]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-green-700",children:"原价"}),e.jsxs("span",{className:"text-lg text-gray-400 line-through",children:["¥",S.originalPrice]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-green-700",children:"节省金额"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["¥",S.savedAmount]})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-green-700",children:"支付金额"}),e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["¥",S.currentPrice]})]})]}),!b&&e.jsx(c,{onClick:()=>{f(!0),h({title:"支付二维码已显示",description:"请使用手机扫码完成支付"})},className:"w-full bg-green-500 hover:bg-green-600",size:"lg",children:"立即支付"})]})]}),b&&e.jsxs(n,{"data-qr-code":!0,className:"border-blue-100 bg-gradient-to-br from-blue-50 to-white",children:[e.jsx(a,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"支"})}),"支付宝扫码支付"]})}),e.jsxs(l,{children:[e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(x,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:N.name}),e.jsx("p",{className:"text-sm text-blue-700",children:"monthly"===v?"月付":"年付"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["¥",S.currentPrice]}),S.isDiscount&&e.jsx("div",{className:"text-sm text-green-600",children:"限时优惠中"})]})]})}),e.jsx(m,{priceId:"prod_3nJOuQeVStqkp6JaDcrKHf",title:`${N.name} - 扫码支付`,showPrice:!0})]})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"测试信息"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:["用户认证状态: ",g?"已登录":"未登录"]}),e.jsxs("p",{children:["优惠期状态: ",P()?"在优惠期内":"不在优惠期内"]}),e.jsxs("p",{children:["倒计时剩余: ",y()]}),e.jsxs("p",{children:["当前价格: ¥",S.currentPrice]}),e.jsxs("p",{children:["原价: ¥",S.originalPrice]}),e.jsxs("p",{children:["节省金额: ¥",S.savedAmount]})]})]})]})}export{h as default};
