import{j as e,K as s}from"./ui-core-BEqq4eN-.js";import{r as a,u as l}from"./router-CDHmMMQ-.js";import{c as t,B as i,C as r,a as c,b as n,e as d,S as o,u as m,d as x}from"./pages-home-BoZVsFKO.js";import{B as h,I as j,L as p,i as u,j as f,k as g,l as N,D as v,b as y,c as b,d as w,m as k,S as C,e as S,f as P,g as K,h as $,n as z}from"./pages-adapt-CiCh1UVu.js";import{P as I}from"./components-layout-LKVIGOSA.js";import{b as E,c as F,d as H,e as L,f as T,h as A,i as O,j as _,k as B,l as D,t as J,m as V,n as M}from"./api-services-Ciw7WX26.js";import{D as Q,Q as R,P as W,X as Y,W as q,Y as G,_ as U,$ as X,n as Z,a0 as ee,a1 as se,E as ae,a2 as le,a3 as te,a4 as ie,a5 as re}from"./utils-U1evx29U.js";const ce=a.forwardRef(({className:a,orientation:l="horizontal",decorative:i=!0,...r},c)=>e.jsx(s,{ref:c,decorative:i,orientation:l,className:t("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",a),...r}));ce.displayName=s.displayName;const ne=({onFilterChange:s})=>{const[l,t]=a.useState(!1),[m,x]=a.useState({blockedKeywords:[],blockedPlatforms:[],preferredKeywords:[],preferredPlatforms:[],showBlocked:!1}),[u,f]=a.useState(""),[g,N]=a.useState("");a.useEffect(()=>{const e=localStorage.getItem("interestFilters");if(e)try{const a=JSON.parse(e);x(a),s(a)}catch(a){}},[]);const v=e=>{localStorage.setItem("interestFilters",JSON.stringify(e)),x(e),s(e)},y=()=>{if(u.trim()&&!m.blockedKeywords.includes(u.trim())){const e={...m,blockedKeywords:[...m.blockedKeywords,u.trim()]};v(e),f("")}},b=()=>{if(g.trim()&&!m.preferredKeywords.includes(g.trim())){const e={...m,preferredKeywords:[...m.preferredKeywords,g.trim()]};v(e),N("")}};return e.jsxs("div",{className:"mb-6",children:[e.jsxs(i,{variant:"outline",onClick:()=>t(!l),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"兴趣调节",m.blockedKeywords.length>0||m.preferredKeywords.length>0&&e.jsx(h,{variant:"secondary",className:"ml-2",children:m.blockedKeywords.length+m.preferredKeywords.length})]}),l&&e.jsxs(r,{className:"mt-4",children:[e.jsx(c,{children:e.jsxs(n,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"兴趣调节设置"}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{v({blockedKeywords:[],blockedPlatforms:[],preferredKeywords:[],preferredPlatforms:[],showBlocked:!1})},children:"重置"})]})}),e.jsxs(d,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"屏蔽关键词"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(j,{placeholder:"输入要屏蔽的关键词",value:u,onChange:e=>f(e.target.value),onKeyPress:e=>"Enter"===e.key&&y()}),e.jsx(i,{onClick:y,size:"sm",children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.blockedKeywords.map((s,a)=>e.jsxs(h,{variant:"destructive",className:"flex items-center gap-1",children:[s,e.jsx(Y,{className:"h-3 w-3 cursor-pointer",onClick:()=>(e=>{const s={...m,blockedKeywords:m.blockedKeywords.filter(s=>s!==e)};v(s)})(s)})]},a))})]}),e.jsx(ce,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"偏好关键词"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(j,{placeholder:"输入偏好的关键词",value:g,onChange:e=>N(e.target.value),onKeyPress:e=>"Enter"===e.key&&b()}),e.jsx(i,{onClick:b,size:"sm",children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.preferredKeywords.map((s,a)=>e.jsxs(h,{variant:"default",className:"flex items-center gap-1",children:[s,e.jsx(Y,{className:"h-3 w-3 cursor-pointer",onClick:()=>(e=>{const s={...m,preferredKeywords:m.preferredKeywords.filter(s=>s!==e)};v(s)})(s)})]},a))})]}),e.jsx(ce,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"平台偏好设置"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{value:"weibo",label:"微博"},{value:"zhihu",label:"知乎"},{value:"bilibili",label:"B站"},{value:"douyin",label:"抖音"},{value:"toutiao",label:"头条"},{value:"baidu",label:"百度"}].map(s=>{const a=m.blockedPlatforms.includes(s.value),l=m.preferredPlatforms.includes(s.value);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"text-sm",children:s.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{htmlFor:`prefer-${s.value}`,className:"text-xs",children:"推荐"}),e.jsx(o,{id:`prefer-${s.value}`,checked:l,onCheckedChange:()=>(e=>{const s=m.preferredPlatforms.includes(e),a={...m,preferredPlatforms:s?m.preferredPlatforms.filter(s=>s!==e):[...m.preferredPlatforms,e]};v(a)})(s.value)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{htmlFor:`block-${s.value}`,className:"text-xs",children:"屏蔽"}),e.jsx(o,{id:`block-${s.value}`,checked:a,onCheckedChange:()=>(e=>{const s=m.blockedPlatforms.includes(e),a={...m,blockedPlatforms:s?m.blockedPlatforms.filter(s=>s!==e):[...m.blockedPlatforms,e]};v(a)})(s.value)})]})]})]},s.value)})})]})]})]})]})},de=({topics:s,onCategoryChange:l,onTopicClick:t})=>{const[i,c]=a.useState("all"),n=[{id:"all",label:"全部",icon:"🔥"},{id:"entertainment",label:"娱乐",icon:"🎬"},{id:"technology",label:"科技",icon:"💻"},{id:"sports",label:"体育",icon:"⚽"},{id:"politics",label:"政治",icon:"🏛️"},{id:"economy",label:"财经",icon:"💰"},{id:"society",label:"社会",icon:"👥"},{id:"education",label:"教育",icon:"📚"},{id:"health",label:"健康",icon:"🏥"},{id:"lifestyle",label:"生活",icon:"🏠"}],o=e=>"all"===e?s:s.filter(s=>(e=>{const s=e.title.toLowerCase(),a=(e.desc||"").toLowerCase();return["明星","演员","歌手","电影","电视剧","综艺","娱乐","明星","艺人","导演","编剧"].some(e=>s.includes(e)||a.includes(e))?"entertainment":["科技","技术","互联网","AI","人工智能","手机","电脑","软件","编程","算法","芯片"].some(e=>s.includes(e)||a.includes(e))?"technology":["足球","篮球","体育","比赛","运动员","教练","球队","联赛","冠军","奥运会"].some(e=>s.includes(e)||a.includes(e))?"sports":["政府","政策","政治","官员","选举","法律","法规","国家","领导人","会议"].some(e=>s.includes(e)||a.includes(e))?"politics":["经济","金融","股票","基金","投资","理财","银行","保险","房地产","股市"].some(e=>s.includes(e)||a.includes(e))?"economy":["社会","事件","新闻","调查","报道","事件","事故","案件","纠纷"].some(e=>s.includes(e)||a.includes(e))?"society":["教育","学校","学生","老师","考试","学习","培训","课程","大学","高考"].some(e=>s.includes(e)||a.includes(e))?"education":["健康","医疗","医院","医生","疾病","治疗","药物","疫苗","疫情","保健"].some(e=>s.includes(e)||a.includes(e))?"health":["生活","美食","旅游","购物","时尚","美容","家居","装修","宠物","园艺"].some(e=>s.includes(e)||a.includes(e))?"lifestyle":"other"})(s)===e),m=e=>o(e).length;return e.jsx("div",{className:"mb-6",children:e.jsxs(u,{value:i,onValueChange:e=>{c(e),l(e)},children:[e.jsx(f,{className:"grid w-full grid-cols-5 lg:grid-cols-10",children:n.map(s=>e.jsxs(g,{value:s.id,className:"flex items-center gap-1 text-xs",children:[e.jsx("span",{children:s.icon}),e.jsx("span",{className:"hidden sm:inline",children:s.label}),e.jsx(h,{variant:"secondary",className:"ml-1 text-xs",children:m(s.id)})]},s.id))}),n.map(s=>e.jsxs(N,{value:s.id,children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o(s.id).map((a,l)=>e.jsx(r,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t(a),children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(h,{variant:"outline",className:"text-xs",children:a.platform}),e.jsxs("span",{className:"text-xs text-gray-500",children:["#",l+1]})]}),e.jsx("h3",{className:"font-medium text-sm line-clamp-2 mb-2",children:a.title}),a.desc&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-2",children:a.desc}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["热度: ",a.hot]}),e.jsx(h,{variant:"secondary",className:"text-xs",children:s.label})]})]})},`${a.platform}-${l}`))}),0===o(s.id).length&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"该分类下暂无话题"})]},s.id))]})})},oe=Object.freeze(Object.defineProperty({__proto__:null,default:function(){l();const{toast:s}=m(),[t,Q]=a.useState(null),[R,Y]=a.useState("all"),[ce,oe]=a.useState(!0),[me,xe]=a.useState(!1),[he,je]=a.useState(""),[pe,ue]=a.useState(null),[fe,ge]=a.useState(new Date),[Ne,ve]=a.useState(new Set),[ye,be]=a.useState(new Set),[we,ke]=a.useState("hot"),[Ce,Se]=a.useState([]),[Pe,Ke]=a.useState({}),[$e,ze]=a.useState(null),[Ie,Ee]=a.useState(!1),[Fe,He]=a.useState(!1),[Le,Te]=a.useState(!1),[Ae,Oe]=a.useState(E()),[_e,Be]=a.useState({}),[De,Je]=a.useState({}),[Ve,Me]=a.useState({keyword:"",name:"",description:"",platforms:[],sources:[],isActive:!0,notificationEnabled:!0,checkInterval:30,minHeatThreshold:1e3,maxHeatThreshold:5e4}),[Qe]=a.useState(F()),Re=H(),[We,Ye]=a.useState({blockedKeywords:[],blockedPlatforms:[],preferredKeywords:[],preferredPlatforms:[],showBlocked:!1}),[qe,Ge]=a.useState("all"),[Ue,Xe]=a.useState([]),Ze=e=>{const s=parseInt(e);return isNaN(s)?e:s>=1e6?`${(s/1e6).toFixed(1)}m`:s>=1e3?`${(s/1e3).toFixed(1)}k`:e},es=e=>{const s=`${e.platform}-${e.title}`;is(s)},ss=e=>{e.url?window.open(e.url,"_blank"):e.mobil_url?window.open(e.mobil_url,"_blank"):s({title:"无法打开链接",description:"该话题暂无源链接",variant:"destructive"})},as=async()=>{try{oe(!0),ue(null);const s=await A();Q(s),ge(new Date),localStorage.setItem("hotTopicsData",JSON.stringify(s.data));const a=localStorage.getItem("interestFilters");if(a)try{const e=JSON.parse(a);Ye(e)}catch(e){}}catch(s){ue(s instanceof Error?s.message:"获取数据失败")}finally{oe(!1)}},ls=async()=>{xe(!0),await as(),xe(!1)},ts=s=>{const a=O(s);return e.jsx("span",{className:`${a} mr-2`})},is=e=>{ve(s=>new Set([...s,e]))},rs=e=>{const a=`${e.platform}-${e.title}`;be(e=>{const l=new Set(e);return l.has(a)?(l.delete(a),s({title:"已取消收藏",description:"话题已从灵感夹移除"})):(l.add(a),s({title:"已收藏",description:"话题已添加到灵感夹"})),l})},cs=e=>{const s=`${e.platform}-${e.title}`;return Ne.has(s)},ns=e=>{const s=`${e.platform}-${e.title}`;return ye.has(s)},ds=()=>{const e=_();Se(e),Oe(E())};a.useEffect(()=>{as(),ds()},[]);const os=(()=>{if(!t||!t.data)return[];let e=[];return"all"===R?Object.values(t.data).forEach(s=>{e=e.concat(s.slice(0,10))}):e=(t.data[R]||[]).slice(0,10),(e=>{const s=e.filter(e=>{const s=e.title.toLowerCase(),a=(e.desc||"").toLowerCase(),l=(e.content||"").toLowerCase(),t=e.platform||"",i=We.blockedKeywords.some(e=>s.includes(e.toLowerCase())||a.includes(e.toLowerCase())||l.includes(e.toLowerCase())),r=We.blockedPlatforms.includes(t);return!i&&!r}).map(e=>{const s=e.title.toLowerCase(),a=(e.desc||"").toLowerCase(),l=(e.content||"").toLowerCase(),t=e.platform||"";let i=0,r=[];return We.preferredKeywords.forEach(e=>{const t=e.toLowerCase();(s.includes(t)||a.includes(t)||l.includes(t))&&(i+=10,r.push(e))}),We.preferredPlatforms.includes(t)&&(i+=5),{...e,preferenceScore:i,matchedKeywords:r,isHighPriority:i>0}});return[...s.filter(e=>e.isHighPriority).sort((e,s)=>{if(s.preferenceScore!==e.preferenceScore)return s.preferenceScore-e.preferenceScore;const a=parseInt(e.hot)||0;return(parseInt(s.hot)||0)-a}),...s.filter(e=>!e.isHighPriority).sort((e,s)=>{const a=parseInt(e.hot)||0;return(parseInt(s.hot)||0)-a})]})(e)})();return(()=>{if(!t||!t.data)return{total:0,platforms:0};Object.values(t.data).reduce((e,s)=>e+s.length,0),Object.keys(t.data).length})(),os.slice(0,3),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(I,{title:"全网雷达",description:"实时监控各平台热门话题，支持自定义话题订阅和智能追踪",showAdaptButton:!1}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(u,{value:we,onValueChange:e=>ke(e),className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs(f,{className:"grid w-full grid-cols-3 max-w-md",children:[e.jsxs(g,{value:"hot",className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(G,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"全网热点"}),e.jsx("span",{className:"sm:hidden",children:"热点"})]}),e.jsxs(g,{value:"subscriptions",className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(U,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"话题订阅"}),e.jsx("span",{className:"sm:hidden",children:"订阅"})]}),e.jsxs(g,{value:"bookmarks",className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(X,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"灵感夹"}),e.jsx("span",{className:"sm:hidden",children:"收藏"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>Ee(!0),className:"text-xs sm:text-sm",children:[e.jsx(W,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"添加订阅"}),e.jsx("span",{className:"sm:hidden",children:"添加"})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:ls,disabled:me,className:"text-xs sm:text-sm",children:[e.jsx(Z,{className:"w-4 h-4 mr-1 "+(me?"animate-spin":"")}),"刷新"]})]})]}),e.jsxs(N,{value:"hot",children:[pe&&e.jsx(r,{className:"mb-6 border-red-200 bg-red-50",children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(ee,{className:"w-4 h-4 text-red-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"获取热点数据失败"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:pe}),e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"可能原因：网络连接异常、API服务暂时不可用、或防火墙限制"})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:ls,disabled:me,className:"border-red-300 text-red-700 hover:bg-red-100",children:[e.jsx(Z,{className:"h-4 h-4 mr-2 "+(me?"animate-spin":"")}),"重试"]})]})})}),!ce&&t&&t.data&&e.jsx("div",{className:"mb-6",children:e.jsxs(r,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-red-500"}),"今日最热门话题"]}),e.jsx(x,{children:"各平台热门话题排行榜"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["最后更新: ",fe.toLocaleString("zh-CN"),"（每15分钟自动更新）"]})]})}),e.jsx(d,{children:e.jsxs(u,{defaultValue:"all",className:"w-full",children:[e.jsxs(f,{className:"flex w-full overflow-x-auto scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-transparent",children:[e.jsx(g,{value:"all",className:"min-w-[72px]",children:"总榜"}),Re.map(s=>e.jsx(g,{value:s,className:"min-w-[72px]",children:L(s)},s))]}),e.jsx(N,{value:"all",className:"mt-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:T(t.data).slice(0,10).map((s,a)=>e.jsxs("div",{className:`p-3 rounded-lg border transition-all hover:shadow-md h-48 flex flex-col ${cs(s)?"bg-gray-50 opacity-75":"bg-white"} ${ns(s)?"border-yellow-300 bg-yellow-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(h,{variant:"destructive",className:"text-xs",children:["#",a+1]}),e.jsx(h,{variant:"outline",className:"text-xs",children:L(s.platform||"")})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 line-clamp-2 mb-2 flex-1",children:s.title}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[e.jsx("span",{children:Ze(s.hot)}),e.jsxs("div",{className:"flex items-center gap-1",children:[ns(s)&&e.jsx(X,{className:"w-3 h-3 text-yellow-500 fill-current"}),cs(s)&&e.jsx(q,{className:"w-3 h-3 text-gray-400"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-auto",children:[e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1 text-xs h-7",onClick:()=>ss(s),children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),"查看"]}),e.jsx(i,{size:"sm",variant:ns(s)?"default":"outline",className:"text-xs h-7 "+(ns(s)?"bg-yellow-500 hover:bg-yellow-600":""),onClick:()=>rs(s),children:e.jsx(X,{className:"w-3 h-3"})})]})]},a))})}),Re.map(s=>e.jsx(N,{value:s,className:"mt-4",children:0===(t.data[s]||[]).length?e.jsx("div",{className:"text-center text-gray-400 py-8",children:"暂无数据"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:(t.data[s]||[]).slice(0,10).map((a,l)=>e.jsxs("div",{className:`p-3 rounded-lg border transition-all hover:shadow-md h-48 flex flex-col ${cs(a)?"bg-gray-50 opacity-75":"bg-white"} ${ns(a)?"border-yellow-300 bg-yellow-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(h,{variant:"destructive",className:"text-xs",children:["#",l+1]}),e.jsx(h,{variant:"outline",className:"text-xs",children:L(s)})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 line-clamp-2 mb-2 flex-1",children:a.title}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[e.jsx("span",{children:Ze(a.hot)}),e.jsxs("div",{className:"flex items-center gap-1",children:[ns(a)&&e.jsx(X,{className:"w-3 h-3 text-yellow-500 fill-current"}),cs(a)&&e.jsx(q,{className:"w-3 h-3 text-gray-400"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-auto",children:[e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1 text-xs h-7",onClick:()=>ss(a),children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),"查看"]}),e.jsx(i,{size:"sm",variant:ns(a)?"default":"outline",className:"text-xs h-7 "+(ns(a)?"bg-yellow-500 hover:bg-yellow-600":""),onClick:()=>rs(a),children:e.jsx(X,{className:"w-3 h-3"})})]})]},l))})},s))]})})]})}),e.jsx(ne,{onFilterChange:e=>{Ye(e),localStorage.setItem("interestFilters",JSON.stringify(e))}}),"all"===R&&!ce&&os.length>0&&e.jsx(de,{topics:os,onCategoryChange:e=>{Ge(e)},onTopicClick:es})]}),e.jsxs(N,{value:"subscriptions",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ae.total}),e.jsx("p",{className:"text-sm text-gray-600",children:"总订阅数"})]})})}),e.jsx(r,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Ae.active}),e.jsx("p",{className:"text-sm text-gray-600",children:"活跃订阅"})]})})}),e.jsx(r,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Ae.notificationEnabled}),e.jsx("p",{className:"text-sm text-gray-600",children:"通知开启"})]})})}),e.jsx(r,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Object.values(Pe).flat().length}),e.jsx("p",{className:"text-sm text-gray-600",children:"监控结果"})]})})})]}),0===Ce.length?e.jsx(r,{children:e.jsxs(d,{className:"text-center py-12",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无话题订阅"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"创建话题订阅，实时监控感兴趣的内容"}),e.jsxs(i,{onClick:()=>Ee(!0),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"添加第一个订阅"]})]})}):e.jsx("div",{className:"space-y-4",children:Ce.map(a=>e.jsxs(r,{className:"hover:shadow-md transition-shadow",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["关键词: ",a.keyword]}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{checked:a.isActive,onCheckedChange:e=>((e,a)=>{try{J(e,a),ds(),s({title:a?"订阅已启用":"订阅已禁用",description:a?"订阅监控已开始":"订阅监控已暂停"})}catch(l){s({title:"操作失败",description:"切换订阅状态时发生错误",variant:"destructive"})}})(a.id,e)}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>(async e=>{Te(!0);try{const a=await V(e);Ke(s=>({...s,[e.id]:a})),a.length>0?s({title:"监控完成",description:`发现 ${a.length} 个相关话题`}):s({title:"监控完成",description:"未发现相关话题"})}catch(a){s({title:"监控失败",description:"监控话题时发生错误",variant:"destructive"})}finally{Te(!1)}})(a),disabled:Le,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),Le?"检查中...":"检查"]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>{ze(a),(async e=>{if(!_e[e]){Je(s=>({...s,[e]:!0}));try{const s=await M(e,7);Be(a=>({...a,[e]:s}))}catch(s){}finally{Je(s=>({...s,[e]:!1}))}}})(a.keyword)},children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"趋势"]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>(e=>{try{D(e),ds(),s({title:"删除成功",description:"订阅已删除"})}catch(a){s({title:"删除失败",description:"删除订阅时发生错误",variant:"destructive"})}})(a.id),className:"text-red-600 hover:text-red-700",children:e.jsx(re,{className:"w-4 h-4"})})]})]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"状态:"}),e.jsx(h,{variant:a.isActive?"default":"secondary",className:"ml-2",children:a.isActive?"活跃":"暂停"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"通知:"}),e.jsx(h,{variant:a.notificationEnabled?"default":"secondary",className:"ml-2",children:a.notificationEnabled?"开启":"关闭"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"检查间隔:"}),e.jsxs("span",{className:"ml-2",children:[a.checkInterval,"分钟"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"热度阈值:"}),e.jsxs("span",{className:"ml-2",children:[a.minHeatThreshold,"-",a.maxHeatThreshold]})]})]}),Pe[a.id]&&Pe[a.id].length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"监控结果"}),e.jsxs("div",{className:"space-y-2",children:[Pe[a.id].slice(0,3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:s.title}),e.jsx(h,{variant:"outline",className:"text-xs",children:s.platform})]},a)),Pe[a.id].length>3&&e.jsxs("p",{className:"text-xs text-gray-500",children:["还有 ",Pe[a.id].length-3," 个结果..."]})]})]})]})]},a.id))})]}),e.jsx(N,{value:"bookmarks",children:e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-yellow-500"}),"灵感夹"]}),e.jsx(x,{children:"您收藏的感兴趣话题"})]}),e.jsx(d,{children:0===ye.size?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无收藏话题"}),e.jsx("p",{className:"text-gray-600",children:"点击话题右侧的书签图标来收藏感兴趣的内容"})]}):e.jsx("div",{className:"space-y-3",children:Array.from(ye).map((s,a)=>{let l=null;if(t&&t.data)for(const[e,i]of Object.entries(t.data)){const e=i.find(e=>`${e.platform}-${e.title}`===s);if(e){l=e;break}}return l?e.jsx("div",{className:"p-4 rounded-lg border border-yellow-300 bg-yellow-50 cursor-pointer transition-all hover:shadow-md",onClick:()=>es(l),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(h,{className:"bg-yellow-500 text-white text-xs",children:[e.jsx(X,{className:"w-3 h-3 mr-1"}),"已收藏"]}),e.jsx(h,{variant:"outline",className:"text-xs",children:L(l.platform||"")}),l.hot&&e.jsxs(h,{variant:"destructive",className:"text-xs",children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"热"]})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:l.title}),l.desc&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:l.desc}),l.content&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:l.content}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["热度: ",Ze(l.hot)]}),e.jsxs("span",{children:["平台: ",L(l.platform||"")]}),l.rank&&e.jsxs("span",{children:["排名: #",l.rank]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx(i,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e=>{e.stopPropagation(),rs(l)},children:e.jsx(X,{className:"w-4 h-4 text-yellow-500 fill-current"})}),e.jsx(i,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e=>{e.stopPropagation(),ss(l)},children:e.jsx(ae,{className:"w-4 h-4"})})]})]})},s):null})})})]})})]}),e.jsx(v,{open:Ie,onOpenChange:Ee,children:e.jsxs(y,{className:"sm:max-w-[500px]",children:[e.jsxs(b,{children:[e.jsx(w,{children:"添加话题订阅"}),e.jsx(k,{children:"设置关键词和监控条件，系统将自动追踪相关话题"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"keyword",children:"关键词 *"}),e.jsx(j,{id:"keyword",placeholder:"输入要监控的关键词",value:Ve.keyword,onChange:e=>Me(s=>({...s,keyword:e.target.value}))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"name",children:"订阅名称"}),e.jsx(j,{id:"name",placeholder:"为订阅起个名字",value:Ve.name,onChange:e=>Me(s=>({...s,name:e.target.value}))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"description",children:"描述"}),e.jsx(j,{id:"description",placeholder:"订阅的详细描述",value:Ve.description,onChange:e=>Me(s=>({...s,description:e.target.value}))})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{children:"监控平台"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Re.map(s=>e.jsxs(i,{variant:Ve.platforms.includes(s)?"default":"outline",size:"sm",onClick:()=>{const e=Ve.platforms.includes(s)?Ve.platforms.filter(e=>e!==s):[...Ve.platforms,s];Me(s=>({...s,platforms:e}))},children:[ts(s),L(s)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"checkInterval",children:"检查间隔 (分钟)"}),e.jsxs(C,{value:Ve.checkInterval.toString(),onValueChange:e=>Me(s=>({...s,checkInterval:parseInt(e)})),children:[e.jsx(S,{children:e.jsx(P,{})}),e.jsxs(K,{children:[e.jsx($,{value:"5",children:"5分钟"}),e.jsx($,{value:"15",children:"15分钟"}),e.jsx($,{value:"30",children:"30分钟"}),e.jsx($,{value:"60",children:"1小时"}),e.jsx($,{value:"120",children:"2小时"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(p,{htmlFor:"minHeatThreshold",children:"最低热度"}),e.jsx(j,{id:"minHeatThreshold",type:"number",value:Ve.minHeatThreshold,onChange:e=>Me(s=>({...s,minHeatThreshold:parseInt(e.target.value)||0}))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"isActive",checked:Ve.isActive,onCheckedChange:e=>Me(s=>({...s,isActive:e}))}),e.jsx(p,{htmlFor:"isActive",children:"立即启用"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"notificationEnabled",checked:Ve.notificationEnabled,onCheckedChange:e=>Me(s=>({...s,notificationEnabled:e}))}),e.jsx(p,{htmlFor:"notificationEnabled",children:"启用通知"})]})]}),e.jsxs(z,{children:[e.jsx(i,{variant:"outline",onClick:()=>Ee(!1),children:"取消"}),e.jsx(i,{onClick:()=>{if(Ve.keyword.trim())try{B({...Ve,lastChecked:null,lastNotification:null}),Me({keyword:"",name:"",description:"",platforms:[],sources:[],isActive:!0,notificationEnabled:!0,checkInterval:30,minHeatThreshold:1e3,maxHeatThreshold:5e4}),Ee(!1),ds(),s({title:"订阅添加成功",description:`已添加关键词"${Ve.keyword}"的订阅`})}catch(e){s({title:"添加失败",description:"添加订阅时发生错误",variant:"destructive"})}else s({title:"请输入关键词",description:"订阅关键词不能为空",variant:"destructive"})},children:"添加订阅"})]})]})})]})]})}},Symbol.toStringTag,{value:"Module"}));export{oe as H,ce as S};
