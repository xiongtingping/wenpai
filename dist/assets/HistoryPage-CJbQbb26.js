import{r as e,u as s,_ as a,j as t,C as i,i as r,ad as l,B as n,g as c,e as o}from"./index-BuR5xlXm.js";import{T as m}from"./trash-2-BeMaJGgV.js";import{C as d}from"./copy-DgfiJkCV.js";function x(){const[x,h]=e.useState([]),[j,u]=e.useState(!0),{toast:p}=s(),{user:N,isAuthenticated:g}=a();return e.useEffect(()=>{if(g&&N){const s=`history_${N.username||N.email||"anonymous"}`,a=localStorage.getItem(s);if(a)try{const e=JSON.parse(a);h(e)}catch(e){h([])}else h([])}else h([]);u(!1)},[g,N]),j?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"加载历史记录中..."})]})}):t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"历史记录"}),t.jsx("p",{className:"text-gray-600",children:"查看您之前生成的内容适配记录"})]}),0===x.length?t.jsx(i,{children:t.jsxs(r,{className:"text-center py-12",children:[t.jsx(l,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无历史记录"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"您还没有生成过内容，快去试试内容适配功能吧！"}),t.jsx(n,{onClick:()=>window.location.href="/adapt",children:"开始生成内容"})]})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs(c,{variant:"secondary",children:["共 ",x.length," 条记录"]})}),t.jsxs(n,{variant:"outline",onClick:()=>{if(N){const e=`history_${N.username||N.email||"anonymous"}`;h([]),localStorage.removeItem(e),p({title:"清空成功",description:"所有历史记录已清空"})}},className:"text-red-600 hover:text-red-700",children:[t.jsx(m,{className:"w-4 h-4 mr-2"}),"清空所有"]})]}),t.jsx("div",{className:"grid gap-4",children:x.map((e,s)=>{return t.jsxs(i,{className:"hover:shadow-md transition-shadow",children:[t.jsx(o,{className:"pb-3",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(c,{variant:"outline",children:(l=e.platformId,{wechat:"微信",weibo:"微博",douyin:"抖音",xiaohongshu:"小红书",zhihu:"知乎",bilibili:"B站",toutiao:"头条",kuaishou:"快手"}[l]||l)}),t.jsx("span",{className:"text-sm text-gray-500",children:(a=e.timestamp,new Date(a).toLocaleString("zh-CN"))})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{size:"sm",variant:"ghost",onClick:()=>{return s=e.content,navigator.clipboard.writeText(s),void p({title:"已复制",description:"内容已复制到剪贴板"});var s},children:t.jsx(d,{className:"w-4 h-4"})}),t.jsx(n,{size:"sm",variant:"ghost",onClick:()=>(e=>{if(N){const s=`history_${N.username||N.email||"anonymous"}`,a=x.filter((s,a)=>a!==e);h(a),localStorage.setItem(s,JSON.stringify(a)),p({title:"删除成功",description:"历史记录已删除"})}})(s),className:"text-red-600 hover:text-red-700",children:t.jsx(m,{className:"w-4 h-4"})})]})]})}),t.jsx(r,{children:t.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:t.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:e.content})})})]},s);var a,l})})]})]})}export{x as default};
