import{c as e,p as s,u as t,_ as r,r as a,j as l,B as i,ad as n,g as c,ap as d,C as x,aq as m,Z as o,e as h,f as p,n as g,i as j,af as u,ar as f,as as N}from"./index-CYvVoP-H.js";import{A as b}from"./AlipayQRCode-BO-RtIJF.js";import{A as y}from"./arrow-left-CQwOW-V4.js";import{G as v}from"./gift-quj9eTR5.js";import{C as w}from"./credit-card-B13ZmeOa.js";import"./creemClientService-hzbV9p0u.js";import"./browser-Cnf2s-_L.js";import"./smartphone-Bju1SvB9.js";
/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=e("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),I=({priceId:e,planName:s,price:t})=>l.jsx(b,{priceId:e,title:`${s} - 扫码支付`,showPrice:!0});function C(){const e=s(),{toast:b}=t(),{user:C,isAuthenticated:P}=r(),[S,$]=a.useState(null),[_,q]=a.useState("monthly"),[A,z]=a.useState(!1),[D,V]=a.useState(0),F=a.useRef(null),M=()=>{if(!C)return;const e=localStorage.getItem("user_registration_time");if(e)return new Date(parseInt(e,10));const s=new Date;return localStorage.setItem("user_registration_time",s.getTime().toString()),s},O=()=>{if(!P)return!1;const e=M();return!!e&&f(e)};a.useEffect(()=>{if(!P)return;const e=M();if(!e)return;const s=()=>{const s=N(e);V(s)};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[P]);const R=e=>{$(e),z(!1),setTimeout(()=>{var e;null==(e=F.current)||e.scrollIntoView({behavior:"smooth",block:"center"})},100)},T=e=>{q(e),z(!1),setTimeout(()=>{var e;null==(e=F.current)||e.scrollIntoView({behavior:"smooth",block:"center"})},100)},Y=()=>{if(!S)return 0;const e="monthly"===_?S.monthly:S.yearly,s=e.originalPrice;return O()&&e.discountPrice||s},B=e=>12*e.monthly.originalPrice-e.yearly.originalPrice;return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white",children:[l.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:l.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100",children:[l.jsx(y,{className:"h-4 w-4"}),"返回首页"]}),l.jsx("div",{className:"h-6 w-px bg-gray-300"}),l.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"支付中心"})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("div",{className:"text-sm text-gray-500",children:P?"已登录":"未登录"})})]})}),l.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-6xl md:py-16 md:px-6",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"选择订阅计划"}),l.jsx("p",{className:"text-muted-foreground",children:"选择最适合您的计划，开启AI创作之旅"})]}),D>0&&l.jsxs("div",{className:"mb-8 p-4 bg-gradient-to-r from-red-100 to-orange-50 border-2 border-red-200 rounded-xl shadow flex flex-col md:flex-row items-center justify-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(v,{className:"w-6 h-6 text-red-500"}),l.jsx("span",{className:"text-lg md:text-xl font-bold text-red-600",children:"新用户限时优惠：30分钟"})]}),l.jsxs("span",{className:"flex items-center gap-2 text-xl md:text-2xl font-bold bg-red-50 px-4 py-2 rounded-lg border-2 border-red-300",children:[l.jsx(n,{className:"w-5 h-5 text-red-400"}),(()=>{if(D<=0)return"已结束";const e=Math.floor(D/1e3),s=Math.floor(e/60),t=Math.floor(s/60);return t>0?`${t}小时${s%60}分钟${e%60}秒`:s>0?`${s}分钟${e%60}秒`:`${e}秒`})()]})]}),l.jsxs("div",{className:"mb-8 flex justify-center gap-4",children:[l.jsx(i,{variant:"monthly"===_?"default":"outline",onClick:()=>T("monthly"),className:"min-w-[120px]",children:"按月订阅"}),l.jsxs(i,{variant:"yearly"===_?"default":"outline",onClick:()=>T("yearly"),className:"min-w-[120px] transition-all duration-300 "+("yearly"===_?"bg-gradient-to-r from-orange-500 to-pink-500 hover:opacity-90 text-white":"bg-gradient-to-r from-orange-100 to-pink-100 text-orange-700 border-orange-300 hover:bg-gradient-to-r hover:from-orange-200 hover:to-pink-200"),children:["按年订阅",l.jsx(c,{variant:"secondary",className:"ml-2",children:"更优惠"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 max-w-6xl mx-auto",children:d.map(e=>{const s="monthly"===_?e.monthly:e.yearly,t=s.originalPrice,r=O(),a="trial"===e.tier?0:r?s.discountPrice:t,n="trial"===e.tier?0:t-a,d=(null==S?void 0:S.id)===e.id,f=B(e);return l.jsxs(x,{className:`cursor-pointer transition-all relative group ${d?"border-4 border-blue-500 shadow-2xl scale-105":"hover:shadow-lg hover:scale-105"} ${e.recommended?"ring-2 ring-blue-200":""}`,onClick:()=>R(e),children:[e.recommended&&l.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 z-10",children:l.jsxs(c,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg px-4 py-1 text-base",children:[l.jsx(m,{className:"h-4 w-4 mr-1"}),"推荐"]})}),r&&D>0&&"trial"!==e.tier&&l.jsx("div",{className:"absolute -top-4 -right-2 z-10",children:l.jsxs(c,{className:"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-lg px-3 py-1 text-sm animate-pulse",children:[l.jsx(o,{className:"h-3 w-3 mr-1"}),"限时"]})}),"yearly"===_&&("pro"===e.tier||"premium"===e.tier)&&l.jsx("div",{className:"absolute -top-4 -left-2 z-10",children:l.jsxs(c,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg px-3 py-1 text-sm",children:[l.jsx(k,{className:"h-3 w-3 mr-1"}),"年付省¥",f]})}),l.jsxs(h,{className:"text-center pb-2",children:[l.jsxs(p,{className:"text-xl flex items-center justify-center gap-2",children:["premium"===e.tier&&l.jsx(g,{className:"h-5 w-5 text-yellow-500"}),e.name]}),l.jsx("p",{className:"text-muted-foreground text-xs md:text-sm mt-1",children:e.description})]}),l.jsxs(j,{className:"space-y-3 pb-4 px-6",children:[l.jsx("div",{className:"text-center",children:"trial"===e.tier?l.jsx("div",{className:"text-3xl font-bold text-green-600",children:"免费"}):l.jsxs("div",{className:"space-y-2",children:[r&&D>0?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"text-3xl font-bold text-red-600",children:["¥",a]}),l.jsxs("div",{className:"text-sm text-red-500 font-semibold",children:[l.jsx(o,{className:"h-3 w-3 inline mr-1"}),"限时特惠价 省¥",n.toFixed(2)]}),l.jsxs("div",{className:"text-sm text-gray-400 line-through",children:["¥",t," 原价"]})]}):l.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:["¥",a]}),l.jsxs("div",{className:"text-sm text-gray-500",children:["/","monthly"===_?"月":"年"]}),"yearly"===_&&("pro"===e.tier||"premium"===e.tier)&&l.jsxs("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:["月均¥",(a/12).toFixed(1),"，比月付省¥",f]})]})}),l.jsx("div",{className:"space-y-1.5 mt-3",children:e.features.map((e,s)=>l.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[l.jsx(u,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),l.jsx("span",{children:e})]},s))}),l.jsx(i,{variant:d?"default":"outline",className:"w-full mt-3 text-base py-2.5",disabled:"trial"===e.tier,onClick:s=>{s.stopPropagation(),R(e)},children:"trial"===e.tier?"当前版本":d?"已选择":"选择此计划"})]})]},e.id)})}),l.jsxs("div",{ref:F,className:"space-y-4 max-w-3xl mx-auto",children:[S&&"trial"!==S.tier&&!A&&l.jsx(x,{className:"border-green-100 bg-gradient-to-br from-green-50 to-white shadow-lg",children:l.jsxs(j,{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded flex items-center justify-center",children:l.jsx(w,{className:"h-3 w-3 text-white"})}),l.jsx("h3",{className:"font-semibold text-green-900",children:"支付信息"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:["¥",Y()]}),l.jsx("div",{className:"text-xs text-green-600",children:"monthly"===_?"月付":"年付"})]})]}),l.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold text-green-900",children:S.name}),l.jsx("span",{className:"text-xs text-green-700 ml-2",children:S.description})]})})}),O()&&D>0||"yearly"===_?l.jsxs("div",{className:"flex gap-2 mb-4",children:[O()&&D>0&&l.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:[l.jsx(o,{className:"h-3 w-3 inline mr-1"}),"限时优惠中，节省 ¥",((S?("monthly"===_?S.monthly:S.yearly).originalPrice:0)-Y()).toFixed(2)]}),"yearly"===_&&l.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:[l.jsx(k,{className:"h-3 w-3 inline mr-1"}),"年付优惠，比月付省 ¥",B(S)]})]}):null,l.jsx(i,{onClick:()=>{S?(z(!0),b({title:"支付二维码已显示",description:"请使用手机扫码完成支付"})):b({title:"请选择订阅计划",description:"请先选择要订阅的计划",variant:"destructive"})},className:"w-full bg-green-500 hover:bg-green-600 text-base py-2",children:"立即支付"})]})}),A&&S&&"trial"!==S.tier&&l.jsx(x,{"data-qr-code":!0,className:"border-blue-100 bg-gradient-to-br from-blue-50 to-white shadow-xl",children:l.jsxs(j,{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:"支"})}),l.jsx("h3",{className:"font-semibold text-blue-900",children:"支付宝扫码支付"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["¥",Y()]}),l.jsx("div",{className:"text-xs text-blue-600",children:"monthly"===_?"月付":"年付"})]})]}),O()&&D>0||"yearly"===_?l.jsxs("div",{className:"flex gap-2 mb-4",children:[O()&&D>0&&l.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:[l.jsx(o,{className:"h-3 w-3 inline mr-1"}),"限时优惠中"]}),"yearly"===_&&l.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:[l.jsx(k,{className:"h-3 w-3 inline mr-1"}),"年付优惠"]})]}):null,l.jsx("div",{className:"flex justify-center items-center py-2",children:(()=>{const e=(t=_,(s=S)&&t?"pro"===s.tier&&"monthly"===t?"prod_3nJOuQeVStqkp6JaDcrKHf":"pro"===s.tier&&"yearly"===t?"prod_5qBlDTLpD3h9gvOZFd4Rgu":"premium"===s.tier&&"monthly"===t?"prod_4HYBfvrcbXYnbxjlswMj28":"premium"===s.tier&&"yearly"===t?"prod_6OfIoVnRg2pXsuYceVKOYk":"":"");var s,t;return e?l.jsx(I,{priceId:e,planName:S.name,price:Y()}):l.jsx("div",{style:{color:"red"},children:"请先选择有效的套餐和周期"})})()}),l.jsx("div",{className:"text-center text-blue-700 text-sm mt-2",children:"请使用支付宝App扫码完成支付"})]})})]}),l.jsxs("div",{className:"mt-6 text-center text-xs md:text-sm text-muted-foreground",children:[l.jsx("p",{className:"text-green-600 font-medium mb-2",children:"💡 随时可取消"}),l.jsx("p",{children:"订阅会在期满后自动续费，您可以随时取消"}),l.jsxs("p",{className:"mt-2",children:["点击立即支付即表示您同意我们的",l.jsx("a",{href:"/terms",className:"text-blue-500 hover:underline mx-1",children:"服务条款"}),"和",l.jsx("a",{href:"/privacy",className:"text-blue-500 hover:underline mx-1",children:"隐私政策"})]})]})]})]})}export{C as default};
