import{j as e}from"./ui-core-CpixwkN4.js";import{r as s,u as r}from"./router-CDHmMMQ-.js";import{p as i,u as c,B as a,s as n,C as l,a as t,b as o,d,e as m,S as x}from"./pages-home-VedHkcQa.js";import{B as h,L as j,I as g}from"./pages-adapt-TpxL9qXl.js";import{S as u}from"./pages-hot-topics-Bfl9l8w8.js";import{u as f}from"./useAuthingStatus-37RmpFhA.js";import{A as p,a as N,b,c as v,d as L,e as y,f as w,g as S,h as C}from"./alert-dialog-BYtbGEVl.js";import{o as U,q as B,aS as D,aK as k,U as T,C as z,p as F,f as I}from"./utils-BtoDKMDU.js";import"./react-vendor-D7XYiaTe.js";import"./components-landing-DkW9i9QU.js";import"./components-layout-DVNx4yCQ.js";import"./components-auth-Dtkj9iM3.js";import"./pages-brand-BFAxHyKh.js";import"./api-services-Bt6XQYxd.js";import"./pages-content-extractor-COXy_-Wy.js";function $({variant:r="destructive",size:l="default",children:t="退出登录",redirectUri:o="/",showConfirm:d=!0,confirmTitle:m="确认退出登录",confirmDescription:x="您确定要退出登录吗？退出后需要重新登录才能访问受保护的功能。",enableSecurityLog:h=!0,className:j="",disabled:g=!1,onLogout:u,onBeforeLogout:f}){const[k,T]=s.useState(!1),{logout:z}=i(),{toast:F}=c(),I=(e,s,r="info")=>{h&&n.secureLog(e,s,r)},$=async()=>{try{if(T(!0),I("用户点击退出登录",{redirectUri:o,timestamp:(new Date).toISOString()}),f&&!(await f()))return void I("退出登录被取消",{reason:"onBeforeLogout returned false"});await z(),I("用户退出登录成功",{redirectUri:o,timestamp:(new Date).toISOString()}),u&&u(),F({title:"退出成功",description:"您已安全退出登录，正在跳转..."})}catch(e){const s=e instanceof Error?e.message:"退出登录失败";I("退出登录失败",{error:s,redirectUri:o,timestamp:(new Date).toISOString()},"error"),F({title:"退出失败",description:s,variant:"destructive"})}finally{T(!1)}},O=e.jsx(e.Fragment,{children:k?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"退出中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),t]})});return d?e.jsxs(p,{children:[e.jsx(N,{asChild:!0,children:e.jsx(a,{variant:r,size:l,className:j,disabled:g||k,children:O})}),e.jsxs(b,{children:[e.jsxs(v,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-orange-500"}),m]}),e.jsxs(y,{className:"flex items-start gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-orange-500 mt-0.5 flex-shrink-0"}),x]})]}),e.jsxs(w,{children:[e.jsx(S,{disabled:k,children:"取消"}),e.jsx(C,{onClick:$,disabled:k,className:"bg-red-600 hover:bg-red-700",children:k?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"退出中..."]}):"确认退出"})]})]})]}):e.jsx(a,{variant:r,size:l,className:j,disabled:g||k,onClick:()=>{$()},children:O})}function O({redirectUri:s="/",children:r="退出登录",className:i="",...c}){return e.jsx($,{showConfirm:!1,redirectUri:s,className:i,...c,children:r})}function A({redirectUri:s="/",children:r="退出登录",className:i="",...c}){return e.jsx($,{showConfirm:!0,redirectUri:s,className:i,...c,children:r})}function q(){const i=r(),[c,n]=s.useState("/"),[p,N]=s.useState(!0),[b,v]=s.useState(!0),[L,y]=s.useState("确认退出登录"),[w,S]=s.useState("您确定要退出登录吗？退出后需要重新登录才能访问受保护的功能。"),[C,q]=s.useState([]),{isLoggedIn:E,user:J,loading:K,error:G}=f({autoCheck:!0,redirectUri:"/logout-button-test",enableSecurityLog:!0}),H=e=>{q(s=>[`${(new Date).toLocaleTimeString()}: ${e}`,...s.slice(0,9)])},M=async()=>(H("退出前检查触发"),!0),P=()=>{H("退出后回调触发")};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(a,{variant:"ghost",onClick:()=>{i(-1)},className:"mb-4",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"返回"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"退出登录按钮测试"}),e.jsx("p",{className:"text-gray-600",children:"测试LogoutButton组件的各种功能和样式"})]}),e.jsxs(l,{className:"mb-8",children:[e.jsxs(t,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"当前登录状态"]}),e.jsx(d,{children:"显示当前用户的登录状态和信息"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[K?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):E?e.jsx(z,{className:"w-4 h-4 text-green-600"}):e.jsx(F,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-medium text-blue-900",children:"登录状态"})]}),e.jsx(h,{variant:E?"default":"secondary",children:K?"检查中...":E?"已登录":"未登录"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium text-green-900",children:"用户信息"})]}),e.jsx("p",{className:"text-sm text-green-700",children:K?"加载中...":J?`${J.nickname} (${J.username})`:"未获取"})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(B,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-medium text-red-900",children:"错误状态"})]}),e.jsx("p",{className:"text-sm text-red-700",children:G||"无错误"})]})]})})]}),e.jsxs(l,{className:"mb-8",children:[e.jsxs(t,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"配置选项"]}),e.jsx(d,{children:"自定义退出登录按钮的行为和样式"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{id:"show-confirm",checked:b,onCheckedChange:v}),e.jsx(j,{htmlFor:"show-confirm",children:"显示确认对话框"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{id:"security-log",checked:p,onCheckedChange:N}),e.jsx(j,{htmlFor:"security-log",children:"启用安全日志"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"redirect-uri",children:"跳转路径"}),e.jsx(g,{id:"redirect-uri",value:c,onChange:e=>n(e.target.value),placeholder:"/"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"custom-title",children:"确认标题"}),e.jsx(g,{id:"custom-title",value:L,onChange:e=>y(e.target.value),placeholder:"确认退出登录"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"custom-description",children:"确认描述"}),e.jsx(g,{id:"custom-description",value:w,onChange:e=>S(e.target.value),placeholder:"您确定要退出登录吗？"})]})]})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-red-600"}),"按钮样式展示"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx(o,{children:"基础样式"}),e.jsx(d,{children:"不同变体的退出登录按钮"})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsx($,{variant:"default",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"默认样式退出"}),e.jsx($,{variant:"destructive",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"危险样式退出"}),e.jsx($,{variant:"outline",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"轮廓样式退出"}),e.jsx($,{variant:"ghost",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"幽灵样式退出"})]})]}),e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx(o,{children:"按钮大小"}),e.jsx(d,{children:"不同尺寸的退出登录按钮"})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsx($,{size:"sm",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"小尺寸退出"}),e.jsx($,{size:"default",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"默认尺寸退出"}),e.jsx($,{size:"lg",showConfirm:b,redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"大尺寸退出"})]})]})]})]}),e.jsx(u,{className:"my-8"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600"}),"便捷组件"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx(o,{children:"简化退出按钮"}),e.jsx(d,{children:"基于您提供的代码逻辑，无确认对话框"})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsx(O,{redirectUri:c,enableSecurityLog:p,onBeforeLogout:M,onLogout:P,children:"直接退出登录"}),e.jsx(O,{variant:"outline",size:"sm",redirectUri:c,enableSecurityLog:p,onBeforeLogout:M,onLogout:P,children:"小尺寸直接退出"})]})]}),e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx(o,{children:"确认退出按钮"}),e.jsx(d,{children:"带确认对话框的安全退出"})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsx(A,{redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"安全退出登录"}),e.jsx(A,{variant:"outline",size:"lg",redirectUri:c,enableSecurityLog:p,confirmTitle:L,confirmDescription:w,onBeforeLogout:M,onLogout:P,children:"大尺寸安全退出"})]})]})]})]}),e.jsx(u,{className:"my-8"}),e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"退出事件日志"]}),e.jsx(d,{children:"记录退出登录过程中的各种事件"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg max-h-60 overflow-y-auto",children:0===C.length?e.jsx("p",{className:"text-gray-500 text-center",children:"暂无事件记录"}):e.jsx("div",{className:"space-y-2",children:C.map((s,r)=>e.jsx("div",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:s},r))})}),e.jsx("div",{className:"mt-4",children:e.jsx(a,{variant:"outline",size:"sm",onClick:()=>q([]),children:"清空日志"})})]})]}),e.jsxs(l,{className:"mt-8",children:[e.jsxs(t,{children:[e.jsx(o,{children:"功能特性"}),e.jsx(d,{children:"LogoutButton组件的主要功能和特性"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"核心功能"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:"• 安全退出登录"}),e.jsx("li",{children:"• 确认对话框"}),e.jsx("li",{children:"• 自定义跳转路径"}),e.jsx("li",{children:"• 多种样式变体"}),e.jsx("li",{children:"• 加载状态显示"}),e.jsx("li",{children:"• 错误处理"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"安全特性"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:"• 安全日志记录"}),e.jsx("li",{children:"• 退出前回调"}),e.jsx("li",{children:"• 退出后回调"}),e.jsx("li",{children:"• 状态验证"}),e.jsx("li",{children:"• 防重复操作"}),e.jsx("li",{children:"• 用户确认机制"})]})]})]})})]})]})}export{q as default};
